var R1=Object.defineProperty;var M1=(t,e,n)=>e in t?R1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Mt=(t,e,n)=>M1(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const Le={get pageContainer(){return document.getElementById("page-container")},get loginSignupBtn(){return document.getElementById("login-signup-btn")},get myAccountDropdown(){return document.getElementById("my-account-dropdown")},get myAccountBtn(){return document.getElementById("my-account-btn")},get trackBtn(){return document.getElementById("track-btn")},get authModal(){return document.getElementById("auth-modal")},get closeAuthModalBtn(){return document.getElementById("close-auth-modal-btn")},get loginView(){return document.getElementById("login-view")},get signupView(){return document.getElementById("signup-view")},get loginToggleText(){return document.getElementById("login-toggle-text")},get signupToggleText(){return document.getElementById("signup-toggle-text")},get showSignupBtn(){return document.getElementById("show-signup-btn")},get showLoginBtn(){return document.getElementById("show-login-btn")},get loginForm(){return document.getElementById("login-form")},get signupForm(){return document.getElementById("signup-form")},get loginEmail(){return document.getElementById("login-email")},get loginPassword(){return document.getElementById("login-password")},get signupName(){return document.getElementById("signup-name")},get signupEmail(){return document.getElementById("signup-email")},get signupPassword(){return document.getElementById("signup-password")},get googleLoginBtn(){return document.querySelector(".google-login-btn")},get appleLoginBtn(){return document.querySelector(".apple-login-btn")},get trackingModal(){return document.getElementById("tracking-modal")},get closeTrackingModalBtn(){return document.getElementById("close-tracking-modal-btn")},get trackingForm(){return document.getElementById("tracking-form")},get trackingIdInput(){return document.getElementById("tracking-id-input")},get complianceBtn(){return document.getElementById("compliance-btn")},get inspectorModal(){return document.getElementById("inspector-modal")},get closeInspectorModalBtn(){return document.getElementById("close-inspector-modal-btn")},get shippingAgreementModal(){return document.getElementById("shipping-agreement-modal")},get closeShippingAgreementModalBtn(){return document.getElementById("close-shipping-agreement-modal-btn")},get shippingAgreementCheckbox(){return document.getElementById("shipping-agreement-checkbox")},get shippingAgreementProceedBtn(){return document.getElementById("shipping-agreement-proceed-btn")},get downloadShippingAgreementPdfBtn(){return document.getElementById("download-shipping-agreement-pdf-btn")},get trackingDeviceModal(){return document.getElementById("tracking-device-modal")},get closeTrackingDeviceModalBtn(){return document.getElementById("close-tracking-device-modal-btn")},get pageLanding(){return document.getElementById("page-landing")},get pageDashboard(){return document.getElementById("page-dashboard")},get pageAddressBook(){return document.getElementById("page-address-book")},get pageSettings(){return document.getElementById("page-settings")},get pageHelp(){return document.getElementById("page-help")},get pageApiHub(){return document.getElementById("page-api-hub")},get pagePrivacy(){return document.getElementById("page-privacy")},get pageTerms(){return document.getElementById("page-terms")},get pagePayment(){return document.getElementById("page-payment")},get pageConfirmation(){return document.getElementById("page-confirmation")},get pageResults(){return document.getElementById("page-results")},parcel:{get quotesContainer(){return document.getElementById("parcel-quotes-container")},get warningsContainer(){return document.getElementById("parcel-warnings-container")}},ecommerce:{get productGrid(){return document.getElementById("ecom-product-grid")},get emptyState(){return document.getElementById("ecom-empty-state")},get wizardContainer(){return document.getElementById("ecom-wizard-container")},get specsList(){return document.getElementById("ecom-specs-list")},get publishSuccess(){return document.getElementById("ecom-publish-success")},get nextBtn(){return document.getElementById("ecom-next-btn")},get prevBtn(){return document.getElementById("ecom-prev-btn")},get productTypeSelector(){return document.getElementById("ecom-product-type-selector")},get physicalProductFields(){return document.getElementById("ecom-physical-product-fields")},get externalProductFields(){return document.getElementById("ecom-external-product-fields")},get reviewPane(){return document.getElementById("ecom-review-pane")},get productName(){return document.getElementById("ecom-product-name")},get productDescription(){return document.getElementById("ecom-product-description")},get productCategory(){return document.getElementById("ecom-product-category")},get productBrand(){return document.getElementById("ecom-product-brand")},get productStock(){return document.getElementById("ecom-product-stock")},get productPrice(){return document.getElementById("ecom-product-price")},get productLink(){return document.getElementById("product-link")},get listProductCtaHero(){return document.getElementById("ecom-list-product-cta-hero")},get addNewFromEmptyBtn(){return document.getElementById("ecom-add-new-from-empty-btn")},get addSpecBtn(){return document.getElementById("add-spec-btn")},get listAnotherProductBtn(){return document.getElementById("list-another-product-btn")},get successTitle(){return document.getElementById("ecom-success-title")}},fcl:{get quoteForm(){return document.getElementById("fcl-quote-form")},get containerList(){return document.getElementById("fcl-container-list")},get pickupAddressFields(){return document.getElementById("fcl-pickup-address-fields")},get pickupLocationFields(){return document.getElementById("fcl-pickup-location-fields")},get deliveryAddressFields(){return document.getElementById("fcl-delivery-address-fields")},get deliveryLocationFields(){return document.getElementById("fcl-delivery-location-fields")},get pickupName(){return document.getElementById("fcl-pickup-name")},get pickupCountry(){return document.getElementById("fcl-pickup-country")},get pickupPortInput(){return document.getElementById("fcl-pickup-port")},get deliveryName(){return document.getElementById("fcl-delivery-name")},get deliveryCountry(){return document.getElementById("fcl-delivery-country")},get deliveryPortInput(){return document.getElementById("fcl-delivery-port")},get cargoDescription(){return document.getElementById("fcl-cargo-description")},get hsCodeInput(){return document.getElementById("fcl-hs-code")},get confirmationTitle(){return document.getElementById("fcl-confirmation-title")},get confirmationMessage(){return document.getElementById("fcl-confirmation-message")},nav:{get backToDetails(){return document.getElementById("fcl-back-to-details-btn")},get toAgreement(){return document.getElementById("fcl-to-agreement-btn")},get backToCompliance(){return document.getElementById("fcl-back-to-compliance-btn")},get toPayment(){return document.getElementById("fcl-to-payment-btn")},get newShipment(){return document.getElementById("fcl-new-shipment-btn")},get downloadDocs(){return document.getElementById("fcl-download-docs-btn")}}},lcl:{get detailsForm(){return document.getElementById("lcl-details-form")},get cargoDescription(){return document.getElementById("lcl-cargo-description")},get hsCodeInput(){return document.getElementById("lcl-hs-code")},get suggestHsCodeBtn(){return document.getElementById("lcl-suggest-hs-code-btn")},get cargoList(){return document.getElementById("lcl-cargo-list")},get addCargoBtn(){return document.getElementById("lcl-add-cargo-btn")},get isStackable(){return document.getElementById("lcl-is-stackable")},get isHazardous(){return document.getElementById("lcl-is-hazardous")},get imdgClassContainer(){return document.getElementById("lcl-imdg-class-container")},get totalCbm(){return document.getElementById("lcl-total-cbm")},get chargeableWeight(){return document.getElementById("lcl-chargeable-weight")},get fclSuggestion(){return document.getElementById("lcl-fcl-suggestion")},get paymentForm(){return document.getElementById("lcl-payment-form")},steps:{get details(){return document.getElementById("lcl-step-details")},get cargo(){return document.getElementById("lcl-step-cargo")},get service(){return document.getElementById("lcl-step-service")},get docs(){return document.getElementById("lcl-step-docs")},get quote(){return document.getElementById("lcl-step-quote")},get payment(){return document.getElementById("lcl-step-payment")},get confirmation(){return document.getElementById("lcl-step-confirmation")}},nav:{get backToDetails(){return document.getElementById("lcl-back-to-details-btn")},get toService(){return document.getElementById("lcl-to-service-btn")},get backToCargo(){return document.getElementById("lcl-back-to-cargo-btn")},get toDocs(){return document.getElementById("lcl-to-docs-btn")},get backToService(){return document.getElementById("lcl-back-to-service-btn")},get toQuote(){return document.getElementById("lcl-to-quote-btn")},get backToDocs(){return document.getElementById("lcl-back-to-docs-btn")},get toPayment(){return document.getElementById("lcl-to-payment-btn")},get backToQuote(){return document.getElementById("lcl-back-to-quote-btn")},get newShipment(){return document.getElementById("lcl-new-shipment-btn")},get downloadLabels(){return document.getElementById("lcl-download-labels-btn")}}},vehicle:{get detailsForm(){return document.getElementById("vehicle-details-form")},get originPort(){return document.getElementById("vehicle-origin-port")},get destPort(){return document.getElementById("vehicle-dest-port")},get make(){return document.getElementById("vehicle-make")},get model(){return document.getElementById("vehicle-model")},get year(){return document.getElementById("vehicle-year")},get condition(){return document.getElementById("vehicle-condition")},get canRoll(){return document.getElementById("vehicle-can-roll")},get photoDropArea(){return document.getElementById("vehicle-photo-drop-area")},get photoInput(){return document.getElementById("vehicle-photo-input")},get length(){return document.getElementById("vehicle-length")},get width(){return document.getElementById("vehicle-width")},get height(){return document.getElementById("vehicle-height")},get weight(){return document.getElementById("vehicle-weight")},get shippingOptions(){return document.getElementById("vehicle-shipping-options")},get quoteSummary(){return document.getElementById("vehicle-quote-summary")},get complianceSummary(){return document.getElementById("vehicle-compliance-summary")},get paymentForm(){return document.getElementById("vehicle-payment-form")},get paymentOverview(){return document.getElementById("vehicle-payment-overview")},get confirmationTitle(){return document.getElementById("vehicle-confirmation-title")},get confirmationMessage(){return document.getElementById("vehicle-confirmation-message")},nav:{get backToDetails(){return document.getElementById("vehicle-back-to-details-btn")},get toMethod(){return document.getElementById("vehicle-to-method-btn")},get backToDims(){return document.getElementById("vehicle-back-to-dims-btn")},get toQuote(){return document.getElementById("vehicle-to-quote-btn")},get backToMethod(){return document.getElementById("vehicle-back-to-method-btn")},get toPayment(){return document.getElementById("vehicle-to-payment-btn")},get backToQuote(){return document.getElementById("vehicle-back-to-quote-btn")},get newShipment(){return document.getElementById("vehicle-new-shipment-btn")},get downloadDocs(){return document.getElementById("vehicle-download-docs-btn")}}},bulk:{get detailsForm(){return document.getElementById("bulk-details-form")},get cargoType(){return document.getElementById("bulk-cargo-type")},get cargoQuantity(){return document.getElementById("bulk-cargo-quantity")},get cargoDescription(){return document.getElementById("bulk-cargo-description")},get originPort(){return document.getElementById("bulk-origin-port")},get destPort(){return document.getElementById("bulk-dest-port")},get quoteSummary(){return document.getElementById("bulk-quote-summary")},get confirmationTitle(){return document.getElementById("bulk-confirmation-title")},get confirmationMessage(){return document.getElementById("bulk-confirmation-message")},steps:{get cargo(){return document.getElementById("bulk-step-cargo")},get route(){return document.getElementById("bulk-step-route")},get docs(){return document.getElementById("bulk-step-docs")},get quote(){return document.getElementById("bulk-step-quote")},get confirmation(){return document.getElementById("bulk-step-confirmation")}},nav:{get backToCargo(){return document.getElementById("bulk-back-to-cargo-btn")},get toRoute(){return document.getElementById("bulk-to-route-btn")},get backToRoute(){return document.getElementById("bulk-back-to-route-btn")},get toDocs(){return document.getElementById("bulk-to-docs-btn")},get backToDocs(){return document.getElementById("bulk-back-to-docs-btn")},get toQuote(){return document.getElementById("bulk-to-quote-btn")},get backToQuote(){return document.getElementById("bulk-back-to-quote-btn")},get toConfirmation(){return document.getElementById("bulk-to-confirmation-btn")},get newShipment(){return document.getElementById("bulk-new-shipment-btn")},get downloadDocs(){return document.getElementById("bulk-download-docs-btn")}}},airfreight:{get detailsForm(){return document.getElementById("airfreight-details-form")},get addPieceBtn(){return document.getElementById("airfreight-add-piece-btn")},get serviceLevelSelector(){return document.getElementById("airfreight-service-level-selector")},get complianceChecklist(){return document.getElementById("airfreight-compliance-checklist")},get ratesContainer(){return document.getElementById("airfreight-rates-container")},get confirmationTitle(){return document.getElementById("airfreight-confirmation-title")},get confirmationMessage(){return document.getElementById("airfreight-confirmation-message")},get confirmationAWB(){return document.getElementById("airfreight-confirmation-awb")},nav:{get backToDetails(){return document.getElementById("airfreight-back-to-details-btn")},get toService(){return document.getElementById("airfreight-to-service-btn")},get backToDims(){return document.getElementById("airfreight-back-to-dims-btn")},get toDocs(){return document.getElementById("airfreight-to-docs-btn")},get backToService(){return document.getElementById("airfreight-back-to-service-btn")},get toRates(){return document.getElementById("airfreight-to-rates-btn")},get backToDocs(){return document.getElementById("airfreight-back-to-docs-btn")},get toConfirmation(){return document.getElementById("airfreight-to-confirmation-btn")},get newShipment(){return document.getElementById("airfreight-new-shipment-btn")},get downloadPDF(){return document.getElementById("airfreight-download-pdf-btn")}}},inland:{get mapForm(){return document.getElementById("inland-map-form")},get originSearch(){return document.getElementById("inland-origin-search")},get destSearch(){return document.getElementById("inland-dest-search")},get ftlToggle(){return document.getElementById("inland-ftl-toggle")},get truckBoardList(){return document.getElementById("inland-truck-board-list")},get paymentOverview(){return document.getElementById("inland-payment-overview")},get paymentForm(){return document.getElementById("inland-payment-form")},get trackingView(){return document.getElementById("inland-tracking-view")},get trackingTitle(){return document.getElementById("inland-tracking-title")},steps:{get map(){return document.getElementById("inland-step-map")},get cargo(){return document.getElementById("inland-step-cargo")},get board(){return document.getElementById("inland-step-board")},get docs(){return document.getElementById("inland-step-docs")},get payment(){return document.getElementById("inland-step-payment")}},nav:{get backToMap(){return document.getElementById("inland-back-to-map-btn")},get toBoard(){return document.getElementById("inland-to-board-btn")},get backToCargo(){return document.getElementById("inland-back-to-cargo-btn")},get backToBoard(){return document.getElementById("inland-back-to-board-btn")},get toPayment(){return document.getElementById("inland-to-payment-btn")},get newBooking(){return document.getElementById("inland-new-booking-btn")},get downloadDocs(){return document.getElementById("inland-download-docs-btn")}}},rivertug:{get detailsForm(){return document.getElementById("rivertug-details-form")},get originPort(){return document.getElementById("rivertug-origin-port")},get destPort(){return document.getElementById("rivertug-dest-port")},get cargoDescription(){return document.getElementById("rivertug-cargo-description")},get cargoVolume(){return document.getElementById("rivertug-cargo-volume")},get isHazardous(){return document.getElementById("rivertug-is-hazardous")},get bargeTypeSelector(){return document.getElementById("rivertug-barge-type-selector")},get complianceChecklist(){return document.getElementById("rivertug-compliance-checklist")},get quoteSummary(){return document.getElementById("rivertug-quote-summary")},get confirmationTitle(){return document.getElementById("rivertug-confirmation-title")},get confirmationMessage(){return document.getElementById("rivertug-confirmation-message")},steps:{get details(){return document.getElementById("rivertug-step-details")},get docs(){return document.getElementById("rivertug-step-docs")},get quote(){return document.getElementById("rivertug-step-quote")},get confirmation(){return document.getElementById("rivertug-step-confirmation")}},nav:{get backToDetails(){return document.getElementById("rivertug-back-to-details-btn")},get toQuote(){return document.getElementById("rivertug-to-quote-btn")},get backToDocs(){return document.getElementById("rivertug-back-to-docs-btn")},get toConfirmation(){return document.getElementById("rivertug-to-confirmation-btn")},get newShipment(){return document.getElementById("rivertug-new-shipment-btn")},get downloadBundle(){return document.getElementById("rivertug-download-bundle-btn")}}},warehouse:{get facilityList(){return document.getElementById("warehouse-facility-list")},get locationSearch(){return document.getElementById("warehouse-location-search")},get filterCheckboxes(){return document.querySelectorAll('#warehouse-filters input[type="checkbox"]')},get applyFiltersBtn(){return document.getElementById("warehouse-apply-filters-btn")},get complianceChecklist(){return document.getElementById("warehouse-compliance-checklist")},get serviceLevelSelector(){return document.getElementById("warehouse-service-level-selector")}},schedules:{get originInput(){return document.getElementById("schedules-origin-input")},get destInput(){return document.getElementById("schedules-dest-input")},get modeSelect(){return document.getElementById("schedules-mode-select")},get carrierSelect(){return document.getElementById("schedules-carrier-select")}},register:{get page(){return document.getElementById("page-register")},get mainView(){return document.getElementById("tf-main-view")},get applicationView(){return document.getElementById("tf-application-view")},get advisorForm(){return document.getElementById("tf-advisor-form")},get userQueryInput(){return document.getElementById("tf-user-query")},get chatHistory(){return document.getElementById("tf-chat-history")},get complianceChecklist(){return document.getElementById("tf-compliance-checklist")}},paymentPage:{get overview(){return document.getElementById("payment-overview")},get form(){return document.getElementById("payment-form")}},confirmationPage:{get title(){return document.getElementById("confirmation-title")},get message(){return document.getElementById("confirmation-message")},get newShipmentBtn(){return document.getElementById("new-shipment-btn")},get pdfBtn(){return document.getElementById("download-pdf-btn")}}};let j={api:null,currentPage:"landing",currentService:null,isLoggedIn:!1,currentUser:null,postLoginRedirectService:null,subscriptionTier:"guest",subscription:null,aiLookupsRemaining:0,currentCurrency:{code:"USD",symbol:"$"},parcelOrigin:null,parcelDestination:null,parcelPickupType:"pickup",parcelSelectedQuote:null,parcelInsuranceAdded:!1,parcelDeclaredValue:0,parcelInsuranceCost:0,parcelPremiumTrackingAdded:!1,parcelPremiumTrackingCost:15,ecomProducts:[],ecomEditingProductId:null,ecomProductType:"physical",ecomInitialView:null,ecomCurrentView:"dashboard",ecomViewingProductId:null,currentBaggageStep:"details",baggageDetails:null,baggageQuote:null,baggageInsuranceCost:0,baggageTrackerCost:0,currentFclStep:1,fclDetails:null,fclQuote:null,fclComplianceDocs:[],fclFlashSlots:[],fclSlotIntervalId:null,fclBookingId:null,fclSignatureDataUrl:null,currentLclStep:1,lclDetails:null,lclComplianceDocs:[],lclQuote:null,lclBookingId:null,currentVehicleStep:1,vehicleDetails:null,vehicleShippingMethod:null,vehicleQuote:null,vehicleComplianceDocs:[],vehicleBookingId:null,currentBulkStep:1,bulkDetails:null,bulkQuote:null,bulkBookingId:null,currentAirfreightStep:1,airfreightDetails:null,airfreightComplianceDocs:[],airfreightQuote:null,airfreightBookingId:null,currentRailwayStep:1,railwayDetails:null,railwayComplianceDocs:[],railwayQuote:null,railwayBookingId:null,currentRiverTugStep:1,riverTugDetails:null,riverTugComplianceDocs:[],riverTugQuote:null,riverTugBookingId:null,currentInlandStep:1,inlandDetails:null,availableTrucks:[],inlandSignatureDataUrl:null,currentWarehouseStep:1,warehouseDetails:null,warehouseComplianceDocs:[],warehouseBookingId:null,currentTradeFinanceStep:1,tradeFinanceProduct:null,tradeFinanceComplianceDocs:[],tradeFinanceAssessment:null,currentSecureTradeStep:1,secureTradeDetails:null,secureTradeId:null,secureTradeFee:0,secureTradeTotalDeposit:0,paymentContext:null,paymentClientSecret:null,promotions:[],activePromotionInterval:null};function Ae(t){j={...j,...t}}function mh(){Ae({parcelOrigin:null,parcelDestination:null,parcelInitialWeight:void 0,parcelInitialLength:void 0,parcelInitialWidth:void 0,parcelInitialHeight:void 0,parcelPickupType:"pickup",parcelSelectedQuote:null,parcelInsuranceAdded:!1,parcelDeclaredValue:0,parcelInsuranceCost:0,parcelPremiumTrackingAdded:!1})}function zm(){Ae({currentBaggageStep:"details",baggageDetails:null,baggageQuote:null,baggageInsuranceCost:0,baggageTrackerCost:0})}function B1(){Ae({currentFclStep:1,fclDetails:null,fclQuote:null,fclComplianceDocs:[],fclBookingId:null,fclSignatureDataUrl:null})}function Jm(){Ae({currentLclStep:1,lclDetails:null,lclQuote:null,lclBookingId:null,lclComplianceDocs:[]})}function D1(){Ae({currentVehicleStep:1,vehicleDetails:null,vehicleShippingMethod:null,vehicleQuote:null,vehicleBookingId:null,vehicleComplianceDocs:[]})}function Ym(){Ae({currentBulkStep:1,bulkDetails:null,bulkQuote:null,bulkBookingId:null})}function F1(){Ae({currentAirfreightStep:1,airfreightDetails:null,airfreightQuote:null,airfreightBookingId:null,airfreightComplianceDocs:[]})}function Km(){Ae({currentRailwayStep:1,railwayDetails:null,railwayComplianceDocs:[],railwayQuote:null,railwayBookingId:null})}function jm(){Ae({currentRiverTugStep:1,riverTugDetails:null,riverTugComplianceDocs:[],riverTugQuote:null,riverTugBookingId:null})}function q1(){Ae({currentInlandStep:1,inlandDetails:null,availableTrucks:[],inlandSignatureDataUrl:null})}function Qm(){Ae({currentWarehouseStep:1,warehouseDetails:null,warehouseComplianceDocs:[],warehouseBookingId:null})}function U1(){Ae({currentTradeFinanceStep:1,tradeFinanceProduct:null,tradeFinanceComplianceDocs:[],tradeFinanceAssessment:null})}function $1(){Ae({currentSecureTradeStep:1,secureTradeDetails:null,secureTradeId:null,secureTradeFee:0,secureTradeTotalDeposit:0})}const Ei=(t,e)=>{const n=document.getElementById(`progress-bar-${t}`);if(!n)return;n.querySelectorAll(".progress-step").forEach((r,o)=>{r.classList.remove("active","completed"),o<e?r.classList.add("completed"):o===e&&r.classList.add("active")})};function O1(){const t=j.currentPage,e=document.getElementById("app-sidebar");if(e){e.querySelectorAll(".sidebar-btn, .sidebar-btn-service").forEach(r=>{r.classList.remove("active")});let i=e.querySelector(`.sidebar-btn-service[data-service="${t}"]`);i||(i=e.querySelector(`.sidebar-btn.static-link[data-page="${t}"]`)),t==="landing"&&(i=e.querySelector('.sidebar-btn.static-link[data-page="landing"]')),i&&i.classList.add("active")}const n=document.querySelector("header");if(n){n.querySelectorAll(".header-btn.static-link").forEach(r=>{r.classList.remove("active")});const i=n.querySelector(`.header-btn.static-link[data-page="${t}"]`);i&&i.classList.add("active")}}const bt=t=>{if(j.currentPage===t&&t!=="landing")return;document.querySelectorAll("#page-container .page").forEach(n=>{n.classList.remove("active")});const e=document.getElementById(`page-${t}`);e?(e.classList.add("active"),Ae({currentPage:t}),O1(),window.scrollTo(0,0)):(console.error(`Page switch failed: Element for page '${t}' not found.`),j.currentPage!=="landing"&&bt("landing"))};function Ee(t,e="info",n=3e3){const i=document.getElementById("toast-container");if(!i)return;const r={success:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /></svg>',error:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /></svg>',info:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z" /></svg>',warning:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" /></svg>'},o=document.createElement("div");o.className=`toast toast-${e}`,o.setAttribute("role","alert"),o.setAttribute("aria-live","assertive"),o.innerHTML=`
        <div class="toast-icon">${r[e]}</div>
        <div class="toast-message">${t}</div>
    `,i.appendChild(o),setTimeout(()=>o.classList.add("show"),10),setTimeout(()=>{o.classList.remove("show"),o.addEventListener("transitionend",()=>o.remove(),{once:!0})},n)}const rt=(t,e="Please wait...")=>{const n=document.getElementById("loading-overlay"),i=document.getElementById("loading-progress-text");!n||!i||(i.textContent=e,n.classList.toggle("active",t))};function tf(){Le.authModal.classList.add("active")}function H1(){Le.authModal.classList.remove("active")}function vh(t){const e=document.getElementById("usage-limit-modal"),n=document.getElementById("limit-modal-title"),i=document.getElementById("limit-modal-message"),r=document.getElementById("limit-modal-action-btn"),o=document.getElementById("close-limit-modal-btn");!e||!n||!i||!r||!o||(t==="guest"?(n.textContent="Free Lookups Used",i.textContent="You've used your 2 free trial lookups. Sign up for a free account to get 5 more each month.",r.textContent="Sign Up for Free",r.onclick=()=>{yh(),tf()}):(n.textContent="Monthly Limit Reached",i.textContent="You have reached your monthly limit of 5 AI-powered quotes. Upgrade to Pro for unlimited access and exclusive rates.",r.textContent="Upgrade to Pro",r.onclick=()=>{Ee("Pro plans are coming soon!","info")}),o.onclick=yh,e.classList.add("active"))}function yh(){const t=document.getElementById("usage-limit-modal");t&&t.classList.remove("active")}function od(){const t=document.getElementById("lookup-counter");if(t)if(j.isLoggedIn)j.subscriptionTier==="free"?(t.textContent=`You have ${j.aiLookupsRemaining} AI quotes left this month.`,t.style.display="block"):t.style.display="none";else{const e=parseInt(localStorage.getItem("vcanship_guest_lookups")||"2",10);t.textContent=`You have ${e} AI lookups remaining in your free trial.`,t.style.display="block"}}const V1="modulepreload",G1=function(t){return"/"+t},bh={},Xr=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){let s=function(u){return Promise.all(u.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=s(n.map(u=>{if(u=G1(u),u in bh)return;bh[u]=!0;const f=u.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const v=document.createElement("link");if(v.rel=f?"stylesheet":V1,f||(v.as="script"),v.crossOrigin="",v.href=u,c&&v.setAttribute("nonce",c),document.head.appendChild(v),f)return new Promise((m,S)=>{v.addEventListener("load",m),v.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return r.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})};function Bt(t){"@babel/helpers - typeof";return Bt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bt(t)}var Fi=Uint8Array,ci=Uint16Array,nf=Int32Array,rf=new Fi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),of=new Fi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),wh=new Fi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Xm=function(t,e){for(var n=new ci(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];for(var r=new nf(n[30]),i=1;i<30;++i)for(var o=n[i];o<n[i+1];++o)r[o]=o-n[i]<<5|i;return{b:n,r}},Zm=Xm(rf,2),W1=Zm.b,sd=Zm.r;W1[28]=258,sd[258]=28;var z1=Xm(of,0),Sh=z1.r,ad=new ci(32768);for(var Yt=0;Yt<32768;++Yt){var $r=(Yt&43690)>>1|(Yt&21845)<<1;$r=($r&52428)>>2|($r&13107)<<2,$r=($r&61680)>>4|($r&3855)<<4,ad[Yt]=(($r&65280)>>8|($r&255)<<8)>>1}var Sa=(function(t,e,n){for(var i=t.length,r=0,o=new ci(e);r<i;++r)t[r]&&++o[t[r]-1];var s=new ci(e);for(r=1;r<e;++r)s[r]=s[r-1]+o[r-1]<<1;var a;if(n){a=new ci(1<<e);var c=15-e;for(r=0;r<i;++r)if(t[r])for(var u=r<<4|t[r],f=e-t[r],p=s[t[r]-1]++<<f,v=p|(1<<f)-1;p<=v;++p)a[ad[p]>>c]=u}else for(a=new ci(i),r=0;r<i;++r)t[r]&&(a[r]=ad[s[t[r]-1]++]>>15-t[r]);return a}),Do=new Fi(288);for(var Yt=0;Yt<144;++Yt)Do[Yt]=8;for(var Yt=144;Yt<256;++Yt)Do[Yt]=9;for(var Yt=256;Yt<280;++Yt)Do[Yt]=7;for(var Yt=280;Yt<288;++Yt)Do[Yt]=8;var ic=new Fi(32);for(var Yt=0;Yt<32;++Yt)ic[Yt]=5;var J1=Sa(Do,9,0),Y1=Sa(ic,5,0),ev=function(t){return(t+7)/8|0},K1=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new Fi(t.subarray(e,n))},gr=function(t,e,n){n<<=e&7;var i=e/8|0;t[i]|=n,t[i+1]|=n>>8},ma=function(t,e,n){n<<=e&7;var i=e/8|0;t[i]|=n,t[i+1]|=n>>8,t[i+2]|=n>>16},pu=function(t,e){for(var n=[],i=0;i<t.length;++i)t[i]&&n.push({s:i,f:t[i]});var r=n.length,o=n.slice();if(!r)return{t:nv,l:0};if(r==1){var s=new Fi(n[0].s+1);return s[n[0].s]=1,{t:s,l:1}}n.sort(function(G,ee){return G.f-ee.f}),n.push({s:-1,f:25001});var a=n[0],c=n[1],u=0,f=1,p=2;for(n[0]={s:-1,f:a.f+c.f,l:a,r:c};f!=r-1;)a=n[n[u].f<n[p].f?u++:p++],c=n[u!=f&&n[u].f<n[p].f?u++:p++],n[f++]={s:-1,f:a.f+c.f,l:a,r:c};for(var v=o[0].s,i=1;i<r;++i)o[i].s>v&&(v=o[i].s);var m=new ci(v+1),S=ld(n[f-1],m,0);if(S>e){var i=0,_=0,E=S-e,C=1<<E;for(o.sort(function(ee,te){return m[te.s]-m[ee.s]||ee.f-te.f});i<r;++i){var k=o[i].s;if(m[k]>e)_+=C-(1<<S-m[k]),m[k]=e;else break}for(_>>=E;_>0;){var I=o[i].s;m[I]<e?_-=1<<e-m[I]++-1:++i}for(;i>=0&&_;--i){var P=o[i].s;m[P]==e&&(--m[P],++_)}S=e}return{t:new Fi(m),l:S}},ld=function(t,e,n){return t.s==-1?Math.max(ld(t.l,e,n+1),ld(t.r,e,n+1)):e[t.s]=n},_h=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new ci(++e),i=0,r=t[0],o=1,s=function(c){n[i++]=c},a=1;a<=e;++a)if(t[a]==r&&a!=e)++o;else{if(!r&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(r),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(r);o=1,r=t[a]}return{c:n.subarray(0,i),n:e}},va=function(t,e){for(var n=0,i=0;i<e.length;++i)n+=t[i]*e[i];return n},tv=function(t,e,n){var i=n.length,r=ev(e+2);t[r]=i&255,t[r+1]=i>>8,t[r+2]=t[r]^255,t[r+3]=t[r+1]^255;for(var o=0;o<i;++o)t[r+o+4]=n[o];return(r+4+i)*8},Ch=function(t,e,n,i,r,o,s,a,c,u,f){gr(e,f++,n),++r[256];for(var p=pu(r,15),v=p.t,m=p.l,S=pu(o,15),_=S.t,E=S.l,C=_h(v),k=C.c,I=C.n,P=_h(_),G=P.c,ee=P.n,te=new ci(19),Y=0;Y<k.length;++Y)++te[k[Y]&31];for(var Y=0;Y<G.length;++Y)++te[G[Y]&31];for(var D=pu(te,7),Z=D.t,N=D.l,F=19;F>4&&!Z[wh[F-1]];--F);var J=u+5<<3,W=va(r,Do)+va(o,ic)+s,ce=va(r,v)+va(o,_)+s+14+3*F+va(te,Z)+2*te[16]+3*te[17]+7*te[18];if(c>=0&&J<=W&&J<=ce)return tv(e,f,t.subarray(c,c+u));var fe,ge,ae,ve;if(gr(e,f,1+(ce<W)),f+=2,ce<W){fe=Sa(v,m,0),ge=v,ae=Sa(_,E,0),ve=_;var xe=Sa(Z,N,0);gr(e,f,I-257),gr(e,f+5,ee-1),gr(e,f+10,F-4),f+=14;for(var Y=0;Y<F;++Y)gr(e,f+3*Y,Z[wh[Y]]);f+=3*F;for(var _e=[k,G],R=0;R<2;++R)for(var O=_e[R],Y=0;Y<O.length;++Y){var V=O[Y]&31;gr(e,f,xe[V]),f+=Z[V],V>15&&(gr(e,f,O[Y]>>5&127),f+=O[Y]>>12)}}else fe=J1,ge=Do,ae=Y1,ve=ic;for(var Y=0;Y<a;++Y){var Q=i[Y];if(Q>255){var V=Q>>18&31;ma(e,f,fe[V+257]),f+=ge[V+257],V>7&&(gr(e,f,Q>>23&31),f+=rf[V]);var ne=Q&31;ma(e,f,ae[ne]),f+=ve[ne],ne>3&&(ma(e,f,Q>>5&8191),f+=of[ne])}else ma(e,f,fe[Q]),f+=ge[Q]}return ma(e,f,fe[256]),f+ge[256]},j1=new nf([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),nv=new Fi(0),Q1=function(t,e,n,i,r,o){var s=o.z||t.length,a=new Fi(i+s+5*(1+Math.ceil(s/7e3))+r),c=a.subarray(i,a.length-r),u=o.l,f=(o.r||0)&7;if(e){f&&(c[0]=o.r>>3);for(var p=j1[e-1],v=p>>13,m=p&8191,S=(1<<n)-1,_=o.p||new ci(32768),E=o.h||new ci(S+1),C=Math.ceil(n/3),k=2*C,I=function(he){return(t[he]^t[he+1]<<C^t[he+2]<<k)&S},P=new nf(25e3),G=new ci(288),ee=new ci(32),te=0,Y=0,D=o.i||0,Z=0,N=o.w||0,F=0;D+2<s;++D){var J=I(D),W=D&32767,ce=E[J];if(_[W]=ce,E[J]=W,N<=D){var fe=s-D;if((te>7e3||Z>24576)&&(fe>423||!u)){f=Ch(t,c,0,P,G,ee,Y,Z,F,D-F,f),Z=te=Y=0,F=D;for(var ge=0;ge<286;++ge)G[ge]=0;for(var ge=0;ge<30;++ge)ee[ge]=0}var ae=2,ve=0,xe=m,_e=W-ce&32767;if(fe>2&&J==I(D-_e))for(var R=Math.min(v,fe)-1,O=Math.min(32767,D),V=Math.min(258,fe);_e<=O&&--xe&&W!=ce;){if(t[D+ae]==t[D+ae-_e]){for(var Q=0;Q<V&&t[D+Q]==t[D+Q-_e];++Q);if(Q>ae){if(ae=Q,ve=_e,Q>R)break;for(var ne=Math.min(_e,Q-2),le=0,ge=0;ge<ne;++ge){var de=D-_e+ge&32767,ue=_[de],we=de-ue&32767;we>le&&(le=we,ce=de)}}}W=ce,ce=_[W],_e+=W-ce&32767}if(ve){P[Z++]=268435456|sd[ae]<<18|Sh[ve];var Ie=sd[ae]&31,Re=Sh[ve]&31;Y+=rf[Ie]+of[Re],++G[257+Ie],++ee[Re],N=D+ae,++te}else P[Z++]=t[D],++G[t[D]]}}for(D=Math.max(D,N);D<s;++D)P[Z++]=t[D],++G[t[D]];f=Ch(t,c,u,P,G,ee,Y,Z,F,D-F,f),u||(o.r=f&7|c[f/8|0]<<3,f-=7,o.h=E,o.p=_,o.i=D,o.w=N)}else{for(var D=o.w||0;D<s+u;D+=65535){var Me=D+65535;Me>=s&&(c[f/8|0]=u,Me=s),f=tv(c,f+1,t.subarray(D,Me))}o.i=s}return K1(a,0,i+ev(f)+r)},iv=function(){var t=1,e=0;return{p:function(n){for(var i=t,r=e,o=n.length|0,s=0;s!=o;){for(var a=Math.min(s+2655,o);s<a;++s)r+=i+=n[s];i=(i&65535)+15*(i>>16),r=(r&65535)+15*(r>>16)}t=i,e=r},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},X1=function(t,e,n,i,r){if(!r&&(r={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),s=new Fi(o.length+t.length);s.set(o),s.set(t,o.length),t=s,r.w=o.length}return Q1(t,e.level==null?6:e.level,e.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,i,r)},rv=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},Z1=function(t,e){var n=e.level,i=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=i<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var r=iv();r.p(e.dictionary),rv(t,2,r.d())}};function cd(t,e){e||(e={});var n=iv();n.p(t);var i=X1(t,e,e.dictionary?6:2,4);return Z1(i,e),rv(i,i.length-4,n.d()),i}var e2=typeof TextDecoder<"u"&&new TextDecoder,t2=0;try{e2.decode(nv,{stream:!0}),t2=1}catch{}function n2(t){if(Array.isArray(t))return t}function i2(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,o,s,a=[],c=!0,u=!1;try{if(o=(n=n.call(t)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(a.push(i.value),a.length!==e);c=!0);}catch(f){u=!0,r=f}finally{try{if(!c&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw r}}return a}}function Eh(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function r2(t,e){if(t){if(typeof t=="string")return Eh(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Eh(t,e):void 0}}function o2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Th(t,e){return n2(t)||i2(t,e)||r2(t,e)||o2()}function Ah(t,e="utf8"){return new TextDecoder(e).decode(t)}const s2=new TextEncoder;function a2(t){return s2.encode(t)}const l2=1024*8,c2=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),gu={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class sf{constructor(e=l2,n={}){Mt(this,"buffer");Mt(this,"byteLength");Mt(this,"byteOffset");Mt(this,"length");Mt(this,"offset");Mt(this,"lastWrittenByte");Mt(this,"littleEndian");Mt(this,"_data");Mt(this,"_mark");Mt(this,"_marks");let i=!1;typeof e=="number"?e=new ArrayBuffer(e):(i=!0,this.lastWrittenByte=e.byteLength);const r=n.offset?n.offset>>>0:0,o=e.byteLength-r;let s=r;(ArrayBuffer.isView(e)||e instanceof sf)&&(e.byteLength!==e.buffer.byteLength&&(s=e.byteOffset+r),e=e.buffer),i?this.lastWrittenByte=o:this.lastWrittenByte=0,this.buffer=e,this.length=o,this.byteLength=o,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,o),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const i=(this.offset+e)*2,r=new Uint8Array(i);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=i,this.byteLength=i,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,n){const i=gu[n].BYTES_PER_ELEMENT*e,r=this.byteOffset+this.offset,o=this.buffer.slice(r,r+i);if(this.littleEndian===c2&&n!=="uint8"&&n!=="int8"){const a=new Uint8Array(this.buffer.slice(r,r+i));a.reverse();const c=new gu[n](a.buffer);return this.offset+=i,c.reverse(),c}const s=new gu[n](o);return this.offset+=i,s}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let n="";for(let i=0;i<e;i++)n+=this.readChar();return n}readUtf8(e=1){return Ah(this.readBytes(e))}decodeText(e=1,n="utf8"){return Ah(this.readBytes(e),n)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let n=0;n<e.length;n++)this._data.setUint8(this.offset++,e[n]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));return this}writeUtf8(e){return this.writeBytes(a2(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Ds(t){let e=t.length;for(;--e>=0;)t[e]=0}const u2=3,d2=258,ov=29,f2=256,h2=f2+1+ov,sv=30,p2=512,g2=new Array((h2+2)*2);Ds(g2);const m2=new Array(sv*2);Ds(m2);const v2=new Array(p2);Ds(v2);const y2=new Array(d2-u2+1);Ds(y2);const b2=new Array(ov);Ds(b2);const w2=new Array(sv);Ds(w2);const S2=(t,e,n,i)=>{let r=t&65535|0,o=t>>>16&65535|0,s=0;for(;n!==0;){s=n>2e3?2e3:n,n-=s;do r=r+e[i++]|0,o=o+r|0;while(--s);r%=65521,o%=65521}return r|o<<16|0};var ud=S2;const _2=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},C2=new Uint32Array(_2()),E2=(t,e,n,i)=>{const r=C2,o=i+n;t^=-1;for(let s=i;s<o;s++)t=t>>>8^r[(t^e[s])&255];return t^-1};var Yi=E2,dd={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},av={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const T2=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var A2=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const i in n)T2(n,i)&&(t[i]=n[i])}}return t},I2=t=>{let e=0;for(let i=0,r=t.length;i<r;i++)e+=t[i].length;const n=new Uint8Array(e);for(let i=0,r=0,o=t.length;i<o;i++){let s=t[i];n.set(s,r),r+=s.length}return n},lv={assign:A2,flattenChunks:I2};let cv=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{cv=!1}const Ma=new Uint8Array(256);for(let t=0;t<256;t++)Ma[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Ma[254]=Ma[254]=1;var k2=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,i,r,o,s=t.length,a=0;for(r=0;r<s;r++)n=t.charCodeAt(r),(n&64512)===55296&&r+1<s&&(i=t.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(a),o=0,r=0;o<a;r++)n=t.charCodeAt(r),(n&64512)===55296&&r+1<s&&(i=t.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?e[o++]=n:n<2048?(e[o++]=192|n>>>6,e[o++]=128|n&63):n<65536?(e[o++]=224|n>>>12,e[o++]=128|n>>>6&63,e[o++]=128|n&63):(e[o++]=240|n>>>18,e[o++]=128|n>>>12&63,e[o++]=128|n>>>6&63,e[o++]=128|n&63);return e};const x2=(t,e)=>{if(e<65534&&t.subarray&&cv)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n};var L2=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let i,r;const o=new Array(n*2);for(r=0,i=0;i<n;){let s=t[i++];if(s<128){o[r++]=s;continue}let a=Ma[s];if(a>4){o[r++]=65533,i+=a-1;continue}for(s&=a===2?31:a===3?15:7;a>1&&i<n;)s=s<<6|t[i++]&63,a--;if(a>1){o[r++]=65533;continue}s<65536?o[r++]=s:(s-=65536,o[r++]=55296|s>>10&1023,o[r++]=56320|s&1023)}return x2(o,r)},P2=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+Ma[t[n]]>e?n:e},fd={string2buf:k2,buf2string:L2,utf8border:P2};function N2(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var R2=N2;const Al=16209,M2=16191;var B2=function(e,n){let i,r,o,s,a,c,u,f,p,v,m,S,_,E,C,k,I,P,G,ee,te,Y,D,Z;const N=e.state;i=e.next_in,D=e.input,r=i+(e.avail_in-5),o=e.next_out,Z=e.output,s=o-(n-e.avail_out),a=o+(e.avail_out-257),c=N.dmax,u=N.wsize,f=N.whave,p=N.wnext,v=N.window,m=N.hold,S=N.bits,_=N.lencode,E=N.distcode,C=(1<<N.lenbits)-1,k=(1<<N.distbits)-1;e:do{S<15&&(m+=D[i++]<<S,S+=8,m+=D[i++]<<S,S+=8),I=_[m&C];t:for(;;){if(P=I>>>24,m>>>=P,S-=P,P=I>>>16&255,P===0)Z[o++]=I&65535;else if(P&16){G=I&65535,P&=15,P&&(S<P&&(m+=D[i++]<<S,S+=8),G+=m&(1<<P)-1,m>>>=P,S-=P),S<15&&(m+=D[i++]<<S,S+=8,m+=D[i++]<<S,S+=8),I=E[m&k];n:for(;;){if(P=I>>>24,m>>>=P,S-=P,P=I>>>16&255,P&16){if(ee=I&65535,P&=15,S<P&&(m+=D[i++]<<S,S+=8,S<P&&(m+=D[i++]<<S,S+=8)),ee+=m&(1<<P)-1,ee>c){e.msg="invalid distance too far back",N.mode=Al;break e}if(m>>>=P,S-=P,P=o-s,ee>P){if(P=ee-P,P>f&&N.sane){e.msg="invalid distance too far back",N.mode=Al;break e}if(te=0,Y=v,p===0){if(te+=u-P,P<G){G-=P;do Z[o++]=v[te++];while(--P);te=o-ee,Y=Z}}else if(p<P){if(te+=u+p-P,P-=p,P<G){G-=P;do Z[o++]=v[te++];while(--P);if(te=0,p<G){P=p,G-=P;do Z[o++]=v[te++];while(--P);te=o-ee,Y=Z}}}else if(te+=p-P,P<G){G-=P;do Z[o++]=v[te++];while(--P);te=o-ee,Y=Z}for(;G>2;)Z[o++]=Y[te++],Z[o++]=Y[te++],Z[o++]=Y[te++],G-=3;G&&(Z[o++]=Y[te++],G>1&&(Z[o++]=Y[te++]))}else{te=o-ee;do Z[o++]=Z[te++],Z[o++]=Z[te++],Z[o++]=Z[te++],G-=3;while(G>2);G&&(Z[o++]=Z[te++],G>1&&(Z[o++]=Z[te++]))}}else if((P&64)===0){I=E[(I&65535)+(m&(1<<P)-1)];continue n}else{e.msg="invalid distance code",N.mode=Al;break e}break}}else if((P&64)===0){I=_[(I&65535)+(m&(1<<P)-1)];continue t}else if(P&32){N.mode=M2;break e}else{e.msg="invalid literal/length code",N.mode=Al;break e}break}}while(i<r&&o<a);G=S>>3,i-=G,S-=G<<3,m&=(1<<S)-1,e.next_in=i,e.next_out=o,e.avail_in=i<r?5+(r-i):5-(i-r),e.avail_out=o<a?257+(a-o):257-(o-a),N.hold=m,N.bits=S};const rs=15,Ih=852,kh=592,xh=0,mu=1,Lh=2,D2=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),F2=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),q2=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),U2=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),$2=(t,e,n,i,r,o,s,a)=>{const c=a.bits;let u=0,f=0,p=0,v=0,m=0,S=0,_=0,E=0,C=0,k=0,I,P,G,ee,te,Y=null,D;const Z=new Uint16Array(rs+1),N=new Uint16Array(rs+1);let F=null,J,W,ce;for(u=0;u<=rs;u++)Z[u]=0;for(f=0;f<i;f++)Z[e[n+f]]++;for(m=c,v=rs;v>=1&&Z[v]===0;v--);if(m>v&&(m=v),v===0)return r[o++]=1<<24|64<<16|0,r[o++]=1<<24|64<<16|0,a.bits=1,0;for(p=1;p<v&&Z[p]===0;p++);for(m<p&&(m=p),E=1,u=1;u<=rs;u++)if(E<<=1,E-=Z[u],E<0)return-1;if(E>0&&(t===xh||v!==1))return-1;for(N[1]=0,u=1;u<rs;u++)N[u+1]=N[u]+Z[u];for(f=0;f<i;f++)e[n+f]!==0&&(s[N[e[n+f]]++]=f);if(t===xh?(Y=F=s,D=20):t===mu?(Y=D2,F=F2,D=257):(Y=q2,F=U2,D=0),k=0,f=0,u=p,te=o,S=m,_=0,G=-1,C=1<<m,ee=C-1,t===mu&&C>Ih||t===Lh&&C>kh)return 1;for(;;){J=u-_,s[f]+1<D?(W=0,ce=s[f]):s[f]>=D?(W=F[s[f]-D],ce=Y[s[f]-D]):(W=96,ce=0),I=1<<u-_,P=1<<S,p=P;do P-=I,r[te+(k>>_)+P]=J<<24|W<<16|ce|0;while(P!==0);for(I=1<<u-1;k&I;)I>>=1;if(I!==0?(k&=I-1,k+=I):k=0,f++,--Z[u]===0){if(u===v)break;u=e[n+s[f]]}if(u>m&&(k&ee)!==G){for(_===0&&(_=m),te+=p,S=u-_,E=1<<S;S+_<v&&(E-=Z[S+_],!(E<=0));)S++,E<<=1;if(C+=1<<S,t===mu&&C>Ih||t===Lh&&C>kh)return 1;G=k&ee,r[G]=m<<24|S<<16|te-o|0}}return k!==0&&(r[te+k]=u-_<<24|64<<16|0),a.bits=m,0};var _a=$2;const O2=0,uv=1,dv=2,{Z_FINISH:Ph,Z_BLOCK:H2,Z_TREES:Il,Z_OK:Fo,Z_STREAM_END:V2,Z_NEED_DICT:G2,Z_STREAM_ERROR:Ci,Z_DATA_ERROR:fv,Z_MEM_ERROR:hv,Z_BUF_ERROR:W2,Z_DEFLATED:Nh}=av,Tc=16180,Rh=16181,Mh=16182,Bh=16183,Dh=16184,Fh=16185,qh=16186,Uh=16187,$h=16188,Oh=16189,rc=16190,mr=16191,vu=16192,Hh=16193,yu=16194,Vh=16195,Gh=16196,Wh=16197,zh=16198,kl=16199,xl=16200,Jh=16201,Yh=16202,Kh=16203,jh=16204,Qh=16205,bu=16206,Xh=16207,Zh=16208,Kt=16209,pv=16210,gv=16211,z2=852,J2=592,Y2=15,K2=Y2,ep=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function j2(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const $o=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Tc||e.mode>gv?1:0},mv=t=>{if($o(t))return Ci;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=Tc,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(z2),e.distcode=e.distdyn=new Int32Array(J2),e.sane=1,e.back=-1,Fo},vv=t=>{if($o(t))return Ci;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,mv(t)},yv=(t,e)=>{let n;if($o(t))return Ci;const i=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Ci:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,vv(t))},bv=(t,e)=>{if(!t)return Ci;const n=new j2;t.state=n,n.strm=t,n.window=null,n.mode=Tc;const i=yv(t,e);return i!==Fo&&(t.state=null),i},Q2=t=>bv(t,K2);let tp=!0,wu,Su;const X2=t=>{if(tp){wu=new Int32Array(512),Su=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(_a(uv,t.lens,0,288,wu,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;_a(dv,t.lens,0,32,Su,0,t.work,{bits:5}),tp=!1}t.lencode=wu,t.lenbits=9,t.distcode=Su,t.distbits=5},wv=(t,e,n,i)=>{let r;const o=t.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(e.subarray(n-o.wsize,n),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),o.window.set(e.subarray(n-i,n-i+r),o.wnext),i-=r,i?(o.window.set(e.subarray(n-i,n),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0},Z2=(t,e)=>{let n,i,r,o,s,a,c,u,f,p,v,m,S,_,E=0,C,k,I,P,G,ee,te,Y;const D=new Uint8Array(4);let Z,N;const F=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if($o(t)||!t.output||!t.input&&t.avail_in!==0)return Ci;n=t.state,n.mode===mr&&(n.mode=vu),s=t.next_out,r=t.output,c=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,u=n.hold,f=n.bits,p=a,v=c,Y=Fo;e:for(;;)switch(n.mode){case Tc:if(n.wrap===0){n.mode=vu;break}for(;f<16;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}if(n.wrap&2&&u===35615){n.wbits===0&&(n.wbits=15),n.check=0,D[0]=u&255,D[1]=u>>>8&255,n.check=Yi(n.check,D,2,0),u=0,f=0,n.mode=Rh;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",n.mode=Kt;break}if((u&15)!==Nh){t.msg="unknown compression method",n.mode=Kt;break}if(u>>>=4,f-=4,te=(u&15)+8,n.wbits===0&&(n.wbits=te),te>15||te>n.wbits){t.msg="invalid window size",n.mode=Kt;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=u&512?Oh:mr,u=0,f=0;break;case Rh:for(;f<16;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}if(n.flags=u,(n.flags&255)!==Nh){t.msg="unknown compression method",n.mode=Kt;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=Kt;break}n.head&&(n.head.text=u>>8&1),n.flags&512&&n.wrap&4&&(D[0]=u&255,D[1]=u>>>8&255,n.check=Yi(n.check,D,2,0)),u=0,f=0,n.mode=Mh;case Mh:for(;f<32;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}n.head&&(n.head.time=u),n.flags&512&&n.wrap&4&&(D[0]=u&255,D[1]=u>>>8&255,D[2]=u>>>16&255,D[3]=u>>>24&255,n.check=Yi(n.check,D,4,0)),u=0,f=0,n.mode=Bh;case Bh:for(;f<16;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}n.head&&(n.head.xflags=u&255,n.head.os=u>>8),n.flags&512&&n.wrap&4&&(D[0]=u&255,D[1]=u>>>8&255,n.check=Yi(n.check,D,2,0)),u=0,f=0,n.mode=Dh;case Dh:if(n.flags&1024){for(;f<16;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}n.length=u,n.head&&(n.head.extra_len=u),n.flags&512&&n.wrap&4&&(D[0]=u&255,D[1]=u>>>8&255,n.check=Yi(n.check,D,2,0)),u=0,f=0}else n.head&&(n.head.extra=null);n.mode=Fh;case Fh:if(n.flags&1024&&(m=n.length,m>a&&(m=a),m&&(n.head&&(te=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(o,o+m),te)),n.flags&512&&n.wrap&4&&(n.check=Yi(n.check,i,m,o)),a-=m,o+=m,n.length-=m),n.length))break e;n.length=0,n.mode=qh;case qh:if(n.flags&2048){if(a===0)break e;m=0;do te=i[o+m++],n.head&&te&&n.length<65536&&(n.head.name+=String.fromCharCode(te));while(te&&m<a);if(n.flags&512&&n.wrap&4&&(n.check=Yi(n.check,i,m,o)),a-=m,o+=m,te)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=Uh;case Uh:if(n.flags&4096){if(a===0)break e;m=0;do te=i[o+m++],n.head&&te&&n.length<65536&&(n.head.comment+=String.fromCharCode(te));while(te&&m<a);if(n.flags&512&&n.wrap&4&&(n.check=Yi(n.check,i,m,o)),a-=m,o+=m,te)break e}else n.head&&(n.head.comment=null);n.mode=$h;case $h:if(n.flags&512){for(;f<16;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}if(n.wrap&4&&u!==(n.check&65535)){t.msg="header crc mismatch",n.mode=Kt;break}u=0,f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=mr;break;case Oh:for(;f<32;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}t.adler=n.check=ep(u),u=0,f=0,n.mode=rc;case rc:if(n.havedict===0)return t.next_out=s,t.avail_out=c,t.next_in=o,t.avail_in=a,n.hold=u,n.bits=f,G2;t.adler=n.check=1,n.mode=mr;case mr:if(e===H2||e===Il)break e;case vu:if(n.last){u>>>=f&7,f-=f&7,n.mode=bu;break}for(;f<3;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}switch(n.last=u&1,u>>>=1,f-=1,u&3){case 0:n.mode=Hh;break;case 1:if(X2(n),n.mode=kl,e===Il){u>>>=2,f-=2;break e}break;case 2:n.mode=Gh;break;case 3:t.msg="invalid block type",n.mode=Kt}u>>>=2,f-=2;break;case Hh:for(u>>>=f&7,f-=f&7;f<32;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",n.mode=Kt;break}if(n.length=u&65535,u=0,f=0,n.mode=yu,e===Il)break e;case yu:n.mode=Vh;case Vh:if(m=n.length,m){if(m>a&&(m=a),m>c&&(m=c),m===0)break e;r.set(i.subarray(o,o+m),s),a-=m,o+=m,c-=m,s+=m,n.length-=m;break}n.mode=mr;break;case Gh:for(;f<14;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}if(n.nlen=(u&31)+257,u>>>=5,f-=5,n.ndist=(u&31)+1,u>>>=5,f-=5,n.ncode=(u&15)+4,u>>>=4,f-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=Kt;break}n.have=0,n.mode=Wh;case Wh:for(;n.have<n.ncode;){for(;f<3;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}n.lens[F[n.have++]]=u&7,u>>>=3,f-=3}for(;n.have<19;)n.lens[F[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Z={bits:n.lenbits},Y=_a(O2,n.lens,0,19,n.lencode,0,n.work,Z),n.lenbits=Z.bits,Y){t.msg="invalid code lengths set",n.mode=Kt;break}n.have=0,n.mode=zh;case zh:for(;n.have<n.nlen+n.ndist;){for(;E=n.lencode[u&(1<<n.lenbits)-1],C=E>>>24,k=E>>>16&255,I=E&65535,!(C<=f);){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}if(I<16)u>>>=C,f-=C,n.lens[n.have++]=I;else{if(I===16){for(N=C+2;f<N;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}if(u>>>=C,f-=C,n.have===0){t.msg="invalid bit length repeat",n.mode=Kt;break}te=n.lens[n.have-1],m=3+(u&3),u>>>=2,f-=2}else if(I===17){for(N=C+3;f<N;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}u>>>=C,f-=C,te=0,m=3+(u&7),u>>>=3,f-=3}else{for(N=C+7;f<N;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}u>>>=C,f-=C,te=0,m=11+(u&127),u>>>=7,f-=7}if(n.have+m>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=Kt;break}for(;m--;)n.lens[n.have++]=te}}if(n.mode===Kt)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=Kt;break}if(n.lenbits=9,Z={bits:n.lenbits},Y=_a(uv,n.lens,0,n.nlen,n.lencode,0,n.work,Z),n.lenbits=Z.bits,Y){t.msg="invalid literal/lengths set",n.mode=Kt;break}if(n.distbits=6,n.distcode=n.distdyn,Z={bits:n.distbits},Y=_a(dv,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Z),n.distbits=Z.bits,Y){t.msg="invalid distances set",n.mode=Kt;break}if(n.mode=kl,e===Il)break e;case kl:n.mode=xl;case xl:if(a>=6&&c>=258){t.next_out=s,t.avail_out=c,t.next_in=o,t.avail_in=a,n.hold=u,n.bits=f,B2(t,v),s=t.next_out,r=t.output,c=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,u=n.hold,f=n.bits,n.mode===mr&&(n.back=-1);break}for(n.back=0;E=n.lencode[u&(1<<n.lenbits)-1],C=E>>>24,k=E>>>16&255,I=E&65535,!(C<=f);){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}if(k&&(k&240)===0){for(P=C,G=k,ee=I;E=n.lencode[ee+((u&(1<<P+G)-1)>>P)],C=E>>>24,k=E>>>16&255,I=E&65535,!(P+C<=f);){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}u>>>=P,f-=P,n.back+=P}if(u>>>=C,f-=C,n.back+=C,n.length=I,k===0){n.mode=Qh;break}if(k&32){n.back=-1,n.mode=mr;break}if(k&64){t.msg="invalid literal/length code",n.mode=Kt;break}n.extra=k&15,n.mode=Jh;case Jh:if(n.extra){for(N=n.extra;f<N;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,f-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=Yh;case Yh:for(;E=n.distcode[u&(1<<n.distbits)-1],C=E>>>24,k=E>>>16&255,I=E&65535,!(C<=f);){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}if((k&240)===0){for(P=C,G=k,ee=I;E=n.distcode[ee+((u&(1<<P+G)-1)>>P)],C=E>>>24,k=E>>>16&255,I=E&65535,!(P+C<=f);){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}u>>>=P,f-=P,n.back+=P}if(u>>>=C,f-=C,n.back+=C,k&64){t.msg="invalid distance code",n.mode=Kt;break}n.offset=I,n.extra=k&15,n.mode=Kh;case Kh:if(n.extra){for(N=n.extra;f<N;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,f-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=Kt;break}n.mode=jh;case jh:if(c===0)break e;if(m=v-c,n.offset>m){if(m=n.offset-m,m>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=Kt;break}m>n.wnext?(m-=n.wnext,S=n.wsize-m):S=n.wnext-m,m>n.length&&(m=n.length),_=n.window}else _=r,S=s-n.offset,m=n.length;m>c&&(m=c),c-=m,n.length-=m;do r[s++]=_[S++];while(--m);n.length===0&&(n.mode=xl);break;case Qh:if(c===0)break e;r[s++]=n.length,c--,n.mode=xl;break;case bu:if(n.wrap){for(;f<32;){if(a===0)break e;a--,u|=i[o++]<<f,f+=8}if(v-=c,t.total_out+=v,n.total+=v,n.wrap&4&&v&&(t.adler=n.check=n.flags?Yi(n.check,r,v,s-v):ud(n.check,r,v,s-v)),v=c,n.wrap&4&&(n.flags?u:ep(u))!==n.check){t.msg="incorrect data check",n.mode=Kt;break}u=0,f=0}n.mode=Xh;case Xh:if(n.wrap&&n.flags){for(;f<32;){if(a===0)break e;a--,u+=i[o++]<<f,f+=8}if(n.wrap&4&&u!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=Kt;break}u=0,f=0}n.mode=Zh;case Zh:Y=V2;break e;case Kt:Y=fv;break e;case pv:return hv;case gv:default:return Ci}return t.next_out=s,t.avail_out=c,t.next_in=o,t.avail_in=a,n.hold=u,n.bits=f,(n.wsize||v!==t.avail_out&&n.mode<Kt&&(n.mode<bu||e!==Ph))&&wv(t,t.output,t.next_out,v-t.avail_out),p-=t.avail_in,v-=t.avail_out,t.total_in+=p,t.total_out+=v,n.total+=v,n.wrap&4&&v&&(t.adler=n.check=n.flags?Yi(n.check,r,v,t.next_out-v):ud(n.check,r,v,t.next_out-v)),t.data_type=n.bits+(n.last?64:0)+(n.mode===mr?128:0)+(n.mode===kl||n.mode===yu?256:0),(p===0&&v===0||e===Ph)&&Y===Fo&&(Y=W2),Y},eb=t=>{if($o(t))return Ci;let e=t.state;return e.window&&(e.window=null),t.state=null,Fo},tb=(t,e)=>{if($o(t))return Ci;const n=t.state;return(n.wrap&2)===0?Ci:(n.head=e,e.done=!1,Fo)},nb=(t,e)=>{const n=e.length;let i,r,o;return $o(t)||(i=t.state,i.wrap!==0&&i.mode!==rc)?Ci:i.mode===rc&&(r=1,r=ud(r,e,n,0),r!==i.check)?fv:(o=wv(t,e,n,n),o?(i.mode=pv,hv):(i.havedict=1,Fo))};var ib=vv,rb=yv,ob=mv,sb=Q2,ab=bv,lb=Z2,cb=eb,ub=tb,db=nb,fb="pako inflate (from Nodeca project)",yr={inflateReset:ib,inflateReset2:rb,inflateResetKeep:ob,inflateInit:sb,inflateInit2:ab,inflate:lb,inflateEnd:cb,inflateGetHeader:ub,inflateSetDictionary:db,inflateInfo:fb};function hb(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var pb=hb;const Sv=Object.prototype.toString,{Z_NO_FLUSH:gb,Z_FINISH:mb,Z_OK:Ba,Z_STREAM_END:_u,Z_NEED_DICT:Cu,Z_STREAM_ERROR:vb,Z_DATA_ERROR:np,Z_MEM_ERROR:yb}=av;function $a(t){this.options=lv.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new R2,this.strm.avail_out=0;let n=yr.inflateInit2(this.strm,e.windowBits);if(n!==Ba)throw new Error(dd[n]);if(this.header=new pb,yr.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=fd.string2buf(e.dictionary):Sv.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=yr.inflateSetDictionary(this.strm,e.dictionary),n!==Ba)))throw new Error(dd[n])}$a.prototype.push=function(t,e){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?mb:gb,Sv.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),o=yr.inflate(n,s),o===Cu&&r&&(o=yr.inflateSetDictionary(n,r),o===Ba?o=yr.inflate(n,s):o===np&&(o=Cu));n.avail_in>0&&o===_u&&n.state.wrap>0&&t[n.next_in]!==0;)yr.inflateReset(n),o=yr.inflate(n,s);switch(o){case vb:case np:case Cu:case yb:return this.onEnd(o),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(n.avail_out===0||o===_u))if(this.options.to==="string"){let c=fd.utf8border(n.output,n.next_out),u=n.next_out-c,f=fd.buf2string(n.output,c);n.next_out=u,n.avail_out=i-u,u&&n.output.set(n.output.subarray(c,c+u),0),this.onData(f)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(o===Ba&&a===0)){if(o===_u)return o=yr.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};$a.prototype.onData=function(t){this.chunks.push(t)};$a.prototype.onEnd=function(t){t===Ba&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=lv.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function bb(t,e){const n=new $a(e);if(n.push(t),n.err)throw n.msg||dd[n.err];return n.result}var wb=$a,Sb=bb,_b={Inflate:wb,inflate:Sb};const{Inflate:Cb,inflate:Eb}=_b;var ip=Cb,Tb=Eb;const _v=[];for(let t=0;t<256;t++){let e=t;for(let n=0;n<8;n++)e&1?e=3988292384^e>>>1:e=e>>>1;_v[t]=e}const rp=4294967295;function Ab(t,e,n){let i=t;for(let r=0;r<n;r++)i=_v[(i^e[r])&255]^i>>>8;return i}function Ib(t,e){return(Ab(rp,t,e)^rp)>>>0}function op(t,e,n){const i=t.readUint32(),r=Ib(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(r!==i)throw new Error(`CRC mismatch for chunk ${n}. Expected ${i}, found ${r}`)}function Cv(t,e,n){for(let i=0;i<n;i++)e[i]=t[i]}function Ev(t,e,n,i){let r=0;for(;r<i;r++)e[r]=t[r];for(;r<n;r++)e[r]=t[r]+e[r-i]&255}function Tv(t,e,n,i){let r=0;if(n.length===0)for(;r<i;r++)e[r]=t[r];else for(;r<i;r++)e[r]=t[r]+n[r]&255}function Av(t,e,n,i,r){let o=0;if(n.length===0){for(;o<r;o++)e[o]=t[o];for(;o<i;o++)e[o]=t[o]+(e[o-r]>>1)&255}else{for(;o<r;o++)e[o]=t[o]+(n[o]>>1)&255;for(;o<i;o++)e[o]=t[o]+(e[o-r]+n[o]>>1)&255}}function Iv(t,e,n,i,r){let o=0;if(n.length===0){for(;o<r;o++)e[o]=t[o];for(;o<i;o++)e[o]=t[o]+e[o-r]&255}else{for(;o<r;o++)e[o]=t[o]+n[o]&255;for(;o<i;o++)e[o]=t[o]+kb(e[o-r],n[o],n[o-r])&255}}function kb(t,e,n){const i=t+e-n,r=Math.abs(i-t),o=Math.abs(i-e),s=Math.abs(i-n);return r<=o&&r<=s?t:o<=s?e:n}function xb(t,e,n,i,r,o){switch(t){case 0:Cv(e,n,r);break;case 1:Ev(e,n,r,o);break;case 2:Tv(e,n,i,r);break;case 3:Av(e,n,i,r,o);break;case 4:Iv(e,n,i,r,o);break;default:throw new Error(`Unsupported filter: ${t}`)}}const Lb=new Uint16Array([255]),Pb=new Uint8Array(Lb.buffer),Nb=Pb[0]===255;function Rb(t){const{data:e,width:n,height:i,channels:r,depth:o}=t,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],a=Math.ceil(o/8)*r,c=new Uint8Array(i*n*a);let u=0;for(let f=0;f<7;f++){const p=s[f],v=Math.ceil((n-p.x)/p.xStep),m=Math.ceil((i-p.y)/p.yStep);if(v<=0||m<=0)continue;const S=v*a,_=new Uint8Array(S);for(let E=0;E<m;E++){const C=e[u++],k=e.subarray(u,u+S);u+=S;const I=new Uint8Array(S);xb(C,k,I,_,S,a),_.set(I);for(let P=0;P<v;P++){const G=p.x+P*p.xStep,ee=p.y+E*p.yStep;if(!(G>=n||ee>=i))for(let te=0;te<a;te++)c[(ee*n+G)*a+te]=I[P*a+te]}}}if(o===16){const f=new Uint16Array(c.buffer);if(Nb)for(let p=0;p<f.length;p++)f[p]=Mb(f[p]);return f}else return c}function Mb(t){return(t&255)<<8|t>>8&255}const Bb=new Uint16Array([255]),Db=new Uint8Array(Bb.buffer),Fb=Db[0]===255,qb=new Uint8Array(0);function sp(t){const{data:e,width:n,height:i,channels:r,depth:o}=t,s=Math.ceil(o/8)*r,a=Math.ceil(o/8*r*n),c=new Uint8Array(i*a);let u=qb,f=0,p,v;for(let m=0;m<i;m++){switch(p=e.subarray(f+1,f+1+a),v=c.subarray(m*a,(m+1)*a),e[f]){case 0:Cv(p,v,a);break;case 1:Ev(p,v,a,s);break;case 2:Tv(p,v,u,a);break;case 3:Av(p,v,u,a,s);break;case 4:Iv(p,v,u,a,s);break;default:throw new Error(`Unsupported filter: ${e[f]}`)}u=v,f+=a+1}if(o===16){const m=new Uint16Array(c.buffer);if(Fb)for(let S=0;S<m.length;S++)m[S]=Ub(m[S]);return m}else return c}function Ub(t){return(t&255)<<8|t>>8&255}const Vl=Uint8Array.of(137,80,78,71,13,10,26,10);function ap(t){if(!$b(t.readBytes(Vl.length)))throw new Error("wrong PNG signature")}function $b(t){if(t.length<Vl.length)return!1;for(let e=0;e<Vl.length;e++)if(t[e]!==Vl[e])return!1;return!0}const Ob="tEXt",Hb=0,kv=new TextDecoder("latin1");function Vb(t){if(Wb(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const Gb=/^[\u0000-\u00FF]*$/;function Wb(t){if(!Gb.test(t))throw new Error("invalid latin1 text")}function zb(t,e,n){const i=xv(e);t[i]=Jb(e,n-i.length-1)}function xv(t){for(t.mark();t.readByte()!==Hb;);const e=t.offset;t.reset();const n=kv.decode(t.readBytes(e-t.offset-1));return t.skip(1),Vb(n),n}function Jb(t,e){return kv.decode(t.readBytes(e))}const ai={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Eu={UNKNOWN:-1,DEFLATE:0},lp={UNKNOWN:-1,ADAPTIVE:0},Tu={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Ll={NONE:0,BACKGROUND:1,PREVIOUS:2},Au={SOURCE:0,OVER:1};class Yb extends sf{constructor(n,i={}){super(n);Mt(this,"_checkCrc");Mt(this,"_inflator");Mt(this,"_png");Mt(this,"_apng");Mt(this,"_end");Mt(this,"_hasPalette");Mt(this,"_palette");Mt(this,"_hasTransparency");Mt(this,"_transparency");Mt(this,"_compressionMethod");Mt(this,"_filterMethod");Mt(this,"_interlaceMethod");Mt(this,"_colorType");Mt(this,"_isAnimated");Mt(this,"_numberOfFrames");Mt(this,"_numberOfPlays");Mt(this,"_frames");Mt(this,"_writingDataChunks");const{checkCrc:r=!1}=i;this._checkCrc=r,this._inflator=new ip,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Eu.UNKNOWN,this._filterMethod=lp.UNKNOWN,this._interlaceMethod=Tu.UNKNOWN,this._colorType=ai.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(ap(this);!this._end;){const n=this.readUint32(),i=this.readChars(4);this.decodeChunk(n,i)}return this.decodeImage(),this._png}decodeApng(){for(ap(this);!this._end;){const n=this.readUint32(),i=this.readChars(4);this.decodeApngChunk(n,i)}return this.decodeApngImage(),this._apng}decodeChunk(n,i){const r=this.offset;switch(i){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case Ob:zb(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-r!==n)throw new Error(`Length mismatch while decoding chunk ${i}`);this._checkCrc?op(this,n+4,i):this.skip(4)}decodeApngChunk(n,i){const r=this.offset;switch(i!=="fdAT"&&i!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),i){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,i),this.offset=r+n;break}if(this.offset-r!==n)throw new Error(`Length mismatch while decoding chunk ${i}`);this._checkCrc?op(this,n+4,i):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=Kb(this.readUint8());const i=this.readUint8();this._colorType=i;let r;switch(i){case ai.GREYSCALE:r=1;break;case ai.TRUECOLOUR:r=3;break;case ai.INDEXED_COLOUR:r=1;break;case ai.GREYSCALE_ALPHA:r=2;break;case ai.TRUECOLOUR_ALPHA:r=4;break;case ai.UNKNOWN:default:throw new Error(`Unknown color type: ${i}`)}if(this._png.channels=r,this._compressionMethod=this.readUint8(),this._compressionMethod!==Eu.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const i=n/3;this._hasPalette=!0;const r=[];this._palette=r;for(let o=0;o<i;o++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const i=n,r=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,r,i)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let i=n,r=this.offset+this.byteOffset;if(r+=4,i-=4,this._inflator.push(new Uint8Array(this.buffer,r,i)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case ai.GREYSCALE:case ai.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let i=0;i<n/2;i++)this._transparency[i]=this.readUint16();break}case ai.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let i=0;for(;i<n;i++){const r=this.readByte();this._palette[i].push(r)}for(;i<this._palette.length;i++)this._palette[i].push(255);break}case ai.UNKNOWN:case ai.GREYSCALE_ALPHA:case ai.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const i=xv(this),r=this.readUint8();if(r!==Eu.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${r}`);const o=this.readBytes(n-i.length-2);this._png.iccEmbeddedProfile={name:i,profile:Tb(o)}}decodepHYs(){const n=this.readUint32(),i=this.readUint32(),r=this.readByte();this._png.resolution={x:n,y:i,unit:r}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const i={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},r=this._frames.at(n);if(r){if(r.data=sp({data:r.data,width:r.width,height:r.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||r.xOffset===0&&r.yOffset===0&&r.width===this._png.width&&r.height===this._png.height)i.data=r.data;else{const o=this._apng.frames.at(n-1);this.disposeFrame(r,o,i),this.addFrameDataToCanvas(i,r)}this._apng.frames.push(i)}}return this._apng}disposeFrame(n,i,r){switch(n.disposeOp){case Ll.NONE:break;case Ll.BACKGROUND:for(let o=0;o<this._png.height;o++)for(let s=0;s<this._png.width;s++){const a=(o*n.width+s)*this._png.channels;for(let c=0;c<this._png.channels;c++)r.data[a+c]=0}break;case Ll.PREVIOUS:r.data.set(i.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,i){const r=1<<this._png.depth,o=(s,a)=>{const c=((s+i.yOffset)*this._png.width+i.xOffset+a)*this._png.channels,u=(s*i.width+a)*this._png.channels;return{index:c,frameIndex:u}};switch(i.blendOp){case Au.SOURCE:for(let s=0;s<i.height;s++)for(let a=0;a<i.width;a++){const{index:c,frameIndex:u}=o(s,a);for(let f=0;f<this._png.channels;f++)n.data[c+f]=i.data[u+f]}break;case Au.OVER:for(let s=0;s<i.height;s++)for(let a=0;a<i.width;a++){const{index:c,frameIndex:u}=o(s,a);for(let f=0;f<this._png.channels;f++){const p=i.data[u+this._png.channels-1]/r,v=f%(this._png.channels-1)===0?1:i.data[u+f],m=Math.floor(p*v+(1-p)*n.data[c+f]);n.data[c+f]+=m}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var i;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((i=this._frames)==null?void 0:i.at(0)).data:this._inflator.result;if(this._filterMethod!==lp.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Tu.NO_INTERLACE)this._png.data=sp({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Tu.ADAM7)this._png.data=Rb({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,i=this._frames.at(-1);i?i.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Ll.NONE,blendOp:Au.SOURCE,data:n}),this._inflator=new ip,this._writingDataChunks=!1}}function Kb(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var cp;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(cp||(cp={}));function jb(t,e){return new Yb(t,e).decode()}var et=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Iu(){et.console&&typeof et.console.log=="function"&&et.console.log.apply(et.console,arguments)}var Ot={log:Iu,warn:function(t){et.console&&(typeof et.console.warn=="function"?et.console.warn.apply(et.console,arguments):Iu.call(null,arguments))},error:function(t){et.console&&(typeof et.console.error=="function"?et.console.error.apply(et.console,arguments):Iu(t))}};function ku(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){ko(i.response,e,n)},i.onerror=function(){Ot.error("could not download file")},i.send()}function up(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Pl(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var ko=et.saveAs||((typeof window>"u"?"undefined":Bt(window))!=="object"||window!==et?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var i=et.URL||et.webkitURL,r=document.createElement("a");e=e||t.name||"download",r.download=e,r.rel="noopener",typeof t=="string"?(r.href=t,r.origin!==location.origin?up(r.href)?ku(t,e,n):Pl(r,r.target="_blank"):Pl(r)):(r.href=i.createObjectURL(t),setTimeout(function(){i.revokeObjectURL(r.href)},4e4),setTimeout(function(){Pl(r)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(up(t))ku(t,e,n);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout(function(){Pl(i)})}else navigator.msSaveOrOpenBlob((function(r,o){return o===void 0?o={autoBom:!1}:Bt(o)!=="object"&&(Ot.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r})(t,n),e)}:function(t,e,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof t=="string")return ku(t,e,n);var r=t.type==="application/octet-stream",o=/constructor/i.test(et.HTMLElement)||et.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||r&&o)&&(typeof FileReader>"u"?"undefined":Bt(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var f=a.result;f=s?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=f:location=f,i=null},a.readAsDataURL(t)}else{var c=et.URL||et.webkitURL,u=c.createObjectURL(t);i?i.location=u:location.href=u,i=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Lv(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],i=0;i<n.length;i++){var r=n[i].re,o=n[i].process,s=r.exec(t);s&&(e=o(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return a.length==1&&(a="0"+a),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+a+c+u}}var Gl=et.atob.bind(et),dp=et.btoa.bind(et);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function xu(t,e){var n=t[0],i=t[1],r=t[2],o=t[3];n=Fn(n,i,r,o,e[0],7,-680876936),o=Fn(o,n,i,r,e[1],12,-389564586),r=Fn(r,o,n,i,e[2],17,606105819),i=Fn(i,r,o,n,e[3],22,-1044525330),n=Fn(n,i,r,o,e[4],7,-176418897),o=Fn(o,n,i,r,e[5],12,1200080426),r=Fn(r,o,n,i,e[6],17,-1473231341),i=Fn(i,r,o,n,e[7],22,-45705983),n=Fn(n,i,r,o,e[8],7,1770035416),o=Fn(o,n,i,r,e[9],12,-1958414417),r=Fn(r,o,n,i,e[10],17,-42063),i=Fn(i,r,o,n,e[11],22,-1990404162),n=Fn(n,i,r,o,e[12],7,1804603682),o=Fn(o,n,i,r,e[13],12,-40341101),r=Fn(r,o,n,i,e[14],17,-1502002290),n=qn(n,i=Fn(i,r,o,n,e[15],22,1236535329),r,o,e[1],5,-165796510),o=qn(o,n,i,r,e[6],9,-1069501632),r=qn(r,o,n,i,e[11],14,643717713),i=qn(i,r,o,n,e[0],20,-373897302),n=qn(n,i,r,o,e[5],5,-701558691),o=qn(o,n,i,r,e[10],9,38016083),r=qn(r,o,n,i,e[15],14,-660478335),i=qn(i,r,o,n,e[4],20,-405537848),n=qn(n,i,r,o,e[9],5,568446438),o=qn(o,n,i,r,e[14],9,-1019803690),r=qn(r,o,n,i,e[3],14,-187363961),i=qn(i,r,o,n,e[8],20,1163531501),n=qn(n,i,r,o,e[13],5,-1444681467),o=qn(o,n,i,r,e[2],9,-51403784),r=qn(r,o,n,i,e[7],14,1735328473),n=Un(n,i=qn(i,r,o,n,e[12],20,-1926607734),r,o,e[5],4,-378558),o=Un(o,n,i,r,e[8],11,-2022574463),r=Un(r,o,n,i,e[11],16,1839030562),i=Un(i,r,o,n,e[14],23,-35309556),n=Un(n,i,r,o,e[1],4,-1530992060),o=Un(o,n,i,r,e[4],11,1272893353),r=Un(r,o,n,i,e[7],16,-155497632),i=Un(i,r,o,n,e[10],23,-1094730640),n=Un(n,i,r,o,e[13],4,681279174),o=Un(o,n,i,r,e[0],11,-358537222),r=Un(r,o,n,i,e[3],16,-722521979),i=Un(i,r,o,n,e[6],23,76029189),n=Un(n,i,r,o,e[9],4,-640364487),o=Un(o,n,i,r,e[12],11,-421815835),r=Un(r,o,n,i,e[15],16,530742520),n=$n(n,i=Un(i,r,o,n,e[2],23,-995338651),r,o,e[0],6,-198630844),o=$n(o,n,i,r,e[7],10,1126891415),r=$n(r,o,n,i,e[14],15,-1416354905),i=$n(i,r,o,n,e[5],21,-57434055),n=$n(n,i,r,o,e[12],6,1700485571),o=$n(o,n,i,r,e[3],10,-1894986606),r=$n(r,o,n,i,e[10],15,-1051523),i=$n(i,r,o,n,e[1],21,-2054922799),n=$n(n,i,r,o,e[8],6,1873313359),o=$n(o,n,i,r,e[15],10,-30611744),r=$n(r,o,n,i,e[6],15,-1560198380),i=$n(i,r,o,n,e[13],21,1309151649),n=$n(n,i,r,o,e[4],6,-145523070),o=$n(o,n,i,r,e[11],10,-1120210379),r=$n(r,o,n,i,e[2],15,718787259),i=$n(i,r,o,n,e[9],21,-343485551),t[0]=Qr(n,t[0]),t[1]=Qr(i,t[1]),t[2]=Qr(r,t[2]),t[3]=Qr(o,t[3])}function Ac(t,e,n,i,r,o){return e=Qr(Qr(e,t),Qr(i,o)),Qr(e<<r|e>>>32-r,n)}function Fn(t,e,n,i,r,o,s){return Ac(e&n|~e&i,t,e,r,o,s)}function qn(t,e,n,i,r,o,s){return Ac(e&i|n&~i,t,e,r,o,s)}function Un(t,e,n,i,r,o,s){return Ac(e^n^i,t,e,r,o,s)}function $n(t,e,n,i,r,o,s){return Ac(n^(e|~i),t,e,r,o,s)}function Pv(t){var e,n=t.length,i=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)xu(i,Qb(t.substring(e-64,e)));t=t.substring(e-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)r[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(xu(i,r),e=0;e<16;e++)r[e]=0;return r[14]=8*n,xu(i,r),i}function Qb(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}var fp="0123456789abcdef".split("");function Xb(t){for(var e="",n=0;n<4;n++)e+=fp[t>>8*n+4&15]+fp[t>>8*n&15];return e}function Zb(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function hd(t){return Pv(t).map(Zb).join("")}var e5=(function(t){for(var e=0;e<t.length;e++)t[e]=Xb(t[e]);return t.join("")})(Pv("hello"))!="5d41402abc4b2a76b9719d911017c592";function Qr(t,e){if(e5){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function pd(t,e){var n,i,r,o;if(t!==n){for(var s=(r=t,o=1+(256/t.length|0),new Array(o+1).join(r)),a=[],c=0;c<256;c++)a[c]=c;var u=0;for(c=0;c<256;c++){var f=a[c];u=(u+f+s.charCodeAt(c))%256,a[c]=a[u],a[u]=f}n=t,i=a}else a=i;var p=e.length,v=0,m=0,S="";for(c=0;c<p;c++)m=(m+(f=a[v=(v+1)%256]))%256,a[v]=a[m],a[m]=f,s=a[(a[v]+a[m])%256],S+=String.fromCharCode(e.charCodeAt(c)^s);return S}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var hp={print:4,modify:8,copy:16,"annot-forms":32};function vs(t,e,n,i){this.v=1,this.r=2;var r=192;t.forEach(function(a){if(hp.perm!==void 0)throw new Error("Invalid permission: "+a);r+=hp[a]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var o=(e+this.padding).substr(0,32),s=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,s),this.P=-(1+(255^r)),this.encryptionKey=hd(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=pd(this.encryptionKey,this.padding)}function ys(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,i=0;i<n;i++){var r=t.charCodeAt(i);e+=r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?"#"+("0"+r.toString(16)).slice(-2):t[i]}return e}function pp(t){if(Bt(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,i,r){if(r=r||!1,typeof n!="string"||typeof i!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var o=Math.random().toString(35);return e[n][o]=[i,!!r],o},this.unsubscribe=function(n){for(var i in e)if(e[i][n])return delete e[i][n],Object.keys(e[i]).length===0&&delete e[i],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var i=Array.prototype.slice.call(arguments,1),r=[];for(var o in e[n]){var s=e[n][o];try{s[0].apply(t,i)}catch(a){et.console&&Ot.error("jsPDF PubSub Error",a.message,a)}s[1]&&r.push(o)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function oc(t){if(!(this instanceof oc))return new oc(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function Nv(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Lo(t,e,n,i,r){if(!(this instanceof Lo))return new Lo(t,e,n,i,r);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,Nv.call(this,i,r)}function _s(t,e,n,i,r){if(!(this instanceof _s))return new _s(t,e,n,i,r);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,Nv.call(this,i,r)}function Oe(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],r=arguments[2],o=arguments[3],s=[],a=1,c=16,u="S",f=null;Bt(t=t||{})==="object"&&(n=t.orientation,i=t.unit||i,r=t.format||r,o=t.compress||t.compressPdf||o,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),a=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),s=t.filters||(o===!0?["FlateEncode"]:s),i=i||"mm",n=(""+(n||"P")).toLowerCase();var p=t.putOnlyUsedFonts||!1,v={},m={internal:{},__private__:{}};m.__private__.PubSub=pp;var S="1.3",_=m.__private__.getPdfVersion=function(){return S};m.__private__.setPdfVersion=function(y){S=y};var E={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return E};var C=m.__private__.getPageFormat=function(y){return E[y]};r=r||"a4";var k="compat",I="advanced",P=k;function G(){this.saveGraphicsState(),H(new Xe(Ze,0,0,-Ze,0,po()*Ze).toString()+" cm"),this.setFontSize(this.getFontSize()/Ze),u="n",P=I}function ee(){this.restoreGraphicsState(),u="S",P=k}var te=m.__private__.combineFontStyleAndFontWeight=function(y,T){if(y=="bold"&&T=="normal"||y=="bold"&&T==400||y=="normal"&&T=="italic"||y=="bold"&&T=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return T&&(y=T==400||T==="normal"?y==="italic"?"italic":"normal":T!=700&&T!=="bold"||y!=="normal"?(T==700?"bold":T)+""+y:"bold"),y};m.advancedAPI=function(y){var T=P===k;return T&&G.call(this),typeof y!="function"||(y(this),T&&ee.call(this)),this},m.compatAPI=function(y){var T=P===I;return T&&ee.call(this),typeof y!="function"||(y(this),T&&G.call(this)),this},m.isAdvancedAPI=function(){return P===I};var Y,D=function(y){if(P!==I)throw new Error(y+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Z=m.roundToPrecision=m.__private__.roundToPrecision=function(y,T){var $=e||T;if(isNaN(y)||isNaN($))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return y.toFixed($).replace(/0+$/,"")};Y=m.hpf=m.__private__.hpf=typeof c=="number"?function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return Z(y,c)}:c==="smart"?function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return Z(y,y>-1&&y<1?16:5)}:function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return Z(y,16)};var N=m.f2=m.__private__.f2=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.f2");return Z(y,2)},F=m.__private__.f3=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.f3");return Z(y,3)},J=m.scale=m.__private__.scale=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.scale");return P===k?y*Ze:P===I?y:void 0},W=function(y){return J((function(T){return P===k?po()-T:P===I?T:void 0})(y))};m.__private__.setPrecision=m.setPrecision=function(y){typeof parseInt(y,10)=="number"&&(e=parseInt(y,10))};var ce,fe="00000000000000000000000000000000",ge=m.__private__.getFileId=function(){return fe},ae=m.__private__.setFileId=function(y){return fe=y!==void 0&&/^[a-fA-F0-9]{32}$/.test(y)?y.toUpperCase():fe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(rn=new vs(f.userPermissions,f.userPassword,f.ownerPassword,fe)),fe};m.setFileId=function(y){return ae(y),this},m.getFileId=function(){return ge()};var ve=m.__private__.convertDateToPDFDate=function(y){var T=y.getTimezoneOffset(),$=T<0?"+":"-",z=Math.floor(Math.abs(T/60)),ie=Math.abs(T%60),ye=[$,V(z),"'",V(ie),"'"].join("");return["D:",y.getFullYear(),V(y.getMonth()+1),V(y.getDate()),V(y.getHours()),V(y.getMinutes()),V(y.getSeconds()),ye].join("")},xe=m.__private__.convertPDFDateToDate=function(y){var T=parseInt(y.substr(2,4),10),$=parseInt(y.substr(6,2),10)-1,z=parseInt(y.substr(8,2),10),ie=parseInt(y.substr(10,2),10),ye=parseInt(y.substr(12,2),10),Ce=parseInt(y.substr(14,2),10);return new Date(T,$,z,ie,ye,Ce,0)},_e=m.__private__.setCreationDate=function(y){var T;if(y===void 0&&(y=new Date),y instanceof Date)T=ve(y);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(y))throw new Error("Invalid argument passed to jsPDF.setCreationDate");T=y}return ce=T},R=m.__private__.getCreationDate=function(y){var T=ce;return y==="jsDate"&&(T=xe(ce)),T};m.setCreationDate=function(y){return _e(y),this},m.getCreationDate=function(y){return R(y)};var O,V=m.__private__.padd2=function(y){return("0"+parseInt(y)).slice(-2)},Q=m.__private__.padd2Hex=function(y){return("00"+(y=y.toString())).substr(y.length)},ne=0,le=[],de=[],ue=0,we=[],Ie=[],Re=!1,Me=de;m.__private__.setCustomOutputDestination=function(y){Re=!0,Me=y};var he=function(y){Re||(Me=y)};m.__private__.resetCustomOutputDestination=function(){Re=!1,Me=de};var H=m.__private__.out=function(y){return y=y.toString(),ue+=y.length+1,Me.push(y),Me},St=m.__private__.write=function(y){return H(arguments.length===1?y.toString():Array.prototype.join.call(arguments," "))},ht=m.__private__.getArrayBuffer=function(y){for(var T=y.length,$=new ArrayBuffer(T),z=new Uint8Array($);T--;)z[T]=y.charCodeAt(T);return $},je=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return je};var ke=t.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(y){return ke=P===I?y/Ze:y,this};var We,Ne=m.__private__.getFontSize=m.getFontSize=function(){return P===k?ke:ke*Ze},pt=t.R2L||!1;m.__private__.setR2L=m.setR2L=function(y){return pt=y,this},m.__private__.getR2L=m.getR2L=function(){return pt};var Ke,It=m.__private__.setZoomMode=function(y){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(y))We=y;else if(isNaN(y)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(y)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+y+'" is not recognized.');We=y}else We=parseInt(y,10)};m.__private__.getZoomMode=function(){return We};var at,lt=m.__private__.setPageMode=function(y){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(y)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+y+'" is not recognized.');Ke=y};m.__private__.getPageMode=function(){return Ke};var Dt=m.__private__.setLayoutMode=function(y){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(y)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+y+'" is not recognized.');at=y};m.__private__.getLayoutMode=function(){return at},m.__private__.setDisplayMode=m.setDisplayMode=function(y,T,$){return It(y),Dt(T),lt($),this};var gt={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(y){if(Object.keys(gt).indexOf(y)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return gt[y]},m.__private__.getDocumentProperties=function(){return gt},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(y){for(var T in gt)gt.hasOwnProperty(T)&&y[T]&&(gt[T]=y[T]);return this},m.__private__.setDocumentProperty=function(y,T){if(Object.keys(gt).indexOf(y)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return gt[y]=T};var Je,Ze,Ye,Ht,kt,Ve={},ct={},Ft=[],Qe={},_t={},ut={},nn={},mn=null,qt=0,nt=[],Lt=new pp(m),to=t.hotfixes||[],Mn={},tr={},Oi=[],Xe=function y(T,$,z,ie,ye,Ce){if(!(this instanceof y))return new y(T,$,z,ie,ye,Ce);isNaN(T)&&(T=1),isNaN($)&&($=0),isNaN(z)&&(z=0),isNaN(ie)&&(ie=1),isNaN(ye)&&(ye=0),isNaN(Ce)&&(Ce=0),this._matrix=[T,$,z,ie,ye,Ce]};Object.defineProperty(Xe.prototype,"sx",{get:function(){return this._matrix[0]},set:function(y){this._matrix[0]=y}}),Object.defineProperty(Xe.prototype,"shy",{get:function(){return this._matrix[1]},set:function(y){this._matrix[1]=y}}),Object.defineProperty(Xe.prototype,"shx",{get:function(){return this._matrix[2]},set:function(y){this._matrix[2]=y}}),Object.defineProperty(Xe.prototype,"sy",{get:function(){return this._matrix[3]},set:function(y){this._matrix[3]=y}}),Object.defineProperty(Xe.prototype,"tx",{get:function(){return this._matrix[4]},set:function(y){this._matrix[4]=y}}),Object.defineProperty(Xe.prototype,"ty",{get:function(){return this._matrix[5]},set:function(y){this._matrix[5]=y}}),Object.defineProperty(Xe.prototype,"a",{get:function(){return this._matrix[0]},set:function(y){this._matrix[0]=y}}),Object.defineProperty(Xe.prototype,"b",{get:function(){return this._matrix[1]},set:function(y){this._matrix[1]=y}}),Object.defineProperty(Xe.prototype,"c",{get:function(){return this._matrix[2]},set:function(y){this._matrix[2]=y}}),Object.defineProperty(Xe.prototype,"d",{get:function(){return this._matrix[3]},set:function(y){this._matrix[3]=y}}),Object.defineProperty(Xe.prototype,"e",{get:function(){return this._matrix[4]},set:function(y){this._matrix[4]=y}}),Object.defineProperty(Xe.prototype,"f",{get:function(){return this._matrix[5]},set:function(y){this._matrix[5]=y}}),Object.defineProperty(Xe.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Xe.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Xe.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Xe.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Xe.prototype.join=function(y){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Y).join(y)},Xe.prototype.multiply=function(y){var T=y.sx*this.sx+y.shy*this.shx,$=y.sx*this.shy+y.shy*this.sy,z=y.shx*this.sx+y.sy*this.shx,ie=y.shx*this.shy+y.sy*this.sy,ye=y.tx*this.sx+y.ty*this.shx+this.tx,Ce=y.tx*this.shy+y.ty*this.sy+this.ty;return new Xe(T,$,z,ie,ye,Ce)},Xe.prototype.decompose=function(){var y=this.sx,T=this.shy,$=this.shx,z=this.sy,ie=this.tx,ye=this.ty,Ce=Math.sqrt(y*y+T*T),qe=(y/=Ce)*$+(T/=Ce)*z;$-=y*qe,z-=T*qe;var He=Math.sqrt($*$+z*z);return qe/=He,y*(z/=He)<T*($/=He)&&(y=-y,T=-T,qe=-qe,Ce=-Ce),{scale:new Xe(Ce,0,0,He,0,0),translate:new Xe(1,0,0,1,ie,ye),rotate:new Xe(y,T,-T,y,0,0),skew:new Xe(1,0,qe,1,0,0)}},Xe.prototype.toString=function(y){return this.join(" ")},Xe.prototype.inversed=function(){var y=this.sx,T=this.shy,$=this.shx,z=this.sy,ie=this.tx,ye=this.ty,Ce=1/(y*z-T*$),qe=z*Ce,He=-T*Ce,tt=-$*Ce,ot=y*Ce;return new Xe(qe,He,tt,ot,-qe*ie-tt*ye,-He*ie-ot*ye)},Xe.prototype.applyToPoint=function(y){var T=y.x*this.sx+y.y*this.shx+this.tx,$=y.x*this.shy+y.y*this.sy+this.ty;return new fo(T,$)},Xe.prototype.applyToRectangle=function(y){var T=this.applyToPoint(y),$=this.applyToPoint(new fo(y.x+y.w,y.y+y.h));return new Xs(T.x,T.y,$.x-T.x,$.y-T.y)},Xe.prototype.clone=function(){var y=this.sx,T=this.shy,$=this.shx,z=this.sy,ie=this.tx,ye=this.ty;return new Xe(y,T,$,z,ie,ye)},m.Matrix=Xe;var nr=m.matrixMult=function(y,T){return T.multiply(y)},ir=new Xe(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=ir;var ui=function(y,T){if(!_t[y]){var $=(T instanceof Lo?"Sh":"P")+(Object.keys(Qe).length+1).toString(10);T.id=$,_t[y]=$,Qe[$]=T,Lt.publish("addPattern",T)}};m.ShadingPattern=Lo,m.TilingPattern=_s,m.addShadingPattern=function(y,T){return D("addShadingPattern()"),ui(y,T),this},m.beginTilingPattern=function(y){D("beginTilingPattern()"),Zs(y.boundingBox[0],y.boundingBox[1],y.boundingBox[2]-y.boundingBox[0],y.boundingBox[3]-y.boundingBox[1],y.matrix)},m.endTilingPattern=function(y,T){D("endTilingPattern()"),T.stream=Ie[O].join(`
`),ui(y,T),Lt.publish("endTilingPattern",T),Oi.pop().restore()};var di,Qt=m.__private__.newObject=function(){var y=Cn();return kn(y,!0),y},Cn=m.__private__.newObjectDeferred=function(){return ne++,le[ne]=function(){return ue},ne},kn=function(y,T){return T=typeof T=="boolean"&&T,le[y]=ue,T&&H(y+" 0 obj"),y},no=m.__private__.newAdditionalObject=function(){var y={objId:Cn(),content:""};return we.push(y),y},Cr=Cn(),Ti=Cn(),Hi=m.__private__.decodeColorString=function(y){var T=y.split(" ");if(T.length!==2||T[1]!=="g"&&T[1]!=="G")T.length!==5||T[4]!=="k"&&T[4]!=="K"||(T=[(1-T[0])*(1-T[3]),(1-T[1])*(1-T[3]),(1-T[2])*(1-T[3]),"r"]);else{var $=parseFloat(T[0]);T=[$,$,$,"r"]}for(var z="#",ie=0;ie<3;ie++)z+=("0"+Math.floor(255*parseFloat(T[ie])).toString(16)).slice(-2);return z},Ai=m.__private__.encodeColorString=function(y){var T;typeof y=="string"&&(y={ch1:y});var $=y.ch1,z=y.ch2,ie=y.ch3,ye=y.ch4,Ce=y.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof $=="string"&&$.charAt(0)!=="#"){var qe=new Lv($);if(qe.ok)$=qe.toHex();else if(!/^\d*\.?\d*$/.test($))throw new Error('Invalid color "'+$+'" passed to jsPDF.encodeColorString.')}if(typeof $=="string"&&/^#[0-9A-Fa-f]{3}$/.test($)&&($="#"+$[1]+$[1]+$[2]+$[2]+$[3]+$[3]),typeof $=="string"&&/^#[0-9A-Fa-f]{6}$/.test($)){var He=parseInt($.substr(1),16);$=He>>16&255,z=He>>8&255,ie=255&He}if(z===void 0||ye===void 0&&$===z&&z===ie)T=typeof $=="string"?$+" "+Ce[0]:y.precision===2?N($/255)+" "+Ce[0]:F($/255)+" "+Ce[0];else if(ye===void 0||Bt(ye)==="object"){if(ye&&!isNaN(ye.a)&&ye.a===0)return["1.","1.","1.",Ce[1]].join(" ");T=typeof $=="string"?[$,z,ie,Ce[1]].join(" "):y.precision===2?[N($/255),N(z/255),N(ie/255),Ce[1]].join(" "):[F($/255),F(z/255),F(ie/255),Ce[1]].join(" ")}else T=typeof $=="string"?[$,z,ie,ye,Ce[2]].join(" "):y.precision===2?[N($),N(z),N(ie),N(ye),Ce[2]].join(" "):[F($),F(z),F(ie),F(ye),Ce[2]].join(" ");return T},Ii=m.__private__.getFilters=function(){return s},fi=m.__private__.putStream=function(y){var T=(y=y||{}).data||"",$=y.filters||Ii(),z=y.alreadyAppliedFilters||[],ie=y.addLength1||!1,ye=T.length,Ce=y.objectId,qe=function(vn){return vn};if(f!==null&&Ce===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(qe=rn.encryptor(Ce,0));var He={};$===!0&&($=["FlateEncode"]);var tt=y.additionalKeyValues||[],ot=(He=Oe.API.processDataByFilters!==void 0?Oe.API.processDataByFilters(T,$):{data:T,reverseChain:[]}).reverseChain+(Array.isArray(z)?z.join(" "):z.toString());if(He.data.length!==0&&(tt.push({key:"Length",value:He.data.length}),ie===!0&&tt.push({key:"Length1",value:ye})),ot.length!=0)if(ot.split("/").length-1==1)tt.push({key:"Filter",value:ot});else{tt.push({key:"Filter",value:"["+ot+"]"});for(var xt=0;xt<tt.length;xt+=1)if(tt[xt].key==="DecodeParms"){for(var jt=[],hn=0;hn<He.reverseChain.split("/").length-1;hn+=1)jt.push("null");jt.push(tt[xt].value),tt[xt].value="["+jt.join(" ")+"]"}}H("<<");for(var Vt=0;Vt<tt.length;Vt++)H("/"+tt[Vt].key+" "+tt[Vt].value);H(">>"),He.data.length!==0&&(H("stream"),H(qe(He.data)),H("endstream"))},io=m.__private__.putPage=function(y){var T=y.number,$=y.data,z=y.objId,ie=y.contentsObjId;kn(z,!0),H("<</Type /Page"),H("/Parent "+y.rootDictionaryObjId+" 0 R"),H("/Resources "+y.resourceDictionaryObjId+" 0 R"),H("/MediaBox ["+parseFloat(Y(y.mediaBox.bottomLeftX))+" "+parseFloat(Y(y.mediaBox.bottomLeftY))+" "+Y(y.mediaBox.topRightX)+" "+Y(y.mediaBox.topRightY)+"]"),y.cropBox!==null&&H("/CropBox ["+Y(y.cropBox.bottomLeftX)+" "+Y(y.cropBox.bottomLeftY)+" "+Y(y.cropBox.topRightX)+" "+Y(y.cropBox.topRightY)+"]"),y.bleedBox!==null&&H("/BleedBox ["+Y(y.bleedBox.bottomLeftX)+" "+Y(y.bleedBox.bottomLeftY)+" "+Y(y.bleedBox.topRightX)+" "+Y(y.bleedBox.topRightY)+"]"),y.trimBox!==null&&H("/TrimBox ["+Y(y.trimBox.bottomLeftX)+" "+Y(y.trimBox.bottomLeftY)+" "+Y(y.trimBox.topRightX)+" "+Y(y.trimBox.topRightY)+"]"),y.artBox!==null&&H("/ArtBox ["+Y(y.artBox.bottomLeftX)+" "+Y(y.artBox.bottomLeftY)+" "+Y(y.artBox.topRightX)+" "+Y(y.artBox.topRightY)+"]"),typeof y.userUnit=="number"&&y.userUnit!==1&&H("/UserUnit "+y.userUnit),Lt.publish("putPage",{objId:z,pageContext:nt[T],pageNumber:T,page:$}),H("/Contents "+ie+" 0 R"),H(">>"),H("endobj");var ye=$.join(`
`);return P===I&&(ye+=`
Q`),kn(ie,!0),fi({data:ye,filters:Ii(),objectId:ie}),H("endobj"),z},Vi=m.__private__.putPages=function(){var y,T,$=[];for(y=1;y<=qt;y++)nt[y].objId=Cn(),nt[y].contentsObjId=Cn();for(y=1;y<=qt;y++)$.push(io({number:y,data:Ie[y],objId:nt[y].objId,contentsObjId:nt[y].contentsObjId,mediaBox:nt[y].mediaBox,cropBox:nt[y].cropBox,bleedBox:nt[y].bleedBox,trimBox:nt[y].trimBox,artBox:nt[y].artBox,userUnit:nt[y].userUnit,rootDictionaryObjId:Cr,resourceDictionaryObjId:Ti}));kn(Cr,!0),H("<</Type /Pages");var z="/Kids [";for(T=0;T<qt;T++)z+=$[T]+" 0 R ";H(z+"]"),H("/Count "+qt),H(">>"),H("endobj"),Lt.publish("postPutPages")},ro=function(y){Lt.publish("putFont",{font:y,out:H,newObject:Qt,putStream:fi}),y.isAlreadyPutted!==!0&&(y.objectNumber=Qt(),H("<<"),H("/Type /Font"),H("/BaseFont /"+ys(y.postScriptName)),H("/Subtype /Type1"),typeof y.encoding=="string"&&H("/Encoding /"+y.encoding),H("/FirstChar 32"),H("/LastChar 255"),H(">>"),H("endobj"))},Wo=function(y){y.objectNumber=Qt();var T=[];T.push({key:"Type",value:"/XObject"}),T.push({key:"Subtype",value:"/Form"}),T.push({key:"BBox",value:"["+[Y(y.x),Y(y.y),Y(y.x+y.width),Y(y.y+y.height)].join(" ")+"]"}),T.push({key:"Matrix",value:"["+y.matrix.toString()+"]"});var $=y.pages[1].join(`
`);fi({data:$,additionalKeyValues:T,objectId:y.objectNumber}),H("endobj")},zo=function(y,T){T||(T=21);var $=Qt(),z=(function(Ce,qe){var He,tt=[],ot=1/(qe-1);for(He=0;He<1;He+=ot)tt.push(He);if(tt.push(1),Ce[0].offset!=0){var xt={offset:0,color:Ce[0].color};Ce.unshift(xt)}if(Ce[Ce.length-1].offset!=1){var jt={offset:1,color:Ce[Ce.length-1].color};Ce.push(jt)}for(var hn="",Vt=0,vn=0;vn<tt.length;vn++){for(He=tt[vn];He>Ce[Vt+1].offset;)Vt++;var pn=Ce[Vt].offset,xn=(He-pn)/(Ce[Vt+1].offset-pn),pi=Ce[Vt].color,zn=Ce[Vt+1].color;hn+=Q(Math.round((1-xn)*pi[0]+xn*zn[0]).toString(16))+Q(Math.round((1-xn)*pi[1]+xn*zn[1]).toString(16))+Q(Math.round((1-xn)*pi[2]+xn*zn[2]).toString(16))}return hn.trim()})(y.colors,T),ie=[];ie.push({key:"FunctionType",value:"0"}),ie.push({key:"Domain",value:"[0.0 1.0]"}),ie.push({key:"Size",value:"["+T+"]"}),ie.push({key:"BitsPerSample",value:"8"}),ie.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ie.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),fi({data:z,additionalKeyValues:ie,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:$}),H("endobj"),y.objectNumber=Qt(),H("<< /ShadingType "+y.type),H("/ColorSpace /DeviceRGB");var ye="/Coords ["+Y(parseFloat(y.coords[0]))+" "+Y(parseFloat(y.coords[1]))+" ";y.type===2?ye+=Y(parseFloat(y.coords[2]))+" "+Y(parseFloat(y.coords[3])):ye+=Y(parseFloat(y.coords[2]))+" "+Y(parseFloat(y.coords[3]))+" "+Y(parseFloat(y.coords[4]))+" "+Y(parseFloat(y.coords[5])),H(ye+="]"),y.matrix&&H("/Matrix ["+y.matrix.toString()+"]"),H("/Function "+$+" 0 R"),H("/Extend [true true]"),H(">>"),H("endobj")},Jo=function(y,T){var $=Cn(),z=Qt();T.push({resourcesOid:$,objectOid:z}),y.objectNumber=z;var ie=[];ie.push({key:"Type",value:"/Pattern"}),ie.push({key:"PatternType",value:"1"}),ie.push({key:"PaintType",value:"1"}),ie.push({key:"TilingType",value:"1"}),ie.push({key:"BBox",value:"["+y.boundingBox.map(Y).join(" ")+"]"}),ie.push({key:"XStep",value:Y(y.xStep)}),ie.push({key:"YStep",value:Y(y.yStep)}),ie.push({key:"Resources",value:$+" 0 R"}),y.matrix&&ie.push({key:"Matrix",value:"["+y.matrix.toString()+"]"}),fi({data:y.stream,additionalKeyValues:ie,objectId:y.objectNumber}),H("endobj")},Dc=function(y){for(var T in y.objectNumber=Qt(),H("<<"),y)switch(T){case"opacity":H("/ca "+N(y[T]));break;case"stroke-opacity":H("/CA "+N(y[T]))}H(">>"),H("endobj")},Hs=function(y){kn(y.resourcesOid,!0),H("<<"),H("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var T in H("/Font <<"),Ve)Ve.hasOwnProperty(T)&&(p===!1||p===!0&&v.hasOwnProperty(T))&&H("/"+T+" "+Ve[T].objectNumber+" 0 R");H(">>")})(),(function(){if(Object.keys(Qe).length>0){for(var T in H("/Shading <<"),Qe)Qe.hasOwnProperty(T)&&Qe[T]instanceof Lo&&Qe[T].objectNumber>=0&&H("/"+T+" "+Qe[T].objectNumber+" 0 R");Lt.publish("putShadingPatternDict"),H(">>")}})(),(function(T){if(Object.keys(Qe).length>0){for(var $ in H("/Pattern <<"),Qe)Qe.hasOwnProperty($)&&Qe[$]instanceof m.TilingPattern&&Qe[$].objectNumber>=0&&Qe[$].objectNumber<T&&H("/"+$+" "+Qe[$].objectNumber+" 0 R");Lt.publish("putTilingPatternDict"),H(">>")}})(y.objectOid),(function(){if(Object.keys(ut).length>0){var T;for(T in H("/ExtGState <<"),ut)ut.hasOwnProperty(T)&&ut[T].objectNumber>=0&&H("/"+T+" "+ut[T].objectNumber+" 0 R");Lt.publish("putGStateDict"),H(">>")}})(),(function(){for(var T in H("/XObject <<"),Mn)Mn.hasOwnProperty(T)&&Mn[T].objectNumber>=0&&H("/"+T+" "+Mn[T].objectNumber+" 0 R");Lt.publish("putXobjectDict"),H(">>")})(),H(">>"),H("endobj")},Wa=function(y){ct[y.fontName]=ct[y.fontName]||{},ct[y.fontName][y.fontStyle]=y.id},za=function(y,T,$,z,ie){var ye={id:"F"+(Object.keys(Ve).length+1).toString(10),postScriptName:y,fontName:T,fontStyle:$,encoding:z,isStandardFont:ie||!1,metadata:{}};return Lt.publish("addFont",{font:ye,instance:this}),Ve[ye.id]=ye,Wa(ye),ye.id},hi=m.__private__.pdfEscape=m.pdfEscape=function(y,T){return(function($,z){var ie,ye,Ce,qe,He,tt,ot,xt,jt;if(Ce=(z=z||{}).sourceEncoding||"Unicode",He=z.outputEncoding,(z.autoencode||He)&&Ve[Je].metadata&&Ve[Je].metadata[Ce]&&Ve[Je].metadata[Ce].encoding&&(qe=Ve[Je].metadata[Ce].encoding,!He&&Ve[Je].encoding&&(He=Ve[Je].encoding),!He&&qe.codePages&&(He=qe.codePages[0]),typeof He=="string"&&(He=qe[He]),He)){for(ot=!1,tt=[],ie=0,ye=$.length;ie<ye;ie++)(xt=He[$.charCodeAt(ie)])?tt.push(String.fromCharCode(xt)):tt.push($[ie]),tt[ie].charCodeAt(0)>>8&&(ot=!0);$=tt.join("")}for(ie=$.length;ot===void 0&&ie!==0;)$.charCodeAt(ie-1)>>8&&(ot=!0),ie--;if(!ot)return $;for(tt=z.noBOM?[]:[254,255],ie=0,ye=$.length;ie<ye;ie++){if((jt=(xt=$.charCodeAt(ie))>>8)>>8)throw new Error("Character at position "+ie+" of string '"+$+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");tt.push(jt),tt.push(xt-(jt<<8))}return String.fromCharCode.apply(void 0,tt)})(y,T).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Vs=m.__private__.beginPage=function(y){Ie[++qt]=[],nt[qt]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(y[0]),topRightY:Number(y[1])}},Ya(qt),he(Ie[O])},Ja=function(y,T){var $,z,ie;switch(n=T||n,typeof y=="string"&&($=C(y.toLowerCase()),Array.isArray($)&&(z=$[0],ie=$[1])),Array.isArray(y)&&(z=y[0]*Ze,ie=y[1]*Ze),isNaN(z)&&(z=r[0],ie=r[1]),(z>14400||ie>14400)&&(Ot.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),z=Math.min(14400,z),ie=Math.min(14400,ie)),r=[z,ie],n.substr(0,1)){case"l":ie>z&&(r=[ie,z]);break;case"p":z>ie&&(r=[ie,z])}Vs(r),Wc(Ys),H(Ko),js!==0&&H(js+" J"),Qs!==0&&H(Qs+" j"),Lt.publish("addPage",{pageNumber:qt})},Gs=function(y){y>0&&y<=qt&&(Ie.splice(y,1),nt.splice(y,1),qt--,O>qt&&(O=qt),this.setPage(O))},Ya=function(y){y>0&&y<=qt&&(O=y)},Ka=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return Ie.length-1},ja=function(y,T,$){var z,ie=void 0;return $=$||{},y=y!==void 0?y:Ve[Je].fontName,T=T!==void 0?T:Ve[Je].fontStyle,z=y.toLowerCase(),ct[z]!==void 0&&ct[z][T]!==void 0?ie=ct[z][T]:ct[y]!==void 0&&ct[y][T]!==void 0?ie=ct[y][T]:$.disableWarning===!1&&Ot.warn("Unable to look up font label for font '"+y+"', '"+T+"'. Refer to getFontList() for available fonts."),ie||$.noFallback||(ie=ct.times[T])==null&&(ie=ct.times.normal),ie},Yo=m.__private__.putInfo=function(){var y=Qt(),T=function(z){return z};for(var $ in f!==null&&(T=rn.encryptor(y,0)),H("<<"),H("/Producer ("+hi(T("jsPDF "+Oe.version))+")"),gt)gt.hasOwnProperty($)&&gt[$]&&H("/"+$.substr(0,1).toUpperCase()+$.substr(1)+" ("+hi(T(gt[$]))+")");H("/CreationDate ("+hi(T(ce))+")"),H(">>"),H("endobj")},Fc=m.__private__.putCatalog=function(y){var T=(y=y||{}).rootDictionaryObjId||Cr;switch(Qt(),H("<<"),H("/Type /Catalog"),H("/Pages "+T+" 0 R"),We||(We="fullwidth"),We){case"fullwidth":H("/OpenAction [3 0 R /FitH null]");break;case"fullheight":H("/OpenAction [3 0 R /FitV null]");break;case"fullpage":H("/OpenAction [3 0 R /Fit]");break;case"original":H("/OpenAction [3 0 R /XYZ null null 1]");break;default:var $=""+We;$.substr($.length-1)==="%"&&(We=parseInt(We)/100),typeof We=="number"&&H("/OpenAction [3 0 R /XYZ null null "+N(We)+"]")}switch(at||(at="continuous"),at){case"continuous":H("/PageLayout /OneColumn");break;case"single":H("/PageLayout /SinglePage");break;case"two":case"twoleft":H("/PageLayout /TwoColumnLeft");break;case"tworight":H("/PageLayout /TwoColumnRight")}Ke&&H("/PageMode /"+Ke),Lt.publish("putCatalog"),H(">>"),H("endobj")},fn=m.__private__.putTrailer=function(){H("trailer"),H("<<"),H("/Size "+(ne+1)),H("/Root "+ne+" 0 R"),H("/Info "+(ne-1)+" 0 R"),f!==null&&H("/Encrypt "+rn.oid+" 0 R"),H("/ID [ <"+fe+"> <"+fe+"> ]"),H(">>")},Qa=m.__private__.putHeader=function(){H("%PDF-"+S),H("%ºß¬à")},Xa=m.__private__.putXRef=function(){var y="0000000000";H("xref"),H("0 "+(ne+1)),H("0000000000 65535 f ");for(var T=1;T<=ne;T++)typeof le[T]=="function"?H((y+le[T]()).slice(-10)+" 00000 n "):le[T]!==void 0?H((y+le[T]).slice(-10)+" 00000 n "):H("0000000000 00000 n ")},rr=m.__private__.buildDocument=function(){var y;ne=0,ue=0,de=[],le=[],we=[],Cr=Cn(),Ti=Cn(),he(de),Lt.publish("buildDocument"),Qa(),Vi(),(function(){Lt.publish("putAdditionalObjects");for(var $=0;$<we.length;$++){var z=we[$];kn(z.objId,!0),H(z.content),H("endobj")}Lt.publish("postPutAdditionalObjects")})(),y=[],(function(){for(var $ in Ve)Ve.hasOwnProperty($)&&(p===!1||p===!0&&v.hasOwnProperty($))&&ro(Ve[$])})(),(function(){var $;for($ in ut)ut.hasOwnProperty($)&&Dc(ut[$])})(),(function(){for(var $ in Mn)Mn.hasOwnProperty($)&&Wo(Mn[$])})(),(function($){var z;for(z in Qe)Qe.hasOwnProperty(z)&&(Qe[z]instanceof Lo?zo(Qe[z]):Qe[z]instanceof _s&&Jo(Qe[z],$))})(y),Lt.publish("putResources"),y.forEach(Hs),Hs({resourcesOid:Ti,objectOid:Number.MAX_SAFE_INTEGER}),Lt.publish("postPutResources"),f!==null&&(rn.oid=Qt(),H("<<"),H("/Filter /Standard"),H("/V "+rn.v),H("/R "+rn.r),H("/U <"+rn.toHexString(rn.U)+">"),H("/O <"+rn.toHexString(rn.O)+">"),H("/P "+rn.P),H(">>"),H("endobj")),Yo(),Fc();var T=ue;return Xa(),fn(),H("startxref"),H(""+T),H("%%EOF"),he(Ie[O]),de.join(`
`)},oo=m.__private__.getBlob=function(y){return new Blob([ht(y)],{type:"application/pdf"})},ki=m.output=m.__private__.output=(di=function(y,T){switch(typeof(T=T||{})=="string"?T={filename:T}:T.filename=T.filename||"generated.pdf",y){case void 0:return rr();case"save":m.save(T.filename);break;case"arraybuffer":return ht(rr());case"blob":return oo(rr());case"bloburi":case"bloburl":if(et.URL!==void 0&&typeof et.URL.createObjectURL=="function")return et.URL&&et.URL.createObjectURL(oo(rr()))||void 0;Ot.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var $="",z=rr();try{$=dp(z)}catch{$=dp(unescape(encodeURIComponent(z)))}return"data:application/pdf;filename="+T.filename+";base64,"+$;case"pdfobjectnewwindow":if(Object.prototype.toString.call(et)==="[object Window]"){var ie="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ye=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';T.pdfObjectUrl&&(ie=T.pdfObjectUrl,ye="");var Ce='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ie+'"'+ye+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(T)+");<\/script></body></html>",qe=et.open();return qe!==null&&qe.document.write(Ce),qe}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(et)==="[object Window]"){var He='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(T.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+T.filename+'" width="500px" height="400px" /></body></html>',tt=et.open();if(tt!==null){tt.document.write(He);var ot=this;tt.document.documentElement.querySelector("#pdfViewer").onload=function(){tt.document.title=T.filename,tt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ot.output("bloburl"))}}return tt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(et)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var xt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",T)+'"></iframe></body></html>',jt=et.open();if(jt!==null&&(jt.document.write(xt),jt.document.title=T.filename),jt||typeof safari>"u")return jt;break;case"datauri":case"dataurl":return et.document.location.href=this.output("datauristring",T);default:return null}},di.foo=function(){try{return di.apply(this,arguments)}catch($){var y=$.stack||"";~y.indexOf(" at ")&&(y=y.split(" at ")[1]);var T="Error in function "+y.split(`
`)[0].split("<")[0]+": "+$.message;if(!et.console)throw new Error(T);et.console.error(T,$),et.alert&&alert(T)}},di.foo.bar=di,di.foo),so=function(y){return Array.isArray(to)===!0&&to.indexOf(y)>-1};switch(i){case"pt":Ze=1;break;case"mm":Ze=72/25.4;break;case"cm":Ze=72/2.54;break;case"in":Ze=72;break;case"px":Ze=so("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ze=12;break;case"ex":Ze=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);Ze=i}var rn=null;_e(),ae();var Ws=m.__private__.getPageInfo=m.getPageInfo=function(y){if(isNaN(y)||y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:nt[y].objId,pageNumber:y,pageContext:nt[y]}},qc=m.__private__.getPageInfoByObjId=function(y){if(isNaN(y)||y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var T in nt)if(nt[T].objId===y)break;return Ws(T)},Uc=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:nt[O].objId,pageNumber:O,pageContext:nt[O]}};m.addPage=function(){return Ja.apply(this,arguments),this},m.setPage=function(){return Ya.apply(this,arguments),he.call(this,Ie[O]),this},m.insertPage=function(y){return this.addPage(),this.movePage(O,y),this},m.movePage=function(y,T){var $,z;if(y>T){$=Ie[y],z=nt[y];for(var ie=y;ie>T;ie--)Ie[ie]=Ie[ie-1],nt[ie]=nt[ie-1];Ie[T]=$,nt[T]=z,this.setPage(T)}else if(y<T){$=Ie[y],z=nt[y];for(var ye=y;ye<T;ye++)Ie[ye]=Ie[ye+1],nt[ye]=nt[ye+1];Ie[T]=$,nt[T]=z,this.setPage(T)}return this},m.deletePage=function(){return Gs.apply(this,arguments),this},m.__private__.text=m.text=function(y,T,$,z,ie){var ye,Ce,qe,He,tt,ot,xt,jt,hn,Vt=(z=z||{}).scope||this;if(typeof y=="number"&&typeof T=="number"&&(typeof $=="string"||Array.isArray($))){var vn=$;$=T,T=y,y=vn}if(arguments[3]instanceof Xe==0?(qe=arguments[4],He=arguments[5],Bt(xt=arguments[3])==="object"&&xt!==null||(typeof qe=="string"&&(He=qe,qe=null),typeof xt=="string"&&(He=xt,xt=null),typeof xt=="number"&&(qe=xt,xt=null),z={flags:xt,angle:qe,align:He})):(D("The transform parameter of text() with a Matrix value"),hn=ie),isNaN(T)||isNaN($)||y==null)throw new Error("Invalid arguments passed to jsPDF.text");if(y.length===0)return Vt;var pn,xn="",pi=typeof z.lineHeightFactor=="number"?z.lineHeightFactor:lo,zn=Vt.internal.scaleFactor;function sl(Pt){return Pt=Pt.split("	").join(Array(z.TabLen||9).join(" ")),hi(Pt,xt)}function Zo(Pt){for(var Ut,sn=Pt.concat(),yn=[],dr=sn.length;dr--;)typeof(Ut=sn.shift())=="string"?yn.push(Ut):Array.isArray(Pt)&&(Ut.length===1||Ut[1]===void 0&&Ut[2]===void 0)?yn.push(Ut[0]):yn.push([Ut[0],Ut[1],Ut[2]]);return yn}function go(Pt,Ut){var sn;if(typeof Pt=="string")sn=Ut(Pt)[0];else if(Array.isArray(Pt)){for(var yn,dr,ca=Pt.concat(),ns=[],cl=ca.length;cl--;)typeof(yn=ca.shift())=="string"?ns.push(Ut(yn)[0]):Array.isArray(yn)&&typeof yn[0]=="string"&&(dr=Ut(yn[0],yn[1],yn[2]),ns.push([dr[0],dr[1],dr[2]]));sn=ns}return sn}var Ar=!1,mo=!0;if(typeof y=="string")Ar=!0;else if(Array.isArray(y)){var vo=y.concat();Ce=[];for(var yo,Bn=vo.length;Bn--;)(typeof(yo=vo.shift())!="string"||Array.isArray(yo)&&typeof yo[0]!="string")&&(mo=!1);Ar=mo}if(Ar===!1)throw new Error('Type of text must be string or Array. "'+y+'" is not recognized.');typeof y=="string"&&(y=y.match(/[\r?\n]/)?y.split(/\r\n|\r|\n/g):[y]);var bo=ke/Vt.internal.scaleFactor,wo=bo*(pi-1);switch(z.baseline){case"bottom":$-=wo;break;case"top":$+=bo-wo;break;case"hanging":$+=bo-2*wo;break;case"middle":$+=bo/2-wo}if((ot=z.maxWidth||0)>0&&(typeof y=="string"?y=Vt.splitTextToSize(y,ot):Object.prototype.toString.call(y)==="[object Array]"&&(y=y.reduce(function(Pt,Ut){return Pt.concat(Vt.splitTextToSize(Ut,ot))},[]))),ye={text:y,x:T,y:$,options:z,mutex:{pdfEscape:hi,activeFontKey:Je,fonts:Ve,activeFontSize:ke}},Lt.publish("preProcessText",ye),y=ye.text,qe=(z=ye.options).angle,hn instanceof Xe==0&&qe&&typeof qe=="number"){qe*=Math.PI/180,z.rotationDirection===0&&(qe=-qe),P===I&&(qe=-qe);var ea=Math.cos(qe),ta=Math.sin(qe);hn=new Xe(ea,ta,-ta,ea,0,0)}else qe&&qe instanceof Xe&&(hn=qe);P!==I||hn||(hn=ir),(tt=z.charSpace||Qo)!==void 0&&(xn+=Y(J(tt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(jt=z.horizontalScale)!==void 0&&(xn+=Y(100*jt)+` Tz
`),z.lang;var Xt=-1,cr=z.renderingMode!==void 0?z.renderingMode:z.stroke,es=Vt.internal.getCurrentPageInfo().pageContext;switch(cr){case 0:case!1:case"fill":Xt=0;break;case 1:case!0:case"stroke":Xt=1;break;case 2:case"fillThenStroke":Xt=2;break;case 3:case"invisible":Xt=3;break;case 4:case"fillAndAddForClipping":Xt=4;break;case 5:case"strokeAndAddPathForClipping":Xt=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Xt=6;break;case 7:case"addToPathForClipping":Xt=7}var al=es.usedRenderingMode!==void 0?es.usedRenderingMode:-1;Xt!==-1?xn+=Xt+` Tr
`:al!==-1&&(xn+=`0 Tr
`),Xt!==-1&&(es.usedRenderingMode=Xt),He=z.align||"left";var gi,So=ke*pi,na=Vt.internal.pageSize.getWidth(),ia=Ve[Je];tt=z.charSpace||Qo,ot=z.maxWidth||0,xt=Object.assign({autoencode:!0,noBOM:!0},z.flags);var Ir=[],_o=function(Pt){return Vt.getStringUnitWidth(Pt,{font:ia,charSpace:tt,fontSize:ke,doKerning:!1})*ke/zn};if(Object.prototype.toString.call(y)==="[object Array]"){var Zn;Ce=Zo(y),He!=="left"&&(gi=Ce.map(_o));var ei,kr=0;if(He==="right"){T-=gi[0],y=[],Bn=Ce.length;for(var ur=0;ur<Bn;ur++)ur===0?(ei=or(T),Zn=sr($)):(ei=J(kr-gi[ur]),Zn=-So),y.push([Ce[ur],ei,Zn]),kr=gi[ur]}else if(He==="center"){T-=gi[0]/2,y=[],Bn=Ce.length;for(var xr=0;xr<Bn;xr++)xr===0?(ei=or(T),Zn=sr($)):(ei=J((kr-gi[xr])/2),Zn=-So),y.push([Ce[xr],ei,Zn]),kr=gi[xr]}else if(He==="left"){y=[],Bn=Ce.length;for(var ra=0;ra<Bn;ra++)y.push(Ce[ra])}else if(He==="justify"&&ia.encoding==="Identity-H"){y=[],Bn=Ce.length,ot=ot!==0?ot:na;for(var ts=0,on=0;on<Bn;on++)if(Zn=on===0?sr($):-So,ei=on===0?or(T):ts,on<Bn-1){var ll=J((ot-gi[on])/(Ce[on].split(" ").length-1)),Wi=Ce[on].split(" ");y.push([Wi[0]+" ",ei,Zn]),ts=0;for(var zi=1;zi<Wi.length;zi++){var oa=(_o(Wi[zi-1]+" "+Wi[zi])-_o(Wi[zi]))*zn+ll;zi==Wi.length-1?y.push([Wi[zi],oa,0]):y.push([Wi[zi]+" ",oa,0]),ts-=oa}}else y.push([Ce[on],ei,Zn]);y.push(["",ts,0])}else{if(He!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(y=[],Bn=Ce.length,ot=ot!==0?ot:na,on=0;on<Bn;on++){Zn=on===0?sr($):-So,ei=on===0?or(T):0;var sa=Ce[on].split(" ").length-1,aa=sa>0?(ot-gi[on])/sa:0;on<Bn-1?Ir.push(Y(J(aa))):Ir.push(0),y.push([Ce[on],ei,Zn])}}}(typeof z.R2L=="boolean"?z.R2L:pt)===!0&&(y=go(y,function(Pt,Ut,sn){return[Pt.split("").reverse().join(""),Ut,sn]})),ye={text:y,x:T,y:$,options:z,mutex:{pdfEscape:hi,activeFontKey:Je,fonts:Ve,activeFontSize:ke}},Lt.publish("postProcessText",ye),y=ye.text,pn=ye.mutex.isHex||!1;var la=Ve[Je].encoding;la!=="WinAnsiEncoding"&&la!=="StandardEncoding"||(y=go(y,function(Pt,Ut,sn){return[sl(Pt),Ut,sn]})),Ce=Zo(y),y=[];for(var Lr,Pr,Nr,Co=Array.isArray(Ce[0])?1:0,Rr="",Eo=function(Pt,Ut,sn){var yn="";return sn instanceof Xe?(sn=typeof z.angle=="number"?nr(sn,new Xe(1,0,0,1,Pt,Ut)):nr(new Xe(1,0,0,1,Pt,Ut),sn),P===I&&(sn=nr(new Xe(1,0,0,-1,0,0),sn)),yn=sn.join(" ")+` Tm
`):yn=Y(Pt)+" "+Y(Ut)+` Td
`,yn},mi=0;mi<Ce.length;mi++){switch(Rr="",Co){case 1:Nr=(pn?"<":"(")+Ce[mi][0]+(pn?">":")"),Lr=parseFloat(Ce[mi][1]),Pr=parseFloat(Ce[mi][2]);break;case 0:Nr=(pn?"<":"(")+Ce[mi]+(pn?">":")"),Lr=or(T),Pr=sr($)}Ir!==void 0&&Ir[mi]!==void 0&&(Rr=Ir[mi]+` Tw
`),mi===0?y.push(Rr+Eo(Lr,Pr,hn)+Nr):Co===0?y.push(Rr+Nr):Co===1&&y.push(Rr+Eo(Lr,Pr,hn)+Nr)}y=Co===0?y.join(` Tj
T* `):y.join(` Tj
`),y+=` Tj
`;var Ji=`BT
/`;return Ji+=Je+" "+ke+` Tf
`,Ji+=Y(ke*pi)+` TL
`,Ji+=co+`
`,Ji+=xn,Ji+=y,H(Ji+="ET"),v[Je]=!0,Vt};var $c=m.__private__.clip=m.clip=function(y){return H(y==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return $c("evenodd")},m.__private__.discardPath=m.discardPath=function(){return H("n"),this};var Gi=m.__private__.isValidStyle=function(y){var T=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(y)!==-1&&(T=!0),T};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(y){return Gi(y)&&(u=y),this};var Za=m.__private__.getStyle=m.getStyle=function(y){var T=u;switch(y){case"D":case"S":T="S";break;case"F":T="f";break;case"FD":case"DF":T="B";break;case"f":case"f*":case"B":case"B*":T=y}return T},el=m.close=function(){return H("h"),this};m.stroke=function(){return H("S"),this},m.fill=function(y){return Er("f",y),this},m.fillEvenOdd=function(y){return Er("f*",y),this},m.fillStroke=function(y){return Er("B",y),this},m.fillStrokeEvenOdd=function(y){return Er("B*",y),this};var Er=function(y,T){Bt(T)==="object"?Hc(T,y):H(y)},zs=function(y){y===null||P===I&&y===void 0||(y=Za(y),H(y))};function Oc(y,T,$,z,ie){var ye=new _s(T||this.boundingBox,$||this.xStep,z||this.yStep,this.gState,ie||this.matrix);ye.stream=this.stream;var Ce=y+"$$"+this.cloneIndex+++"$$";return ui(Ce,ye),ye}var Hc=function(y,T){var $=_t[y.key],z=Qe[$];if(z instanceof Lo)H("q"),H(Vc(T)),z.gState&&m.setGState(z.gState),H(y.matrix.toString()+" cm"),H("/"+$+" sh"),H("Q");else if(z instanceof _s){var ie=new Xe(1,0,0,-1,0,po());y.matrix&&(ie=ie.multiply(y.matrix||ir),$=Oc.call(z,y.key,y.boundingBox,y.xStep,y.yStep,ie).id),H("q"),H("/Pattern cs"),H("/"+$+" scn"),z.gState&&m.setGState(z.gState),H(T),H("Q")}},Vc=function(y){switch(y){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Js=m.moveTo=function(y,T){return H(Y(J(y))+" "+Y(W(T))+" m"),this},ao=m.lineTo=function(y,T){return H(Y(J(y))+" "+Y(W(T))+" l"),this},Tr=m.curveTo=function(y,T,$,z,ie,ye){return H([Y(J(y)),Y(W(T)),Y(J($)),Y(W(z)),Y(J(ie)),Y(W(ye)),"c"].join(" ")),this};m.__private__.line=m.line=function(y,T,$,z,ie){if(isNaN(y)||isNaN(T)||isNaN($)||isNaN(z)||!Gi(ie))throw new Error("Invalid arguments passed to jsPDF.line");return P===k?this.lines([[$-y,z-T]],y,T,[1,1],ie||"S"):this.lines([[$-y,z-T]],y,T,[1,1]).stroke()},m.__private__.lines=m.lines=function(y,T,$,z,ie,ye){var Ce,qe,He,tt,ot,xt,jt,hn,Vt,vn,pn,xn;if(typeof y=="number"&&(xn=$,$=T,T=y,y=xn),z=z||[1,1],ye=ye||!1,isNaN(T)||isNaN($)||!Array.isArray(y)||!Array.isArray(z)||!Gi(ie)||typeof ye!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Js(T,$),Ce=z[0],qe=z[1],tt=y.length,vn=T,pn=$,He=0;He<tt;He++)(ot=y[He]).length===2?(vn=ot[0]*Ce+vn,pn=ot[1]*qe+pn,ao(vn,pn)):(xt=ot[0]*Ce+vn,jt=ot[1]*qe+pn,hn=ot[2]*Ce+vn,Vt=ot[3]*qe+pn,vn=ot[4]*Ce+vn,pn=ot[5]*qe+pn,Tr(xt,jt,hn,Vt,vn,pn));return ye&&el(),zs(ie),this},m.path=function(y){for(var T=0;T<y.length;T++){var $=y[T],z=$.c;switch($.op){case"m":Js(z[0],z[1]);break;case"l":ao(z[0],z[1]);break;case"c":Tr.apply(this,z);break;case"h":el()}}return this},m.__private__.rect=m.rect=function(y,T,$,z,ie){if(isNaN(y)||isNaN(T)||isNaN($)||isNaN(z)||!Gi(ie))throw new Error("Invalid arguments passed to jsPDF.rect");return P===k&&(z=-z),H([Y(J(y)),Y(W(T)),Y(J($)),Y(J(z)),"re"].join(" ")),zs(ie),this},m.__private__.triangle=m.triangle=function(y,T,$,z,ie,ye,Ce){if(isNaN(y)||isNaN(T)||isNaN($)||isNaN(z)||isNaN(ie)||isNaN(ye)||!Gi(Ce))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[$-y,z-T],[ie-$,ye-z],[y-ie,T-ye]],y,T,[1,1],Ce,!0),this},m.__private__.roundedRect=m.roundedRect=function(y,T,$,z,ie,ye,Ce){if(isNaN(y)||isNaN(T)||isNaN($)||isNaN(z)||isNaN(ie)||isNaN(ye)||!Gi(Ce))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var qe=4/3*(Math.SQRT2-1);return ie=Math.min(ie,.5*$),ye=Math.min(ye,.5*z),this.lines([[$-2*ie,0],[ie*qe,0,ie,ye-ye*qe,ie,ye],[0,z-2*ye],[0,ye*qe,-ie*qe,ye,-ie,ye],[2*ie-$,0],[-ie*qe,0,-ie,-ye*qe,-ie,-ye],[0,2*ye-z],[0,-ye*qe,ie*qe,-ye,ie,-ye]],y+ie,T,[1,1],Ce,!0),this},m.__private__.ellipse=m.ellipse=function(y,T,$,z,ie){if(isNaN(y)||isNaN(T)||isNaN($)||isNaN(z)||!Gi(ie))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ye=4/3*(Math.SQRT2-1)*$,Ce=4/3*(Math.SQRT2-1)*z;return Js(y+$,T),Tr(y+$,T-Ce,y+ye,T-z,y,T-z),Tr(y-ye,T-z,y-$,T-Ce,y-$,T),Tr(y-$,T+Ce,y-ye,T+z,y,T+z),Tr(y+ye,T+z,y+$,T+Ce,y+$,T),zs(ie),this},m.__private__.circle=m.circle=function(y,T,$,z){if(isNaN(y)||isNaN(T)||isNaN($)||!Gi(z))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(y,T,$,$,z)},m.setFont=function(y,T,$){return $&&(T=te(T,$)),Je=ja(y,T,{disableWarning:!1}),this};var Gc=m.__private__.getFont=m.getFont=function(){return Ve[ja.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var y,T,$={};for(y in ct)if(ct.hasOwnProperty(y))for(T in $[y]=[],ct[y])ct[y].hasOwnProperty(T)&&$[y].push(T);return $},m.addFont=function(y,T,$,z,ie){var ye=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ye.indexOf(arguments[3])!==-1?ie=arguments[3]:arguments[3]&&ye.indexOf(arguments[3])==-1&&($=te($,z)),za.call(this,y,T,$,ie=ie||"Identity-H")};var lo,Ys=t.lineWidth||.200025,it=m.__private__.getLineWidth=m.getLineWidth=function(){return Ys},Wc=m.__private__.setLineWidth=m.setLineWidth=function(y){return Ys=y,H(Y(J(y))+" w"),this};m.__private__.setLineDash=Oe.API.setLineDash=Oe.API.setLineDashPattern=function(y,T){if(y=y||[],T=T||0,isNaN(T)||!Array.isArray(y))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return y=y.map(function($){return Y(J($))}).join(" "),T=Y(J(T)),H("["+y+"] "+T+" d"),this};var zc=m.__private__.getLineHeight=m.getLineHeight=function(){return ke*lo};m.__private__.getLineHeight=m.getLineHeight=function(){return ke*lo};var Jc=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(y){return typeof(y=y||1.15)=="number"&&(lo=y),this},Yc=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return lo};Jc(t.lineHeight);var or=m.__private__.getHorizontalCoordinate=function(y){return J(y)},sr=m.__private__.getVerticalCoordinate=function(y){return P===I?y:nt[O].mediaBox.topRightY-nt[O].mediaBox.bottomLeftY-J(y)},Kc=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(y){return Y(or(y))},jc=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(y){return Y(sr(y))},Ko=t.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return Hi(Ko)},m.__private__.setStrokeColor=m.setDrawColor=function(y,T,$,z){return Ko=Ai({ch1:y,ch2:T,ch3:$,ch4:z,pdfColorType:"draw",precision:2}),H(Ko),this};var Ks=t.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return Hi(Ks)},m.__private__.setFillColor=m.setFillColor=function(y,T,$,z){return Ks=Ai({ch1:y,ch2:T,ch3:$,ch4:z,pdfColorType:"fill",precision:2}),H(Ks),this};var co=t.textColor||"0 g",jo=m.__private__.getTextColor=m.getTextColor=function(){return Hi(co)};m.__private__.setTextColor=m.setTextColor=function(y,T,$,z){return co=Ai({ch1:y,ch2:T,ch3:$,ch4:z,pdfColorType:"text",precision:3}),this};var Qo=t.charSpace,Qc=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(Qo||0)};m.__private__.setCharSpace=m.setCharSpace=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Qo=y,this};var js=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(y){var T=m.CapJoinStyles[y];if(T===void 0)throw new Error("Line cap style of '"+y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return js=T,H(T+" J"),this};var Qs=0;m.__private__.setLineJoin=m.setLineJoin=function(y){var T=m.CapJoinStyles[y];if(T===void 0)throw new Error("Line join style of '"+y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qs=T,H(T+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(y){if(y=y||0,isNaN(y))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return H(Y(J(y))+" M"),this},m.GState=oc,m.setGState=function(y){(y=typeof y=="string"?ut[nn[y]]:uo(null,y)).equals(mn)||(H("/"+y.id+" gs"),mn=y)};var uo=function(y,T){if(!y||!nn[y]){var $=!1;for(var z in ut)if(ut.hasOwnProperty(z)&&ut[z].equals(T)){$=!0;break}if($)T=ut[z];else{var ie="GS"+(Object.keys(ut).length+1).toString(10);ut[ie]=T,T.id=ie}return y&&(nn[y]=T.id),Lt.publish("addGState",T),T}};m.addGState=function(y,T){return uo(y,T),this},m.saveGraphicsState=function(){return H("q"),Ft.push({key:Je,size:ke,color:co}),this},m.restoreGraphicsState=function(){H("Q");var y=Ft.pop();return Je=y.key,ke=y.size,co=y.color,mn=null,this},m.setCurrentTransformationMatrix=function(y){return H(y.toString()+" cm"),this},m.comment=function(y){return H("#"+y),this};var fo=function(y,T){var $=y||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return $},set:function(ye){isNaN(ye)||($=parseFloat(ye))}});var z=T||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return z},set:function(ye){isNaN(ye)||(z=parseFloat(ye))}});var ie="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ie},set:function(ye){ie=ye.toString()}}),this},Xs=function(y,T,$,z){fo.call(this,y,T),this.type="rect";var ie=$||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ie},set:function(Ce){isNaN(Ce)||(ie=parseFloat(Ce))}});var ye=z||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ye},set:function(Ce){isNaN(Ce)||(ye=parseFloat(Ce))}}),this},Xo=function(){this.page=qt,this.currentPage=O,this.pages=Ie.slice(0),this.pagesContext=nt.slice(0),this.x=Ye,this.y=Ht,this.matrix=kt,this.width=tl(O),this.height=ar(O),this.outputDestination=Me,this.id="",this.objectNumber=-1};Xo.prototype.restore=function(){qt=this.page,O=this.currentPage,nt=this.pagesContext,Ie=this.pages,Ye=this.x,Ht=this.y,kt=this.matrix,nl(O,this.width),lr(O,this.height),Me=this.outputDestination};var Zs=function(y,T,$,z,ie){Oi.push(new Xo),qt=O=0,Ie=[],Ye=y,Ht=T,kt=ie,Vs([$,z])};for(var ho in m.beginFormObject=function(y,T,$,z,ie){return Zs(y,T,$,z,ie),this},m.endFormObject=function(y){return(function(T){if(tr[T])Oi.pop().restore();else{var $=new Xo,z="Xo"+(Object.keys(Mn).length+1).toString(10);$.id=z,tr[T]=z,Mn[z]=$,Lt.publish("addFormObject",$),Oi.pop().restore()}})(y),this},m.doFormObject=function(y,T){var $=Mn[tr[y]];return H("q"),H(T.toString()+" cm"),H("/"+$.id+" Do"),H("Q"),this},m.getFormObject=function(y){var T=Mn[tr[y]];return{x:T.x,y:T.y,width:T.width,height:T.height,matrix:T.matrix}},m.save=function(y,T){return y=y||"generated.pdf",(T=T||{}).returnPromise=T.returnPromise||!1,T.returnPromise===!1?(ko(oo(rr()),y),typeof ko.unload=="function"&&et.setTimeout&&setTimeout(ko.unload,911),this):new Promise(function($,z){try{var ie=ko(oo(rr()),y);typeof ko.unload=="function"&&et.setTimeout&&setTimeout(ko.unload,911),$(ie)}catch(ye){z(ye.message)}})},Oe.API)Oe.API.hasOwnProperty(ho)&&(ho==="events"&&Oe.API.events.length?(function(y,T){var $,z,ie;for(ie=T.length-1;ie!==-1;ie--)$=T[ie][0],z=T[ie][1],y.subscribe.apply(y,[$].concat(typeof z=="function"?[z]:z))})(Lt,Oe.API.events):m[ho]=Oe.API[ho]);function tl(y){return nt[y].mediaBox.topRightX-nt[y].mediaBox.bottomLeftX}function nl(y,T){nt[y].mediaBox.topRightX=T+nt[y].mediaBox.bottomLeftX}function ar(y){return nt[y].mediaBox.topRightY-nt[y].mediaBox.bottomLeftY}function lr(y,T){nt[y].mediaBox.topRightY=T+nt[y].mediaBox.bottomLeftY}var il=m.getPageWidth=function(y){return tl(y=y||O)/Ze},rl=m.setPageWidth=function(y,T){nl(y,T*Ze)},po=m.getPageHeight=function(y){return ar(y=y||O)/Ze},ol=m.setPageHeight=function(y,T){lr(y,T*Ze)};return m.internal={pdfEscape:hi,getStyle:Za,getFont:Gc,getFontSize:Ne,getCharSpace:Qc,getTextColor:jo,getLineHeight:zc,getLineHeightFactor:Yc,getLineWidth:it,write:St,getHorizontalCoordinate:or,getVerticalCoordinate:sr,getCoordinateString:Kc,getVerticalCoordinateString:jc,collections:{},newObject:Qt,newAdditionalObject:no,newObjectDeferred:Cn,newObjectDeferredBegin:kn,getFilters:Ii,putStream:fi,events:Lt,scaleFactor:Ze,pageSize:{getWidth:function(){return il(O)},setWidth:function(y){rl(O,y)},getHeight:function(){return po(O)},setHeight:function(y){ol(O,y)}},encryptionOptions:f,encryption:rn,getEncryptor:function(y){return f!==null?rn.encryptor(y,0):function(T){return T}},output:ki,getNumberOfPages:Ka,pages:Ie,out:H,f2:N,f3:F,getPageInfo:Ws,getPageInfoByObjId:qc,getCurrentPageInfo:Uc,getPDFVersion:_,Point:fo,Rectangle:Xs,Matrix:Xe,hasHotfix:so},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return il(O)},set:function(y){rl(O,y)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return po(O)},set:function(y){ol(O,y)},enumerable:!0,configurable:!0}),(function(y){for(var T=0,$=je.length;T<$;T++){var z=za.call(this,y[T][0],y[T][1],y[T][2],je[T][3],!0);p===!1&&(v[z]=!0);var ie=y[T][0].split("-");Wa({id:z,fontName:ie[0],fontStyle:ie[1]||""})}Lt.publish("addFonts",{fonts:Ve,dictionary:ct})}).call(m,je),Je="F1",Ja(r,n),Lt.publish("initialized"),m}vs.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},vs.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},vs.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},vs.prototype.processOwnerPassword=function(t,e){return pd(hd(e).substr(0,5),t)},vs.prototype.encryptor=function(t,e){var n=hd(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(i){return pd(n,i)}},oc.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||Bt(t)!==Bt(this))return!1;var i=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;i++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&i--;return i===0},Oe.API={events:[]},Oe.version="3.0.3";var tn=Oe.API,af=1,Oo=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},os=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},st=function(t){return t.toFixed(2)},Or=function(t){return t.toFixed(5)};tn.__acroform__={};var Xn=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},gp=function(t){return t*af},Ki=function(t){var e=new Mv,n=Fe.internal.getHeight(t)||0,i=Fe.internal.getWidth(t)||0;return e.BBox=[0,0,Number(st(i)),Number(st(n))],e},t5=tn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},n5=tn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},i5=tn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},cn=tn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return i5(t,e-1)},un=tn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return t5(t,e-1)},dn=tn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return n5(t,e-1)},r5=tn.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,i=e.internal.getVerticalCoordinate,r=t[0],o=t[1],s=t[2],a=t[3],c={};return c.lowerLeft_X=n(r)||0,c.lowerLeft_Y=i(o+a)||0,c.upperRight_X=n(r+s)||0,c.upperRight_Y=i(o)||0,[Number(st(c.lowerLeft_X)),Number(st(c.lowerLeft_Y)),Number(st(c.upperRight_X)),Number(st(c.upperRight_Y))]},o5=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,i=gd(t,n),r=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+r+" "+st(i.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(i.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=Ki(t);return o.scope=t.scope,o.stream=e.join(`
`),o}},gd=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,i={text:"",fontSize:""},r=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");r=t.multiline?r.map(function(N){return N.split(`
`)}):r.map(function(N){return[N]});var o=n,s=Fe.internal.getHeight(t)||0;s=s<0?-s:s;var a=Fe.internal.getWidth(t)||0;a=a<0?-a:a;var c=function(N,F,J){if(N+1<r.length){var W=F+" "+r[N+1][0];return Nl(W,t,J).width<=a-4}return!1};o++;e:for(;o>0;){e="",o--;var u,f,p=Nl("3",t,o).height,v=t.multiline?s-o:(s-p)/2,m=v+=2,S=0,_=0,E=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+Nl(e,t,o=12).width+", FieldWidth:"+a+`
`;break}for(var C="",k=0,I=0;I<r.length;I++)if(r.hasOwnProperty(I)){var P=!1;if(r[I].length!==1&&E!==r[I].length-1){if((p+2)*(k+2)+2>s)continue e;C+=r[I][E],P=!0,_=I,I--}else{C=(C+=r[I][E]+" ").substr(C.length-1)==" "?C.substr(0,C.length-1):C;var G=parseInt(I),ee=c(G,C,o),te=I>=r.length-1;if(ee&&!te){C+=" ",E=0;continue}if(ee||te){if(te)_=G;else if(t.multiline&&(p+2)*(k+2)+2>s)continue e}else{if(!t.multiline||(p+2)*(k+2)+2>s)continue e;_=G}}for(var Y="",D=S;D<=_;D++){var Z=r[D];if(t.multiline){if(D===_){Y+=Z[E]+" ",E=(E+1)%Z.length;continue}if(D===S){Y+=Z[Z.length-1]+" ";continue}}Y+=Z[0]+" "}switch(Y=Y.substr(Y.length-1)==" "?Y.substr(0,Y.length-1):Y,f=Nl(Y,t,o).width,t.textAlign){case"right":u=a-f-2;break;case"center":u=(a-f)/2;break;default:u=2}e+=st(u)+" "+st(m)+` Td
`,e+="("+Oo(Y)+`) Tj
`,e+=-st(u)+` 0 Td
`,m=-(o+2),f=0,S=P?_:_+1,k++,C=""}break}return i.text=e,i.fontSize=o,i},Nl=function(t,e,n){var i=e.scope.internal.getFont(e.fontName,e.fontStyle),r=e.scope.getStringUnitWidth(t,{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:r}},s5={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},a5=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(i){return i.type===n.type&&i.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},l5=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(qi.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(s5)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");af=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Bv,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in i)if(i.hasOwnProperty(r)){var o=i[r];o.objId=void 0,o.hasAnnotation&&a5(o,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(i,r){var o=!i;for(var s in i||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(s)){var a=i[s],c=[],u=a.Rect;if(a.Rect&&(a.Rect=r5(a.Rect,r)),r.internal.newObjectDeferredBegin(a.objId,!0),a.DA=Fe.createDefaultAppearanceStream(a),Bt(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(c=a.getKeyValueListForStream()),a.Rect=u,a.hasAppearanceStream&&!a.appearanceStreamContent){var f=o5(a);c.push({key:"AP",value:"<</N "+f+">>"}),r.internal.acroformPlugin.xForms.push(f)}if(a.appearanceStreamContent){var p="";for(var v in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(v)){var m=a.appearanceStreamContent[v];if(p+="/"+v+" ",p+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var s in m)if(m.hasOwnProperty(s)){var S=m[s];typeof S=="function"&&(S=S.call(r,a)),p+="/"+s+" "+S+" ",r.internal.acroformPlugin.xForms.indexOf(S)>=0||r.internal.acroformPlugin.xForms.push(S)}}else typeof(S=m)=="function"&&(S=S.call(r,a)),p+="/"+s+" "+S,r.internal.acroformPlugin.xForms.indexOf(S)>=0||r.internal.acroformPlugin.xForms.push(S);p+=">>"}c.push({key:"AP",value:`<<
`+p+">>"})}r.internal.putStream({additionalKeyValues:c,objectId:a.objId}),r.internal.out("endobj")}o&&(function(_,E){for(var C in _)if(_.hasOwnProperty(C)){var k=C,I=_[C];E.internal.newObjectDeferredBegin(I.objId,!0),Bt(I)==="object"&&typeof I.putStream=="function"&&I.putStream(),delete _[k]}})(r.internal.acroformPlugin.xForms,r)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},Rv=tn.__acroform__.arrayToPdfArray=function(t,e,n){var i=function(s){return s};if(Array.isArray(t)){for(var r="[",o=0;o<t.length;o++)switch(o!==0&&(r+=" "),Bt(t[o])){case"boolean":case"number":case"object":r+=t[o].toString();break;case"string":t[o].substr(0,1)!=="/"?(e!==void 0&&n&&(i=n.internal.getEncryptor(e)),r+="("+Oo(i(t[o].toString()))+")"):r+=t[o].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Lu=function(t,e,n){var i=function(r){return r};return e!==void 0&&n&&(i=n.internal.getEncryptor(e)),(t=t||"").toString(),"("+Oo(i(t))+")"},Xi=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Xi.prototype.toString=function(){return this.objId+" 0 R"},Xi.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Xi.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var i=e[n],r=this[i];r&&(Array.isArray(r)?t.push({key:i,value:Rv(r,this.objId,this.scope)}):r instanceof Xi?(r.scope=this.scope,t.push({key:i,value:r.objId+" 0 R"})):typeof r!="function"&&t.push({key:i,value:r}))}return t};var Mv=function(){Xi.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};Xn(Mv,Xi);var Bv=function(){Xi.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(i){return i};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Oo(n(t))+")"}},set:function(n){t=n}})};Xn(Bv,Xi);var qi=function t(){Xi.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(C){if(isNaN(C))throw new Error('Invalid value "'+C+'" for attribute F supplied.');e=C}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!cn(e,3)},set:function(C){C?this.F=un(e,3):this.F=dn(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(C){if(isNaN(C))throw new Error('Invalid value "'+C+'" for attribute Ff supplied.');n=C}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(C){i=C!==void 0?C:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(C){i[0]=C}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(C){i[1]=C}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(C){i[2]=C}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(C){i[3]=C}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(C){switch(C){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=C;break;default:throw new Error('Invalid value "'+C+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof sc)return;o="FieldObject"+t.FieldNum++}var C=function(k){return k};return this.scope&&(C=this.scope.internal.getEncryptor(this.objId)),"("+Oo(C(o))+")"},set:function(C){o=C.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(C){o=C}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(C){s=C}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(C){a=C}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(C){c=C}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/af:u},set:function(C){u=C}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(C){f=C}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof sc||this instanceof Ro))return Lu(p,this.objId,this.scope)},set:function(C){C=C.toString(),p=C}});var v=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof Tn==0?Lu(v,this.objId,this.scope):v},set:function(C){C=C.toString(),v=this instanceof Tn==0?C.substr(0,1)==="("?os(C.substr(1,C.length-2)):os(C):C}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Tn==1?os(v.substr(1,v.length-1)):v},set:function(C){C=C.toString(),v=this instanceof Tn==1?"/"+C:C}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(C){this.V=C}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Tn==0?Lu(m,this.objId,this.scope):m},set:function(C){C=C.toString(),m=this instanceof Tn==0?C.substr(0,1)==="("?os(C.substr(1,C.length-2)):os(C):C}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Tn==1?os(m.substr(1,m.length-1)):m},set:function(C){C=C.toString(),m=this instanceof Tn==1?"/"+C:C}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var S,_=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return _},set:function(C){C=!!C,_=C}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(S)return S},set:function(C){S=C}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,1)},set:function(C){C?this.Ff=un(this.Ff,1):this.Ff=dn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,2)},set:function(C){C?this.Ff=un(this.Ff,2):this.Ff=dn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,3)},set:function(C){C?this.Ff=un(this.Ff,3):this.Ff=dn(this.Ff,3)}});var E=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(E!==null)return E},set:function(C){if([0,1,2].indexOf(C)===-1)throw new Error('Invalid value "'+C+'" for attribute Q supplied.');E=C}}),Object.defineProperty(this,"textAlign",{get:function(){var C;switch(E){case 0:default:C="left";break;case 1:C="center";break;case 2:C="right"}return C},configurable:!0,enumerable:!0,set:function(C){switch(C){case"right":case 2:E=2;break;case"center":case 1:E=1;break;default:E=0}}})};Xn(qi,Xi);var Ts=function(){qi.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Rv(e,this.objId,this.scope)},set:function(n){var i,r;r=[],typeof(i=n)=="string"&&(r=(function(o,s,a){a||(a=1);for(var c,u=[];c=s.exec(o);)u.push(c[a]);return u})(i,/\((.*?)\)/g)),e=r}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,i){for(i=i||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,18)},set:function(n){n?this.Ff=un(this.Ff,18):this.Ff=dn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=un(this.Ff,19):this.Ff=dn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,20)},set:function(n){n?(this.Ff=un(this.Ff,20),e.sort()):this.Ff=dn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,22)},set:function(n){n?this.Ff=un(this.Ff,22):this.Ff=dn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,23)},set:function(n){n?this.Ff=un(this.Ff,23):this.Ff=dn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,27)},set:function(n){n?this.Ff=un(this.Ff,27):this.Ff=dn(this.Ff,27)}}),this.hasAppearanceStream=!1};Xn(Ts,qi);var As=function(){Ts.call(this),this.fontName="helvetica",this.combo=!1};Xn(As,Ts);var Is=function(){As.call(this),this.combo=!0};Xn(Is,As);var Wl=function(){Is.call(this),this.edit=!0};Xn(Wl,Is);var Tn=function(){qi.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,15)},set:function(n){n?this.Ff=un(this.Ff,15):this.Ff=dn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,16)},set:function(n){n?this.Ff=un(this.Ff,16):this.Ff=dn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,17)},set:function(n){n?this.Ff=un(this.Ff,17):this.Ff=dn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,26)},set:function(n){n?this.Ff=un(this.Ff,26):this.Ff=dn(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(o){return o};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var i,r=[];for(i in r.push("<<"),e)r.push("/"+i+" ("+Oo(n(e[i]))+")");return r.push(">>"),r.join(`
`)}},set:function(n){Bt(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}})};Xn(Tn,qi);var zl=function(){Tn.call(this),this.pushButton=!0};Xn(zl,Tn);var ks=function(){Tn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Xn(ks,Tn);var sc=function(){var t,e;qi.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(r){e=r}});var n,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var o,s=[];for(o in s.push("<<"),i)s.push("/"+o+" ("+Oo(r(i[o]))+")");return s.push(">>"),s.join(`
`)},set:function(r){Bt(r)==="object"&&(i=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(r){typeof r=="string"&&(i.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(r){n="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Fe.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Xn(sc,qi),ks.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},ks.prototype.createOption=function(t){var e=new sc;return e.Parent=this,e.optionName=t,this.Kids.push(e),c5.call(this.scope,e),e};var Jl=function(){Tn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Fe.CheckBox.createAppearanceStream()};Xn(Jl,Tn);var Ro=function(){qi.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,13)},set:function(e){e?this.Ff=un(this.Ff,13):this.Ff=dn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,21)},set:function(e){e?this.Ff=un(this.Ff,21):this.Ff=dn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,23)},set:function(e){e?this.Ff=un(this.Ff,23):this.Ff=dn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,24)},set:function(e){e?this.Ff=un(this.Ff,24):this.Ff=dn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,25)},set:function(e){e?this.Ff=un(this.Ff,25):this.Ff=dn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,26)},set:function(e){e?this.Ff=un(this.Ff,26):this.Ff=dn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Xn(Ro,qi);var Yl=function(){Ro.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!cn(this.Ff,14)},set:function(t){t?this.Ff=un(this.Ff,14):this.Ff=dn(this.Ff,14)}}),this.password=!0};Xn(Yl,Ro);var Fe={CheckBox:{createAppearanceStream:function(){return{N:{On:Fe.CheckBox.YesNormal},D:{On:Fe.CheckBox.YesPushDown,Off:Fe.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Ki(t);e.scope=t.scope;var n=[],i=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),o=gd(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+st(Fe.internal.getWidth(t))+" "+st(Fe.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+i+" "+st(o.fontSize)+" Tf "+r),n.push("BT"),n.push(o.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=Ki(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),r=[],o=Fe.internal.getHeight(t),s=Fe.internal.getWidth(t),a=gd(t,t.caption);return r.push("1 g"),r.push("0 0 "+st(s)+" "+st(o)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+st(s-1)+" "+st(o-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+n+" "+st(a.fontSize)+" Tf "+i),r.push(a.text),r.push("ET"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Ki(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+st(Fe.internal.getWidth(t))+" "+st(Fe.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Fe.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Fe.RadioButton.Circle.YesNormal,e.D[t]=Fe.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Ki(t);e.scope=t.scope;var n=[],i=Fe.internal.getWidth(t)<=Fe.internal.getHeight(t)?Fe.internal.getWidth(t)/4:Fe.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var r=Fe.internal.Bezier_C,o=Number((i*r).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Or(Fe.internal.getWidth(t)/2)+" "+Or(Fe.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),n.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),n.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),n.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Ki(t);e.scope=t.scope;var n=[],i=Fe.internal.getWidth(t)<=Fe.internal.getHeight(t)?Fe.internal.getWidth(t)/4:Fe.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),o=Number((r*Fe.internal.Bezier_C).toFixed(5)),s=Number((i*Fe.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Or(Fe.internal.getWidth(t)/2)+" "+Or(Fe.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Or(Fe.internal.getWidth(t)/2)+" "+Or(Fe.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Ki(t);e.scope=t.scope;var n=[],i=Fe.internal.getWidth(t)<=Fe.internal.getHeight(t)?Fe.internal.getWidth(t)/4:Fe.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),o=Number((r*Fe.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Or(Fe.internal.getWidth(t)/2)+" "+Or(Fe.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Fe.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Fe.RadioButton.Cross.YesNormal,e.D[t]=Fe.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Ki(t);e.scope=t.scope;var n=[],i=Fe.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+st(Fe.internal.getWidth(t)-2)+" "+st(Fe.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(st(i.x1.x)+" "+st(i.x1.y)+" m"),n.push(st(i.x2.x)+" "+st(i.x2.y)+" l"),n.push(st(i.x4.x)+" "+st(i.x4.y)+" m"),n.push(st(i.x3.x)+" "+st(i.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Ki(t);e.scope=t.scope;var n=Fe.internal.calculateCross(t),i=[];return i.push("0.749023 g"),i.push("0 0 "+st(Fe.internal.getWidth(t))+" "+st(Fe.internal.getHeight(t))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+st(Fe.internal.getWidth(t)-2)+" "+st(Fe.internal.getHeight(t)-2)+" re"),i.push("W"),i.push("n"),i.push(st(n.x1.x)+" "+st(n.x1.y)+" m"),i.push(st(n.x2.x)+" "+st(n.x2.y)+" l"),i.push(st(n.x4.x)+" "+st(n.x4.y)+" m"),i.push(st(n.x3.x)+" "+st(n.x3.y)+" l"),i.push("s"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=Ki(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+st(Fe.internal.getWidth(t))+" "+st(Fe.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};Fe.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Fe.internal.getWidth(t),n=Fe.internal.getHeight(t),i=Math.min(e,n);return{x1:{x:(e-i)/2,y:(n-i)/2+i},x2:{x:(e-i)/2+i,y:(n-i)/2},x3:{x:(e-i)/2,y:(n-i)/2},x4:{x:(e-i)/2+i,y:(n-i)/2+i}}}},Fe.internal.getWidth=function(t){var e=0;return Bt(t)==="object"&&(e=gp(t.Rect[2])),e},Fe.internal.getHeight=function(t){var e=0;return Bt(t)==="object"&&(e=gp(t.Rect[3])),e};var c5=tn.addField=function(t){if(l5(this,t),!(t instanceof qi))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};tn.AcroFormChoiceField=Ts,tn.AcroFormListBox=As,tn.AcroFormComboBox=Is,tn.AcroFormEditBox=Wl,tn.AcroFormButton=Tn,tn.AcroFormPushButton=zl,tn.AcroFormRadioButton=ks,tn.AcroFormCheckBox=Jl,tn.AcroFormTextField=Ro,tn.AcroFormPasswordField=Yl,tn.AcroFormAppearance=Fe,tn.AcroForm={ChoiceField:Ts,ListBox:As,ComboBox:Is,EditBox:Wl,Button:Tn,PushButton:zl,RadioButton:ks,CheckBox:Jl,TextField:Ro,PasswordField:Yl,Appearance:Fe},Oe.AcroForm={ChoiceField:Ts,ListBox:As,ComboBox:Is,EditBox:Wl,Button:Tn,PushButton:zl,RadioButton:ks,CheckBox:Jl,TextField:Ro,PasswordField:Yl,Appearance:Fe};Oe.AcroForm;function Dv(t){return t.reduce(function(e,n,i){return e[n]=i,e},{})}(function(t){var e="addImage_";t.__addimage__={};var n="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=t.__addimage__.getImageFileTypeByImageData=function(N,F){var J,W,ce,fe,ge,ae=n;if((F=F||n)==="RGBA"||N.data!==void 0&&N.data instanceof Uint8ClampedArray&&"height"in N&&"width"in N)return"RGBA";if(ee(N))for(ge in i)for(ce=i[ge],J=0;J<ce.length;J+=1){for(fe=!0,W=0;W<ce[J].length;W+=1)if(ce[J][W]!==void 0&&ce[J][W]!==N[W]){fe=!1;break}if(fe===!0){ae=ge;break}}else for(ge in i)for(ce=i[ge],J=0;J<ce.length;J+=1){for(fe=!0,W=0;W<ce[J].length;W+=1)if(ce[J][W]!==void 0&&ce[J][W]!==N.charCodeAt(W)){fe=!1;break}if(fe===!0){ae=ge;break}}return ae===n&&F!==n&&(ae=F),ae},o=function N(F){for(var J=this.internal.write,W=this.internal.putStream,ce=(0,this.internal.getFilters)();ce.indexOf("FlateEncode")!==-1;)ce.splice(ce.indexOf("FlateEncode"),1);F.objectId=this.internal.newObject();var fe=[];if(fe.push({key:"Type",value:"/XObject"}),fe.push({key:"Subtype",value:"/Image"}),fe.push({key:"Width",value:F.width}),fe.push({key:"Height",value:F.height}),F.colorSpace===C.INDEXED?fe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(F.palette.length/3-1)+" "+("sMask"in F&&F.sMask!==void 0?F.objectId+2:F.objectId+1)+" 0 R]"}):(fe.push({key:"ColorSpace",value:"/"+F.colorSpace}),F.colorSpace===C.DEVICE_CMYK&&fe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),fe.push({key:"BitsPerComponent",value:F.bitsPerComponent}),"decodeParameters"in F&&F.decodeParameters!==void 0&&fe.push({key:"DecodeParms",value:"<<"+F.decodeParameters+">>"}),"transparency"in F&&Array.isArray(F.transparency)&&F.transparency.length>0){for(var ge="",ae=0,ve=F.transparency.length;ae<ve;ae++)ge+=F.transparency[ae]+" "+F.transparency[ae]+" ";fe.push({key:"Mask",value:"["+ge+"]"})}F.sMask!==void 0&&fe.push({key:"SMask",value:F.objectId+1+" 0 R"});var xe=F.filter!==void 0?["/"+F.filter]:void 0;if(W({data:F.data,additionalKeyValues:fe,alreadyAppliedFilters:xe,objectId:F.objectId}),J("endobj"),"sMask"in F&&F.sMask!==void 0){var _e,R=(_e=F.sMaskBitsPerComponent)!==null&&_e!==void 0?_e:F.bitsPerComponent,O={width:F.width,height:F.height,colorSpace:"DeviceGray",bitsPerComponent:R,data:F.sMask};"filter"in F&&(O.decodeParameters="/Predictor ".concat(F.predictor," /Colors 1 /BitsPerComponent ").concat(R," /Columns ").concat(F.width),O.filter=F.filter),N.call(this,O)}if(F.colorSpace===C.INDEXED){var V=this.internal.newObject();W({data:Y(new Uint8Array(F.palette)),objectId:V}),J("endobj")}},s=function(){var N=this.internal.collections[e+"images"];for(var F in N)o.call(this,N[F])},a=function(){var N,F=this.internal.collections[e+"images"],J=this.internal.write;for(var W in F)J("/I"+(N=F[W]).index,N.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},u=function(){var N=this.internal.collections[e+"images"];return c.call(this),N},f=function(){return Object.keys(this.internal.collections[e+"images"]).length},p=function(N){return typeof t["process"+N.toUpperCase()]=="function"},v=function(N){return Bt(N)==="object"&&N.nodeType===1},m=function(N,F){if(N.nodeName==="IMG"&&N.hasAttribute("src")){var J=""+N.getAttribute("src");if(J.indexOf("data:image/")===0)return Gl(unescape(J).split("base64,").pop());var W=t.loadFile(J,!0);if(W!==void 0)return W}if(N.nodeName==="CANVAS"){if(N.width===0||N.height===0)throw new Error("Given canvas must have data. Canvas width: "+N.width+", height: "+N.height);var ce;switch(F){case"PNG":ce="image/png";break;case"WEBP":ce="image/webp";break;default:ce="image/jpeg"}return Gl(N.toDataURL(ce,1).split("base64,").pop())}},S=function(N){var F=this.internal.collections[e+"images"];if(F){for(var J in F)if(N===F[J].alias)return F[J]}},_=function(N,F,J){return N||F||(N=-96,F=-96),N<0&&(N=-1*J.width*72/N/this.internal.scaleFactor),F<0&&(F=-1*J.height*72/F/this.internal.scaleFactor),N===0&&(N=F*J.width/J.height),F===0&&(F=N*J.height/J.width),[N,F]},E=function(N,F,J,W,ce,fe){var ge=_.call(this,J,W,ce),ae=this.internal.getCoordinateString,ve=this.internal.getVerticalCoordinateString,xe=u.call(this);if(J=ge[0],W=ge[1],xe[ce.index]=ce,fe){fe*=Math.PI/180;var _e=Math.cos(fe),R=Math.sin(fe),O=function(Q){return Q.toFixed(4)},V=[O(_e),O(R),O(-1*R),O(_e),0,0,"cm"]}this.internal.write("q"),fe?(this.internal.write([1,"0","0",1,ae(N),ve(F+W),"cm"].join(" ")),this.internal.write(V.join(" ")),this.internal.write([ae(J),"0","0",ae(W),"0","0","cm"].join(" "))):this.internal.write([ae(J),"0","0",ae(W),ae(N),ve(F+W),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ce.index+" Do"),this.internal.write("Q")},C=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var k=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},I=t.__addimage__.sHashCode=function(N){var F,J,W=0;if(typeof N=="string")for(J=N.length,F=0;F<J;F++)W=(W<<5)-W+N.charCodeAt(F),W|=0;else if(ee(N))for(J=N.byteLength/2,F=0;F<J;F++)W=(W<<5)-W+N[F],W|=0;return W},P=t.__addimage__.validateStringAsBase64=function(N){(N=N||"").toString().trim();var F=!0;return N.length===0&&(F=!1),N.length%4!=0&&(F=!1),/^[A-Za-z0-9+/]+$/.test(N.substr(0,N.length-2))===!1&&(F=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(N.substr(-2))===!1&&(F=!1),F},G=t.__addimage__.extractImageFromDataUrl=function(N){if(N==null||!(N=N.trim()).startsWith("data:"))return null;var F=N.indexOf(",");return F<0?null:N.substring(0,F).trim().endsWith("base64")?N.substring(F+1):null};t.__addimage__.isArrayBuffer=function(N){return N instanceof ArrayBuffer};var ee=t.__addimage__.isArrayBufferView=function(N){return N instanceof Int8Array||N instanceof Uint8Array||N instanceof Uint8ClampedArray||N instanceof Int16Array||N instanceof Uint16Array||N instanceof Int32Array||N instanceof Uint32Array||N instanceof Float32Array||N instanceof Float64Array},te=t.__addimage__.binaryStringToUint8Array=function(N){for(var F=N.length,J=new Uint8Array(F),W=0;W<F;W++)J[W]=N.charCodeAt(W);return J},Y=t.__addimage__.arrayBufferToBinaryString=function(N){for(var F="",J=ee(N)?N:new Uint8Array(N),W=0;W<J.length;W+=8192)F+=String.fromCharCode.apply(null,J.subarray(W,W+8192));return F};t.addImage=function(){var N,F,J,W,ce,fe,ge,ae,ve;if(typeof arguments[1]=="number"?(F=n,J=arguments[1],W=arguments[2],ce=arguments[3],fe=arguments[4],ge=arguments[5],ae=arguments[6],ve=arguments[7]):(F=arguments[1],J=arguments[2],W=arguments[3],ce=arguments[4],fe=arguments[5],ge=arguments[6],ae=arguments[7],ve=arguments[8]),Bt(N=arguments[0])==="object"&&!v(N)&&"imageData"in N){var xe=N;N=xe.imageData,F=xe.format||F||n,J=xe.x||J||0,W=xe.y||W||0,ce=xe.w||xe.width||ce,fe=xe.h||xe.height||fe,ge=xe.alias||ge,ae=xe.compression||ae,ve=xe.rotation||xe.angle||ve}var _e=this.internal.getFilters();if(ae===void 0&&_e.indexOf("FlateEncode")!==-1&&(ae="SLOW"),isNaN(J)||isNaN(W))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var R=D.call(this,N,F,ge,ae);return E.call(this,J,W,ce,fe,R,ve),this};var D=function(N,F,J,W){var ce,fe,ge;if(typeof N=="string"&&r(N)===n){N=unescape(N);var ae=Z(N,!1);(ae!==""||(ae=t.loadFile(N,!0))!==void 0)&&(N=ae)}if(v(N)&&(N=m(N,F)),F=r(N,F),!p(F))throw new Error("addImage does not support files of type '"+F+"', please ensure that a plugin for '"+F+"' support is added.");if(((ge=J)==null||ge.length===0)&&(J=(function(ve){return typeof ve=="string"||ee(ve)?I(ve):ee(ve.data)?I(ve.data):null})(N)),(ce=S.call(this,J))||(N instanceof Uint8Array||F==="RGBA"||(fe=N,N=te(N)),ce=this["process"+F.toUpperCase()](N,f.call(this),J,(function(ve){return ve&&typeof ve=="string"&&(ve=ve.toUpperCase()),ve in t.image_compression?ve:k.NONE})(W),fe)),!ce)throw new Error("An unknown error occurred whilst processing the image.");return ce},Z=t.__addimage__.convertBase64ToBinaryString=function(N,F){F=typeof F!="boolean"||F;var J,W="";if(typeof N=="string"){var ce;J=(ce=G(N))!==null&&ce!==void 0?ce:N;try{W=Gl(J)}catch(fe){if(F)throw P(J)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+fe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return W};t.getImageProperties=function(N){var F,J,W="";if(v(N)&&(N=m(N)),typeof N=="string"&&r(N)===n&&((W=Z(N,!1))===""&&(W=t.loadFile(N)||""),N=W),J=r(N),!p(J))throw new Error("addImage does not support files of type '"+J+"', please ensure that a plugin for '"+J+"' support is added.");if(N instanceof Uint8Array||(N=te(N)),!(F=this["process"+J.toUpperCase()](N)))throw new Error("An unknown error occurred whilst processing the image");return F.fileType=J,F}})(Oe.API),(function(t){var e=function(n){if(n!==void 0&&n!="")return!0};Oe.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var i,r,o,s=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(n.objId),u=n.pageContext.annotations,f=!1,p=0;p<u.length&&!f;p++)switch((i=u[p]).type){case"link":(e(i.options.url)||e(i.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var v=0;v<u.length;v++){i=u[v];var m=this.internal.pdfEscape,S=this.internal.getEncryptor(n.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var _=this.internal.newAdditionalObject(),E=this.internal.newAdditionalObject(),C=this.internal.getEncryptor(_.objId),k=i.title||"Note";o="<</Type /Annot /Subtype /Text "+(r="/Rect ["+s(i.bounds.x)+" "+a(i.bounds.y+i.bounds.h)+" "+s(i.bounds.x+i.bounds.w)+" "+a(i.bounds.y)+"] ")+"/Contents ("+m(C(i.contents))+")",o+=" /Popup "+E.objId+" 0 R",o+=" /P "+c.objId+" 0 R",o+=" /T ("+m(C(k))+") >>",_.content=o;var I=_.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+s(i.bounds.x+30)+" "+a(i.bounds.y+i.bounds.h)+" "+s(i.bounds.x+i.bounds.w+30)+" "+a(i.bounds.y)+"] ")+" /Parent "+I,i.open&&(o+=" /Open true"),o+=" >>",E.content=o,this.internal.write(_.objId,"0 R",E.objId,"0 R");break;case"freetext":r="/Rect ["+s(i.bounds.x)+" "+a(i.bounds.y)+" "+s(i.bounds.x+i.bounds.w)+" "+a(i.bounds.y+i.bounds.h)+"] ";var P=i.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+m(S(i.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+P+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(i.options.name){var G=this.annotations._nameMap[i.options.name];i.options.pageNumber=G.page,i.options.top=G.y}else i.options.top||(i.options.top=0);if(r="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",o="",i.options.url)o="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+m(S(i.options.url))+") >>";else if(i.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,o+=" /FitV "+i.options.left+"]";break;default:var ee=a(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),o+=" /XYZ "+i.options.left+" "+ee+" "+i.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var i=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":i.pageContext.annotations.push(n)}},t.link=function(n,i,r,o,s){var a=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:c(n),y:u(i),w:c(n+r),h:u(i+o)},options:s,type:"link"})},t.textWithLink=function(n,i,r,o){var s,a,c=this.getTextWidth(n),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){a=o.maxWidth;var f=this.splitTextToSize(n,a).length;s=Math.ceil(u*f)}else a=c,s=u;return this.text(n,i,r,o),r+=.2*u,o.align==="center"&&(i-=c/2),o.align==="right"&&(i-=c),this.link(i,r-u,a,s,o),c},t.getTextWidth=function(n){var i=this.internal.getFontSize();return this.getStringUnitWidth(n)*i/this.internal.scaleFactor}})(Oe.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];t.__arabicParser__={};var o=t.__arabicParser__.isInArabicSubstitutionA=function(_){return e[_.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(_){return typeof _=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(_)},a=t.__arabicParser__.isArabicEndLetter=function(_){return s(_)&&o(_)&&e[_.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(_){return s(_)&&r.indexOf(_.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(_){return s(_)&&o(_)&&e[_.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(_){return s(_)&&o(_)&&e[_.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(_){return s(_)&&o(_)&&e[_.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(_){return s(_)&&o(_)&&e[_.charCodeAt(0)].length==4},p=t.__arabicParser__.resolveLigatures=function(_){var E=0,C=n,k="",I=0;for(E=0;E<_.length;E+=1)C[_.charCodeAt(E)]!==void 0?(I++,typeof(C=C[_.charCodeAt(E)])=="number"&&(k+=String.fromCharCode(C),C=n,I=0),E===_.length-1&&(C=n,k+=_.charAt(E-(I-1)),E-=I-1,I=0)):(C=n,k+=_.charAt(E-I),E-=I,I=0);return k};t.__arabicParser__.isArabicDiacritic=function(_){return _!==void 0&&i[_.charCodeAt(0)]!==void 0};var v=t.__arabicParser__.getCorrectForm=function(_,E,C){return s(_)?o(_)===!1?-1:!u(_)||!s(E)&&!s(C)||!s(C)&&a(E)||a(_)&&!s(E)||a(_)&&c(E)||a(_)&&a(E)?0:f(_)&&s(E)&&!a(E)&&s(C)&&u(C)?3:a(_)||!s(C)?1:2:-1},m=function(_){var E=0,C=0,k=0,I="",P="",G="",ee=(_=_||"").split("\\s+"),te=[];for(E=0;E<ee.length;E+=1){for(te.push(""),C=0;C<ee[E].length;C+=1)I=ee[E][C],P=ee[E][C-1],G=ee[E][C+1],s(I)?(k=v(I,P,G),te[E]+=k!==-1?String.fromCharCode(e[I.charCodeAt(0)][k]):I):te[E]+=I;te[E]=p(te[E])}return te.join(" ")},S=t.__arabicParser__.processArabic=t.processArabic=function(){var _,E=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,C=[];if(Array.isArray(E)){var k=0;for(C=[],k=0;k<E.length;k+=1)Array.isArray(E[k])?C.push([m(E[k][0]),E[k][1],E[k][2]]):C.push([m(E[k])]);_=C}else _=m(E);return typeof arguments[0]=="string"?_:(arguments[0].text=_,arguments[0])};t.events.push(["preProcessText",S])})(Oe.API),Oe.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(a){n=a}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(a){i=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(a){r=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(a){o=a}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(a){s=a}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,i){var r;if((n=n||"2d")!=="2d")return null;for(r in i)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=i[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(Oe.API),(function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(_){c=_}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(_){u=_}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(_){f=_}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(_){p=_}});var v=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return v},set:function(_){v=_}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(_){m=_}});var S=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return S},set:function(_){S=_}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return i.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){i.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),p=u.font||this.getFont(),v=u.scaleFactor||this.internal.scaleFactor,m=0,S=0,_=0,E=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var C=u.maxWidth;C>0?typeof c=="string"?c=this.splitTextToSize(c,C):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(I,P){return I.concat(E.splitTextToSize(P,C))},[])):c=Array.isArray(c)?c:[c];for(var k=0;k<c.length;k++)m<(_=this.getStringUnitWidth(c[k],{font:p})*f)&&(m=_);return m!==0&&(S=c.length),{w:m/=v,h:Math.max((S*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/v,0)}},t.cellAddPage=function(){i.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var c;c=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),i.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,p=this.internal.__cell__.margins||e,v=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=p.top,m&&v&&(this.printHeaderRow(c.lineNumber,!0),c.y+=v[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,n===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,f,p,v){if(i.call(this),!f)throw new Error("No data for PDF table.");var m,S,_,E,C=[],k=[],I=[],P={},G={},ee=[],te=[],Y=(v=v||{}).autoSize||!1,D=v.printHeaders!==!1,Z=v.css&&v.css["font-size"]!==void 0?16*v.css["font-size"]:v.fontSize||12,N=v.margins||Object.assign({width:this.getPageWidth()},e),F=typeof v.padding=="number"?v.padding:3,J=v.headerBackgroundColor||"#c8c8c8",W=v.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=D,this.internal.__cell__.margins=N,this.internal.__cell__.table_font_size=Z,this.internal.__cell__.padding=F,this.internal.__cell__.headerBackgroundColor=J,this.internal.__cell__.headerTextColor=W,this.setFontSize(Z),p==null)k=C=Object.keys(f[0]),I=C.map(function(){return"left"});else if(Array.isArray(p)&&Bt(p[0])==="object")for(C=p.map(function(xe){return xe.name}),k=p.map(function(xe){return xe.prompt||xe.name||""}),I=p.map(function(xe){return xe.align||"left"}),m=0;m<p.length;m+=1)G[p[m].name]=.7499990551181103*p[m].width;else Array.isArray(p)&&typeof p[0]=="string"&&(k=C=p,I=C.map(function(){return"left"}));if(Y||Array.isArray(p)&&typeof p[0]=="string")for(m=0;m<C.length;m+=1){for(P[E=C[m]]=f.map(function(xe){return xe[E]}),this.setFont(void 0,"bold"),ee.push(this.getTextDimensions(k[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),S=P[E],this.setFont(void 0,"normal"),_=0;_<S.length;_+=1)ee.push(this.getTextDimensions(S[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);G[E]=Math.max.apply(null,ee)+F+F,ee=[]}if(D){var ce={};for(m=0;m<C.length;m+=1)ce[C[m]]={},ce[C[m]].text=k[m],ce[C[m]].align=I[m];var fe=a.call(this,ce,G);te=C.map(function(xe){return new o(c,u,G[xe],fe,ce[xe].text,void 0,ce[xe].align)}),this.setTableHeaderRow(te),this.printHeaderRow(1,!1)}var ge=p.reduce(function(xe,_e){return xe[_e.name]=_e.align,xe},{});for(m=0;m<f.length;m+=1){"rowStart"in v&&v.rowStart instanceof Function&&v.rowStart({row:m,data:f[m]},this);var ae=a.call(this,f[m],G);for(_=0;_<C.length;_+=1){var ve=f[m][C[_]];"cellStart"in v&&v.cellStart instanceof Function&&v.cellStart({row:m,col:_,data:ve},this),s.call(this,new o(c,u,G[C[_]],ae,ve,m+2,ge[C[_]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var a=function(c,u){var f=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,v=this.internal.scaleFactor;return Object.keys(c).map(function(m){var S=c[m];return this.splitTextToSize(S.hasOwnProperty("text")?S.text:S,u[m]-f-f)},this).map(function(m){return this.getLineHeightFactor()*m.length*p/v+f+f},this).reduce(function(m,S){return Math.max(m,S)},0)};t.setTableHeaderRow=function(c){i.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var v=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){f=this.internal.__cell__.tableHeaderRow[m].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,v.push(f)),f.lineNumber=c;var S=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,f),this.setTextColor(S)}v.length>0&&this.setTableHeaderRow(v),this.setFont(void 0,"normal"),n=!1}})(Oe.API);var Fv={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},qv=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],md=Dv(qv),Uv=[100,200,300,400,500,600,700,800,900],u5=Dv(Uv);function Pu(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=(function(o){return Fv[o=o||"normal"]?o:"normal"})(t.style),i=(function(o){return o?typeof o=="number"?o>=100&&o<=900&&o%100==0?o:400:/^\d00$/.test(o)?parseInt(o):o==="bold"?700:400:400})(t.weight),r=(function(o){return typeof md[o=o||"normal"]=="number"?o:"normal"})(t.stretch);return{family:e,style:n,weight:i,stretch:r,src:t.src||[],ref:t.ref||{name:e,style:[r,n,i].join(" ")}}}function mp(t,e,n,i){var r;for(r=n;r>=0&&r<e.length;r+=i)if(t[e[r]])return t[e[r]];for(r=n;r>=0&&r<e.length;r-=i)if(t[e[r]])return t[e[r]]}var d5={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},vp={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function yp(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function bp(t){return t.trimLeft()}function f5(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function h5(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Rl,wp,Sp,ss,Ml,_p,Cp,Ep,Nu=["times"];function Tp(t,e,n,i,r){var o=4,s=Ip;switch(r){case Oe.API.image_compression.FAST:o=1,s=Ap;break;case Oe.API.image_compression.MEDIUM:o=6,s=kp;break;case Oe.API.image_compression.SLOW:o=9,s=xp}t=(function(c,u,f,p){for(var v,m=c.length/u,S=new Uint8Array(c.length+m),_=[p5,Ap,Ip,kp,xp],E=0;E<m;E+=1){var C=E*u,k=c.subarray(C,C+u);if(p)S.set(p(k,f,v),C+E);else{for(var I=_.length,P=[],G=0;G<I;G+=1)P[G]=_[G](k,f,v);var ee=m5(P.concat());S.set(P[ee],C+E)}v=k}return S})(t,e,Math.ceil(n*i/8),s);var a=cd(t,{level:o});return Oe.API.__addimage__.arrayBufferToBinaryString(a)}function p5(t){var e=Array.apply([],t);return e.unshift(0),e}function Ap(t,e){var n=t.length,i=[];i[0]=1;for(var r=0;r<n;r+=1){var o=t[r-e]||0;i[r+1]=t[r]-o+256&255}return i}function Ip(t,e,n){var i=t.length,r=[];r[0]=2;for(var o=0;o<i;o+=1){var s=n&&n[o]||0;r[o+1]=t[o]-s+256&255}return r}function kp(t,e,n){var i=t.length,r=[];r[0]=3;for(var o=0;o<i;o+=1){var s=t[o-e]||0,a=n&&n[o]||0;r[o+1]=t[o]+256-(s+a>>>1)&255}return r}function xp(t,e,n){var i=t.length,r=[];r[0]=4;for(var o=0;o<i;o+=1){var s=g5(t[o-e]||0,n&&n[o]||0,n&&n[o-e]||0);r[o+1]=t[o]-s+256&255}return r}function g5(t,e,n){if(t===e&&e===n)return t;var i=Math.abs(e-n),r=Math.abs(t-n),o=Math.abs(t+e-n-n);return i<=r&&i<=o?t:r<=o?e:n}function m5(t){var e=t.map(function(n){return n.reduce(function(i,r){return i+Math.abs(r)},0)});return e.indexOf(Math.min.apply(null,e))}function Ru(t,e,n){var i=e*n,r=Math.floor(i/8),o=16-(i-8*r+n),s=(1<<n)-1;return $v(t,r)>>o&s}function Lp(t,e,n,i){var r=n*i,o=Math.floor(r/8),s=16-(r-8*o+i),a=(1<<i)-1,c=(e&a)<<s;(function(u,f,p){if(f+1<u.byteLength)u.setUint16(f,p,!1);else{var v=p>>8&255;u.setUint8(f,v)}})(t,o,$v(t,o)&~(a<<s)&65535|c)}function $v(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function v5(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,i=t[e++]|t[e++]<<8,r=t[e++],o=r>>7,s=1<<1+(7&r);t[e++],t[e++];var a=null,c=null;o&&(a=e,c=s,e+=3*s);var u=!0,f=[],p=0,v=null,m=0,S=null;for(this.width=n,this.height=i;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,S=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((N=t[e++])>=0))throw Error("Invalid block size");if(N===0)break;e+=N}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var _=t[e++];p=t[e++]|t[e++]<<8,v=t[e++],1&_||(v=null),m=_>>2&7,e++;break;case 254:for(;;){if(!((N=t[e++])>=0))throw Error("Invalid block size");if(N===0)break;e+=N}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var E=t[e++]|t[e++]<<8,C=t[e++]|t[e++]<<8,k=t[e++]|t[e++]<<8,I=t[e++]|t[e++]<<8,P=t[e++],G=P>>6&1,ee=1<<1+(7&P),te=a,Y=c,D=!1;P>>7&&(D=!0,te=e,Y=ee,e+=3*ee);var Z=e;for(e++;;){var N;if(!((N=t[e++])>=0))throw Error("Invalid block size");if(N===0)break;e+=N}f.push({x:E,y:C,width:k,height:I,has_local_palette:D,palette_offset:te,palette_size:Y,data_offset:Z,data_length:e-Z,transparent_index:v,interlaced:!!G,delay:p,disposal:m});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return S},this.frameInfo=function(F){if(F<0||F>=f.length)throw new Error("Frame index out of range.");return f[F]},this.decodeAndBlitFrameBGRA=function(F,J){var W=this.frameInfo(F),ce=W.width*W.height,fe=new Uint8Array(ce);Pp(t,W.data_offset,fe,ce);var ge=W.palette_offset,ae=W.transparent_index;ae===null&&(ae=256);var ve=W.width,xe=n-ve,_e=ve,R=4*(W.y*n+W.x),O=4*((W.y+W.height)*n+W.x),V=R,Q=4*xe;W.interlaced===!0&&(Q+=4*n*7);for(var ne=8,le=0,de=fe.length;le<de;++le){var ue=fe[le];if(_e===0&&(_e=ve,(V+=Q)>=O&&(Q=4*xe+4*n*(ne-1),V=R+(ve+xe)*(ne<<1),ne>>=1)),ue===ae)V+=4;else{var we=t[ge+3*ue],Ie=t[ge+3*ue+1],Re=t[ge+3*ue+2];J[V++]=Re,J[V++]=Ie,J[V++]=we,J[V++]=255}--_e}},this.decodeAndBlitFrameRGBA=function(F,J){var W=this.frameInfo(F),ce=W.width*W.height,fe=new Uint8Array(ce);Pp(t,W.data_offset,fe,ce);var ge=W.palette_offset,ae=W.transparent_index;ae===null&&(ae=256);var ve=W.width,xe=n-ve,_e=ve,R=4*(W.y*n+W.x),O=4*((W.y+W.height)*n+W.x),V=R,Q=4*xe;W.interlaced===!0&&(Q+=4*n*7);for(var ne=8,le=0,de=fe.length;le<de;++le){var ue=fe[le];if(_e===0&&(_e=ve,(V+=Q)>=O&&(Q=4*xe+4*n*(ne-1),V=R+(ve+xe)*(ne<<1),ne>>=1)),ue===ae)V+=4;else{var we=t[ge+3*ue],Ie=t[ge+3*ue+1],Re=t[ge+3*ue+2];J[V++]=we,J[V++]=Ie,J[V++]=Re,J[V++]=255}--_e}}}function Pp(t,e,n,i){for(var r=t[e++],o=1<<r,s=o+1,a=s+1,c=r+1,u=(1<<c)-1,f=0,p=0,v=0,m=t[e++],S=new Int32Array(4096),_=null;;){for(;f<16&&m!==0;)p|=t[e++]<<f,f+=8,m===1?m=t[e++]:--m;if(f<c)break;var E=p&u;if(p>>=c,f-=c,E!==o){if(E===s)break;for(var C=E<a?E:_,k=0,I=C;I>o;)I=S[I]>>8,++k;var P=I;if(v+k+(C!==E?1:0)>i)return void Ot.log("Warning, gif stream longer than expected.");n[v++]=P;var G=v+=k;for(C!==E&&(n[v++]=P),I=C;k--;)I=S[I],n[--G]=255&I,I>>=8;_!==null&&a<4096&&(S[a++]=_<<8|P,a>=u+1&&c<12&&(++c,u=u<<1|1)),_=E}else a=s+1,u=(1<<(c=r+1))-1,_=null}return v!==i&&Ot.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Mu(t){var e,n,i,r,o,s=Math.floor,a=new Array(64),c=new Array(64),u=new Array(64),f=new Array(64),p=new Array(65535),v=new Array(65535),m=new Array(64),S=new Array(64),_=[],E=0,C=7,k=new Array(64),I=new Array(64),P=new Array(64),G=new Array(256),ee=new Array(2048),te=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Y=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],D=[0,1,2,3,4,5,6,7,8,9,10,11],Z=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],N=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],F=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],J=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ce=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function fe(R,O){for(var V=0,Q=0,ne=new Array,le=1;le<=16;le++){for(var de=1;de<=R[le];de++)ne[O[Q]]=[],ne[O[Q]][0]=V,ne[O[Q]][1]=le,Q++,V++;V*=2}return ne}function ge(R){for(var O=R[0],V=R[1]-1;V>=0;)O&1<<V&&(E|=1<<C),V--,--C<0&&(E==255?(ae(255),ae(0)):ae(E),C=7,E=0)}function ae(R){_.push(R)}function ve(R){ae(R>>8&255),ae(255&R)}function xe(R,O,V,Q,ne){for(var le,de=ne[0],ue=ne[240],we=(function(ke,We){var Ne,pt,Ke,It,at,lt,Dt,gt,Je,Ze,Ye=0;for(Je=0;Je<8;++Je){Ne=ke[Ye],pt=ke[Ye+1],Ke=ke[Ye+2],It=ke[Ye+3],at=ke[Ye+4],lt=ke[Ye+5],Dt=ke[Ye+6];var Ht=Ne+(gt=ke[Ye+7]),kt=Ne-gt,Ve=pt+Dt,ct=pt-Dt,Ft=Ke+lt,Qe=Ke-lt,_t=It+at,ut=It-at,nn=Ht+_t,mn=Ht-_t,qt=Ve+Ft,nt=Ve-Ft;ke[Ye]=nn+qt,ke[Ye+4]=nn-qt;var Lt=.707106781*(nt+mn);ke[Ye+2]=mn+Lt,ke[Ye+6]=mn-Lt;var to=.382683433*((nn=ut+Qe)-(nt=ct+kt)),Mn=.5411961*nn+to,tr=1.306562965*nt+to,Oi=.707106781*(qt=Qe+ct),Xe=kt+Oi,nr=kt-Oi;ke[Ye+5]=nr+Mn,ke[Ye+3]=nr-Mn,ke[Ye+1]=Xe+tr,ke[Ye+7]=Xe-tr,Ye+=8}for(Ye=0,Je=0;Je<8;++Je){Ne=ke[Ye],pt=ke[Ye+8],Ke=ke[Ye+16],It=ke[Ye+24],at=ke[Ye+32],lt=ke[Ye+40],Dt=ke[Ye+48];var ir=Ne+(gt=ke[Ye+56]),ui=Ne-gt,di=pt+Dt,Qt=pt-Dt,Cn=Ke+lt,kn=Ke-lt,no=It+at,Cr=It-at,Ti=ir+no,Hi=ir-no,Ai=di+Cn,Ii=di-Cn;ke[Ye]=Ti+Ai,ke[Ye+32]=Ti-Ai;var fi=.707106781*(Ii+Hi);ke[Ye+16]=Hi+fi,ke[Ye+48]=Hi-fi;var io=.382683433*((Ti=Cr+kn)-(Ii=Qt+ui)),Vi=.5411961*Ti+io,ro=1.306562965*Ii+io,Wo=.707106781*(Ai=kn+Qt),zo=ui+Wo,Jo=ui-Wo;ke[Ye+40]=Jo+Vi,ke[Ye+24]=Jo-Vi,ke[Ye+8]=zo+ro,ke[Ye+56]=zo-ro,Ye++}for(Je=0;Je<64;++Je)Ze=ke[Je]*We[Je],m[Je]=Ze>0?Ze+.5|0:Ze-.5|0;return m})(R,O),Ie=0;Ie<64;++Ie)S[te[Ie]]=we[Ie];var Re=S[0]-V;V=S[0],Re==0?ge(Q[0]):(ge(Q[v[le=32767+Re]]),ge(p[le]));for(var Me=63;Me>0&&S[Me]==0;)Me--;if(Me==0)return ge(de),V;for(var he,H=1;H<=Me;){for(var St=H;S[H]==0&&H<=Me;)++H;var ht=H-St;if(ht>=16){he=ht>>4;for(var je=1;je<=he;++je)ge(ue);ht&=15}le=32767+S[H],ge(ne[(ht<<4)+v[le]]),ge(p[le]),H++}return Me!=63&&ge(de),V}function _e(R){R=Math.min(Math.max(R,1),100),o!=R&&((function(O){for(var V=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Q=0;Q<64;Q++){var ne=s((V[Q]*O+50)/100);ne=Math.min(Math.max(ne,1),255),a[te[Q]]=ne}for(var le=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],de=0;de<64;de++){var ue=s((le[de]*O+50)/100);ue=Math.min(Math.max(ue,1),255),c[te[de]]=ue}for(var we=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ie=0,Re=0;Re<8;Re++)for(var Me=0;Me<8;Me++)u[Ie]=1/(a[te[Ie]]*we[Re]*we[Me]*8),f[Ie]=1/(c[te[Ie]]*we[Re]*we[Me]*8),Ie++})(R<50?Math.floor(5e3/R):Math.floor(200-2*R)),o=R)}this.encode=function(R,O){O&&_e(O),_=new Array,E=0,C=7,ve(65496),ve(65504),ve(16),ae(74),ae(70),ae(73),ae(70),ae(0),ae(1),ae(1),ae(0),ve(1),ve(1),ae(0),ae(0),(function(){ve(65499),ve(132),ae(0);for(var pt=0;pt<64;pt++)ae(a[pt]);ae(1);for(var Ke=0;Ke<64;Ke++)ae(c[Ke])})(),(function(pt,Ke){ve(65472),ve(17),ae(8),ve(Ke),ve(pt),ae(3),ae(1),ae(17),ae(0),ae(2),ae(17),ae(1),ae(3),ae(17),ae(1)})(R.width,R.height),(function(){ve(65476),ve(418),ae(0);for(var pt=0;pt<16;pt++)ae(Y[pt+1]);for(var Ke=0;Ke<=11;Ke++)ae(D[Ke]);ae(16);for(var It=0;It<16;It++)ae(Z[It+1]);for(var at=0;at<=161;at++)ae(N[at]);ae(1);for(var lt=0;lt<16;lt++)ae(F[lt+1]);for(var Dt=0;Dt<=11;Dt++)ae(J[Dt]);ae(17);for(var gt=0;gt<16;gt++)ae(W[gt+1]);for(var Je=0;Je<=161;Je++)ae(ce[Je])})(),ve(65498),ve(12),ae(3),ae(1),ae(0),ae(2),ae(17),ae(3),ae(17),ae(0),ae(63),ae(0);var V=0,Q=0,ne=0;E=0,C=7,this.encode.displayName="_encode_";for(var le,de,ue,we,Ie,Re,Me,he,H,St=R.data,ht=R.width,je=R.height,ke=4*ht,We=0;We<je;){for(le=0;le<ke;){for(Ie=ke*We+le,Me=-1,he=0,H=0;H<64;H++)Re=Ie+(he=H>>3)*ke+(Me=4*(7&H)),We+he>=je&&(Re-=ke*(We+1+he-je)),le+Me>=ke&&(Re-=le+Me-ke+4),de=St[Re++],ue=St[Re++],we=St[Re++],k[H]=(ee[de]+ee[ue+256|0]+ee[we+512|0]>>16)-128,I[H]=(ee[de+768|0]+ee[ue+1024|0]+ee[we+1280|0]>>16)-128,P[H]=(ee[de+1280|0]+ee[ue+1536|0]+ee[we+1792|0]>>16)-128;V=xe(k,u,V,e,i),Q=xe(I,f,Q,n,r),ne=xe(P,f,ne,n,r),le+=32}We+=8}if(C>=0){var Ne=[];Ne[1]=C+1,Ne[0]=(1<<C+1)-1,ge(Ne)}return ve(65497),new Uint8Array(_)},t=t||50,(function(){for(var R=String.fromCharCode,O=0;O<256;O++)G[O]=R(O)})(),e=fe(Y,D),n=fe(F,J),i=fe(Z,N),r=fe(W,ce),(function(){for(var R=1,O=2,V=1;V<=15;V++){for(var Q=R;Q<O;Q++)v[32767+Q]=V,p[32767+Q]=[],p[32767+Q][1]=V,p[32767+Q][0]=Q;for(var ne=-(O-1);ne<=-R;ne++)v[32767+ne]=V,p[32767+ne]=[],p[32767+ne][1]=V,p[32767+ne][0]=O-1+ne;R<<=1,O<<=1}})(),(function(){for(var R=0;R<256;R++)ee[R]=19595*R,ee[R+256|0]=38470*R,ee[R+512|0]=7471*R+32768,ee[R+768|0]=-11059*R,ee[R+1024|0]=-21709*R,ee[R+1280|0]=32768*R+8421375,ee[R+1536|0]=-27439*R,ee[R+1792|0]=-5329*R})(),_e(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ni(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Np(t){function e(D){if(!D)throw Error("assert :P")}function n(D,Z,N){for(var F=0;4>F;F++)if(D[Z+F]!=N.charCodeAt(F))return!0;return!1}function i(D,Z,N,F,J){for(var W=0;W<J;W++)D[Z+W]=N[F+W]}function r(D,Z,N,F){for(var J=0;J<F;J++)D[Z+J]=N}function o(D){return new Int32Array(D)}function s(D,Z){for(var N=[],F=0;F<D;F++)N.push(new Z);return N}function a(D,Z){var N=[];return(function F(J,W,ce){for(var fe=ce[W],ge=0;ge<fe&&(J.push(ce.length>W+1?[]:new Z),!(ce.length<W+1));ge++)F(J[ge],W+1,ce)})(N,0,D),N}var c=function(){var D=this;function Z(h,g){for(var b=1<<g-1>>>0;h&b;)b>>>=1;return b?(h&b-1)+b:h}function N(h,g,b,w,A){e(!(w%b));do h[g+(w-=b)]=A;while(0<w)}function F(h,g,b,w,A){if(e(2328>=A),512>=A)var x=o(512);else if((x=o(A))==null)return 0;return(function(L,M,B,q,K,se){var U,X,re=M,pe=1<<B,oe=o(16),me=o(16);for(e(K!=0),e(q!=null),e(L!=null),e(0<B),X=0;X<K;++X){if(15<q[X])return 0;++oe[q[X]]}if(oe[0]==K)return 0;for(me[1]=0,U=1;15>U;++U){if(oe[U]>1<<U)return 0;me[U+1]=me[U]+oe[U]}for(X=0;X<K;++X)U=q[X],0<q[X]&&(se[me[U]++]=X);if(me[15]==1)return(q=new J).g=0,q.value=se[0],N(L,re,1,pe,q),pe;var be,Te=-1,Se=pe-1,Ge=0,Be=1,mt=1,Ue=1<<B;for(X=0,U=1,K=2;U<=B;++U,K<<=1){if(Be+=mt<<=1,0>(mt-=oe[U]))return 0;for(;0<oe[U];--oe[U])(q=new J).g=U,q.value=se[X++],N(L,re+Ge,K,Ue,q),Ge=Z(Ge,U)}for(U=B+1,K=2;15>=U;++U,K<<=1){if(Be+=mt<<=1,0>(mt-=oe[U]))return 0;for(;0<oe[U];--oe[U]){if(q=new J,(Ge&Se)!=Te){for(re+=Ue,be=1<<(Te=U)-B;15>Te&&!(0>=(be-=oe[Te]));)++Te,be<<=1;pe+=Ue=1<<(be=Te-B),L[M+(Te=Ge&Se)].g=be+B,L[M+Te].value=re-M-Te}q.g=U-B,q.value=se[X++],N(L,re+(Ge>>B),K,Ue,q),Ge=Z(Ge,U)}}return Be!=2*me[15]-1?0:pe})(h,g,b,w,A,x)}function J(){this.value=this.g=0}function W(){this.value=this.g=0}function ce(){this.G=s(5,J),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(_o,W)}function fe(h,g,b,w){e(h!=null),e(g!=null),e(2147483648>w),h.Ca=254,h.I=0,h.b=-8,h.Ka=0,h.oa=g,h.pa=b,h.Jd=g,h.Yc=b+w,h.Zc=4<=w?b+w-4+1:b,de(h)}function ge(h,g){for(var b=0;0<g--;)b|=we(h,128)<<g;return b}function ae(h,g){var b=ge(h,g);return ue(h)?-b:b}function ve(h,g,b,w){var A,x=0;for(e(h!=null),e(g!=null),e(4294967288>w),h.Sb=w,h.Ra=0,h.u=0,h.h=0,4<w&&(w=4),A=0;A<w;++A)x+=g[b+A]<<8*A;h.Ra=x,h.bb=w,h.oa=g,h.pa=b}function xe(h){for(;8<=h.u&&h.bb<h.Sb;)h.Ra>>>=8,h.Ra+=h.oa[h.pa+h.bb]<<kr-8>>>0,++h.bb,h.u-=8;Q(h)&&(h.h=1,h.u=0)}function _e(h,g){if(e(0<=g),!h.h&&g<=ei){var b=V(h)&Zn[g];return h.u+=g,xe(h),b}return h.h=1,h.u=0}function R(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function O(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function V(h){return h.Ra>>>(h.u&kr-1)>>>0}function Q(h){return e(h.bb<=h.Sb),h.h||h.bb==h.Sb&&h.u>kr}function ne(h,g){h.u=g,h.h=Q(h)}function le(h){h.u>=ur&&(e(h.u>=ur),xe(h))}function de(h){e(h!=null&&h.oa!=null),h.pa<h.Zc?(h.I=(h.oa[h.pa++]|h.I<<8)>>>0,h.b+=8):(e(h!=null&&h.oa!=null),h.pa<h.Yc?(h.b+=8,h.I=h.oa[h.pa++]|h.I<<8):h.Ka?h.b=0:(h.I<<=8,h.b+=8,h.Ka=1))}function ue(h){return ge(h,1)}function we(h,g){var b=h.Ca;0>h.b&&de(h);var w=h.b,A=b*g>>>8,x=(h.I>>>w>A)+0;for(x?(b-=A,h.I-=A+1<<w>>>0):b=A+1,w=b,A=0;256<=w;)A+=8,w>>=8;return w=7^A+xr[w],h.b-=w,h.Ca=(b<<w)-1,x}function Ie(h,g,b){h[g+0]=b>>24&255,h[g+1]=b>>16&255,h[g+2]=b>>8&255,h[g+3]=255&b}function Re(h,g){return h[g+0]|h[g+1]<<8}function Me(h,g){return Re(h,g)|h[g+2]<<16}function he(h,g){return Re(h,g)|Re(h,g+2)<<16}function H(h,g){var b=1<<g;return e(h!=null),e(0<g),h.X=o(b),h.X==null?0:(h.Mb=32-g,h.Xa=g,1)}function St(h,g){e(h!=null),e(g!=null),e(h.Xa==g.Xa),i(g.X,0,h.X,0,1<<g.Xa)}function ht(){this.X=[],this.Xa=this.Mb=0}function je(h,g,b,w){e(b!=null),e(w!=null);var A=b[0],x=w[0];return A==0&&(A=(h*x+g/2)/g),x==0&&(x=(g*A+h/2)/h),0>=A||0>=x?0:(b[0]=A,w[0]=x,1)}function ke(h,g){return h+(1<<g)-1>>>g}function We(h,g){return((4278255360&h)+(4278255360&g)>>>0&4278255360)+((16711935&h)+(16711935&g)>>>0&16711935)>>>0}function Ne(h,g){D[g]=function(b,w,A,x,L,M,B){var q;for(q=0;q<L;++q){var K=D[h](M[B+q-1],A,x+q);M[B+q]=We(b[w+q],K)}}}function pt(){this.ud=this.hd=this.jd=0}function Ke(h,g){return((4278124286&(h^g))>>>1)+(h&g)>>>0}function It(h){return 0<=h&&256>h?h:0>h?0:255<h?255:void 0}function at(h,g){return It(h+(h-g+.5>>1))}function lt(h,g,b){return Math.abs(g-b)-Math.abs(h-b)}function Dt(h,g,b,w,A,x,L){for(w=x[L-1],b=0;b<A;++b)x[L+b]=w=We(h[g+b],w)}function gt(h,g,b,w,A){var x;for(x=0;x<b;++x){var L=h[g+x],M=L>>8&255,B=16711935&(B=(B=16711935&L)+((M<<16)+M));w[A+x]=(4278255360&L)+B>>>0}}function Je(h,g){g.jd=255&h,g.hd=h>>8&255,g.ud=h>>16&255}function Ze(h,g,b,w,A,x){var L;for(L=0;L<w;++L){var M=g[b+L],B=M>>>8,q=M,K=255&(K=(K=M>>>16)+((h.jd<<24>>24)*(B<<24>>24)>>>5));q=255&(q=(q+=(h.hd<<24>>24)*(B<<24>>24)>>>5)+((h.ud<<24>>24)*(K<<24>>24)>>>5)),A[x+L]=(4278255360&M)+(K<<16)+q}}function Ye(h,g,b,w,A){D[g]=function(x,L,M,B,q,K,se,U,X){for(B=se;B<U;++B)for(se=0;se<X;++se)q[K++]=A(M[w(x[L++])])},D[h]=function(x,L,M,B,q,K,se){var U=8>>x.b,X=x.Ea,re=x.K[0],pe=x.w;if(8>U)for(x=(1<<x.b)-1,pe=(1<<U)-1;L<M;++L){var oe,me=0;for(oe=0;oe<X;++oe)oe&x||(me=w(B[q++])),K[se++]=A(re[me&pe]),me>>=U}else D["VP8LMapColor"+b](B,q,re,pe,K,se,L,M,X)}}function Ht(h,g,b,w,A){for(b=g+b;g<b;){var x=h[g++];w[A++]=x>>16&255,w[A++]=x>>8&255,w[A++]=255&x}}function kt(h,g,b,w,A){for(b=g+b;g<b;){var x=h[g++];w[A++]=x>>16&255,w[A++]=x>>8&255,w[A++]=255&x,w[A++]=x>>24&255}}function Ve(h,g,b,w,A){for(b=g+b;g<b;){var x=(L=h[g++])>>16&240|L>>12&15,L=240&L|L>>28&15;w[A++]=x,w[A++]=L}}function ct(h,g,b,w,A){for(b=g+b;g<b;){var x=(L=h[g++])>>16&248|L>>13&7,L=L>>5&224|L>>3&31;w[A++]=x,w[A++]=L}}function Ft(h,g,b,w,A){for(b=g+b;g<b;){var x=h[g++];w[A++]=255&x,w[A++]=x>>8&255,w[A++]=x>>16&255}}function Qe(h,g,b,w,A,x){if(x==0)for(b=g+b;g<b;)Ie(w,((x=h[g++])[0]>>24|x[1]>>8&65280|x[2]<<8&16711680|x[3]<<24)>>>0),A+=32;else i(w,A,h,g,b)}function _t(h,g){D[g][0]=D[h+"0"],D[g][1]=D[h+"1"],D[g][2]=D[h+"2"],D[g][3]=D[h+"3"],D[g][4]=D[h+"4"],D[g][5]=D[h+"5"],D[g][6]=D[h+"6"],D[g][7]=D[h+"7"],D[g][8]=D[h+"8"],D[g][9]=D[h+"9"],D[g][10]=D[h+"10"],D[g][11]=D[h+"11"],D[g][12]=D[h+"12"],D[g][13]=D[h+"13"],D[g][14]=D[h+"0"],D[g][15]=D[h+"0"]}function ut(h){return h==eu||h==tu||h==gl||h==nu}function nn(){this.eb=[],this.size=this.A=this.fb=0}function mn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function qt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new nn,this.f.kb=new mn,this.sd=null}function nt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Lt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function to(h){return alert("todo:WebPSamplerProcessPlane"),h.T}function Mn(h,g){var b=h.T,w=g.ba.f.RGBA,A=w.eb,x=w.fb+h.ka*w.A,L=yi[g.ba.S],M=h.y,B=h.O,q=h.f,K=h.N,se=h.ea,U=h.W,X=g.cc,re=g.dc,pe=g.Mc,oe=g.Nc,me=h.ka,be=h.ka+h.T,Te=h.U,Se=Te+1>>1;for(me==0?L(M,B,null,null,q,K,se,U,q,K,se,U,A,x,null,null,Te):(L(g.ec,g.fc,M,B,X,re,pe,oe,q,K,se,U,A,x-w.A,A,x,Te),++b);me+2<be;me+=2)X=q,re=K,pe=se,oe=U,K+=h.Rc,U+=h.Rc,x+=2*w.A,L(M,(B+=2*h.fa)-h.fa,M,B,X,re,pe,oe,q,K,se,U,A,x-w.A,A,x,Te);return B+=h.fa,h.j+be<h.o?(i(g.ec,g.fc,M,B,Te),i(g.cc,g.dc,q,K,Se),i(g.Mc,g.Nc,se,U,Se),b--):1&be||L(M,B,null,null,q,K,se,U,q,K,se,U,A,x+w.A,null,null,Te),b}function tr(h,g,b){var w=h.F,A=[h.J];if(w!=null){var x=h.U,L=g.ba.S,M=L==pl||L==gl;g=g.ba.f.RGBA;var B=[0],q=h.ka;B[0]=h.T,h.Kb&&(q==0?--B[0]:(--q,A[0]-=h.width),h.j+h.ka+h.T==h.o&&(B[0]=h.o-h.j-q));var K=g.eb;q=g.fb+q*g.A,h=$f(w,A[0],h.width,x,B,K,q+(M?0:3),g.A),e(b==B),h&&ut(L)&&ua(K,q,M,x,B,g.A)}return 0}function Oi(h){var g=h.ma,b=g.ba.S,w=11>b,A=b==fl||b==hl||b==pl||b==Zc||b==12||ut(b);if(g.memory=null,g.Ib=null,g.Jb=null,g.Nd=null,!na(g.Oa,h,A?11:12))return 0;if(A&&ut(b)&&sl(),h.da)alert("todo:use_scaling");else{if(w){if(g.Ib=to,h.Kb){if(b=h.U+1>>1,g.memory=o(h.U+2*b),g.memory==null)return 0;g.ec=g.memory,g.fc=0,g.cc=g.ec,g.dc=g.fc+h.U,g.Mc=g.cc,g.Nc=g.dc+b,g.Ib=Mn,sl()}}else alert("todo:EmitYUV");A&&(g.Jb=tr,w&&pi())}if(w&&!nh){for(h=0;256>h;++h)p1[h]=89858*(h-128)+vl>>ml,v1[h]=-22014*(h-128)+vl,m1[h]=-45773*(h-128),g1[h]=113618*(h-128)+vl>>ml;for(h=fa;h<ou;++h)g=76283*(h-16)+vl>>ml,y1[h-fa]=Xt(g,255),b1[h-fa]=Xt(g+8>>4,15);nh=1}return 1}function Xe(h){var g=h.ma,b=h.U,w=h.T;return e(!(1&h.ka)),0>=b||0>=w?0:(b=g.Ib(h,g),g.Jb!=null&&g.Jb(h,g,b),g.Dc+=b,1)}function nr(h){h.ma.memory=null}function ir(h,g,b,w){return _e(h,8)!=47?0:(g[0]=_e(h,14)+1,b[0]=_e(h,14)+1,w[0]=_e(h,1),_e(h,3)!=0?0:!h.h)}function ui(h,g){if(4>h)return h+1;var b=h-2>>1;return(2+(1&h)<<b)+_e(g,b)+1}function di(h,g){return 120<g?g-120:1<=(b=((b=e1[g-1])>>4)*h+(8-(15&b)))?b:1;var b}function Qt(h,g,b){var w=V(b),A=h[g+=255&w].g-8;return 0<A&&(ne(b,b.u+8),w=V(b),g+=h[g].value,g+=w&(1<<A)-1),ne(b,b.u+h[g].g),h[g].value}function Cn(h,g,b){return b.g+=h.g,b.value+=h.value<<g>>>0,e(8>=b.g),h.g}function kn(h,g,b){var w=h.xc;return e((g=w==0?0:h.vc[h.md*(b>>w)+(g>>w)])<h.Wb),h.Ya[g]}function no(h,g,b,w){var A=h.ab,x=h.c*g,L=h.C;g=L+g;var M=b,B=w;for(w=h.Ta,b=h.Ua;0<A--;){var q=h.gc[A],K=L,se=g,U=M,X=B,re=(B=w,M=b,q.Ea);switch(e(K<se),e(se<=q.nc),q.hc){case 2:on(U,X,(se-K)*re,B,M);break;case 0:var pe=K,oe=se,me=B,be=M,Te=(Ue=q).Ea;pe==0&&(ra(U,X,null,null,1,me,be),Dt(U,X+1,0,0,Te-1,me,be+1),X+=Te,be+=Te,++pe);for(var Se=1<<Ue.b,Ge=Se-1,Be=ke(Te,Ue.b),mt=Ue.K,Ue=Ue.w+(pe>>Ue.b)*Be;pe<oe;){var Ct=mt,bn=Ue,vt=1;for(ts(U,X,me,be-Te,1,me,be);vt<Te;){var $e=(vt&~Ge)+Se;$e>Te&&($e=Te),(0,sa[Ct[bn++]>>8&15])(U,X+ +vt,me,be+vt-Te,$e-vt,me,be+vt),vt=$e}X+=Te,be+=Te,++pe&Ge||(Ue+=Be)}se!=q.nc&&i(B,M-re,B,M+(se-K-1)*re,re);break;case 1:for(re=U,oe=X,Te=(U=q.Ea)-(be=U&~(me=(X=1<<q.b)-1)),pe=ke(U,q.b),Se=q.K,q=q.w+(K>>q.b)*pe;K<se;){for(Ge=Se,Be=q,mt=new pt,Ue=oe+be,Ct=oe+U;oe<Ue;)Je(Ge[Be++],mt),aa(mt,re,oe,X,B,M),oe+=X,M+=X;oe<Ct&&(Je(Ge[Be++],mt),aa(mt,re,oe,Te,B,M),oe+=Te,M+=Te),++K&me||(q+=pe)}break;case 3:if(U==B&&X==M&&0<q.b){for(oe=B,U=re=M+(se-K)*re-(be=(se-K)*ke(q.Ea,q.b)),X=B,me=M,pe=[],be=(Te=be)-1;0<=be;--be)pe[be]=X[me+be];for(be=Te-1;0<=be;--be)oe[U+be]=pe[be];ll(q,K,se,B,re,B,M)}else ll(q,K,se,U,X,B,M)}M=w,B=b}B!=b&&i(w,b,M,B,x)}function Cr(h,g){var b=h.V,w=h.Ba+h.c*h.C,A=g-h.C;if(e(g<=h.l.o),e(16>=A),0<A){var x=h.l,L=h.Ta,M=h.Ua,B=x.width;if(no(h,A,b,w),A=M=[M],e((b=h.C)<(w=g)),e(x.v<x.va),w>x.o&&(w=x.o),b<x.j){var q=x.j-b;b=x.j,A[0]+=q*B}if(b>=w?b=0:(A[0]+=4*x.v,x.ka=b-x.j,x.U=x.va-x.v,x.T=w-b,b=1),b){if(M=M[0],11>(b=h.ca).S){var K=b.f.RGBA,se=(w=b.S,A=x.U,x=x.T,q=K.eb,K.A),U=x;for(K=K.fb+h.Ma*K.A;0<U--;){var X=L,re=M,pe=A,oe=q,me=K;switch(w){case dl:la(X,re,pe,oe,me);break;case fl:Lr(X,re,pe,oe,me);break;case eu:Lr(X,re,pe,oe,me),ua(oe,me,0,pe,1,0);break;case Jf:Co(X,re,pe,oe,me);break;case hl:Qe(X,re,pe,oe,me,1);break;case tu:Qe(X,re,pe,oe,me,1),ua(oe,me,0,pe,1,0);break;case pl:Qe(X,re,pe,oe,me,0);break;case gl:Qe(X,re,pe,oe,me,0),ua(oe,me,1,pe,1,0);break;case Zc:Pr(X,re,pe,oe,me);break;case nu:Pr(X,re,pe,oe,me),Uf(oe,me,pe,1,0);break;case Yf:Nr(X,re,pe,oe,me);break;default:e(0)}M+=B,K+=se}h.Ma+=x}else alert("todo:EmitRescaledRowsYUVA");e(h.Ma<=b.height)}}h.C=g,e(h.C<=h.i)}function Ti(h){var g;if(0<h.ua)return 0;for(g=0;g<h.Wb;++g){var b=h.Ya[g].G,w=h.Ya[g].H;if(0<b[1][w[1]+0].g||0<b[2][w[2]+0].g||0<b[3][w[3]+0].g)return 0}return 1}function Hi(h,g,b,w,A,x){if(h.Z!=0){var L=h.qd,M=h.rd;for(e(Br[h.Z]!=null);g<b;++g)Br[h.Z](L,M,w,A,w,A,x),L=w,M=A,A+=x;h.qd=L,h.rd=M}}function Ai(h,g){var b=h.l.ma,w=b.Z==0||b.Z==1?h.l.j:h.C;if(w=h.C<w?w:h.C,e(g<=h.l.o),g>w){var A=h.l.width,x=b.ca,L=b.tb+A*w,M=h.V,B=h.Ba+h.c*w,q=h.gc;e(h.ab==1),e(q[0].hc==3),zi(q[0],w,g,M,B,x,L),Hi(b,w,g,x,L,A)}h.C=h.Ma=g}function Ii(h,g,b,w,A,x,L){var M=h.$/w,B=h.$%w,q=h.m,K=h.s,se=b+h.$,U=se;A=b+w*A;var X=b+w*x,re=280+K.ua,pe=h.Pb?M:16777216,oe=0<K.ua?K.Wa:null,me=K.wc,be=se<X?kn(K,B,M):null;e(h.C<x),e(X<=A);var Te=!1;e:for(;;){for(;Te||se<X;){var Se=0;if(M>=pe){var Ge=se-b;e((pe=h).Pb),pe.wd=pe.m,pe.xd=Ge,0<pe.s.ua&&St(pe.s.Wa,pe.s.vb),pe=M+n1}if(B&me||(be=kn(K,B,M)),e(be!=null),be.Qb&&(g[se]=be.qb,Te=!0),!Te)if(le(q),be.jc){Se=q,Ge=g;var Be=se,mt=be.pd[V(Se)&_o-1];e(be.jc),256>mt.g?(ne(Se,Se.u+mt.g),Ge[Be]=mt.value,Se=0):(ne(Se,Se.u+mt.g-256),e(256<=mt.value),Se=mt.value),Se==0&&(Te=!0)}else Se=Qt(be.G[0],be.H[0],q);if(q.h)break;if(Te||256>Se){if(!Te)if(be.nd)g[se]=(be.qb|Se<<8)>>>0;else{if(le(q),Te=Qt(be.G[1],be.H[1],q),le(q),Ge=Qt(be.G[2],be.H[2],q),Be=Qt(be.G[3],be.H[3],q),q.h)break;g[se]=(Be<<24|Te<<16|Se<<8|Ge)>>>0}if(Te=!1,++se,++B>=w&&(B=0,++M,L!=null&&M<=x&&!(M%16)&&L(h,M),oe!=null))for(;U<se;)Se=g[U++],oe.X[(506832829*Se&4294967295)>>>oe.Mb]=Se}else if(280>Se){if(Se=ui(Se-256,q),Ge=Qt(be.G[4],be.H[4],q),le(q),Ge=di(w,Ge=ui(Ge,q)),q.h)break;if(se-b<Ge||A-se<Se)break e;for(Be=0;Be<Se;++Be)g[se+Be]=g[se+Be-Ge];for(se+=Se,B+=Se;B>=w;)B-=w,++M,L!=null&&M<=x&&!(M%16)&&L(h,M);if(e(se<=A),B&me&&(be=kn(K,B,M)),oe!=null)for(;U<se;)Se=g[U++],oe.X[(506832829*Se&4294967295)>>>oe.Mb]=Se}else{if(!(Se<re))break e;for(Te=Se-280,e(oe!=null);U<se;)Se=g[U++],oe.X[(506832829*Se&4294967295)>>>oe.Mb]=Se;Se=se,e(!(Te>>>(Ge=oe).Xa)),g[Se]=Ge.X[Te],Te=!0}Te||e(q.h==Q(q))}if(h.Pb&&q.h&&se<A)e(h.m.h),h.a=5,h.m=h.wd,h.$=h.xd,0<h.s.ua&&St(h.s.vb,h.s.Wa);else{if(q.h)break e;L!=null&&L(h,M>x?x:M),h.a=0,h.$=se-b}return 1}return h.a=3,0}function fi(h){e(h!=null),h.vc=null,h.yc=null,h.Ya=null;var g=h.Wa;g!=null&&(g.X=null),h.vb=null,e(h!=null)}function io(){var h=new He;return h==null?null:(h.a=0,h.xb=Qf,_t("Predictor","VP8LPredictors"),_t("Predictor","VP8LPredictors_C"),_t("PredictorAdd","VP8LPredictorsAdd"),_t("PredictorAdd","VP8LPredictorsAdd_C"),on=gt,aa=Ze,la=Ht,Lr=kt,Pr=Ve,Nr=ct,Co=Ft,D.VP8LMapColor32b=Wi,D.VP8LMapColor8b=oa,h)}function Vi(h,g,b,w,A){var x=1,L=[h],M=[g],B=w.m,q=w.s,K=null,se=0;e:for(;;){if(b)for(;x&&_e(B,1);){var U=L,X=M,re=w,pe=1,oe=re.m,me=re.gc[re.ab],be=_e(oe,2);if(re.Oc&1<<be)x=0;else{switch(re.Oc|=1<<be,me.hc=be,me.Ea=U[0],me.nc=X[0],me.K=[null],++re.ab,e(4>=re.ab),be){case 0:case 1:me.b=_e(oe,3)+2,pe=Vi(ke(me.Ea,me.b),ke(me.nc,me.b),0,re,me.K),me.K=me.K[0];break;case 3:var Te,Se=_e(oe,8)+1,Ge=16<Se?0:4<Se?1:2<Se?2:3;if(U[0]=ke(me.Ea,Ge),me.b=Ge,Te=pe=Vi(Se,1,0,re,me.K)){var Be,mt=Se,Ue=me,Ct=1<<(8>>Ue.b),bn=o(Ct);if(bn==null)Te=0;else{var vt=Ue.K[0],$e=Ue.w;for(bn[0]=Ue.K[0][0],Be=1;Be<1*mt;++Be)bn[Be]=We(vt[$e+Be],bn[Be-1]);for(;Be<4*Ct;++Be)bn[Be]=0;Ue.K[0]=null,Ue.K[0]=bn,Te=1}}pe=Te;break;case 2:break;default:e(0)}x=pe}}if(L=L[0],M=M[0],x&&_e(B,1)&&!(x=1<=(se=_e(B,4))&&11>=se)){w.a=3;break e}var Pe;if(Pe=x)t:{var an,dt,Et,zt=w,Ln=L,Hn=M,Zt=se,Dn=b,Vn=zt.m,wn=zt.s,Tt=[null],Nt=1,en=0,Rt=t1[Zt];n:for(;;){if(Dn&&_e(Vn,1)){var Pn=_e(Vn,3)+2,Li=ke(Ln,Pn),ln=ke(Hn,Pn),Jn=Li*ln;if(!Vi(Li,ln,0,zt,Tt))break n;for(Tt=Tt[0],wn.xc=Pn,an=0;an<Jn;++an){var $t=Tt[an]>>8&65535;Tt[an]=$t,$t>=Nt&&(Nt=$t+1)}}if(Vn.h)break n;for(dt=0;5>dt;++dt){var Sn=Kf[dt];!dt&&0<Zt&&(Sn+=1<<Zt),en<Sn&&(en=Sn)}var ni=s(Nt*Rt,J),Gn=Nt,ii=s(Gn,ce);if(ii==null)var ri=null;else e(65536>=Gn),ri=ii;var Yn=o(en);if(ri==null||Yn==null||ni==null){zt.a=1;break n}var oi=ni;for(an=Et=0;an<Nt;++an){var Gt=ri[an],si=Gt.G,Pi=Gt.H,To=0,hr=1,Nn=0;for(dt=0;5>dt;++dt){Sn=Kf[dt],si[dt]=oi,Pi[dt]=Et,!dt&&0<Zt&&(Sn+=1<<Zt);r:{var bl,su=Sn,wl=zt,ha=Yn,_1=oi,C1=Et,au=0,Dr=wl.m,E1=_e(Dr,1);if(r(ha,0,0,su),E1){var T1=_e(Dr,1)+1,A1=_e(Dr,1),oh=_e(Dr,A1==0?1:8);ha[oh]=1,T1==2&&(ha[oh=_e(Dr,8)]=1);var Sl=1}else{var sh=o(19),ah=_e(Dr,4)+4;if(19<ah){wl.a=3;var _l=0;break r}for(bl=0;bl<ah;++bl)sh[Z0[bl]]=_e(Dr,3);var lu=void 0,pa=void 0,lh=wl,I1=sh,Cl=su,ch=ha,cu=0,Fr=lh.m,uh=8,dh=s(128,J);i:for(;F(dh,0,7,I1,19);){if(_e(Fr,1)){var k1=2+2*_e(Fr,3);if((lu=2+_e(Fr,k1))>Cl)break i}else lu=Cl;for(pa=0;pa<Cl&&lu--;){le(Fr);var fh=dh[0+(127&V(Fr))];ne(Fr,Fr.u+fh.g);var is=fh.value;if(16>is)ch[pa++]=is,is!=0&&(uh=is);else{var x1=is==16,hh=is-16,L1=Q0[hh],ph=_e(Fr,j0[hh])+L1;if(pa+ph>Cl)break i;for(var P1=x1?uh:0;0<ph--;)ch[pa++]=P1}}cu=1;break i}cu||(lh.a=3),Sl=cu}(Sl=Sl&&!Dr.h)&&(au=F(_1,C1,8,ha,su)),Sl&&au!=0?_l=au:(wl.a=3,_l=0)}if(_l==0)break n;if(hr&&X0[dt]==1&&(hr=oi[Et].g==0),To+=oi[Et].g,Et+=_l,3>=dt){var ga,uu=Yn[0];for(ga=1;ga<Sn;++ga)Yn[ga]>uu&&(uu=Yn[ga]);Nn+=uu}}if(Gt.nd=hr,Gt.Qb=0,hr&&(Gt.qb=(si[3][Pi[3]+0].value<<24|si[1][Pi[1]+0].value<<16|si[2][Pi[2]+0].value)>>>0,To==0&&256>si[0][Pi[0]+0].value&&(Gt.Qb=1,Gt.qb+=si[0][Pi[0]+0].value<<8)),Gt.jc=!Gt.Qb&&6>Nn,Gt.jc){var El,pr=Gt;for(El=0;El<_o;++El){var qr=El,Ur=pr.pd[qr],Tl=pr.G[0][pr.H[0]+qr];256<=Tl.value?(Ur.g=Tl.g+256,Ur.value=Tl.value):(Ur.g=0,Ur.value=0,qr>>=Cn(Tl,8,Ur),qr>>=Cn(pr.G[1][pr.H[1]+qr],16,Ur),qr>>=Cn(pr.G[2][pr.H[2]+qr],0,Ur),Cn(pr.G[3][pr.H[3]+qr],24,Ur))}}}wn.vc=Tt,wn.Wb=Nt,wn.Ya=ri,wn.yc=ni,Pe=1;break t}Pe=0}if(!(x=Pe)){w.a=3;break e}if(0<se){if(q.ua=1<<se,!H(q.Wa,se)){w.a=1,x=0;break e}}else q.ua=0;var du=w,gh=L,N1=M,fu=du.s,hu=fu.xc;if(du.c=gh,du.i=N1,fu.md=ke(gh,hu),fu.wc=hu==0?-1:(1<<hu)-1,b){w.xb=c1;break e}if((K=o(L*M))==null){w.a=1,x=0;break e}x=(x=Ii(w,K,0,L,M,M,null))&&!B.h;break e}return x?(A!=null?A[0]=K:(e(K==null),e(b)),w.$=0,b||fi(q)):fi(q),x}function ro(h,g){var b=h.c*h.i,w=b+g+16*g;return e(h.c<=g),h.V=o(w),h.V==null?(h.Ta=null,h.Ua=0,h.a=1,0):(h.Ta=h.V,h.Ua=h.Ba+b+g,1)}function Wo(h,g){var b=h.C,w=g-b,A=h.V,x=h.Ba+h.c*b;for(e(g<=h.l.o);0<w;){var L=16<w?16:w,M=h.l.ma,B=h.l.width,q=B*L,K=M.ca,se=M.tb+B*b,U=h.Ta,X=h.Ua;no(h,L,A,x),Of(U,X,K,se,q),Hi(M,b,b+L,K,se,B),w-=L,A+=L*h.c,b+=L}e(b==g),h.C=h.Ma=g}function zo(){this.ub=this.yd=this.td=this.Rb=0}function Jo(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Dc(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function Hs(){this.Yb=(function(){var h=[];return(function g(b,w,A){for(var x=A[w],L=0;L<x&&(b.push(A.length>w+1?[]:0),!(A.length<w+1));L++)g(b[L],w+1,A)})(h,0,[3,11]),h})()}function Wa(){this.jb=o(3),this.Wc=a([4,8],Hs),this.Xc=a([4,17],Hs)}function za(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function hi(){this.ld=this.La=this.dd=this.tc=0}function Vs(){this.Na=this.la=0}function Ja(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Gs(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ya(){this.uc=this.M=this.Nb=0,this.wa=Array(new hi),this.Y=0,this.ya=Array(new Gs),this.aa=0,this.l=new Yo}function Ka(){this.y=o(16),this.f=o(8),this.ea=o(8)}function ja(){this.cb=this.a=0,this.sc="",this.m=new R,this.Od=new zo,this.Kc=new Jo,this.ed=new za,this.Qa=new Dc,this.Ic=this.$c=this.Aa=0,this.D=new Ya,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,R),this.ia=0,this.pb=s(4,Ja),this.Pa=new Wa,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ka),this.Hd=0,this.rb=Array(new Vs),this.sb=0,this.wa=Array(new hi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Gs),this.L=this.aa=0,this.gd=a([4,2],hi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Yo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Fc(){var h=new ja;return h!=null&&(h.a=0,h.sc="OK",h.cb=0,h.Xb=0,da||(da=rr)),h}function fn(h,g,b){return h.a==0&&(h.a=g,h.sc=b,h.cb=0),0}function Qa(h,g,b){return 3<=b&&h[g+0]==157&&h[g+1]==1&&h[g+2]==42}function Xa(h,g){if(h==null)return 0;if(h.a=0,h.sc="OK",g==null)return fn(h,2,"null VP8Io passed to VP8GetHeaders()");var b=g.data,w=g.w,A=g.ha;if(4>A)return fn(h,7,"Truncated header.");var x=b[w+0]|b[w+1]<<8|b[w+2]<<16,L=h.Od;if(L.Rb=!(1&x),L.td=x>>1&7,L.yd=x>>4&1,L.ub=x>>5,3<L.td)return fn(h,3,"Incorrect keyframe parameters.");if(!L.yd)return fn(h,4,"Frame not displayable.");w+=3,A-=3;var M=h.Kc;if(L.Rb){if(7>A)return fn(h,7,"cannot parse picture header");if(!Qa(b,w,A))return fn(h,3,"Bad code word");M.c=16383&(b[w+4]<<8|b[w+3]),M.Td=b[w+4]>>6,M.i=16383&(b[w+6]<<8|b[w+5]),M.Ud=b[w+6]>>6,w+=7,A-=7,h.za=M.c+15>>4,h.Ub=M.i+15>>4,g.width=M.c,g.height=M.i,g.Da=0,g.j=0,g.v=0,g.va=g.width,g.o=g.height,g.da=0,g.ib=g.width,g.hb=g.height,g.U=g.width,g.T=g.height,r((x=h.Pa).jb,0,255,x.jb.length),e((x=h.Qa)!=null),x.Cb=0,x.Bb=0,x.Fb=1,r(x.Zb,0,0,x.Zb.length),r(x.Lb,0,0,x.Lb)}if(L.ub>A)return fn(h,7,"bad partition length");fe(x=h.m,b,w,L.ub),w+=L.ub,A-=L.ub,L.Rb&&(M.Ld=ue(x),M.Kd=ue(x)),M=h.Qa;var B,q=h.Pa;if(e(x!=null),e(M!=null),M.Cb=ue(x),M.Cb){if(M.Bb=ue(x),ue(x)){for(M.Fb=ue(x),B=0;4>B;++B)M.Zb[B]=ue(x)?ae(x,7):0;for(B=0;4>B;++B)M.Lb[B]=ue(x)?ae(x,6):0}if(M.Bb)for(B=0;3>B;++B)q.jb[B]=ue(x)?ge(x,8):255}else M.Bb=0;if(x.Ka)return fn(h,3,"cannot parse segment header");if((M=h.ed).zd=ue(x),M.Tb=ge(x,6),M.wb=ge(x,3),M.Pc=ue(x),M.Pc&&ue(x)){for(q=0;4>q;++q)ue(x)&&(M.vd[q]=ae(x,6));for(q=0;4>q;++q)ue(x)&&(M.od[q]=ae(x,6))}if(h.L=M.Tb==0?0:M.zd?1:2,x.Ka)return fn(h,3,"cannot parse filter header");var K=A;if(A=B=w,w=B+K,M=K,h.Xb=(1<<ge(h.m,2))-1,K<3*(q=h.Xb))b=7;else{for(B+=3*q,M-=3*q,K=0;K<q;++K){var se=b[A+0]|b[A+1]<<8|b[A+2]<<16;se>M&&(se=M),fe(h.Jc[+K],b,B,se),B+=se,M-=se,A+=3}fe(h.Jc[+q],b,B,M),b=B<w?0:5}if(b!=0)return fn(h,b,"cannot parse partitions");for(b=ge(B=h.m,7),A=ue(B)?ae(B,4):0,w=ue(B)?ae(B,4):0,M=ue(B)?ae(B,4):0,q=ue(B)?ae(B,4):0,B=ue(B)?ae(B,4):0,K=h.Qa,se=0;4>se;++se){if(K.Cb){var U=K.Zb[se];K.Fb||(U+=b)}else{if(0<se){h.pb[se]=h.pb[0];continue}U=b}var X=h.pb[se];X.Sc[0]=iu[Xt(U+A,127)],X.Sc[1]=ru[Xt(U+0,127)],X.Eb[0]=2*iu[Xt(U+w,127)],X.Eb[1]=101581*ru[Xt(U+M,127)]>>16,8>X.Eb[1]&&(X.Eb[1]=8),X.Qc[0]=iu[Xt(U+q,117)],X.Qc[1]=ru[Xt(U+B,127)],X.lc=U+B}if(!L.Rb)return fn(h,4,"Not a key frame.");for(ue(x),L=h.Pa,b=0;4>b;++b){for(A=0;8>A;++A)for(w=0;3>w;++w)for(M=0;11>M;++M)q=we(x,a1[b][A][w][M])?ge(x,8):o1[b][A][w][M],L.Wc[b][A].Yb[w][M]=q;for(A=0;17>A;++A)L.Xc[b][A]=L.Wc[b][l1[A]]}return h.kc=ue(x),h.kc&&(h.Bd=ge(x,8)),h.cb=1}function rr(h,g,b,w,A,x,L){var M=g[A].Yb[b];for(b=0;16>A;++A){if(!we(h,M[b+0]))return A;for(;!we(h,M[b+1]);)if(M=g[++A].Yb[0],b=0,A==16)return 16;var B=g[A+1].Yb;if(we(h,M[b+2])){var q=h,K=0;if(we(q,(U=M)[(se=b)+3]))if(we(q,U[se+6])){for(M=0,se=2*(K=we(q,U[se+8]))+(U=we(q,U[se+9+K])),K=0,U=i1[se];U[M];++M)K+=K+we(q,U[M]);K+=3+(8<<se)}else we(q,U[se+7])?(K=7+2*we(q,165),K+=we(q,145)):K=5+we(q,159);else K=we(q,U[se+4])?3+we(q,U[se+5]):2;M=B[2]}else K=1,M=B[1];B=L+r1[A],0>(q=h).b&&de(q);var se,U=q.b,X=(se=q.Ca>>1)-(q.I>>U)>>31;--q.b,q.Ca+=X,q.Ca|=1,q.I-=(se+1&X)<<U,x[B]=((K^X)-X)*w[(0<A)+0]}return 16}function oo(h){var g=h.rb[h.sb-1];g.la=0,g.Na=0,r(h.zc,0,0,h.zc.length),h.ja=0}function ki(h,g,b,w,A){A=h[g+b+32*w]+(A>>3),h[g+b+32*w]=-256&A?0>A?0:255:A}function so(h,g,b,w,A,x){ki(h,g,0,b,w+A),ki(h,g,1,b,w+x),ki(h,g,2,b,w-x),ki(h,g,3,b,w-A)}function rn(h){return(20091*h>>16)+h}function Ws(h,g,b,w){var A,x=0,L=o(16);for(A=0;4>A;++A){var M=h[g+0]+h[g+8],B=h[g+0]-h[g+8],q=(35468*h[g+4]>>16)-rn(h[g+12]),K=rn(h[g+4])+(35468*h[g+12]>>16);L[x+0]=M+K,L[x+1]=B+q,L[x+2]=B-q,L[x+3]=M-K,x+=4,g++}for(A=x=0;4>A;++A)M=(h=L[x+0]+4)+L[x+8],B=h-L[x+8],q=(35468*L[x+4]>>16)-rn(L[x+12]),ki(b,w,0,0,M+(K=rn(L[x+4])+(35468*L[x+12]>>16))),ki(b,w,1,0,B+q),ki(b,w,2,0,B-q),ki(b,w,3,0,M-K),x++,w+=32}function qc(h,g,b,w){var A=h[g+0]+4,x=35468*h[g+4]>>16,L=rn(h[g+4]),M=35468*h[g+1]>>16;so(b,w,0,A+L,h=rn(h[g+1]),M),so(b,w,1,A+x,h,M),so(b,w,2,A-x,h,M),so(b,w,3,A-L,h,M)}function Uc(h,g,b,w,A){Ws(h,g,b,w),A&&Ws(h,g+16,b,w+4)}function $c(h,g,b,w){Eo(h,g+0,b,w,1),Eo(h,g+32,b,w+128,1)}function Gi(h,g,b,w){var A;for(h=h[g+0]+4,A=0;4>A;++A)for(g=0;4>g;++g)ki(b,w,g,A,h)}function Za(h,g,b,w){h[g+0]&&Pt(h,g+0,b,w),h[g+16]&&Pt(h,g+16,b,w+4),h[g+32]&&Pt(h,g+32,b,w+128),h[g+48]&&Pt(h,g+48,b,w+128+4)}function el(h,g,b,w){var A,x=o(16);for(A=0;4>A;++A){var L=h[g+0+A]+h[g+12+A],M=h[g+4+A]+h[g+8+A],B=h[g+4+A]-h[g+8+A],q=h[g+0+A]-h[g+12+A];x[0+A]=L+M,x[8+A]=L-M,x[4+A]=q+B,x[12+A]=q-B}for(A=0;4>A;++A)L=(h=x[0+4*A]+3)+x[3+4*A],M=x[1+4*A]+x[2+4*A],B=x[1+4*A]-x[2+4*A],q=h-x[3+4*A],b[w+0]=L+M>>3,b[w+16]=q+B>>3,b[w+32]=L-M>>3,b[w+48]=q-B>>3,w+=64}function Er(h,g,b){var w,A=g-32,x=ti,L=255-h[A-1];for(w=0;w<b;++w){var M,B=x,q=L+h[g-1];for(M=0;M<b;++M)h[g+M]=B[q+h[A+M]];g+=32}}function zs(h,g){Er(h,g,4)}function Oc(h,g){Er(h,g,8)}function Hc(h,g){Er(h,g,16)}function Vc(h,g){var b;for(b=0;16>b;++b)i(h,g+32*b,h,g-32,16)}function Js(h,g){var b;for(b=16;0<b;--b)r(h,g,h[g-1],16),g+=32}function ao(h,g,b){var w;for(w=0;16>w;++w)r(g,b+32*w,h,16)}function Tr(h,g){var b,w=16;for(b=0;16>b;++b)w+=h[g-1+32*b]+h[g+b-32];ao(w>>5,h,g)}function Gc(h,g){var b,w=8;for(b=0;16>b;++b)w+=h[g-1+32*b];ao(w>>4,h,g)}function lo(h,g){var b,w=8;for(b=0;16>b;++b)w+=h[g+b-32];ao(w>>4,h,g)}function Ys(h,g){ao(128,h,g)}function it(h,g,b){return h+2*g+b+2>>2}function Wc(h,g){var b,w=g-32;for(w=new Uint8Array([it(h[w-1],h[w+0],h[w+1]),it(h[w+0],h[w+1],h[w+2]),it(h[w+1],h[w+2],h[w+3]),it(h[w+2],h[w+3],h[w+4])]),b=0;4>b;++b)i(h,g+32*b,w,0,w.length)}function zc(h,g){var b=h[g-1],w=h[g-1+32],A=h[g-1+64],x=h[g-1+96];Ie(h,g+0,16843009*it(h[g-1-32],b,w)),Ie(h,g+32,16843009*it(b,w,A)),Ie(h,g+64,16843009*it(w,A,x)),Ie(h,g+96,16843009*it(A,x,x))}function Jc(h,g){var b,w=4;for(b=0;4>b;++b)w+=h[g+b-32]+h[g-1+32*b];for(w>>=3,b=0;4>b;++b)r(h,g+32*b,w,4)}function Yc(h,g){var b=h[g-1+0],w=h[g-1+32],A=h[g-1+64],x=h[g-1-32],L=h[g+0-32],M=h[g+1-32],B=h[g+2-32],q=h[g+3-32];h[g+0+96]=it(w,A,h[g-1+96]),h[g+1+96]=h[g+0+64]=it(b,w,A),h[g+2+96]=h[g+1+64]=h[g+0+32]=it(x,b,w),h[g+3+96]=h[g+2+64]=h[g+1+32]=h[g+0+0]=it(L,x,b),h[g+3+64]=h[g+2+32]=h[g+1+0]=it(M,L,x),h[g+3+32]=h[g+2+0]=it(B,M,L),h[g+3+0]=it(q,B,M)}function or(h,g){var b=h[g+1-32],w=h[g+2-32],A=h[g+3-32],x=h[g+4-32],L=h[g+5-32],M=h[g+6-32],B=h[g+7-32];h[g+0+0]=it(h[g+0-32],b,w),h[g+1+0]=h[g+0+32]=it(b,w,A),h[g+2+0]=h[g+1+32]=h[g+0+64]=it(w,A,x),h[g+3+0]=h[g+2+32]=h[g+1+64]=h[g+0+96]=it(A,x,L),h[g+3+32]=h[g+2+64]=h[g+1+96]=it(x,L,M),h[g+3+64]=h[g+2+96]=it(L,M,B),h[g+3+96]=it(M,B,B)}function sr(h,g){var b=h[g-1+0],w=h[g-1+32],A=h[g-1+64],x=h[g-1-32],L=h[g+0-32],M=h[g+1-32],B=h[g+2-32],q=h[g+3-32];h[g+0+0]=h[g+1+64]=x+L+1>>1,h[g+1+0]=h[g+2+64]=L+M+1>>1,h[g+2+0]=h[g+3+64]=M+B+1>>1,h[g+3+0]=B+q+1>>1,h[g+0+96]=it(A,w,b),h[g+0+64]=it(w,b,x),h[g+0+32]=h[g+1+96]=it(b,x,L),h[g+1+32]=h[g+2+96]=it(x,L,M),h[g+2+32]=h[g+3+96]=it(L,M,B),h[g+3+32]=it(M,B,q)}function Kc(h,g){var b=h[g+0-32],w=h[g+1-32],A=h[g+2-32],x=h[g+3-32],L=h[g+4-32],M=h[g+5-32],B=h[g+6-32],q=h[g+7-32];h[g+0+0]=b+w+1>>1,h[g+1+0]=h[g+0+64]=w+A+1>>1,h[g+2+0]=h[g+1+64]=A+x+1>>1,h[g+3+0]=h[g+2+64]=x+L+1>>1,h[g+0+32]=it(b,w,A),h[g+1+32]=h[g+0+96]=it(w,A,x),h[g+2+32]=h[g+1+96]=it(A,x,L),h[g+3+32]=h[g+2+96]=it(x,L,M),h[g+3+64]=it(L,M,B),h[g+3+96]=it(M,B,q)}function jc(h,g){var b=h[g-1+0],w=h[g-1+32],A=h[g-1+64],x=h[g-1+96];h[g+0+0]=b+w+1>>1,h[g+2+0]=h[g+0+32]=w+A+1>>1,h[g+2+32]=h[g+0+64]=A+x+1>>1,h[g+1+0]=it(b,w,A),h[g+3+0]=h[g+1+32]=it(w,A,x),h[g+3+32]=h[g+1+64]=it(A,x,x),h[g+3+64]=h[g+2+64]=h[g+0+96]=h[g+1+96]=h[g+2+96]=h[g+3+96]=x}function Ko(h,g){var b=h[g-1+0],w=h[g-1+32],A=h[g-1+64],x=h[g-1+96],L=h[g-1-32],M=h[g+0-32],B=h[g+1-32],q=h[g+2-32];h[g+0+0]=h[g+2+32]=b+L+1>>1,h[g+0+32]=h[g+2+64]=w+b+1>>1,h[g+0+64]=h[g+2+96]=A+w+1>>1,h[g+0+96]=x+A+1>>1,h[g+3+0]=it(M,B,q),h[g+2+0]=it(L,M,B),h[g+1+0]=h[g+3+32]=it(b,L,M),h[g+1+32]=h[g+3+64]=it(w,b,L),h[g+1+64]=h[g+3+96]=it(A,w,b),h[g+1+96]=it(x,A,w)}function Ks(h,g){var b;for(b=0;8>b;++b)i(h,g+32*b,h,g-32,8)}function co(h,g){var b;for(b=0;8>b;++b)r(h,g,h[g-1],8),g+=32}function jo(h,g,b){var w;for(w=0;8>w;++w)r(g,b+32*w,h,8)}function Qo(h,g){var b,w=8;for(b=0;8>b;++b)w+=h[g+b-32]+h[g-1+32*b];jo(w>>4,h,g)}function Qc(h,g){var b,w=4;for(b=0;8>b;++b)w+=h[g+b-32];jo(w>>3,h,g)}function js(h,g){var b,w=4;for(b=0;8>b;++b)w+=h[g-1+32*b];jo(w>>3,h,g)}function Qs(h,g){jo(128,h,g)}function uo(h,g,b){var w=h[g-b],A=h[g+0],x=3*(A-w)+Xc[1020+h[g-2*b]-h[g+b]],L=ul[112+(x+4>>3)];h[g-b]=ti[255+w+ul[112+(x+3>>3)]],h[g+0]=ti[255+A-L]}function fo(h,g,b,w){var A=h[g+0],x=h[g+b];return vi[255+h[g-2*b]-h[g-b]]>w||vi[255+x-A]>w}function Xs(h,g,b,w){return 4*vi[255+h[g-b]-h[g+0]]+vi[255+h[g-2*b]-h[g+b]]<=w}function Xo(h,g,b,w,A){var x=h[g-3*b],L=h[g-2*b],M=h[g-b],B=h[g+0],q=h[g+b],K=h[g+2*b],se=h[g+3*b];return 4*vi[255+M-B]+vi[255+L-q]>w?0:vi[255+h[g-4*b]-x]<=A&&vi[255+x-L]<=A&&vi[255+L-M]<=A&&vi[255+se-K]<=A&&vi[255+K-q]<=A&&vi[255+q-B]<=A}function Zs(h,g,b,w){var A=2*w+1;for(w=0;16>w;++w)Xs(h,g+w,b,A)&&uo(h,g+w,b)}function ho(h,g,b,w){var A=2*w+1;for(w=0;16>w;++w)Xs(h,g+w*b,1,A)&&uo(h,g+w*b,1)}function tl(h,g,b,w){var A;for(A=3;0<A;--A)Zs(h,g+=4*b,b,w)}function nl(h,g,b,w){var A;for(A=3;0<A;--A)ho(h,g+=4,b,w)}function ar(h,g,b,w,A,x,L,M){for(x=2*x+1;0<A--;){if(Xo(h,g,b,x,L))if(fo(h,g,b,M))uo(h,g,b);else{var B=h,q=g,K=b,se=B[q-2*K],U=B[q-K],X=B[q+0],re=B[q+K],pe=B[q+2*K],oe=27*(be=Xc[1020+3*(X-U)+Xc[1020+se-re]])+63>>7,me=18*be+63>>7,be=9*be+63>>7;B[q-3*K]=ti[255+B[q-3*K]+be],B[q-2*K]=ti[255+se+me],B[q-K]=ti[255+U+oe],B[q+0]=ti[255+X-oe],B[q+K]=ti[255+re-me],B[q+2*K]=ti[255+pe-be]}g+=w}}function lr(h,g,b,w,A,x,L,M){for(x=2*x+1;0<A--;){if(Xo(h,g,b,x,L))if(fo(h,g,b,M))uo(h,g,b);else{var B=h,q=g,K=b,se=B[q-K],U=B[q+0],X=B[q+K],re=ul[112+(4+(pe=3*(U-se))>>3)],pe=ul[112+(pe+3>>3)],oe=re+1>>1;B[q-2*K]=ti[255+B[q-2*K]+oe],B[q-K]=ti[255+se+pe],B[q+0]=ti[255+U-re],B[q+K]=ti[255+X-oe]}g+=w}}function il(h,g,b,w,A,x){ar(h,g,b,1,16,w,A,x)}function rl(h,g,b,w,A,x){ar(h,g,1,b,16,w,A,x)}function po(h,g,b,w,A,x){var L;for(L=3;0<L;--L)lr(h,g+=4*b,b,1,16,w,A,x)}function ol(h,g,b,w,A,x){var L;for(L=3;0<L;--L)lr(h,g+=4,1,b,16,w,A,x)}function y(h,g,b,w,A,x,L,M){ar(h,g,A,1,8,x,L,M),ar(b,w,A,1,8,x,L,M)}function T(h,g,b,w,A,x,L,M){ar(h,g,1,A,8,x,L,M),ar(b,w,1,A,8,x,L,M)}function $(h,g,b,w,A,x,L,M){lr(h,g+4*A,A,1,8,x,L,M),lr(b,w+4*A,A,1,8,x,L,M)}function z(h,g,b,w,A,x,L,M){lr(h,g+4,1,A,8,x,L,M),lr(b,w+4,1,A,8,x,L,M)}function ie(){this.ba=new qt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Lt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ye(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ce(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function qe(){this.ua=0,this.Wa=new ht,this.vb=new ht,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ce,this.yc=new J}function He(){this.xb=this.a=0,this.l=new Yo,this.ca=new qt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new O,this.Pb=0,this.wd=new O,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new qe,this.ab=0,this.gc=s(4,Ce),this.Oc=0}function tt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Yo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ot(h,g,b,w,A,x,L){for(h=h==null?0:h[g+0],g=0;g<L;++g)A[x+g]=h+b[w+g]&255,h=A[x+g]}function xt(h,g,b,w,A,x,L){var M;if(h==null)ot(null,null,b,w,A,x,L);else for(M=0;M<L;++M)A[x+M]=h[g+M]+b[w+M]&255}function jt(h,g,b,w,A,x,L){if(h==null)ot(null,null,b,w,A,x,L);else{var M,B=h[g+0],q=B,K=B;for(M=0;M<L;++M)q=K+(B=h[g+M])-q,K=b[w+M]+(-256&q?0>q?0:255:q)&255,q=B,A[x+M]=K}}function hn(h,g,b,w){var A=g.width,x=g.o;if(e(h!=null&&g!=null),0>b||0>=w||b+w>x)return null;if(!h.Cc){if(h.ga==null){var L;if(h.ga=new tt,(L=h.ga==null)||(L=g.width*g.o,e(h.Gb.length==0),h.Gb=o(L),h.Uc=0,h.Gb==null?L=0:(h.mb=h.Gb,h.nb=h.Uc,h.rc=null,L=1),L=!L),!L){L=h.ga;var M=h.Fa,B=h.P,q=h.qc,K=h.mb,se=h.nb,U=B+1,X=q-1,re=L.l;if(e(M!=null&&K!=null&&g!=null),Br[0]=null,Br[1]=ot,Br[2]=xt,Br[3]=jt,L.ca=K,L.tb=se,L.c=g.width,L.i=g.height,e(0<L.c&&0<L.i),1>=q)g=0;else if(L.$a=3&M[B+0],L.Z=M[B+0]>>2&3,L.Lc=M[B+0]>>4&3,B=M[B+0]>>6&3,0>L.$a||1<L.$a||4<=L.Z||1<L.Lc||B)g=0;else if(re.put=Xe,re.ac=Oi,re.bc=nr,re.ma=L,re.width=g.width,re.height=g.height,re.Da=g.Da,re.v=g.v,re.va=g.va,re.j=g.j,re.o=g.o,L.$a)e:{e(L.$a==1),g=io();t:for(;;){if(g==null){g=0;break e}if(e(L!=null),L.mc=g,g.c=L.c,g.i=L.i,g.l=L.l,g.l.ma=L,g.l.width=L.c,g.l.height=L.i,g.a=0,ve(g.m,M,U,X),!Vi(L.c,L.i,1,g,null)||(g.ab==1&&g.gc[0].hc==3&&Ti(g.s)?(L.ic=1,M=g.c*g.i,g.Ta=null,g.Ua=0,g.V=o(M),g.Ba=0,g.V==null?(g.a=1,g=0):g=1):(L.ic=0,g=ro(g,L.c)),!g))break t;g=1;break e}L.mc=null,g=0}else g=X>=L.c*L.i;L=!g}if(L)return null;h.ga.Lc!=1?h.Ga=0:w=x-b}e(h.ga!=null),e(b+w<=x);e:{if(g=(M=h.ga).c,x=M.l.o,M.$a==0){if(U=h.rc,X=h.Vc,re=h.Fa,B=h.P+1+b*g,q=h.mb,K=h.nb+b*g,e(B<=h.P+h.qc),M.Z!=0)for(e(Br[M.Z]!=null),L=0;L<w;++L)Br[M.Z](U,X,re,B,q,K,g),U=q,X=K,K+=g,B+=g;else for(L=0;L<w;++L)i(q,K,re,B,g),U=q,X=K,K+=g,B+=g;h.rc=U,h.Vc=X}else{if(e(M.mc!=null),g=b+w,e((L=M.mc)!=null),e(g<=L.i),L.C>=g)g=1;else if(M.ic||pi(),M.ic){M=L.V,U=L.Ba,X=L.c;var pe=L.i,oe=(re=1,B=L.$/X,q=L.$%X,K=L.m,se=L.s,L.$),me=X*pe,be=X*g,Te=se.wc,Se=oe<be?kn(se,q,B):null;e(oe<=me),e(g<=pe),e(Ti(se));t:for(;;){for(;!K.h&&oe<be;){if(q&Te||(Se=kn(se,q,B)),e(Se!=null),le(K),256>(pe=Qt(Se.G[0],Se.H[0],K)))M[U+oe]=pe,++oe,++q>=X&&(q=0,++B<=g&&!(B%16)&&Ai(L,B));else{if(!(280>pe)){re=0;break t}pe=ui(pe-256,K);var Ge,Be=Qt(Se.G[4],Se.H[4],K);if(le(K),!(oe>=(Be=di(X,Be=ui(Be,K)))&&me-oe>=pe)){re=0;break t}for(Ge=0;Ge<pe;++Ge)M[U+oe+Ge]=M[U+oe+Ge-Be];for(oe+=pe,q+=pe;q>=X;)q-=X,++B<=g&&!(B%16)&&Ai(L,B);oe<be&&q&Te&&(Se=kn(se,q,B))}e(K.h==Q(K))}Ai(L,B>g?g:B);break t}!re||K.h&&oe<me?(re=0,L.a=K.h?5:3):L.$=oe,g=re}else g=Ii(L,L.V,L.Ba,L.c,L.i,g,Wo);if(!g){w=0;break e}}b+w>=x&&(h.Cc=1),w=1}if(!w)return null;if(h.Cc&&((w=h.ga)!=null&&(w.mc=null),h.ga=null,0<h.Ga))return alert("todo:WebPDequantizeLevels"),null}return h.nb+b*A}function Vt(h,g,b,w,A,x){for(;0<A--;){var L,M=h,B=g+(b?1:0),q=h,K=g+(b?0:3);for(L=0;L<w;++L){var se=q[K+4*L];se!=255&&(se*=32897,M[B+4*L+0]=M[B+4*L+0]*se>>23,M[B+4*L+1]=M[B+4*L+1]*se>>23,M[B+4*L+2]=M[B+4*L+2]*se>>23)}g+=x}}function vn(h,g,b,w,A){for(;0<w--;){var x;for(x=0;x<b;++x){var L=h[g+2*x+0],M=15&(q=h[g+2*x+1]),B=4369*M,q=(240&q|q>>4)*B>>16;h[g+2*x+0]=(240&L|L>>4)*B>>16&240|(15&L|L<<4)*B>>16>>4&15,h[g+2*x+1]=240&q|M}g+=A}}function pn(h,g,b,w,A,x,L,M){var B,q,K=255;for(q=0;q<A;++q){for(B=0;B<w;++B){var se=h[g+B];x[L+4*B]=se,K&=se}g+=b,L+=M}return K!=255}function xn(h,g,b,w,A){var x;for(x=0;x<A;++x)b[w+x]=h[g+x]>>8}function pi(){ua=Vt,Uf=vn,$f=pn,Of=xn}function zn(h,g,b){D[h]=function(w,A,x,L,M,B,q,K,se,U,X,re,pe,oe,me,be,Te){var Se,Ge=Te-1>>1,Be=M[B+0]|q[K+0]<<16,mt=se[U+0]|X[re+0]<<16;e(w!=null);var Ue=3*Be+mt+131074>>2;for(g(w[A+0],255&Ue,Ue>>16,pe,oe),x!=null&&(Ue=3*mt+Be+131074>>2,g(x[L+0],255&Ue,Ue>>16,me,be)),Se=1;Se<=Ge;++Se){var Ct=M[B+Se]|q[K+Se]<<16,bn=se[U+Se]|X[re+Se]<<16,vt=Be+Ct+mt+bn+524296,$e=vt+2*(Ct+mt)>>3;Ue=$e+Be>>1,Be=(vt=vt+2*(Be+bn)>>3)+Ct>>1,g(w[A+2*Se-1],255&Ue,Ue>>16,pe,oe+(2*Se-1)*b),g(w[A+2*Se-0],255&Be,Be>>16,pe,oe+(2*Se-0)*b),x!=null&&(Ue=vt+mt>>1,Be=$e+bn>>1,g(x[L+2*Se-1],255&Ue,Ue>>16,me,be+(2*Se-1)*b),g(x[L+2*Se+0],255&Be,Be>>16,me,be+(2*Se+0)*b)),Be=Ct,mt=bn}1&Te||(Ue=3*Be+mt+131074>>2,g(w[A+Te-1],255&Ue,Ue>>16,pe,oe+(Te-1)*b),x!=null&&(Ue=3*mt+Be+131074>>2,g(x[L+Te-1],255&Ue,Ue>>16,me,be+(Te-1)*b)))}}function sl(){yi[dl]=u1,yi[fl]=Xf,yi[Jf]=d1,yi[hl]=Zf,yi[pl]=eh,yi[Zc]=th,yi[Yf]=f1,yi[eu]=Xf,yi[tu]=Zf,yi[gl]=eh,yi[nu]=th}function Zo(h){return h&-16384?0>h?0:255:h>>h1}function go(h,g){return Zo((19077*h>>8)+(26149*g>>8)-14234)}function Ar(h,g,b){return Zo((19077*h>>8)-(6419*g>>8)-(13320*b>>8)+8708)}function mo(h,g){return Zo((19077*h>>8)+(33050*g>>8)-17685)}function vo(h,g,b,w,A){w[A+0]=go(h,b),w[A+1]=Ar(h,g,b),w[A+2]=mo(h,g)}function yo(h,g,b,w,A){w[A+0]=mo(h,g),w[A+1]=Ar(h,g,b),w[A+2]=go(h,b)}function Bn(h,g,b,w,A){var x=Ar(h,g,b);g=x<<3&224|mo(h,g)>>3,w[A+0]=248&go(h,b)|x>>5,w[A+1]=g}function bo(h,g,b,w,A){var x=240&mo(h,g)|15;w[A+0]=240&go(h,b)|Ar(h,g,b)>>4,w[A+1]=x}function wo(h,g,b,w,A){w[A+0]=255,vo(h,g,b,w,A+1)}function ea(h,g,b,w,A){yo(h,g,b,w,A),w[A+3]=255}function ta(h,g,b,w,A){vo(h,g,b,w,A),w[A+3]=255}function Xt(h,g){return 0>h?0:h>g?g:h}function cr(h,g,b){D[h]=function(w,A,x,L,M,B,q,K,se){for(var U=K+(-2&se)*b;K!=U;)g(w[A+0],x[L+0],M[B+0],q,K),g(w[A+1],x[L+0],M[B+0],q,K+b),A+=2,++L,++B,K+=2*b;1&se&&g(w[A+0],x[L+0],M[B+0],q,K)}}function es(h,g,b){return b==0?h==0?g==0?6:5:g==0?4:0:b}function al(h,g,b,w,A){switch(h>>>30){case 3:Eo(g,b,w,A,0);break;case 2:mi(g,b,w,A);break;case 1:Pt(g,b,w,A)}}function gi(h,g){var b,w,A=g.M,x=g.Nb,L=h.oc,M=h.pc+40,B=h.oc,q=h.pc+584,K=h.oc,se=h.pc+600;for(b=0;16>b;++b)L[M+32*b-1]=129;for(b=0;8>b;++b)B[q+32*b-1]=129,K[se+32*b-1]=129;for(0<A?L[M-1-32]=B[q-1-32]=K[se-1-32]=129:(r(L,M-32-1,127,21),r(B,q-32-1,127,9),r(K,se-32-1,127,9)),w=0;w<h.za;++w){var U=g.ya[g.aa+w];if(0<w){for(b=-1;16>b;++b)i(L,M+32*b-4,L,M+32*b+12,4);for(b=-1;8>b;++b)i(B,q+32*b-4,B,q+32*b+4,4),i(K,se+32*b-4,K,se+32*b+4,4)}var X=h.Gd,re=h.Hd+w,pe=U.ad,oe=U.Hc;if(0<A&&(i(L,M-32,X[re].y,0,16),i(B,q-32,X[re].f,0,8),i(K,se-32,X[re].ea,0,8)),U.Za){var me=L,be=M-32+16;for(0<A&&(w>=h.za-1?r(me,be,X[re].y[15],4):i(me,be,X[re+1].y,0,4)),b=0;4>b;b++)me[be+128+b]=me[be+256+b]=me[be+384+b]=me[be+0+b];for(b=0;16>b;++b,oe<<=2)me=L,be=M+ih[b],xi[U.Ob[b]](me,be),al(oe,pe,16*+b,me,be)}else if(me=es(w,A,U.Ob[0]),Mr[me](L,M),oe!=0)for(b=0;16>b;++b,oe<<=2)al(oe,pe,16*+b,L,M+ih[b]);for(b=U.Gc,me=es(w,A,U.Dd),fr[me](B,q),fr[me](K,se),oe=pe,me=B,be=q,255&(U=0|b)&&(170&U?Ji(oe,256,me,be):Ut(oe,256,me,be)),U=K,oe=se,255&(b>>=8)&&(170&b?Ji(pe,320,U,oe):Ut(pe,320,U,oe)),A<h.Ub-1&&(i(X[re].y,0,L,M+480,16),i(X[re].f,0,B,q+224,8),i(X[re].ea,0,K,se+224,8)),b=8*x*h.B,X=h.sa,re=h.ta+16*w+16*x*h.R,pe=h.qa,U=h.ra+8*w+b,oe=h.Ha,me=h.Ia+8*w+b,b=0;16>b;++b)i(X,re+b*h.R,L,M+32*b,16);for(b=0;8>b;++b)i(pe,U+b*h.B,B,q+32*b,8),i(oe,me+b*h.B,K,se+32*b,8)}}function So(h,g,b,w,A,x,L,M,B){var q=[0],K=[0],se=0,U=B!=null?B.kd:0,X=B??new ye;if(h==null||12>b)return 7;X.data=h,X.w=g,X.ha=b,g=[g],b=[b],X.gb=[X.gb];e:{var re=g,pe=b,oe=X.gb;if(e(h!=null),e(pe!=null),e(oe!=null),oe[0]=0,12<=pe[0]&&!n(h,re[0],"RIFF")){if(n(h,re[0]+8,"WEBP")){oe=3;break e}var me=he(h,re[0]+4);if(12>me||4294967286<me){oe=3;break e}if(U&&me>pe[0]-8){oe=7;break e}oe[0]=me,re[0]+=12,pe[0]-=12}oe=0}if(oe!=0)return oe;for(me=0<X.gb[0],b=b[0];;){e:{var be=h;pe=g,oe=b;var Te=q,Se=K,Ge=re=[0];if((Ue=se=[se])[0]=0,8>oe[0])oe=7;else{if(!n(be,pe[0],"VP8X")){if(he(be,pe[0]+4)!=10){oe=3;break e}if(18>oe[0]){oe=7;break e}var Be=he(be,pe[0]+8),mt=1+Me(be,pe[0]+12);if(2147483648<=mt*(be=1+Me(be,pe[0]+15))){oe=3;break e}Ge!=null&&(Ge[0]=Be),Te!=null&&(Te[0]=mt),Se!=null&&(Se[0]=be),pe[0]+=18,oe[0]-=18,Ue[0]=1}oe=0}}if(se=se[0],re=re[0],oe!=0)return oe;if(pe=!!(2&re),!me&&se)return 3;if(x!=null&&(x[0]=!!(16&re)),L!=null&&(L[0]=pe),M!=null&&(M[0]=0),L=q[0],re=K[0],se&&pe&&B==null){oe=0;break}if(4>b){oe=7;break}if(me&&se||!me&&!se&&!n(h,g[0],"ALPH")){b=[b],X.na=[X.na],X.P=[X.P],X.Sa=[X.Sa];e:{Be=h,oe=g,me=b;var Ue=X.gb;Te=X.na,Se=X.P,Ge=X.Sa,mt=22,e(Be!=null),e(me!=null),be=oe[0];var Ct=me[0];for(e(Te!=null),e(Ge!=null),Te[0]=null,Se[0]=null,Ge[0]=0;;){if(oe[0]=be,me[0]=Ct,8>Ct){oe=7;break e}var bn=he(Be,be+4);if(4294967286<bn){oe=3;break e}var vt=8+bn+1&-2;if(mt+=vt,0<Ue&&mt>Ue){oe=3;break e}if(!n(Be,be,"VP8 ")||!n(Be,be,"VP8L")){oe=0;break e}if(Ct[0]<vt){oe=7;break e}n(Be,be,"ALPH")||(Te[0]=Be,Se[0]=be+8,Ge[0]=bn),be+=vt,Ct-=vt}}if(b=b[0],X.na=X.na[0],X.P=X.P[0],X.Sa=X.Sa[0],oe!=0)break}b=[b],X.Ja=[X.Ja],X.xa=[X.xa];e:if(Ue=h,oe=g,me=b,Te=X.gb[0],Se=X.Ja,Ge=X.xa,Be=oe[0],be=!n(Ue,Be,"VP8 "),mt=!n(Ue,Be,"VP8L"),e(Ue!=null),e(me!=null),e(Se!=null),e(Ge!=null),8>me[0])oe=7;else{if(be||mt){if(Ue=he(Ue,Be+4),12<=Te&&Ue>Te-12){oe=3;break e}if(U&&Ue>me[0]-8){oe=7;break e}Se[0]=Ue,oe[0]+=8,me[0]-=8,Ge[0]=mt}else Ge[0]=5<=me[0]&&Ue[Be+0]==47&&!(Ue[Be+4]>>5),Se[0]=me[0];oe=0}if(b=b[0],X.Ja=X.Ja[0],X.xa=X.xa[0],g=g[0],oe!=0)break;if(4294967286<X.Ja)return 3;if(M==null||pe||(M[0]=X.xa?2:1),L=[L],re=[re],X.xa){if(5>b){oe=7;break}M=L,U=re,pe=x,h==null||5>b?h=0:5<=b&&h[g+0]==47&&!(h[g+4]>>5)?(me=[0],Ue=[0],Te=[0],ve(Se=new O,h,g,b),ir(Se,me,Ue,Te)?(M!=null&&(M[0]=me[0]),U!=null&&(U[0]=Ue[0]),pe!=null&&(pe[0]=Te[0]),h=1):h=0):h=0}else{if(10>b){oe=7;break}M=re,h==null||10>b||!Qa(h,g+3,b-3)?h=0:(U=h[g+0]|h[g+1]<<8|h[g+2]<<16,pe=16383&(h[g+7]<<8|h[g+6]),h=16383&(h[g+9]<<8|h[g+8]),1&U||3<(U>>1&7)||!(U>>4&1)||U>>5>=X.Ja||!pe||!h?h=0:(L&&(L[0]=pe),M&&(M[0]=h),h=1))}if(!h||(L=L[0],re=re[0],se&&(q[0]!=L||K[0]!=re)))return 3;B!=null&&(B[0]=X,B.offset=g-B.w,e(4294967286>g-B.w),e(B.offset==B.ha-b));break}return oe==0||oe==7&&se&&B==null?(x!=null&&(x[0]|=X.na!=null&&0<X.na.length),w!=null&&(w[0]=L),A!=null&&(A[0]=re),0):oe}function na(h,g,b){var w=g.width,A=g.height,x=0,L=0,M=w,B=A;if(g.Da=h!=null&&0<h.Da,g.Da&&(M=h.cd,B=h.bd,x=h.v,L=h.j,11>b||(x&=-2,L&=-2),0>x||0>L||0>=M||0>=B||x+M>w||L+B>A))return 0;if(g.v=x,g.j=L,g.va=x+M,g.o=L+B,g.U=M,g.T=B,g.da=h!=null&&0<h.da,g.da){if(!je(M,B,b=[h.ib],x=[h.hb]))return 0;g.ib=b[0],g.hb=x[0]}return g.ob=h!=null&&h.ob,g.Kb=h==null||!h.Sd,g.da&&(g.ob=g.ib<3*w/4&&g.hb<3*A/4,g.Kb=0),1}function ia(h){if(h==null)return 2;if(11>h.S){var g=h.f.RGBA;g.fb+=(h.height-1)*g.A,g.A=-g.A}else g=h.f.kb,h=h.height,g.O+=(h-1)*g.fa,g.fa=-g.fa,g.N+=(h-1>>1)*g.Ab,g.Ab=-g.Ab,g.W+=(h-1>>1)*g.Db,g.Db=-g.Db,g.F!=null&&(g.J+=(h-1)*g.lb,g.lb=-g.lb);return 0}function Ir(h,g,b,w){if(w==null||0>=h||0>=g)return 2;if(b!=null){if(b.Da){var A=b.cd,x=b.bd,L=-2&b.v,M=-2&b.j;if(0>L||0>M||0>=A||0>=x||L+A>h||M+x>g)return 2;h=A,g=x}if(b.da){if(!je(h,g,A=[b.ib],x=[b.hb]))return 2;h=A[0],g=x[0]}}w.width=h,w.height=g;e:{var B=w.width,q=w.height;if(h=w.S,0>=B||0>=q||!(h>=dl&&13>h))h=2;else{if(0>=w.Rd&&w.sd==null){L=x=A=g=0;var K=(M=B*rh[h])*q;if(11>h||(x=(q+1)/2*(g=(B+1)/2),h==12&&(L=(A=B)*q)),(q=o(K+2*x+L))==null){h=1;break e}w.sd=q,11>h?((B=w.f.RGBA).eb=q,B.fb=0,B.A=M,B.size=K):((B=w.f.kb).y=q,B.O=0,B.fa=M,B.Fd=K,B.f=q,B.N=0+K,B.Ab=g,B.Cd=x,B.ea=q,B.W=0+K+x,B.Db=g,B.Ed=x,h==12&&(B.F=q,B.J=0+K+2*x),B.Tc=L,B.lb=A)}if(g=1,A=w.S,x=w.width,L=w.height,A>=dl&&13>A)if(11>A)h=w.f.RGBA,g&=(M=Math.abs(h.A))*(L-1)+x<=h.size,g&=M>=x*rh[A],g&=h.eb!=null;else{h=w.f.kb,M=(x+1)/2,K=(L+1)/2,B=Math.abs(h.fa),q=Math.abs(h.Ab);var se=Math.abs(h.Db),U=Math.abs(h.lb),X=U*(L-1)+x;g&=B*(L-1)+x<=h.Fd,g&=q*(K-1)+M<=h.Cd,g=(g&=se*(K-1)+M<=h.Ed)&B>=x&q>=M&se>=M,g&=h.y!=null,g&=h.f!=null,g&=h.ea!=null,A==12&&(g&=U>=x,g&=X<=h.Tc,g&=h.F!=null)}else g=0;h=g?0:2}}return h!=0||b!=null&&b.fd&&(h=ia(w)),h}var _o=64,Zn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ei=24,kr=32,ur=8,xr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ne("Predictor0","PredictorAdd0"),D.Predictor0=function(){return 4278190080},D.Predictor1=function(h){return h},D.Predictor2=function(h,g,b){return g[b+0]},D.Predictor3=function(h,g,b){return g[b+1]},D.Predictor4=function(h,g,b){return g[b-1]},D.Predictor5=function(h,g,b){return Ke(Ke(h,g[b+1]),g[b+0])},D.Predictor6=function(h,g,b){return Ke(h,g[b-1])},D.Predictor7=function(h,g,b){return Ke(h,g[b+0])},D.Predictor8=function(h,g,b){return Ke(g[b-1],g[b+0])},D.Predictor9=function(h,g,b){return Ke(g[b+0],g[b+1])},D.Predictor10=function(h,g,b){return Ke(Ke(h,g[b-1]),Ke(g[b+0],g[b+1]))},D.Predictor11=function(h,g,b){var w=g[b+0];return 0>=lt(w>>24&255,h>>24&255,(g=g[b-1])>>24&255)+lt(w>>16&255,h>>16&255,g>>16&255)+lt(w>>8&255,h>>8&255,g>>8&255)+lt(255&w,255&h,255&g)?w:h},D.Predictor12=function(h,g,b){var w=g[b+0];return(It((h>>24&255)+(w>>24&255)-((g=g[b-1])>>24&255))<<24|It((h>>16&255)+(w>>16&255)-(g>>16&255))<<16|It((h>>8&255)+(w>>8&255)-(g>>8&255))<<8|It((255&h)+(255&w)-(255&g)))>>>0},D.Predictor13=function(h,g,b){var w=g[b-1];return(at((h=Ke(h,g[b+0]))>>24&255,w>>24&255)<<24|at(h>>16&255,w>>16&255)<<16|at(h>>8&255,w>>8&255)<<8|at(255&h,255&w))>>>0};var ra=D.PredictorAdd0;D.PredictorAdd1=Dt,Ne("Predictor2","PredictorAdd2"),Ne("Predictor3","PredictorAdd3"),Ne("Predictor4","PredictorAdd4"),Ne("Predictor5","PredictorAdd5"),Ne("Predictor6","PredictorAdd6"),Ne("Predictor7","PredictorAdd7"),Ne("Predictor8","PredictorAdd8"),Ne("Predictor9","PredictorAdd9"),Ne("Predictor10","PredictorAdd10"),Ne("Predictor11","PredictorAdd11"),Ne("Predictor12","PredictorAdd12"),Ne("Predictor13","PredictorAdd13");var ts=D.PredictorAdd2;Ye("ColorIndexInverseTransform","MapARGB","32b",function(h){return h>>8&255},function(h){return h}),Ye("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(h){return h},function(h){return h>>8&255});var on,ll=D.ColorIndexInverseTransform,Wi=D.MapARGB,zi=D.VP8LColorIndexInverseTransformAlpha,oa=D.MapAlpha,sa=D.VP8LPredictorsAdd=[];sa.length=16,(D.VP8LPredictors=[]).length=16,(D.VP8LPredictorsAdd_C=[]).length=16,(D.VP8LPredictors_C=[]).length=16;var aa,la,Lr,Pr,Nr,Co,Rr,Eo,mi,Ji,Pt,Ut,sn,yn,dr,ca,ns,cl,Rf,Mf,Bf,Df,Ff,qf,ua,Uf,$f,Of,Hf=o(511),Vf=o(2041),Gf=o(225),Wf=o(767),zf=0,Xc=Vf,ul=Gf,ti=Wf,vi=Hf,dl=0,fl=1,Jf=2,hl=3,pl=4,Zc=5,Yf=6,eu=7,tu=8,gl=9,nu=10,j0=[2,3,7],Q0=[3,3,11],Kf=[280,256,256,256,40],X0=[0,1,1,1,0],Z0=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],e1=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],t1=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],n1=8,iu=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ru=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],da=null,i1=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],r1=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],jf=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],o1=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],s1=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],a1=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],l1=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Mr=[],xi=[],fr=[],c1=1,Qf=2,Br=[],yi=[];zn("UpsampleRgbLinePair",vo,3),zn("UpsampleBgrLinePair",yo,3),zn("UpsampleRgbaLinePair",ta,4),zn("UpsampleBgraLinePair",ea,4),zn("UpsampleArgbLinePair",wo,4),zn("UpsampleRgba4444LinePair",bo,2),zn("UpsampleRgb565LinePair",Bn,2);var u1=D.UpsampleRgbLinePair,d1=D.UpsampleBgrLinePair,Xf=D.UpsampleRgbaLinePair,Zf=D.UpsampleBgraLinePair,eh=D.UpsampleArgbLinePair,th=D.UpsampleRgba4444LinePair,f1=D.UpsampleRgb565LinePair,ml=16,vl=1<<ml-1,fa=-227,ou=482,h1=6,nh=0,p1=o(256),g1=o(256),m1=o(256),v1=o(256),y1=o(ou-fa),b1=o(ou-fa);cr("YuvToRgbRow",vo,3),cr("YuvToBgrRow",yo,3),cr("YuvToRgbaRow",ta,4),cr("YuvToBgraRow",ea,4),cr("YuvToArgbRow",wo,4),cr("YuvToRgba4444Row",bo,2),cr("YuvToRgb565Row",Bn,2);var ih=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],yl=[0,2,8],w1=[8,7,6,4,4,2,2,2,1,1,1,1],S1=1;this.WebPDecodeRGBA=function(h,g,b,w,A){var x=fl,L=new ie,M=new qt;L.ba=M,M.S=x,M.width=[M.width],M.height=[M.height];var B=M.width,q=M.height,K=new nt;if(K==null||h==null)var se=2;else e(K!=null),se=So(h,g,b,K.width,K.height,K.Pd,K.Qd,K.format,null);if(se!=0?B=0:(B!=null&&(B[0]=K.width[0]),q!=null&&(q[0]=K.height[0]),B=1),B){M.width=M.width[0],M.height=M.height[0],w!=null&&(w[0]=M.width),A!=null&&(A[0]=M.height);e:{if(w=new Yo,(A=new ye).data=h,A.w=g,A.ha=b,A.kd=1,g=[0],e(A!=null),((h=So(A.data,A.w,A.ha,null,null,null,g,null,A))==0||h==7)&&g[0]&&(h=4),(g=h)==0){if(e(L!=null),w.data=A.data,w.w=A.w+A.offset,w.ha=A.ha-A.offset,w.put=Xe,w.ac=Oi,w.bc=nr,w.ma=L,A.xa){if((h=io())==null){L=1;break e}if((function(U,X){var re=[0],pe=[0],oe=[0];t:for(;;){if(U==null)return 0;if(X==null)return U.a=2,0;if(U.l=X,U.a=0,ve(U.m,X.data,X.w,X.ha),!ir(U.m,re,pe,oe)){U.a=3;break t}if(U.xb=Qf,X.width=re[0],X.height=pe[0],!Vi(re[0],pe[0],1,U,null))break t;return 1}return e(U.a!=0),0})(h,w)){if(w=(g=Ir(w.width,w.height,L.Oa,L.ba))==0){t:{w=h;n:for(;;){if(w==null){w=0;break t}if(e(w.s.yc!=null),e(w.s.Ya!=null),e(0<w.s.Wb),e((b=w.l)!=null),e((A=b.ma)!=null),w.xb!=0){if(w.ca=A.ba,w.tb=A.tb,e(w.ca!=null),!na(A.Oa,b,hl)){w.a=2;break n}if(!ro(w,b.width)||b.da)break n;if((b.da||ut(w.ca.S))&&pi(),11>w.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),w.ca.f.kb.F!=null&&pi()),w.Pb&&0<w.s.ua&&w.s.vb.X==null&&!H(w.s.vb,w.s.Wa.Xa)){w.a=1;break n}w.xb=0}if(!Ii(w,w.V,w.Ba,w.c,w.i,b.o,Cr))break n;A.Dc=w.Ma,w=1;break t}e(w.a!=0),w=0}w=!w}w&&(g=h.a)}else g=h.a}else{if((h=new Fc)==null){L=1;break e}if(h.Fa=A.na,h.P=A.P,h.qc=A.Sa,Xa(h,w)){if((g=Ir(w.width,w.height,L.Oa,L.ba))==0){if(h.Aa=0,b=L.Oa,e((A=h)!=null),b!=null){if(0<(B=0>(B=b.Md)?0:100<B?255:255*B/100)){for(q=K=0;4>q;++q)12>(se=A.pb[q]).lc&&(se.ia=B*w1[0>se.lc?0:se.lc]>>3),K|=se.ia;K&&(alert("todo:VP8InitRandom"),A.ia=1)}A.Ga=b.Id,100<A.Ga?A.Ga=100:0>A.Ga&&(A.Ga=0)}(function(U,X){if(U==null)return 0;if(X==null)return fn(U,2,"NULL VP8Io parameter in VP8Decode().");if(!U.cb&&!Xa(U,X))return 0;if(e(U.cb),X.ac==null||X.ac(X)){X.ob&&(U.L=0);var re=yl[U.L];if(U.L==2?(U.yb=0,U.zb=0):(U.yb=X.v-re>>4,U.zb=X.j-re>>4,0>U.yb&&(U.yb=0),0>U.zb&&(U.zb=0)),U.Va=X.o+15+re>>4,U.Hb=X.va+15+re>>4,U.Hb>U.za&&(U.Hb=U.za),U.Va>U.Ub&&(U.Va=U.Ub),0<U.L){var pe=U.ed;for(re=0;4>re;++re){var oe;if(U.Qa.Cb){var me=U.Qa.Lb[re];U.Qa.Fb||(me+=pe.Tb)}else me=pe.Tb;for(oe=0;1>=oe;++oe){var be=U.gd[re][oe],Te=me;if(pe.Pc&&(Te+=pe.vd[0],oe&&(Te+=pe.od[0])),0<(Te=0>Te?0:63<Te?63:Te)){var Se=Te;0<pe.wb&&(Se=4<pe.wb?Se>>2:Se>>1)>9-pe.wb&&(Se=9-pe.wb),1>Se&&(Se=1),be.dd=Se,be.tc=2*Te+Se,be.ld=40<=Te?2:15<=Te?1:0}else be.tc=0;be.La=oe}}}re=0}else fn(U,6,"Frame setup failed"),re=U.a;if(re=re==0){if(re){U.$c=0,0<U.Aa||(U.Ic=S1);t:{re=U.Ic,pe=4*(Se=U.za);var Ge=32*Se,Be=Se+1,mt=0<U.L?Se*(0<U.Aa?2:1):0,Ue=(U.Aa==2?2:1)*Se;if((be=pe+832+(oe=3*(16*re+yl[U.L])/2*Ge)+(me=U.Fa!=null&&0<U.Fa.length?U.Kc.c*U.Kc.i:0))!=be)re=0;else{if(be>U.Vb){if(U.Vb=0,U.Ec=o(be),U.Fc=0,U.Ec==null){re=fn(U,1,"no memory during frame initialization.");break t}U.Vb=be}be=U.Ec,Te=U.Fc,U.Ac=be,U.Bc=Te,Te+=pe,U.Gd=s(Ge,Ka),U.Hd=0,U.rb=s(Be+1,Vs),U.sb=1,U.wa=mt?s(mt,hi):null,U.Y=0,U.D.Nb=0,U.D.wa=U.wa,U.D.Y=U.Y,0<U.Aa&&(U.D.Y+=Se),e(!0),U.oc=be,U.pc=Te,Te+=832,U.ya=s(Ue,Gs),U.aa=0,U.D.ya=U.ya,U.D.aa=U.aa,U.Aa==2&&(U.D.aa+=Se),U.R=16*Se,U.B=8*Se,Se=(Ge=yl[U.L])*U.R,Ge=Ge/2*U.B,U.sa=be,U.ta=Te+Se,U.qa=U.sa,U.ra=U.ta+16*re*U.R+Ge,U.Ha=U.qa,U.Ia=U.ra+8*re*U.B+Ge,U.$c=0,Te+=oe,U.mb=me?be:null,U.nb=me?Te:null,e(Te+me<=U.Fc+U.Vb),oo(U),r(U.Ac,U.Bc,0,pe),re=1}}if(re){if(X.ka=0,X.y=U.sa,X.O=U.ta,X.f=U.qa,X.N=U.ra,X.ea=U.Ha,X.Vd=U.Ia,X.fa=U.R,X.Rc=U.B,X.F=null,X.J=0,!zf){for(re=-255;255>=re;++re)Hf[255+re]=0>re?-re:re;for(re=-1020;1020>=re;++re)Vf[1020+re]=-128>re?-128:127<re?127:re;for(re=-112;112>=re;++re)Gf[112+re]=-16>re?-16:15<re?15:re;for(re=-255;510>=re;++re)Wf[255+re]=0>re?0:255<re?255:re;zf=1}Rr=el,Eo=Uc,Ji=$c,Pt=Gi,Ut=Za,mi=qc,sn=il,yn=rl,dr=y,ca=T,ns=po,cl=ol,Rf=$,Mf=z,Bf=Zs,Df=ho,Ff=tl,qf=nl,xi[0]=Jc,xi[1]=zs,xi[2]=Wc,xi[3]=zc,xi[4]=Yc,xi[5]=sr,xi[6]=or,xi[7]=Kc,xi[8]=Ko,xi[9]=jc,Mr[0]=Tr,Mr[1]=Hc,Mr[2]=Vc,Mr[3]=Js,Mr[4]=Gc,Mr[5]=lo,Mr[6]=Ys,fr[0]=Qo,fr[1]=Oc,fr[2]=Ks,fr[3]=co,fr[4]=js,fr[5]=Qc,fr[6]=Qs,re=1}else re=0}re&&(re=(function(Ct,bn){for(Ct.M=0;Ct.M<Ct.Va;++Ct.M){var vt,$e=Ct.Jc[Ct.M&Ct.Xb],Pe=Ct.m,an=Ct;for(vt=0;vt<an.za;++vt){var dt=Pe,Et=an,zt=Et.Ac,Ln=Et.Bc+4*vt,Hn=Et.zc,Zt=Et.ya[Et.aa+vt];if(Et.Qa.Bb?Zt.$b=we(dt,Et.Pa.jb[0])?2+we(dt,Et.Pa.jb[2]):we(dt,Et.Pa.jb[1]):Zt.$b=0,Et.kc&&(Zt.Ad=we(dt,Et.Bd)),Zt.Za=!we(dt,145)+0,Zt.Za){var Dn=Zt.Ob,Vn=0;for(Et=0;4>Et;++Et){var wn,Tt=Hn[0+Et];for(wn=0;4>wn;++wn){Tt=s1[zt[Ln+wn]][Tt];for(var Nt=jf[we(dt,Tt[0])];0<Nt;)Nt=jf[2*Nt+we(dt,Tt[Nt])];Tt=-Nt,zt[Ln+wn]=Tt}i(Dn,Vn,zt,Ln,4),Vn+=4,Hn[0+Et]=Tt}}else Tt=we(dt,156)?we(dt,128)?1:3:we(dt,163)?2:0,Zt.Ob[0]=Tt,r(zt,Ln,Tt,4),r(Hn,0,Tt,4);Zt.Dd=we(dt,142)?we(dt,114)?we(dt,183)?1:3:2:0}if(an.m.Ka)return fn(Ct,7,"Premature end-of-partition0 encountered.");for(;Ct.ja<Ct.za;++Ct.ja){if(an=$e,dt=(Pe=Ct).rb[Pe.sb-1],zt=Pe.rb[Pe.sb+Pe.ja],vt=Pe.ya[Pe.aa+Pe.ja],Ln=Pe.kc?vt.Ad:0)dt.la=zt.la=0,vt.Za||(dt.Na=zt.Na=0),vt.Hc=0,vt.Gc=0,vt.ia=0;else{var en,Rt;if(dt=zt,zt=an,Ln=Pe.Pa.Xc,Hn=Pe.ya[Pe.aa+Pe.ja],Zt=Pe.pb[Hn.$b],Et=Hn.ad,Dn=0,Vn=Pe.rb[Pe.sb-1],Tt=wn=0,r(Et,Dn,0,384),Hn.Za)var Pn=0,Li=Ln[3];else{Nt=o(16);var ln=dt.Na+Vn.Na;if(ln=da(zt,Ln[1],ln,Zt.Eb,0,Nt,0),dt.Na=Vn.Na=(0<ln)+0,1<ln)Rr(Nt,0,Et,Dn);else{var Jn=Nt[0]+3>>3;for(Nt=0;256>Nt;Nt+=16)Et[Dn+Nt]=Jn}Pn=1,Li=Ln[0]}var $t=15&dt.la,Sn=15&Vn.la;for(Nt=0;4>Nt;++Nt){var ni=1&Sn;for(Jn=Rt=0;4>Jn;++Jn)$t=$t>>1|(ni=(ln=da(zt,Li,ln=ni+(1&$t),Zt.Sc,Pn,Et,Dn))>Pn)<<7,Rt=Rt<<2|(3<ln?3:1<ln?2:Et[Dn+0]!=0),Dn+=16;$t>>=4,Sn=Sn>>1|ni<<7,wn=(wn<<8|Rt)>>>0}for(Li=$t,Pn=Sn>>4,en=0;4>en;en+=2){for(Rt=0,$t=dt.la>>4+en,Sn=Vn.la>>4+en,Nt=0;2>Nt;++Nt){for(ni=1&Sn,Jn=0;2>Jn;++Jn)ln=ni+(1&$t),$t=$t>>1|(ni=0<(ln=da(zt,Ln[2],ln,Zt.Qc,0,Et,Dn)))<<3,Rt=Rt<<2|(3<ln?3:1<ln?2:Et[Dn+0]!=0),Dn+=16;$t>>=2,Sn=Sn>>1|ni<<5}Tt|=Rt<<4*en,Li|=$t<<4<<en,Pn|=(240&Sn)<<en}dt.la=Li,Vn.la=Pn,Hn.Hc=wn,Hn.Gc=Tt,Hn.ia=43690&Tt?0:Zt.ia,Ln=!(wn|Tt)}if(0<Pe.L&&(Pe.wa[Pe.Y+Pe.ja]=Pe.gd[vt.$b][vt.Za],Pe.wa[Pe.Y+Pe.ja].La|=!Ln),an.Ka)return fn(Ct,7,"Premature end-of-file encountered.")}if(oo(Ct),Pe=bn,an=1,vt=($e=Ct).D,dt=0<$e.L&&$e.M>=$e.zb&&$e.M<=$e.Va,$e.Aa==0)t:{if(vt.M=$e.M,vt.uc=dt,gi($e,vt),an=1,vt=(Rt=$e.D).Nb,dt=(Tt=yl[$e.L])*$e.R,zt=Tt/2*$e.B,Nt=16*vt*$e.R,Jn=8*vt*$e.B,Ln=$e.sa,Hn=$e.ta-dt+Nt,Zt=$e.qa,Et=$e.ra-zt+Jn,Dn=$e.Ha,Vn=$e.Ia-zt+Jn,Sn=($t=Rt.M)==0,wn=$t>=$e.Va-1,$e.Aa==2&&gi($e,Rt),Rt.uc)for(ni=(ln=$e).D.M,e(ln.D.uc),Rt=ln.yb;Rt<ln.Hb;++Rt){Pn=Rt,Li=ni;var Gn=(ii=(Nn=ln).D).Nb;en=Nn.R;var ii=ii.wa[ii.Y+Pn],ri=Nn.sa,Yn=Nn.ta+16*Gn*en+16*Pn,oi=ii.dd,Gt=ii.tc;if(Gt!=0)if(e(3<=Gt),Nn.L==1)0<Pn&&Df(ri,Yn,en,Gt+4),ii.La&&qf(ri,Yn,en,Gt),0<Li&&Bf(ri,Yn,en,Gt+4),ii.La&&Ff(ri,Yn,en,Gt);else{var si=Nn.B,Pi=Nn.qa,To=Nn.ra+8*Gn*si+8*Pn,hr=Nn.Ha,Nn=Nn.Ia+8*Gn*si+8*Pn;Gn=ii.ld,0<Pn&&(yn(ri,Yn,en,Gt+4,oi,Gn),ca(Pi,To,hr,Nn,si,Gt+4,oi,Gn)),ii.La&&(cl(ri,Yn,en,Gt,oi,Gn),Mf(Pi,To,hr,Nn,si,Gt,oi,Gn)),0<Li&&(sn(ri,Yn,en,Gt+4,oi,Gn),dr(Pi,To,hr,Nn,si,Gt+4,oi,Gn)),ii.La&&(ns(ri,Yn,en,Gt,oi,Gn),Rf(Pi,To,hr,Nn,si,Gt,oi,Gn))}}if($e.ia&&alert("todo:DitherRow"),Pe.put!=null){if(Rt=16*$t,$t=16*($t+1),Sn?(Pe.y=$e.sa,Pe.O=$e.ta+Nt,Pe.f=$e.qa,Pe.N=$e.ra+Jn,Pe.ea=$e.Ha,Pe.W=$e.Ia+Jn):(Rt-=Tt,Pe.y=Ln,Pe.O=Hn,Pe.f=Zt,Pe.N=Et,Pe.ea=Dn,Pe.W=Vn),wn||($t-=Tt),$t>Pe.o&&($t=Pe.o),Pe.F=null,Pe.J=null,$e.Fa!=null&&0<$e.Fa.length&&Rt<$t&&(Pe.J=hn($e,Pe,Rt,$t-Rt),Pe.F=$e.mb,Pe.F==null&&Pe.F.length==0)){an=fn($e,3,"Could not decode alpha data.");break t}Rt<Pe.j&&(Tt=Pe.j-Rt,Rt=Pe.j,e(!(1&Tt)),Pe.O+=$e.R*Tt,Pe.N+=$e.B*(Tt>>1),Pe.W+=$e.B*(Tt>>1),Pe.F!=null&&(Pe.J+=Pe.width*Tt)),Rt<$t&&(Pe.O+=Pe.v,Pe.N+=Pe.v>>1,Pe.W+=Pe.v>>1,Pe.F!=null&&(Pe.J+=Pe.v),Pe.ka=Rt-Pe.j,Pe.U=Pe.va-Pe.v,Pe.T=$t-Rt,an=Pe.put(Pe))}vt+1!=$e.Ic||wn||(i($e.sa,$e.ta-dt,Ln,Hn+16*$e.R,dt),i($e.qa,$e.ra-zt,Zt,Et+8*$e.B,zt),i($e.Ha,$e.Ia-zt,Dn,Vn+8*$e.B,zt))}if(!an)return fn(Ct,6,"Output aborted.")}return 1})(U,X)),X.bc!=null&&X.bc(X),re&=1}return re?(U.cb=0,re):0})(h,w)||(g=h.a)}}else g=h.a}g==0&&L.Oa!=null&&L.Oa.fd&&(g=ia(L.ba))}L=g}x=L!=0?null:11>x?M.f.RGBA.eb:M.f.kb.y}else x=null;return x};var rh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(D,Z){for(var N="",F=0;F<4;F++)N+=String.fromCharCode(D[Z++]);return N}function f(D,Z){return D[Z+0]|D[Z+1]<<8}function p(D,Z){return(D[Z+0]|D[Z+1]<<8|D[Z+2]<<16)>>>0}function v(D,Z){return(D[Z+0]|D[Z+1]<<8|D[Z+2]<<16|D[Z+3]<<24)>>>0}new c;var m=[0],S=[0],_=[],E=new c,C=t,k=(function(D,Z){var N={},F=0,J=!1,W=0,ce=0;if(N.frames=[],!(function(R,O){for(var V=0;V<4;V++)if(R[O+V]!="RIFF".charCodeAt(V))return!0;return!1})(D,Z)){for(v(D,Z+=4),Z+=8;Z<D.length;){var fe=u(D,Z),ge=v(D,Z+=4);Z+=4;var ae=ge+(1&ge);switch(fe){case"VP8 ":case"VP8L":N.frames[F]===void 0&&(N.frames[F]={}),(_e=N.frames[F]).src_off=J?ce:Z-8,_e.src_size=W+ge+8,F++,J&&(J=!1,W=0,ce=0);break;case"VP8X":(_e=N.header={}).feature_flags=D[Z];var ve=Z+4;_e.canvas_width=1+p(D,ve),ve+=3,_e.canvas_height=1+p(D,ve),ve+=3;break;case"ALPH":J=!0,W=ae+8,ce=Z-8;break;case"ANIM":(_e=N.header).bgcolor=v(D,Z),ve=Z+4,_e.loop_count=f(D,ve),ve+=2;break;case"ANMF":var xe,_e;(_e=N.frames[F]={}).offset_x=2*p(D,Z),Z+=3,_e.offset_y=2*p(D,Z),Z+=3,_e.width=1+p(D,Z),Z+=3,_e.height=1+p(D,Z),Z+=3,_e.duration=p(D,Z),Z+=3,xe=D[Z++],_e.dispose=1&xe,_e.blend=xe>>1&1}fe!="ANMF"&&(Z+=ae)}return N}})(C,0);k.response=C,k.rgbaoutput=!0,k.dataurl=!1;var I=k.header?k.header:null,P=k.frames?k.frames:null;if(I){I.loop_counter=I.loop_count,m=[I.canvas_height],S=[I.canvas_width];for(var G=0;G<P.length&&P[G].blend!=0;G++);}var ee=P[0],te=E.WebPDecodeRGBA(C,ee.src_off,ee.src_size,S,m);ee.rgba=te,ee.imgwidth=S[0],ee.imgheight=m[0];for(var Y=0;Y<S[0]*m[0]*4;Y++)_[Y]=te[Y];return this.width=S,this.height=m,this.data=_,this}(function(t){var e,n,i,r,o,s,a,c,u,f=function(R){return R=R||{},this.isStrokeTransparent=R.isStrokeTransparent||!1,this.strokeOpacity=R.strokeOpacity||1,this.strokeStyle=R.strokeStyle||"#000000",this.fillStyle=R.fillStyle||"#000000",this.isFillTransparent=R.isFillTransparent||!1,this.fillOpacity=R.fillOpacity||1,this.font=R.font||"10px sans-serif",this.textBaseline=R.textBaseline||"alphabetic",this.textAlign=R.textAlign||"left",this.lineWidth=R.lineWidth||1,this.lineJoin=R.lineJoin||"miter",this.lineCap=R.lineCap||"butt",this.path=R.path||[],this.transform=R.transform!==void 0?R.transform.clone():new c,this.globalCompositeOperation=R.globalCompositeOperation||"normal",this.globalAlpha=R.globalAlpha||1,this.clip_path=R.clip_path||[],this.currentPoint=R.currentPoint||new s,this.miterLimit=R.miterLimit||10,this.lastPoint=R.lastPoint||new s,this.lineDashOffset=R.lineDashOffset||0,this.lineDash=R.lineDash||[],this.margin=R.margin||[0,0,0,0],this.prevPageLastElemOffset=R.prevPageLastElemOffset||0,this.ignoreClearRect=typeof R.ignoreClearRect!="boolean"||R.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new p(this),e=this.internal.f2,n=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,a=this.internal.Rectangle,c=this.internal.Matrix,u=new f}]);var p=function(R){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var O=R;Object.defineProperty(this,"pdf",{get:function(){return O}});var V=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return V},set:function(he){V=!!he}});var Q=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Q},set:function(he){Q=!!he}});var ne=0;Object.defineProperty(this,"posX",{get:function(){return ne},set:function(he){isNaN(he)||(ne=he)}});var le=0;Object.defineProperty(this,"posY",{get:function(){return le},set:function(he){isNaN(he)||(le=he)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(he){var H;typeof he=="number"?H=[he,he,he,he]:((H=new Array(4))[0]=he[0],H[1]=he.length>=2?he[1]:H[0],H[2]=he.length>=3?he[2]:H[0],H[3]=he.length>=4?he[3]:H[1]),u.margin=H}});var de=!1;Object.defineProperty(this,"autoPaging",{get:function(){return de},set:function(he){de=he}});var ue=0;Object.defineProperty(this,"lastBreak",{get:function(){return ue},set:function(he){ue=he}});var we=[];Object.defineProperty(this,"pageBreaks",{get:function(){return we},set:function(he){we=he}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(he){he instanceof f&&(u=he)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(he){u.path=he}});var Ie=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ie},set:function(he){Ie=he}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(he){var H;H=v(he),this.ctx.fillStyle=H.style,this.ctx.isFillTransparent=H.a===0,this.ctx.fillOpacity=H.a,this.pdf.setFillColor(H.r,H.g,H.b,{a:H.a}),this.pdf.setTextColor(H.r,H.g,H.b,{a:H.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(he){var H=v(he);this.ctx.strokeStyle=H.style,this.ctx.isStrokeTransparent=H.a===0,this.ctx.strokeOpacity=H.a,H.a===0?this.pdf.setDrawColor(255,255,255):(H.a,this.pdf.setDrawColor(H.r,H.g,H.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(he){["butt","round","square"].indexOf(he)!==-1&&(this.ctx.lineCap=he,this.pdf.setLineCap(he))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(he){isNaN(he)||(this.ctx.lineWidth=he,this.pdf.setLineWidth(he))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(he){["bevel","round","miter"].indexOf(he)!==-1&&(this.ctx.lineJoin=he,this.pdf.setLineJoin(he))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(he){isNaN(he)||(this.ctx.miterLimit=he,this.pdf.setMiterLimit(he))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(he){this.ctx.textBaseline=he}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(he){["right","end","center","left","start"].indexOf(he)!==-1&&(this.ctx.textAlign=he)}});var Re=null,Me=null;Object.defineProperty(this,"fontFaces",{get:function(){return Me},set:function(he){Re=null,Me=he}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(he){var H;if(this.ctx.font=he,(H=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(he))!==null){var St=H[1];H[2];var ht=H[3],je=H[4];H[5];var ke=H[6],We=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(je)[2];je=Math.floor(We==="px"?parseFloat(je)*this.pdf.internal.scaleFactor:We==="em"?parseFloat(je)*this.pdf.getFontSize():parseFloat(je)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(je);var Ne=(function(Ze){var Ye,Ht,kt=[],Ve=Ze.trim();if(Ve==="")return Nu;if(Ve in vp)return[vp[Ve]];for(;Ve!=="";){switch(Ht=null,Ye=(Ve=bp(Ve)).charAt(0)){case'"':case"'":Ht=f5(Ve.substring(1),Ye);break;default:Ht=h5(Ve)}if(Ht===null||(kt.push(Ht[0]),(Ve=bp(Ht[1]))!==""&&Ve.charAt(0)!==","))return Nu;Ve=Ve.replace(/^,/,"")}return kt})(ke);if(this.fontFaces){var pt=(function(Ze,Ye){if(Re===null){var Ht=(function(kt){var Ve=[];return Object.keys(kt).forEach(function(ct){kt[ct].forEach(function(Ft){var Qe=null;switch(Ft){case"bold":Qe={family:ct,weight:"bold"};break;case"italic":Qe={family:ct,style:"italic"};break;case"bolditalic":Qe={family:ct,weight:"bold",style:"italic"};break;case"":case"normal":Qe={family:ct}}Qe!==null&&(Qe.ref={name:ct,style:Ft},Ve.push(Qe))})}),Ve})(Ze.getFontList());Re=(function(kt){for(var Ve={},ct=0;ct<kt.length;++ct){var Ft=Pu(kt[ct]),Qe=Ft.family,_t=Ft.stretch,ut=Ft.style,nn=Ft.weight;Ve[Qe]=Ve[Qe]||{},Ve[Qe][_t]=Ve[Qe][_t]||{},Ve[Qe][_t][ut]=Ve[Qe][_t][ut]||{},Ve[Qe][_t][ut][nn]=Ft}return Ve})(Ht.concat(Ye))}return Re})(this.pdf,this.fontFaces),Ke=Ne.map(function(Ze){return{family:Ze,stretch:"normal",weight:ht,style:St}}),It=(function(Ze,Ye,Ht){for(var kt=(Ht=Ht||{}).defaultFontFamily||"times",Ve=Object.assign({},d5,Ht.genericFontFamilies||{}),ct=null,Ft=null,Qe=0;Qe<Ye.length;++Qe)if(Ve[(ct=Pu(Ye[Qe])).family]&&(ct.family=Ve[ct.family]),Ze.hasOwnProperty(ct.family)){Ft=Ze[ct.family];break}if(!(Ft=Ft||Ze[kt]))throw new Error("Could not find a font-family for the rule '"+yp(ct)+"' and default family '"+kt+"'.");if(Ft=(function(_t,ut){if(ut[_t])return ut[_t];var nn=md[_t],mn=nn<=md.normal?-1:1,qt=mp(ut,qv,nn,mn);if(!qt)throw new Error("Could not find a matching font-stretch value for "+_t);return qt})(ct.stretch,Ft),Ft=(function(_t,ut){if(ut[_t])return ut[_t];for(var nn=Fv[_t],mn=0;mn<nn.length;++mn)if(ut[nn[mn]])return ut[nn[mn]];throw new Error("Could not find a matching font-style for "+_t)})(ct.style,Ft),!(Ft=(function(_t,ut){if(ut[_t])return ut[_t];if(_t===400&&ut[500])return ut[500];if(_t===500&&ut[400])return ut[400];var nn=u5[_t],mn=mp(ut,Uv,nn,_t<400?-1:1);if(!mn)throw new Error("Could not find a matching font-weight for value "+_t);return mn})(ct.weight,Ft)))throw new Error("Failed to resolve a font for the rule '"+yp(ct)+"'.");return Ft})(pt,Ke);this.pdf.setFont(It.ref.name,It.ref.style)}else{var at="";(ht==="bold"||parseInt(ht,10)>=700||St==="bold")&&(at="bold"),St==="italic"&&(at+="italic"),at.length===0&&(at="normal");for(var lt="",Dt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},gt=0;gt<Ne.length;gt++){if(this.pdf.internal.getFont(Ne[gt],at,{noFallback:!0,disableWarning:!0})!==void 0){lt=Ne[gt];break}if(at==="bolditalic"&&this.pdf.internal.getFont(Ne[gt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)lt=Ne[gt],at="bold";else if(this.pdf.internal.getFont(Ne[gt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){lt=Ne[gt],at="normal";break}}if(lt===""){for(var Je=0;Je<Ne.length;Je++)if(Dt[Ne[Je]]){lt=Dt[Ne[Je]];break}}lt=lt===""?"Times":lt,this.pdf.setFont(lt,at)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(he){this.ctx.globalCompositeOperation=he}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(he){this.ctx.globalAlpha=he}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(he){this.ctx.lineDashOffset=he,_e.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(he){this.ctx.lineDash=he,_e.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(he){this.ctx.ignoreClearRect=!!he}})};p.prototype.setLineDash=function(R){this.lineDash=R},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){P.call(this,"fill",!1)},p.prototype.stroke=function(){P.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(R,O){if(isNaN(R)||isNaN(O))throw Ot.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var V=this.ctx.transform.applyToPoint(new s(R,O));this.path.push({type:"mt",x:V.x,y:V.y}),this.ctx.lastPoint=new s(R,O)},p.prototype.closePath=function(){var R=new s(0,0),O=0;for(O=this.path.length-1;O!==-1;O--)if(this.path[O].type==="begin"&&Bt(this.path[O+1])==="object"&&typeof this.path[O+1].x=="number"){R=new s(this.path[O+1].x,this.path[O+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(R.x,R.y)},p.prototype.lineTo=function(R,O){if(isNaN(R)||isNaN(O))throw Ot.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var V=this.ctx.transform.applyToPoint(new s(R,O));this.path.push({type:"lt",x:V.x,y:V.y}),this.ctx.lastPoint=new s(V.x,V.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),P.call(this,null,!0)},p.prototype.quadraticCurveTo=function(R,O,V,Q){if(isNaN(V)||isNaN(Q)||isNaN(R)||isNaN(O))throw Ot.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ne=this.ctx.transform.applyToPoint(new s(V,Q)),le=this.ctx.transform.applyToPoint(new s(R,O));this.path.push({type:"qct",x1:le.x,y1:le.y,x:ne.x,y:ne.y}),this.ctx.lastPoint=new s(ne.x,ne.y)},p.prototype.bezierCurveTo=function(R,O,V,Q,ne,le){if(isNaN(ne)||isNaN(le)||isNaN(R)||isNaN(O)||isNaN(V)||isNaN(Q))throw Ot.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var de=this.ctx.transform.applyToPoint(new s(ne,le)),ue=this.ctx.transform.applyToPoint(new s(R,O)),we=this.ctx.transform.applyToPoint(new s(V,Q));this.path.push({type:"bct",x1:ue.x,y1:ue.y,x2:we.x,y2:we.y,x:de.x,y:de.y}),this.ctx.lastPoint=new s(de.x,de.y)},p.prototype.arc=function(R,O,V,Q,ne,le){if(isNaN(R)||isNaN(O)||isNaN(V)||isNaN(Q)||isNaN(ne))throw Ot.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(le=!!le,!this.ctx.transform.isIdentity){var de=this.ctx.transform.applyToPoint(new s(R,O));R=de.x,O=de.y;var ue=this.ctx.transform.applyToPoint(new s(0,V)),we=this.ctx.transform.applyToPoint(new s(0,0));V=Math.sqrt(Math.pow(ue.x-we.x,2)+Math.pow(ue.y-we.y,2))}Math.abs(ne-Q)>=2*Math.PI&&(Q=0,ne=2*Math.PI),this.path.push({type:"arc",x:R,y:O,radius:V,startAngle:Q,endAngle:ne,counterclockwise:le})},p.prototype.arcTo=function(R,O,V,Q,ne){throw new Error("arcTo not implemented.")},p.prototype.rect=function(R,O,V,Q){if(isNaN(R)||isNaN(O)||isNaN(V)||isNaN(Q))throw Ot.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(R,O),this.lineTo(R+V,O),this.lineTo(R+V,O+Q),this.lineTo(R,O+Q),this.lineTo(R,O),this.lineTo(R+V,O),this.lineTo(R,O)},p.prototype.fillRect=function(R,O,V,Q){if(isNaN(R)||isNaN(O)||isNaN(V)||isNaN(Q))throw Ot.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var ne={};this.lineCap!=="butt"&&(ne.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ne.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(R,O,V,Q),this.fill(),ne.hasOwnProperty("lineCap")&&(this.lineCap=ne.lineCap),ne.hasOwnProperty("lineJoin")&&(this.lineJoin=ne.lineJoin)}},p.prototype.strokeRect=function(R,O,V,Q){if(isNaN(R)||isNaN(O)||isNaN(V)||isNaN(Q))throw Ot.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");S.call(this)||(this.beginPath(),this.rect(R,O,V,Q),this.stroke())},p.prototype.clearRect=function(R,O,V,Q){if(isNaN(R)||isNaN(O)||isNaN(V)||isNaN(Q))throw Ot.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(R,O,V,Q))},p.prototype.save=function(R){R=typeof R!="boolean"||R;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("q");if(this.pdf.setPage(O),R){this.ctx.fontSize=this.pdf.internal.getFontSize();var Q=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Q}},p.prototype.restore=function(R){R=typeof R!="boolean"||R;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("Q");this.pdf.setPage(O),R&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var v=function(R){var O,V,Q,ne;if(R.isCanvasGradient===!0&&(R=R.getColor()),!R)return{r:0,g:0,b:0,a:0,style:R};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(R))O=0,V=0,Q=0,ne=0;else{var le=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(R);if(le!==null)O=parseInt(le[1]),V=parseInt(le[2]),Q=parseInt(le[3]),ne=1;else if((le=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(R))!==null)O=parseInt(le[1]),V=parseInt(le[2]),Q=parseInt(le[3]),ne=parseFloat(le[4]);else{if(ne=1,typeof R=="string"&&R.charAt(0)!=="#"){var de=new Lv(R);R=de.ok?de.toHex():"#000000"}R.length===4?(O=R.substring(1,2),O+=O,V=R.substring(2,3),V+=V,Q=R.substring(3,4),Q+=Q):(O=R.substring(1,3),V=R.substring(3,5),Q=R.substring(5,7)),O=parseInt(O,16),V=parseInt(V,16),Q=parseInt(Q,16)}}return{r:O,g:V,b:Q,a:ne,style:R}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},S=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(R,O,V,Q){if(isNaN(O)||isNaN(V)||typeof R!="string")throw Ot.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Q=isNaN(Q)?void 0:Q,!m.call(this)){var ne=ae(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;F.call(this,{text:R,x:O,y:V,scale:le,angle:ne,align:this.textAlign,maxWidth:Q})}},p.prototype.strokeText=function(R,O,V,Q){if(isNaN(O)||isNaN(V)||typeof R!="string")throw Ot.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!S.call(this)){Q=isNaN(Q)?void 0:Q;var ne=ae(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;F.call(this,{text:R,x:O,y:V,scale:le,renderingMode:"stroke",angle:ne,align:this.textAlign,maxWidth:Q})}},p.prototype.measureText=function(R){if(typeof R!="string")throw Ot.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var O=this.pdf,V=this.pdf.internal.scaleFactor,Q=O.internal.getFontSize(),ne=O.getStringUnitWidth(R)*Q/O.internal.scaleFactor;return new function(le){var de=(le=le||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return de}}),this}({width:ne*=Math.round(96*V/72*1e4)/1e4})},p.prototype.scale=function(R,O){if(isNaN(R)||isNaN(O))throw Ot.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var V=new c(R,0,0,O,0,0);this.ctx.transform=this.ctx.transform.multiply(V)},p.prototype.rotate=function(R){if(isNaN(R))throw Ot.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var O=new c(Math.cos(R),Math.sin(R),-Math.sin(R),Math.cos(R),0,0);this.ctx.transform=this.ctx.transform.multiply(O)},p.prototype.translate=function(R,O){if(isNaN(R)||isNaN(O))throw Ot.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var V=new c(1,0,0,1,R,O);this.ctx.transform=this.ctx.transform.multiply(V)},p.prototype.transform=function(R,O,V,Q,ne,le){if(isNaN(R)||isNaN(O)||isNaN(V)||isNaN(Q)||isNaN(ne)||isNaN(le))throw Ot.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var de=new c(R,O,V,Q,ne,le);this.ctx.transform=this.ctx.transform.multiply(de)},p.prototype.setTransform=function(R,O,V,Q,ne,le){R=isNaN(R)?1:R,O=isNaN(O)?0:O,V=isNaN(V)?0:V,Q=isNaN(Q)?1:Q,ne=isNaN(ne)?0:ne,le=isNaN(le)?0:le,this.ctx.transform=new c(R,O,V,Q,ne,le)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(R,O,V,Q,ne,le,de,ue,we){var Ie=this.pdf.getImageProperties(R),Re=1,Me=1,he=1,H=1;Q!==void 0&&ue!==void 0&&(he=ue/Q,H=we/ne,Re=Ie.width/Q*ue/Q,Me=Ie.height/ne*we/ne),le===void 0&&(le=O,de=V,O=0,V=0),Q!==void 0&&ue===void 0&&(ue=Q,we=ne),Q===void 0&&ue===void 0&&(ue=Ie.width,we=Ie.height);for(var St,ht=this.ctx.transform.decompose(),je=ae(ht.rotate.shx),ke=new c,We=(ke=(ke=(ke=ke.multiply(ht.translate)).multiply(ht.skew)).multiply(ht.scale)).applyToRectangle(new a(le-O*he,de-V*H,Q*Re,ne*Me)),Ne=E.call(this,We),pt=[],Ke=0;Ke<Ne.length;Ke+=1)pt.indexOf(Ne[Ke])===-1&&pt.push(Ne[Ke]);if(I(pt),this.autoPaging)for(var It=pt[0],at=pt[pt.length-1],lt=It;lt<at+1;lt++){this.pdf.setPage(lt);var Dt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],gt=lt===1?this.posY+this.margin[0]:this.margin[0],Je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ze=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ye=lt===1?0:Je+(lt-2)*Ze;if(this.ctx.clip_path.length!==0){var Ht=this.path;St=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(St,this.posX+this.margin[3],-Ye+gt+this.ctx.prevPageLastElemOffset),G.call(this,"fill",!0),this.path=Ht}var kt=JSON.parse(JSON.stringify(We));kt=k([kt],this.posX+this.margin[3],-Ye+gt+this.ctx.prevPageLastElemOffset)[0];var Ve=(lt>It||lt<at)&&_.call(this);Ve&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Dt,Ze,null).clip().discardPath()),this.pdf.addImage(R,"JPEG",kt.x,kt.y,kt.w,kt.h,null,null,je),Ve&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(R,"JPEG",We.x,We.y,We.w,We.h,null,null,je)};var E=function(R,O,V){var Q=[];O=O||this.pdf.internal.pageSize.width,V=V||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ne=this.posY+this.ctx.prevPageLastElemOffset;switch(R.type){default:case"mt":case"lt":Q.push(Math.floor((R.y+ne)/V)+1);break;case"arc":Q.push(Math.floor((R.y+ne-R.radius)/V)+1),Q.push(Math.floor((R.y+ne+R.radius)/V)+1);break;case"qct":var le=ve(this.ctx.lastPoint.x,this.ctx.lastPoint.y,R.x1,R.y1,R.x,R.y);Q.push(Math.floor((le.y+ne)/V)+1),Q.push(Math.floor((le.y+le.h+ne)/V)+1);break;case"bct":var de=xe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,R.x1,R.y1,R.x2,R.y2,R.x,R.y);Q.push(Math.floor((de.y+ne)/V)+1),Q.push(Math.floor((de.y+de.h+ne)/V)+1);break;case"rect":Q.push(Math.floor((R.y+ne)/V)+1),Q.push(Math.floor((R.y+R.h+ne)/V)+1)}for(var ue=0;ue<Q.length;ue+=1)for(;this.pdf.internal.getNumberOfPages()<Q[ue];)C.call(this);return Q},C=function(){var R=this.fillStyle,O=this.strokeStyle,V=this.font,Q=this.lineCap,ne=this.lineWidth,le=this.lineJoin;this.pdf.addPage(),this.fillStyle=R,this.strokeStyle=O,this.font=V,this.lineCap=Q,this.lineWidth=ne,this.lineJoin=le},k=function(R,O,V){for(var Q=0;Q<R.length;Q++)switch(R[Q].type){case"bct":R[Q].x2+=O,R[Q].y2+=V;case"qct":R[Q].x1+=O,R[Q].y1+=V;default:R[Q].x+=O,R[Q].y+=V}return R},I=function(R){return R.sort(function(O,V){return O-V})},P=function(R,O){for(var V,Q,ne=this.fillStyle,le=this.strokeStyle,de=this.lineCap,ue=this.lineWidth,we=Math.abs(ue*this.ctx.transform.scaleX),Ie=this.lineJoin,Re=JSON.parse(JSON.stringify(this.path)),Me=JSON.parse(JSON.stringify(this.path)),he=[],H=0;H<Me.length;H++)if(Me[H].x!==void 0)for(var St=E.call(this,Me[H]),ht=0;ht<St.length;ht+=1)he.indexOf(St[ht])===-1&&he.push(St[ht]);for(var je=0;je<he.length;je++)for(;this.pdf.internal.getNumberOfPages()<he[je];)C.call(this);if(I(he),this.autoPaging)for(var ke=he[0],We=he[he.length-1],Ne=ke;Ne<We+1;Ne++){this.pdf.setPage(Ne),this.fillStyle=ne,this.strokeStyle=le,this.lineCap=de,this.lineWidth=we,this.lineJoin=Ie;var pt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ke=Ne===1?this.posY+this.margin[0]:this.margin[0],It=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],at=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],lt=Ne===1?0:It+(Ne-2)*at;if(this.ctx.clip_path.length!==0){var Dt=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(V,this.posX+this.margin[3],-lt+Ke+this.ctx.prevPageLastElemOffset),G.call(this,R,!0),this.path=Dt}if(Q=JSON.parse(JSON.stringify(Re)),this.path=k(Q,this.posX+this.margin[3],-lt+Ke+this.ctx.prevPageLastElemOffset),O===!1||Ne===0){var gt=(Ne>ke||Ne<We)&&_.call(this);gt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],pt,at,null).clip().discardPath()),G.call(this,R,O),gt&&this.pdf.restoreGraphicsState()}this.lineWidth=ue}else this.lineWidth=we,G.call(this,R,O),this.lineWidth=ue;this.path=Re},G=function(R,O){if((R!=="stroke"||O||!S.call(this))&&(R==="stroke"||O||!m.call(this))){for(var V,Q,ne=[],le=this.path,de=0;de<le.length;de++){var ue=le[de];switch(ue.type){case"begin":ne.push({begin:!0});break;case"close":ne.push({close:!0});break;case"mt":ne.push({start:ue,deltas:[],abs:[]});break;case"lt":var we=ne.length;if(le[de-1]&&!isNaN(le[de-1].x)&&(V=[ue.x-le[de-1].x,ue.y-le[de-1].y],we>0)){for(;we>=0;we--)if(ne[we-1].close!==!0&&ne[we-1].begin!==!0){ne[we-1].deltas.push(V),ne[we-1].abs.push(ue);break}}break;case"bct":V=[ue.x1-le[de-1].x,ue.y1-le[de-1].y,ue.x2-le[de-1].x,ue.y2-le[de-1].y,ue.x-le[de-1].x,ue.y-le[de-1].y],ne[ne.length-1].deltas.push(V);break;case"qct":var Ie=le[de-1].x+2/3*(ue.x1-le[de-1].x),Re=le[de-1].y+2/3*(ue.y1-le[de-1].y),Me=ue.x+2/3*(ue.x1-ue.x),he=ue.y+2/3*(ue.y1-ue.y),H=ue.x,St=ue.y;V=[Ie-le[de-1].x,Re-le[de-1].y,Me-le[de-1].x,he-le[de-1].y,H-le[de-1].x,St-le[de-1].y],ne[ne.length-1].deltas.push(V);break;case"arc":ne.push({deltas:[],abs:[],arc:!0}),Array.isArray(ne[ne.length-1].abs)&&ne[ne.length-1].abs.push(ue)}}Q=O?null:R==="stroke"?"stroke":"fill";for(var ht=!1,je=0;je<ne.length;je++)if(ne[je].arc)for(var ke=ne[je].abs,We=0;We<ke.length;We++){var Ne=ke[We];Ne.type==="arc"?Y.call(this,Ne.x,Ne.y,Ne.radius,Ne.startAngle,Ne.endAngle,Ne.counterclockwise,void 0,O,!ht):J.call(this,Ne.x,Ne.y),ht=!0}else if(ne[je].close===!0)this.pdf.internal.out("h"),ht=!1;else if(ne[je].begin!==!0){var pt=ne[je].start.x,Ke=ne[je].start.y;W.call(this,ne[je].deltas,pt,Ke),ht=!0}Q&&D.call(this,Q),O&&Z.call(this)}},ee=function(R){var O=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,V=O*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return R-V;case"top":return R+O-V;case"hanging":return R+O-2*V;case"middle":return R+O/2-V;default:return R}},te=function(R){return R+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var R=function(){};return R.colorStops=[],R.addColorStop=function(O,V){this.colorStops.push([O,V])},R.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},R.isCanvasGradient=!0,R},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var Y=function(R,O,V,Q,ne,le,de,ue,we){for(var Ie=fe.call(this,V,Q,ne,le),Re=0;Re<Ie.length;Re++){var Me=Ie[Re];Re===0&&(we?N.call(this,Me.x1+R,Me.y1+O):J.call(this,Me.x1+R,Me.y1+O)),ce.call(this,R,O,Me.x2,Me.y2,Me.x3,Me.y3,Me.x4,Me.y4)}ue?Z.call(this):D.call(this,de)},D=function(R){switch(R){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Z=function(){this.pdf.clip(),this.pdf.discardPath()},N=function(R,O){this.pdf.internal.out(n(R)+" "+i(O)+" m")},F=function(R){var O;switch(R.align){case"right":case"end":O="right";break;case"center":O="center";break;default:O="left"}var V=this.pdf.getTextDimensions(R.text),Q=ee.call(this,R.y),ne=te.call(this,Q)-V.h,le=this.ctx.transform.applyToPoint(new s(R.x,Q)),de=this.ctx.transform.decompose(),ue=new c;ue=(ue=(ue=ue.multiply(de.translate)).multiply(de.skew)).multiply(de.scale);for(var we,Ie,Re,Me=this.ctx.transform.applyToRectangle(new a(R.x,Q,V.w,V.h)),he=ue.applyToRectangle(new a(R.x,ne,V.w,V.h)),H=E.call(this,he),St=[],ht=0;ht<H.length;ht+=1)St.indexOf(H[ht])===-1&&St.push(H[ht]);if(I(St),this.autoPaging)for(var je=St[0],ke=St[St.length-1],We=je;We<ke+1;We++){this.pdf.setPage(We);var Ne=We===1?this.posY+this.margin[0]:this.margin[0],pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ke=this.pdf.internal.pageSize.height-this.margin[2],It=Ke-this.margin[0],at=this.pdf.internal.pageSize.width-this.margin[1],lt=at-this.margin[3],Dt=We===1?0:pt+(We-2)*It;if(this.ctx.clip_path.length!==0){var gt=this.path;we=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(we,this.posX+this.margin[3],-1*Dt+Ne),G.call(this,"fill",!0),this.path=gt}var Je=k([JSON.parse(JSON.stringify(he))],this.posX+this.margin[3],-Dt+Ne+this.ctx.prevPageLastElemOffset)[0];R.scale>=.01&&(Ie=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ie*R.scale),Re=this.lineWidth,this.lineWidth=Re*R.scale);var Ze=this.autoPaging!=="text";if(Ze||Je.y+Je.h<=Ke){if(Ze||Je.y>=Ne&&Je.x<=at){var Ye=Ze?R.text:this.pdf.splitTextToSize(R.text,R.maxWidth||at-Je.x)[0],Ht=k([JSON.parse(JSON.stringify(Me))],this.posX+this.margin[3],-Dt+Ne+this.ctx.prevPageLastElemOffset)[0],kt=Ze&&(We>je||We<ke)&&_.call(this);kt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lt,It,null).clip().discardPath()),this.pdf.text(Ye,Ht.x,Ht.y,{angle:R.angle,align:O,renderingMode:R.renderingMode}),kt&&this.pdf.restoreGraphicsState()}}else Je.y<Ke&&(this.ctx.prevPageLastElemOffset+=Ke-Je.y);R.scale>=.01&&(this.pdf.setFontSize(Ie),this.lineWidth=Re)}else R.scale>=.01&&(Ie=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ie*R.scale),Re=this.lineWidth,this.lineWidth=Re*R.scale),this.pdf.text(R.text,le.x+this.posX,le.y+this.posY,{angle:R.angle,align:O,renderingMode:R.renderingMode,maxWidth:R.maxWidth}),R.scale>=.01&&(this.pdf.setFontSize(Ie),this.lineWidth=Re)},J=function(R,O,V,Q){V=V||0,Q=Q||0,this.pdf.internal.out(n(R+V)+" "+i(O+Q)+" l")},W=function(R,O,V){return this.pdf.lines(R,O,V,null,null)},ce=function(R,O,V,Q,ne,le,de,ue){this.pdf.internal.out([e(r(V+R)),e(o(Q+O)),e(r(ne+R)),e(o(le+O)),e(r(de+R)),e(o(ue+O)),"c"].join(" "))},fe=function(R,O,V,Q){for(var ne=2*Math.PI,le=Math.PI/2;O>V;)O-=ne;var de=Math.abs(V-O);de<ne&&Q&&(de=ne-de);for(var ue=[],we=Q?-1:1,Ie=O;de>1e-5;){var Re=Ie+we*Math.min(de,le);ue.push(ge.call(this,R,Ie,Re)),de-=Math.abs(Re-Ie),Ie=Re}return ue},ge=function(R,O,V){var Q=(V-O)/2,ne=R*Math.cos(Q),le=R*Math.sin(Q),de=ne,ue=-le,we=de*de+ue*ue,Ie=we+de*ne+ue*le,Re=4/3*(Math.sqrt(2*we*Ie)-Ie)/(de*le-ue*ne),Me=de-Re*ue,he=ue+Re*de,H=Me,St=-he,ht=Q+O,je=Math.cos(ht),ke=Math.sin(ht);return{x1:R*Math.cos(O),y1:R*Math.sin(O),x2:Me*je-he*ke,y2:Me*ke+he*je,x3:H*je-St*ke,y3:H*ke+St*je,x4:R*Math.cos(V),y4:R*Math.sin(V)}},ae=function(R){return 180*R/Math.PI},ve=function(R,O,V,Q,ne,le){var de=R+.5*(V-R),ue=O+.5*(Q-O),we=ne+.5*(V-ne),Ie=le+.5*(Q-le),Re=Math.min(R,ne,de,we),Me=Math.max(R,ne,de,we),he=Math.min(O,le,ue,Ie),H=Math.max(O,le,ue,Ie);return new a(Re,he,Me-Re,H-he)},xe=function(R,O,V,Q,ne,le,de,ue){var we,Ie,Re,Me,he,H,St,ht,je,ke,We,Ne,pt,Ke,It=V-R,at=Q-O,lt=ne-V,Dt=le-Q,gt=de-ne,Je=ue-le;for(Ie=0;Ie<41;Ie++)je=(St=(Re=R+(we=Ie/40)*It)+we*((he=V+we*lt)-Re))+we*(he+we*(ne+we*gt-he)-St),ke=(ht=(Me=O+we*at)+we*((H=Q+we*Dt)-Me))+we*(H+we*(le+we*Je-H)-ht),Ie==0?(We=je,Ne=ke,pt=je,Ke=ke):(We=Math.min(We,je),Ne=Math.min(Ne,ke),pt=Math.max(pt,je),Ke=Math.max(Ke,ke));return new a(Math.round(We),Math.round(Ne),Math.round(pt-We),Math.round(Ke-Ne))},_e=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var R,O,V=(R=this.ctx.lineDash,O=this.ctx.lineDashOffset,JSON.stringify({lineDash:R,lineDashOffset:O}));this.prevLineDash!==V&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=V)}}})(Oe.API),(function(t){var e=function(s){var a,c,u,f,p,v,m,S,_,E;for(c=[],u=0,f=(s+=a="\0\0\0\0".slice(s.length%4||4)).length;f>u;u+=4)(p=(s.charCodeAt(u)<<24)+(s.charCodeAt(u+1)<<16)+(s.charCodeAt(u+2)<<8)+s.charCodeAt(u+3))!==0?(v=(p=((p=((p=((p=(p-(E=p%85))/85)-(_=p%85))/85)-(S=p%85))/85)-(m=p%85))/85)%85,c.push(v+33,m+33,S+33,_+33,E+33)):c.push(122);return(function(C,k){for(var I=k;I>0;I--)C.pop()})(c,a.length),String.fromCharCode.apply(String,c)+"~>"},n=function(s){var a,c,u,f,p,v=String,m="length",S=255,_="charCodeAt",E="slice",C="replace";for(s[E](-2),s=s[E](0,-2)[C](/\s/g,"")[C]("z","!!!!!"),u=[],f=0,p=(s+=a="uuuuu"[E](s[m]%5||5))[m];p>f;f+=5)c=52200625*(s[_](f)-33)+614125*(s[_](f+1)-33)+7225*(s[_](f+2)-33)+85*(s[_](f+3)-33)+(s[_](f+4)-33),u.push(S&c>>24,S&c>>16,S&c>>8,S&c);return(function(k,I){for(var P=I;P>0;P--)k.pop()})(u,a[m]),v.fromCharCode.apply(v,u)},i=function(s){return s.split("").map(function(a){return("0"+a.charCodeAt().toString(16)).slice(-2)}).join("")+">"},r=function(s){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),a.test(s)===!1)return"";for(var c="",u=0;u<s.length;u+=2)c+=String.fromCharCode("0x"+(s[u]+s[u+1]));return c},o=function(s){for(var a=new Uint8Array(s.length),c=s.length;c--;)a[c]=s.charCodeAt(c);return(a=cd(a)).reduce(function(u,f){return u+String.fromCharCode(f)},"")};t.processDataByFilters=function(s,a){var c=0,u=s||"",f=[];for(typeof(a=a||[])=="string"&&(a=[a]),c=0;c<a.length;c+=1)switch(a[c]){case"ASCII85Decode":case"/ASCII85Decode":u=n(u),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=r(u),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=i(u),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=o(u),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[c]+'" is not implemented')}return{data:u,reverseChain:f.reverse().join(" ")}}})(Oe.API),(function(t){t.loadFile=function(e,n,i){return(function(r,o,s){o=o!==!1,s=typeof s=="function"?s:function(){};var a=void 0;try{a=(function(c,u,f){var p=new XMLHttpRequest,v=0,m=function(S){var _=S.length,E=[],C=String.fromCharCode;for(v=0;v<_;v+=1)E.push(C(255&S.charCodeAt(v)));return E.join("")};if(p.open("GET",c,!u),p.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(p.onload=function(){p.status===200?f(m(this.responseText)):f(void 0)}),p.send(null),u&&p.status===200)return m(p.responseText)})(r,o,s)}catch{}return a})(e,n,i)},t.loadImageFile=t.loadFile})(Oe.API),(function(t){function e(){return(et.html2canvas?Promise.resolve(et.html2canvas):Xr(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function n(){return(et.DOMPurify?Promise.resolve(et.DOMPurify):Xr(()=>import("./purify.es-aGzT-_H7.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var i=function(a){var c=Bt(a);return c==="undefined"?"undefined":c==="string"||a instanceof String?"string":c==="number"||a instanceof Number?"number":c==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":c==="object"?"object":"unknown"},r=function(a,c){var u=document.createElement(a);for(var f in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[f]=c.style[f];return u},o=function a(c,u){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)u!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||f.appendChild(a(p,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f},s=function a(c){var u=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),f=a.convert(Promise.resolve(),u);return(f=f.setProgress(1,a,1,[a])).set(c)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(a,c){return a.__proto__=c||s.prototype,a},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(a,c){return this.then(function(){switch(c=c||(function(u){switch(i(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(a),c){case"string":return this.then(n).then(function(u){return this.set({src:r("div",{innerHTML:a,dompurify:u})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},s.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=o(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(c){var u=this.opt.jsPDF,f=this.opt.fontFaces,p=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,v=Object.assign({async:!0,allowTaint:!0,scale:p,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete v.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=f,f)for(var m=0;m<f.length;++m){var S=f[m],_=S.src.find(function(E){return E.format==="truetype"});_&&u.addFont(_.url,S.ref.name,S.ref.style)}return v.windowHeight=v.windowHeight||0,v.windowHeight=v.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):v.windowHeight,u.context2d.save(!0),c(this.prop.container,v)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(a,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(a,c):this.outputPdf(a,c)},s.prototype.outputPdf=function(a,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,c)})},s.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},s.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(a){if(i(a)!=="object")return this;var c=Object.keys(a||{}).map(function(u){if(u in s.template.prop)return function(){this.prop[u]=a[u]};switch(u){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[u]=a[u]}}},this);return this.then(function(){return this.thenList(c)})},s.prototype.get=function(a,c){return this.then(function(){var u=a in s.template.prop?this.prop[a]:this.opt[a];return c?c(u):u})},s.prototype.setMargin=function(a){return this.then(function(){switch(i(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},s.prototype.setPageSize=function(a){function c(u,f){return Math.floor(u*f/72*96)}return this.then(function(){(a=a||Oe.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:c(a.inner.width,a.k),height:c(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},s.prototype.setProgress=function(a,c,u,f){return a!=null&&(this.progress.val=a),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(a,c,u,f){return this.setProgress(a?this.progress.val+a:null,c||null,u?this.progress.n+u:null,f?this.progress.stack.concat(f):null)},s.prototype.then=function(a,c){var u=this;return this.thenCore(a,c,function(f,p){return u.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(v){return u.updateProgress(null,f),v}).then(f,p).then(function(v){return u.updateProgress(1),v})})},s.prototype.thenCore=function(a,c,u){u=u||Promise.prototype.then;var f=this;a&&(a=a.bind(f)),c&&(c=c.bind(f));var p=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:s.convert(Object.assign({},f),Promise.prototype),v=u.call(p,a,c);return s.convert(v,f.__proto__)},s.prototype.thenExternal=function(a,c){return Promise.prototype.then.call(this,a,c)},s.prototype.thenList=function(a){var c=this;return a.forEach(function(u){c=c.thenCore(u)}),c},s.prototype.catch=function(a){a&&(a=a.bind(this));var c=Promise.prototype.catch.call(this,a);return s.convert(c,this)},s.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},s.prototype.error=function(a){return this.then(function(){throw new Error(a)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,Oe.getPageSize=function(a,c,u){if(Bt(a)==="object"){var f=a;a=f.orientation,c=f.unit||c,u=f.format||u}c=c||"mm",u=u||"a4",a=(""+(a||"P")).toLowerCase();var p,v=(""+u).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":p=1;break;case"mm":p=72/25.4;break;case"cm":p=72/2.54;break;case"in":p=72;break;case"px":p=.75;break;case"pc":case"em":p=12;break;case"ex":p=6;break;default:throw"Invalid unit: "+c}var S,_=0,E=0;if(m.hasOwnProperty(v))_=m[v][1]/p,E=m[v][0]/p;else try{_=u[1],E=u[0]}catch{throw new Error("Invalid format: "+u)}if(a==="p"||a==="portrait")a="p",E>_&&(S=E,E=_,_=S);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",_>E&&(S=E,E=_,_=S)}return{width:E,height:_,unit:c,k:p,orientation:a}},t.html=function(a,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(Pu):null;var u=new s(c);return c.worker?u:u.from(a).doCallback()}})(Oe.API),Oe.API.addJS=function(t){return Sp=t,this.internal.events.subscribe("postPutResources",function(){Rl=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Rl+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),wp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Sp+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Rl!==void 0&&wp!==void 0&&this.internal.out("/Names <</JavaScript "+Rl+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var n=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=n.outline.render().split(/\r\n/),o=0;o<r.length;o++){var s=r[o],a=i.exec(s);if(a!=null){var c=a[1];n.internal.newObjectDeferredBegin(c,!1)}n.internal.write(s)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(o=0;o<u;o++){var p=n.internal.newObject();f.push(p);var v=n.internal.getPageInfo(o+1);n.internal.write("<< /D["+v.objId+" 0 R /XYZ null null null]>> endobj")}var m=n.internal.newObject();for(n.internal.write("<< /Names [ "),o=0;o<f.length;o++)n.internal.write("(page_"+(o+1)+")"+f[o]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+m+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(i,r,o){var s={title:r,options:o,children:[]};return i==null&&(i=this.root),i.children.push(s),s},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(i){i.id=n.internal.newObjectDeferred();for(var r=0;r<i.children.length;r++)this.genIds_r(i.children[r])},n.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},n.outline.renderItems=function(i){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<i.children.length;o++){var s=i.children[o];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(i)),o>0&&this.line("/Prev "+this.makeRef(i.children[o-1])),o<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[o+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var a=this.count=this.count_r({count:0},s);if(a>0&&this.line("/Count "+a),s.options&&s.options.pageNumber){var c=n.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var u=0;u<i.children.length;u++)this.renderItems(i.children[u])},n.outline.line=function(i){this.ctx.val+=i+`\r
`},n.outline.makeRef=function(i){return i.id+" 0 R"},n.outline.makeString=function(i){return"("+n.internal.pdfEscape(i)+")"},n.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(i,r){for(var o=0;o<r.children.length;o++)i.count++,this.count_r(i,r.children[o]);return i.count}}])})(Oe.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,i,r,o,s,a){var c,u=this.decode.DCT_DECODE,f=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=s||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,c=(function(p){for(var v,m=256*p.charCodeAt(4)+p.charCodeAt(5),S=p.length,_={width:0,height:0,numcomponents:1},E=4;E<S;E+=2){if(E+=m,e.indexOf(p.charCodeAt(E+1))!==-1){v=256*p.charCodeAt(E+5)+p.charCodeAt(E+6),_={width:256*p.charCodeAt(E+7)+p.charCodeAt(E+8),height:v,numcomponents:p.charCodeAt(E+9)};break}m=256*p.charCodeAt(E+2)+p.charCodeAt(E+3)}return _})(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),c.numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}f={data:n,width:c.width,height:c.height,colorSpace:a,bitsPerComponent:8,filter:u,index:i,alias:r}}return f}})(Oe.API),Oe.API.processPNG=function(t,e,n,i){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var r,o=jb(t,{checkCrc:!0}),s=o.width,a=o.height,c=o.channels,u=o.palette,f=o.depth;r=u&&c===1?(function(Y){for(var D=Y.width,Z=Y.height,N=Y.data,F=Y.palette,J=Y.depth,W=!1,ce=[],fe=[],ge=void 0,ae=!1,ve=0,xe=0;xe<F.length;xe++){var _e=Th(F[xe],4),R=_e[0],O=_e[1],V=_e[2],Q=_e[3];ce.push(R,O,V),Q!=null&&(Q===0?(ve++,fe.length<1&&fe.push(xe)):Q<255&&(ae=!0))}if(ae||ve>1){W=!0,fe=void 0;var ne=D*Z;ge=new Uint8Array(ne);for(var le=new DataView(N.buffer),de=0;de<ne;de++){var ue=Ru(le,de,J),we=Th(F[ue],4)[3];ge[de]=we}}else ve===0&&(fe=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:W?8:void 0,colorBytes:N,alphaBytes:ge,needSMask:W,palette:ce,mask:fe}})(o):c===2||c===4?(function(Y){for(var D=Y.data,Z=Y.width,N=Y.height,F=Y.channels,J=Y.depth,W=F===2?"DeviceGray":"DeviceRGB",ce=F-1,fe=Z*N,ge=ce,ae=fe*ge,ve=1*fe,xe=Math.ceil(ae*J/8),_e=Math.ceil(ve*J/8),R=new Uint8Array(xe),O=new Uint8Array(_e),V=new DataView(D.buffer),Q=new DataView(R.buffer),ne=new DataView(O.buffer),le=!1,de=0;de<fe;de++){for(var ue=de*F,we=0;we<ge;we++)Lp(Q,Ru(V,ue+we,J),de*ge+we,J);var Ie=Ru(V,ue+ge,J);Ie<(1<<J)-1&&(le=!0),Lp(ne,Ie,1*de,J)}return{colorSpace:W,colorsPerPixel:ce,sMaskBitsPerComponent:le?J:void 0,colorBytes:R,alphaBytes:O,needSMask:le}})(o):(function(Y){var D=Y.data,Z=Y.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:Z,colorsPerPixel:Z==="DeviceGray"?1:3,colorBytes:D instanceof Uint16Array?(function(N){for(var F=N.length,J=new Uint8Array(2*F),W=new DataView(J.buffer,J.byteOffset,J.byteLength),ce=0;ce<F;ce++)W.setUint16(2*ce,N[ce],!1);return J})(D):D,needSMask:!1}})(o);var p,v,m,S=r,_=S.colorSpace,E=S.colorsPerPixel,C=S.sMaskBitsPerComponent,k=S.colorBytes,I=S.alphaBytes,P=S.needSMask,G=S.palette,ee=S.mask,te=null;return i!==Oe.API.image_compression.NONE&&typeof cd=="function"?(te=(function(Y){var D;switch(Y){case Oe.API.image_compression.FAST:D=11;break;case Oe.API.image_compression.MEDIUM:D=13;break;case Oe.API.image_compression.SLOW:D=14;break;default:D=12}return D})(i),p=this.decode.FLATE_DECODE,v="/Predictor ".concat(te," /Colors ").concat(E," /BitsPerComponent ").concat(f," /Columns ").concat(s),t=Tp(k,Math.ceil(s*E*f/8),E,f,i),P&&(m=Tp(I,Math.ceil(s*C/8),1,C,i))):(p=void 0,v=void 0,t=k,P&&(m=I)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(m&&this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),{alias:n,data:t,index:e,filter:p,decodeParameters:v,transparency:ee,palette:G,sMask:m,predictor:te,width:s,height:a,bitsPerComponent:f,sMaskBitsPerComponent:C,colorSpace:_}}},(function(t){t.processGIF89A=function(e,n,i,r){var o=new v5(e),s=o.width,a=o.height,c=[];o.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:s,height:a},f=new Mu(100).encode(u,100);return t.processJPEG.call(this,f,n,i,r)},t.processGIF87A=t.processGIF89A})(Oe.API),Ni.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:r,green:i,blue:n,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ni.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(n){Ot.log("bit decode error:"+n)}},Ni.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<e;r++)for(var o=this.datav.getUint8(this.pos++,!0),s=i*this.width*4+8*r*4,a=0;a<8&&8*r+a<this.width;a++){var c=this.palette[o>>7-a&1];this.data[s+4*a]=c.blue,this.data[s+4*a+1]=c.green,this.data[s+4*a+2]=c.red,this.data[s+4*a+3]=255}n!==0&&(this.pos+=4-n)}},Ni.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,r=0;r<t;r++){var o=this.datav.getUint8(this.pos++,!0),s=i*this.width*4+2*r*4,a=o>>4,c=15&o,u=this.palette[a];if(this.data[s]=u.blue,this.data[s+1]=u.green,this.data[s+2]=u.red,this.data[s+3]=255,2*r+1>=this.width)break;u=this.palette[c],this.data[s+4]=u.blue,this.data[s+4+1]=u.green,this.data[s+4+2]=u.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},Ni.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<this.width;i++){var r=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+4*i;if(r<this.palette.length){var s=this.palette[r];this.data[o]=s.red,this.data[o+1]=s.green,this.data[o+2]=s.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}t!==0&&(this.pos+=4-t)}},Ni.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,a=(o>>5&e)/e*255|0,c=(o>>10&e)/e*255|0,u=o>>15?255:0,f=i*this.width*4+4*r;this.data[f]=c,this.data[f+1]=a,this.data[f+2]=s,this.data[f+3]=u}this.pos+=t}},Ni.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var r=this.bottom_up?i:this.height-1-i,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,c=(s>>5&n)/n*255|0,u=(s>>11)/e*255|0,f=r*this.width*4+4*o;this.data[f]=u,this.data[f+1]=c,this.data[f+2]=a,this.data[f+3]=255}this.pos+=t}},Ni.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*n;this.data[s]=o,this.data[s+1]=r,this.data[s+2]=i,this.data[s+3]=255}this.pos+=this.width%4}},Ni.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*n;this.data[a]=o,this.data[a+1]=r,this.data[a+2]=i,this.data[a+3]=s}},Ni.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,n,i,r){var o=new Ni(e,!1),s=o.width,a=o.height,c={data:o.getData(),width:s,height:a},u=new Mu(100).encode(c,100);return t.processJPEG.call(this,u,n,i,r)}})(Oe.API),Np.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,n,i,r){var o=new Np(e),s=o.width,a=o.height,c={data:o.getData(),width:s,height:a},u=new Mu(100).encode(c,100);return t.processJPEG.call(this,u,n,i,r)}})(Oe.API),Oe.API.processRGBA=function(t,e,n){for(var i=t.data,r=i.length,o=new Uint8Array(r/4*3),s=new Uint8Array(r/4),a=0,c=0,u=0;u<r;u+=4){var f=i[u],p=i[u+1],v=i[u+2],m=i[u+3];o[a++]=f,o[a++]=p,o[a++]=v,s[c++]=m}var S=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:S,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Oe.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ss=Oe.API,Ml=ss.getCharWidthsArray=function(t,e){var n,i,r=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:r.metadata.Unicode.widths,c=a.fof?a.fof:1,u=e.kerning?e.kerning:r.metadata.Unicode.kerning,f=u.fof?u.fof:1,p=e.doKerning!==!1,v=0,m=t.length,S=0,_=a[0]||c,E=[];for(n=0;n<m;n++)i=t.charCodeAt(n),typeof r.metadata.widthOfString=="function"?E.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(i))+s*(1e3/o)||0)/1e3):(v=p&&Bt(u[i])==="object"&&!isNaN(parseInt(u[i][S],10))?u[i][S]/f:0,E.push((a[i]||_)/c+v)),S=i;return E},_p=ss.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),i=e.font||this.internal.getFont(),r=e.charSpace||this.internal.getCharSpace();return ss.processArabic&&(t=ss.processArabic(t)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(t,n,r)/n:Ml.apply(this,arguments).reduce(function(o,s){return o+s},0)},Cp=function(t,e,n,i){for(var r=[],o=0,s=t.length,a=0;o!==s&&a+e[o]<n;)a+=e[o],o++;r.push(t.slice(0,o));var c=o;for(a=0;o!==s;)a+e[o]>i&&(r.push(t.slice(c,o)),a=0,c=o),a+=e[o],o++;return c!==o&&r.push(t.slice(c,o)),r},Ep=function(t,e,n){n||(n={});var i,r,o,s,a,c,u,f=[],p=[f],v=n.textIndent||0,m=0,S=0,_=t.split(" "),E=Ml.apply(this,[" ",n])[0];if(c=n.lineIndent===-1?_[0].length+2:n.lineIndent||0){var C=Array(c).join(" "),k=[];_.map(function(P){(P=P.split(/\s*\n/)).length>1?k=k.concat(P.map(function(G,ee){return(ee&&G.length?`
`:"")+G})):k.push(P[0])}),_=k,c=_p.apply(this,[C,n])}for(o=0,s=_.length;o<s;o++){var I=0;if(i=_[o],c&&i[0]==`
`&&(i=i.substr(1),I=1),v+m+(S=(r=Ml.apply(this,[i,n])).reduce(function(P,G){return P+G},0))>e||I){if(S>e){for(a=Cp.apply(this,[i,r,e-(v+m),e]),f.push(a.shift()),f=[a.pop()];a.length;)p.push([a.shift()]);S=r.slice(i.length-(f[0]?f[0].length:0)).reduce(function(P,G){return P+G},0)}else f=[i];p.push(f),v=S+c,m=E}else f.push(i),v+=m+S,m=E}return u=c?function(P,G){return(G?C:"")+P.join(" ")}:function(P){return P.join(" ")},p.map(u)},ss.splitTextToSize=function(t,e,n){var i,r=(n=n||{}).fontSize||this.internal.getFontSize(),o=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var p=this.internal.getFont(f.fontName,f.fontStyle),v="Unicode";return p.metadata[v]?{widths:p.metadata[v].widths||{0:1},kerning:p.metadata[v].kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);i=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/r;o.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/r:0,o.lineIndent=n.lineIndent;var a,c,u=[];for(a=0,c=i.length;a<c;a++)u=u.concat(Ep.apply(this,[i[a],s,o]));return u},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",n="klmnopqrstuvwxyz",i={},r={},o=0;o<16;o++)i[n[o]]=e[o],r[e[o]]=n[o];var s=function(v){return"0x"+parseInt(v,10).toString(16)},a=t.__fontmetrics__.compress=function(v){var m,S,_,E,C=["{"];for(var k in v){if(m=v[k],isNaN(parseInt(k,10))?S="'"+k+"'":(k=parseInt(k,10),S=(S=s(k).slice(2)).slice(0,-1)+r[S.slice(-1)]),typeof m=="number")m<0?(_=s(m).slice(3),E="-"):(_=s(m).slice(2),E=""),_=E+_.slice(0,-1)+r[_.slice(-1)];else{if(Bt(m)!=="object")throw new Error("Don't know what to do with value type "+Bt(m)+".");_=a(m)}C.push(S+_)}return C.push("}"),C.join("")},c=t.__fontmetrics__.uncompress=function(v){if(typeof v!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,S,_,E,C={},k=1,I=C,P=[],G="",ee="",te=v.length-1,Y=1;Y<te;Y+=1)(E=v[Y])=="'"?m?(_=m.join(""),m=void 0):m=[]:m?m.push(E):E=="{"?(P.push([I,_]),I={},_=void 0):E=="}"?((S=P.pop())[0][S[1]]=I,_=void 0,I=S[0]):E=="-"?k=-1:_===void 0?i.hasOwnProperty(E)?(G+=i[E],_=parseInt(G,16)*k,k=1,G=""):G+=E:i.hasOwnProperty(E)?(ee+=i[E],I[_]=parseInt(ee,16)*k,k=1,_=void 0,ee=""):ee+=E;return C},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},p={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(v){var m=v.font,S=p.Unicode[m.postScriptName];S&&(m.metadata.Unicode={},m.metadata.Unicode.widths=S.widths,m.metadata.Unicode.kerning=S.kerning);var _=f.Unicode[m.postScriptName];_&&(m.metadata.Unicode.encoding=_,m.encoding=_.codePages[0])}])})(Oe.API),(function(t){var e=function(n){for(var i=n.length,r=new Uint8Array(i),o=0;o<i;o++)r[o]=n.charCodeAt(o);return r};t.API.events.push(["addFont",function(n){var i=void 0,r=n.font,o=n.instance;if(!r.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(i=o.existsFileInVFS(r.postScriptName)===!1?o.loadFile(r.postScriptName):o.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(s,a){a=/^\x00\x01\x00\x00/.test(a)?e(a):e(Gl(a)),s.metadata=t.API.TTFFont.open(a),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(r,i)}}])})(Oe),Oe.API.addSvgAsImage=function(t,e,n,i,r,o,s,a){if(isNaN(e)||isNaN(n))throw Ot.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(r))throw Ot.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=i,c.height=r;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return(et.canvg?Promise.resolve(et.canvg):Xr(()=>import("./index.es-BYA8hYHx.js"),[])).catch(function(v){return Promise.reject(new Error("Could not load canvg: "+v))}).then(function(v){return v.default?v.default:v}).then(function(v){return v.fromString(u,t,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(v){return v.render(f)}).then(function(){p.addImage(c.toDataURL("image/jpeg",1),e,n,i,r,s,a)})},Oe.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var r=0;r<this.internal.pages[i].length;r++)this.internal.pages[i][r]=this.internal.pages[i][r].replace(e,n);return this},Oe.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var i,r,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(s),c=[],u=0,f=0,p=0;function v(S,_){var E,C=!1;for(E=0;E<S.length;E+=1)S[E]===_&&(C=!0);return C}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var m=a.length;for(p=0;p<m;p+=1)n[a[p]].value=n[a[p]].defaultValue,n[a[p]].explicitSet=!1}if(Bt(t)==="object"){for(r in t)if(o=t[r],v(a,r)&&o!==void 0){if(n[r].type==="boolean"&&typeof o=="boolean")n[r].value=o;else if(n[r].type==="name"&&v(n[r].valueSet,o))n[r].value=o;else if(n[r].type==="integer"&&Number.isInteger(o))n[r].value=o;else if(n[r].type==="array"){for(u=0;u<o.length;u+=1)if(i=!0,o[u].length===1&&typeof o[u][0]=="number")c.push(String(o[u]-1));else if(o[u].length>1){for(f=0;f<o[u].length;f+=1)typeof o[u][f]!="number"&&(i=!1);i===!0&&c.push([o[u][0]-1,o[u][1]-1].join(" "))}n[r].value="["+c.join(" ")+"]"}else n[r].value=n[r].defaultValue;n[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var S,_=[];for(S in n)n[S].explicitSet===!0&&(n[S].type==="name"?_.push("/"+S+" /"+n[S].value):_.push("/"+S+" "+n[S].value));_.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+_.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},(function(t){var e=function(){var i='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(i)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=o.length+s.length+a.length+r.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(r+o+s+a+c),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(i,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:i,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",e)),this}})(Oe.API),(function(t){var e=t.API,n=e.pdfEscape16=function(o,s){for(var a,c=s.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],p=0,v=o.length;p<v;++p){if(a=s.metadata.characterToGlyph(o.charCodeAt(p)),s.metadata.glyIdsUsed.push(a),s.metadata.toUnicode[a]=o.charCodeAt(p),c.indexOf(a)==-1&&(c.push(a),c.push([parseInt(s.metadata.widthOfGlyph(a),10)])),a=="0")return f.join("");a=a.toString(16),f.push(u[4-a.length],a)}return f.join("")},i=function(o){var s,a,c,u,f,p,v;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],p=0,v=(a=Object.keys(o).sort(function(m,S){return m-S})).length;p<v;p++)s=a[p],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),o[s]!==void 0&&o[s]!==null&&typeof o[s].toString=="function"&&(u=("0000"+o[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+u+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(s){var a=s.font,c=s.out,u=s.newObject,f=s.putStream;if(a.metadata instanceof t.API.TTFFont&&a.encoding==="Identity-H"){for(var p=a.metadata.Unicode.widths,v=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),m="",S=0;S<v.length;S++)m+=String.fromCharCode(v[S]);var _=u();f({data:m,addLength1:!0,objectId:_}),c("endobj");var E=u();f({data:i(a.metadata.toUnicode),addLength1:!0,objectId:E}),c("endobj");var C=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+ys(a.fontName)),c("/FontFile2 "+_+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(a.metadata.bbox)),c("/Flags "+a.metadata.flags),c("/StemV "+a.metadata.stemV),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c(">>"),c("endobj");var k=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+ys(a.fontName)),c("/FontDescriptor "+C+" 0 R"),c("/W "+t.API.PDFObject.convert(p)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+a.encoding+")"),c(">>"),c(">>"),c("endobj"),a.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+E+" 0 R"),c("/BaseFont /"+ys(a.fontName)),c("/Encoding /"+a.encoding),c("/DescendantFonts ["+k+" 0 R]"),c(">>"),c("endobj"),a.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(s){var a=s.font,c=s.out,u=s.newObject,f=s.putStream;if(a.metadata instanceof t.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var p=a.metadata.rawData,v="",m=0;m<p.length;m++)v+=String.fromCharCode(p[m]);var S=u();f({data:v,addLength1:!0,objectId:S}),c("endobj");var _=u();f({data:i(a.metadata.toUnicode),addLength1:!0,objectId:_}),c("endobj");var E=u();c("<<"),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c("/StemV "+a.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+S+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(a.metadata.bbox)),c("/FontName /"+ys(a.fontName)),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c(">>"),c("endobj"),a.objectNumber=u();for(var C=0;C<a.metadata.hmtx.widths.length;C++)a.metadata.hmtx.widths[C]=parseInt(a.metadata.hmtx.widths[C]*(1e3/a.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+_+" 0 R/BaseFont/"+ys(a.fontName)+"/FontDescriptor "+E+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),c("endobj"),a.isAlreadyPutted=!0}})(o)}]);var r=function(o){var s,a=o.text||"",c=o.x,u=o.y,f=o.options||{},p=o.mutex||{},v=p.pdfEscape,m=p.activeFontKey,S=p.fonts,_=m,E="",C=0,k="",I=S[_].encoding;if(S[_].encoding!=="Identity-H")return{text:a,x:c,y:u,options:f,mutex:p};for(k=a,_=m,Array.isArray(a)&&(k=a[0]),C=0;C<k.length;C+=1)S[_].metadata.hasOwnProperty("cmap")&&(s=S[_].metadata.cmap.unicode.codeMap[k[C].charCodeAt(0)]),s||k[C].charCodeAt(0)<256&&S[_].metadata.hasOwnProperty("Unicode")?E+=k[C]:E+="";var P="";return parseInt(_.slice(1))<14||I==="WinAnsiEncoding"?P=v(E,_).split("").map(function(G){return G.charCodeAt(0).toString(16)}).join(""):I==="Identity-H"&&(P=n(E,S[_])),p.isHex=!0,{text:P,x:c,y:u,options:f,mutex:p}};e.events.push(["postProcessText",function(o){var s=o.text||"",a=[],c={text:s,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(s)){var u=0;for(u=0;u<s.length;u+=1)Array.isArray(s[u])&&s[u].length===3?a.push([r(Object.assign({},c,{text:s[u][0]})).text,s[u][1],s[u][2]]):a.push(r(Object.assign({},c,{text:s[u]})).text);o.text=a}else o.text=r(Object.assign({},c,{text:s})).text}])})(Oe),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,i){return e.call(this),this.internal.vFS[n]=i,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}})(Oe.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(i){var r,o,s,a,c,u,f,p=e,v=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],S={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},E=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],C=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),k=!1,I=0;this.__bidiEngine__={};var P=function(N){var F=N.charCodeAt(),J=F>>8,W=_[J];return W!==void 0?p[256*W+(255&F)]:J===252||J===253?"AL":C.test(J)?"L":J===8?"R":"N"},G=function(N){for(var F,J=0;J<N.length;J++){if((F=P(N.charAt(J)))==="L")return!1;if(F==="R")return!0}return!1},ee=function(N,F,J,W){var ce,fe,ge,ae,ve=F[W];switch(ve){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":k=!1;break;case"N":case"AN":break;case"EN":k&&(ve="AN");break;case"AL":k=!0,ve="R";break;case"WS":case"BN":ve="N";break;case"CS":W<1||W+1>=F.length||(ce=J[W-1])!=="EN"&&ce!=="AN"||(fe=F[W+1])!=="EN"&&fe!=="AN"?ve="N":k&&(fe="AN"),ve=fe===ce?fe:"N";break;case"ES":ve=(ce=W>0?J[W-1]:"B")==="EN"&&W+1<F.length&&F[W+1]==="EN"?"EN":"N";break;case"ET":if(W>0&&J[W-1]==="EN"){ve="EN";break}if(k){ve="N";break}for(ge=W+1,ae=F.length;ge<ae&&F[ge]==="ET";)ge++;ve=ge<ae&&F[ge]==="EN"?"EN":"N";break;case"NSM":if(s&&!a){for(ae=F.length,ge=W+1;ge<ae&&F[ge]==="NSM";)ge++;if(ge<ae){var xe=N[W],_e=xe>=1425&&xe<=2303||xe===64286;if(ce=F[ge],_e&&(ce==="R"||ce==="AL")){ve="R";break}}}ve=W<1||(ce=F[W-1])==="B"?"N":J[W-1];break;case"B":k=!1,r=!0,ve=I;break;case"S":o=!0,ve="N"}return ve},te=function(N,F,J){var W=N.split("");return J&&Y(W,J,{hiLevel:I}),W.reverse(),F&&F.reverse(),W.join("")},Y=function(N,F,J){var W,ce,fe,ge,ae,ve=-1,xe=N.length,_e=0,R=[],O=I?m:v,V=[];for(k=!1,r=!1,o=!1,ce=0;ce<xe;ce++)V[ce]=P(N[ce]);for(fe=0;fe<xe;fe++){if(ae=_e,R[fe]=ee(N,V,R,fe),W=240&(_e=O[ae][S[R[fe]]]),_e&=15,F[fe]=ge=O[_e][5],W>0)if(W===16){for(ce=ve;ce<fe;ce++)F[ce]=1;ve=-1}else ve=-1;if(O[_e][6])ve===-1&&(ve=fe);else if(ve>-1){for(ce=ve;ce<fe;ce++)F[ce]=ge;ve=-1}V[fe]==="B"&&(F[fe]=0),J.hiLevel|=ge}o&&(function(Q,ne,le){for(var de=0;de<le;de++)if(Q[de]==="S"){ne[de]=I;for(var ue=de-1;ue>=0&&Q[ue]==="WS";ue--)ne[ue]=I}})(V,F,xe)},D=function(N,F,J,W,ce){if(!(ce.hiLevel<N)){if(N===1&&I===1&&!r)return F.reverse(),void(J&&J.reverse());for(var fe,ge,ae,ve,xe=F.length,_e=0;_e<xe;){if(W[_e]>=N){for(ae=_e+1;ae<xe&&W[ae]>=N;)ae++;for(ve=_e,ge=ae-1;ve<ge;ve++,ge--)fe=F[ve],F[ve]=F[ge],F[ge]=fe,J&&(fe=J[ve],J[ve]=J[ge],J[ge]=fe);_e=ae}_e++}}},Z=function(N,F,J){var W=N.split(""),ce={hiLevel:I};return J||(J=[]),Y(W,J,ce),(function(fe,ge,ae){if(ae.hiLevel!==0&&f)for(var ve,xe=0;xe<fe.length;xe++)ge[xe]===1&&(ve=E.indexOf(fe[xe]))>=0&&(fe[xe]=E[ve+1])})(W,J,ce),D(2,W,F,J,ce),D(1,W,F,J,ce),W.join("")};return this.__bidiEngine__.doBidiReorder=function(N,F,J){if((function(ce,fe){if(fe)for(var ge=0;ge<ce.length;ge++)fe[ge]=ge;a===void 0&&(a=G(ce)),u===void 0&&(u=G(ce))})(N,F),s||!c||u)if(s&&c&&a^u)I=a?1:0,N=te(N,F,J);else if(!s&&c&&u)I=a?1:0,N=Z(N,F,J),N=te(N,F);else if(!s||a||c||u){if(s&&!c&&a^u)N=te(N,F),a?(I=0,N=Z(N,F,J)):(I=1,N=Z(N,F,J),N=te(N,F));else if(s&&a&&!c&&u)I=1,N=Z(N,F,J),N=te(N,F);else if(!s&&!c&&a^u){var W=f;a?(I=1,N=Z(N,F,J),I=0,f=!1,N=Z(N,F,J),f=W):(I=0,N=Z(N,F,J),N=te(N,F),I=1,f=!1,N=Z(N,F,J),f=W,N=te(N,F))}}else I=0,N=Z(N,F,J);else I=a?1:0,N=Z(N,F,J);return N},this.__bidiEngine__.setOptions=function(N){N&&(s=N.isInputVisual,c=N.isOutputVisual,a=N.isInputRtl,u=N.isOutputRtl,f=N.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(i){var r=i.text;i.x,i.y;var o=i.options||{};i.mutex,o.lang;var s=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,n.setOptions(o),Object.prototype.toString.call(r)==="[object Array]"){var a=0;for(s=[],a=0;a<r.length;a+=1)Object.prototype.toString.call(r[a])==="[object Array]"?s.push([n.doBidiReorder(r[a][0]),r[a][1],r[a][2]]):s.push([n.doBidiReorder(r[a])]);i.text=s}else i.text=n.doBidiReorder(r);n.setOptions({isInputVisual:!0})}])})(Oe),Oe.API.TTFFont=(function(){function t(e){var n;if(this.rawData=e,n=this.contents=new Zr(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new N5(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new y5(this.contents),this.head=new w5(this),this.name=new T5(this),this.cmap=new Ov(this),this.toUnicode={},this.hhea=new S5(this),this.maxp=new A5(this),this.hmtx=new I5(this),this.post=new C5(this),this.os2=new _5(this),this.loca=new P5(this),this.glyf=new k5(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,i,r,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,a,c,u;for(u=[],s=0,a=(c=this.bbox).length;s<a;s++)e=c[s],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(i=255&(r=this.post.italic_angle),32768&(n=r>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,i){var r,o,s,a;for(s=0,o=0,a=(e=""+e).length;0<=a?o<a:o>a;o=0<=a?++o:--o)r=e.charCodeAt(o),s+=this.widthOfGlyph(this.characterToGlyph(r))+i*(1e3/n)||0;return s*(n/1e3)},t.prototype.lineHeight=function(e,n){var i;return n==null&&(n=!1),i=n?this.lineGap:0,(this.ascender+i-this.decender)/1e3*e},t})();var Ui,Zr=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,i;for(i=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)i[n]=String.fromCharCode(this.readByte());return i.join("")},t.prototype.writeString=function(e){var n,i,r;for(r=[],n=0,i=e.length;0<=i?n<i:n>i;n=0<=i?++n:--n)r.push(this.writeByte(e.charCodeAt(n)));return r},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,i,r,o,s,a,c;return e=this.readByte(),n=this.readByte(),i=this.readByte(),r=this.readByte(),o=this.readByte(),s=this.readByte(),a=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^i)+4294967296*(255^r)+16777216*(255^o)+65536*(255^s)+256*(255^a)+(255^c)+1):72057594037927940*e+281474976710656*n+1099511627776*i+4294967296*r+16777216*o+65536*s+256*a+c},t.prototype.writeLongLong=function(e){var n,i;return n=Math.floor(e/4294967296),i=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,i;for(n=[],i=0;0<=e?i<e:i>e;i=0<=e?++i:--i)n.push(this.readByte());return n},t.prototype.write=function(e){var n,i,r,o;for(o=[],i=0,r=e.length;i<r;i++)n=e[i],o.push(this.writeByte(n));return o},t})(),y5=(function(){var t;function e(n){var i,r,o;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},r=0,o=this.tableCount;0<=o?r<o:r>o;r=0<=o?++r:--r)i={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[i.tag]=i}return e.prototype.encode=function(n){var i,r,o,s,a,c,u,f,p,v,m,S,_;for(_ in m=Object.keys(n).length,c=Math.log(2),p=16*Math.floor(Math.log(m)/c),s=Math.floor(p/c),f=16*m-p,(r=new Zr).writeInt(this.scalarType),r.writeShort(m),r.writeShort(p),r.writeShort(s),r.writeShort(f),o=16*m,u=r.pos+o,a=null,S=[],n)for(v=n[_],r.writeString(_),r.writeInt(t(v)),r.writeInt(u),r.writeInt(v.length),S=S.concat(v),_==="head"&&(a=u),u+=v.length;u%4;)S.push(0),u++;return r.write(S),i=2981146554-t(r.data),r.pos=a+8,r.writeUInt32(i),r.data},t=function(n){var i,r,o,s;for(n=Hv.call(n);n.length%4;)n.push(0);for(o=new Zr(n),r=0,i=0,s=n.length;i<s;i=i+=4)r+=o.readUInt32();return 4294967295&r},e})(),b5={}.hasOwnProperty,er=function(t,e){for(var n in e)b5.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};Ui=(function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var w5=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return er(t,Ui),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new Zr).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t})(),Rp=(function(){function t(e,n){var i,r,o,s,a,c,u,f,p,v,m,S,_,E,C,k,I;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),p=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(m=e.readUInt16(),v=m/2,e.pos+=6,o=(function(){var P,G;for(G=[],c=P=0;0<=v?P<v:P>v;c=0<=v?++P:--P)G.push(e.readUInt16());return G})(),e.pos+=2,_=(function(){var P,G;for(G=[],c=P=0;0<=v?P<v:P>v;c=0<=v?++P:--P)G.push(e.readUInt16());return G})(),u=(function(){var P,G;for(G=[],c=P=0;0<=v?P<v:P>v;c=0<=v?++P:--P)G.push(e.readUInt16());return G})(),f=(function(){var P,G;for(G=[],c=P=0;0<=v?P<v:P>v;c=0<=v?++P:--P)G.push(e.readUInt16());return G})(),r=(this.length-e.pos+this.offset)/2,a=(function(){var P,G;for(G=[],c=P=0;0<=r?P<r:P>r;c=0<=r?++P:--P)G.push(e.readUInt16());return G})(),c=C=0,I=o.length;C<I;c=++C)for(E=o[c],i=k=S=_[c];S<=E?k<=E:k>=E;i=S<=E?++k:--k)f[c]===0?s=i+u[c]:(s=a[f[c]/2+(i-S)-(v-c)]||0)!==0&&(s+=u[c]),this.codeMap[i]=65535&s}e.pos=p}return t.encode=function(e,n){var i,r,o,s,a,c,u,f,p,v,m,S,_,E,C,k,I,P,G,ee,te,Y,D,Z,N,F,J,W,ce,fe,ge,ae,ve,xe,_e,R,O,V,Q,ne,le,de,ue,we,Ie,Re;switch(W=new Zr,s=Object.keys(e).sort(function(Me,he){return Me-he}),n){case"macroman":for(_=0,E=(function(){var Me=[];for(S=0;S<256;++S)Me.push(0);return Me})(),k={0:0},o={},ce=0,ve=s.length;ce<ve;ce++)k[ue=e[r=s[ce]]]==null&&(k[ue]=++_),o[r]={old:e[r],new:k[e[r]]},E[r]=k[e[r]];return W.writeUInt16(1),W.writeUInt16(0),W.writeUInt32(12),W.writeUInt16(0),W.writeUInt16(262),W.writeUInt16(0),W.write(E),{charMap:o,subtable:W.data,maxGlyphID:_+1};case"unicode":for(F=[],p=[],I=0,k={},i={},C=u=null,fe=0,xe=s.length;fe<xe;fe++)k[G=e[r=s[fe]]]==null&&(k[G]=++I),i[r]={old:G,new:k[G]},a=k[G]-r,C!=null&&a===u||(C&&p.push(C),F.push(r),u=a),C=r;for(C&&p.push(C),p.push(65535),F.push(65535),Z=2*(D=F.length),Y=2*Math.pow(Math.log(D)/Math.LN2,2),v=Math.log(Y/2)/Math.LN2,te=2*D-Y,c=[],ee=[],m=[],S=ge=0,_e=F.length;ge<_e;S=++ge){if(N=F[S],f=p[S],N===65535){c.push(0),ee.push(0);break}if(N-(J=i[N].new)>=32768)for(c.push(0),ee.push(2*(m.length+D-S)),r=ae=N;N<=f?ae<=f:ae>=f;r=N<=f?++ae:--ae)m.push(i[r].new);else c.push(J-N),ee.push(0)}for(W.writeUInt16(3),W.writeUInt16(1),W.writeUInt32(12),W.writeUInt16(4),W.writeUInt16(16+8*D+2*m.length),W.writeUInt16(0),W.writeUInt16(Z),W.writeUInt16(Y),W.writeUInt16(v),W.writeUInt16(te),le=0,R=p.length;le<R;le++)r=p[le],W.writeUInt16(r);for(W.writeUInt16(0),de=0,O=F.length;de<O;de++)r=F[de],W.writeUInt16(r);for(we=0,V=c.length;we<V;we++)a=c[we],W.writeUInt16(a);for(Ie=0,Q=ee.length;Ie<Q;Ie++)P=ee[Ie],W.writeUInt16(P);for(Re=0,ne=m.length;Re<ne;Re++)_=m[Re],W.writeUInt16(_);return{charMap:i,subtable:W.data,maxGlyphID:I+1}}},t})(),Ov=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return er(t,Ui),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,i,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)n=new Rp(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var i,r;return n==null&&(n="macroman"),i=Rp.encode(e,n),(r=new Zr).writeUInt16(0),r.writeUInt16(1),i.table=r.data.concat(i.subtable),i},t})(),S5=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return er(t,Ui),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),_5=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return er(t,Ui),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var n,i;for(i=[],n=0;n<10;++n)i.push(e.readByte());return i})(),this.charRange=(function(){var n,i;for(i=[],n=0;n<4;++n)i.push(e.readInt());return i})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(e.readInt());return i})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),C5=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return er(t,Ui),t.prototype.tag="post",t.prototype.parse=function(e){var n,i,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var o;for(i=e.readUInt16(),this.glyphNameIndex=[],o=0;0<=i?o<i:o>i;o=0<=i?++o:--o)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)n=e.readByte(),r.push(this.names.push(e.readString(n)));return r;case 151552:return i=e.readUInt16(),this.offsets=e.read(i);case 262144:return this.map=(function(){var s,a,c;for(c=[],o=s=0,a=this.file.maxp.numGlyphs;0<=a?s<a:s>a;o=0<=a?++s:--s)c.push(e.readUInt32());return c}).call(this)}},t})(),E5=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},T5=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return er(t,Ui),t.prototype.tag="name",t.prototype.parse=function(e){var n,i,r,o,s,a,c,u,f,p,v;for(e.pos=this.offset,e.readShort(),n=e.readShort(),a=e.readShort(),i=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)i.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+a+e.readShort()});for(c={},o=f=0,p=i.length;f<p;o=++f)r=i[o],e.pos=r.offset,u=e.readString(r.length),s=new E5(u,r),c[v=r.nameID]==null&&(c[v]=[]),c[r.nameID].push(s);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t})(),A5=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return er(t,Ui),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),I5=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return er(t,Ui),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,i,r,o,s,a,c;for(e.pos=this.offset,this.metrics=[],n=0,a=this.file.hhea.numberOfMetrics;0<=a?n<a:n>a;n=0<=a?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var u,f;for(f=[],n=u=0;0<=r?u<r:u>r;n=0<=r?++u:--u)f.push(e.readInt16());return f})(),this.widths=(function(){var u,f,p,v;for(v=[],u=0,f=(p=this.metrics).length;u<f;u++)o=p[u],v.push(o.advance);return v}).call(this),i=this.widths[this.widths.length-1],c=[],n=s=0;0<=r?s<r:s>r;n=0<=r?++s:--s)c.push(this.widths.push(i));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),Hv=[].slice,k5=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return er(t,Ui),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,i,r,o,s,a,c,u,f,p;return e in this.cache?this.cache[e]:(o=this.file.loca,n=this.file.contents,i=o.indexOf(e),(r=o.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+i,s=(a=new Zr(n.read(r))).readShort(),u=a.readShort(),p=a.readShort(),c=a.readShort(),f=a.readShort(),this.cache[e]=s===-1?new L5(a,u,p,c,f):new x5(a,s,u,p,c,f),this.cache[e]))},t.prototype.encode=function(e,n,i){var r,o,s,a,c;for(s=[],o=[],a=0,c=n.length;a<c;a++)r=e[n[a]],o.push(s.length),r&&(s=s.concat(r.encode(i)));return o.push(s.length),{table:s,offsets:o}},t})(),x5=(function(){function t(e,n,i,r,o,s){this.raw=e,this.numberOfContours=n,this.xMin=i,this.yMin=r,this.xMax=o,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),L5=(function(){function t(e,n,i,r,o){var s,a;for(this.raw=e,this.xMin=n,this.yMin=i,this.xMax=r,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;a=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&a;)s.pos+=1&a?4:2,128&a?s.pos+=8:64&a?s.pos+=4:8&a&&(s.pos+=2)}return t.prototype.encode=function(){var e,n,i;for(n=new Zr(Hv.call(this.raw.data)),e=0,i=this.glyphIDs.length;e<i;++e)n.pos=this.glyphOffsets[e];return n.data},t})(),P5=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return er(t,Ui),t.prototype.tag="loca",t.prototype.parse=function(e){var n,i;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var r,o;for(o=[],i=0,r=this.length;i<r;i+=2)o.push(2*e.readUInt16());return o}).call(this):(function(){var r,o;for(o=[],i=0,r=this.length;i<r;i+=4)o.push(e.readUInt32());return o}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var i=new Uint32Array(this.offsets.length),r=0,o=0,s=0;s<i.length;++s)if(i[s]=r,o<n.length&&n[o]==s){++o,i[s]=r;var a=this.offsets[s],c=this.offsets[s+1]-a;c>0&&(r+=c)}for(var u=new Array(4*i.length),f=0;f<i.length;++f)u[4*f+3]=255&i[f],u[4*f+2]=(65280&i[f])>>8,u[4*f+1]=(16711680&i[f])>>16,u[4*f]=(4278190080&i[f])>>24;return u},t})(),N5=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,i,r,o;for(n in r=this.font.cmap.tables[0].codeMap,e={},o=this.subset)i=o[n],e[n]=r[i];return e},t.prototype.glyphsFor=function(e){var n,i,r,o,s,a,c;for(r={},s=0,a=e.length;s<a;s++)r[o=e[s]]=this.font.glyf.glyphFor(o);for(o in n=[],r)(i=r[o])!=null&&i.compound&&n.push.apply(n,i.glyphIDs);if(n.length>0)for(o in c=this.glyphsFor(n))i=c[o],r[o]=i;return r},t.prototype.encode=function(e,n){var i,r,o,s,a,c,u,f,p,v,m,S,_,E,C;for(r in i=Ov.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),m={0:0},C=i.charMap)m[(c=C[r]).old]=c.new;for(S in v=i.maxGlyphID,s)S in m||(m[S]=v++);return f=(function(k){var I,P;for(I in P={},k)P[k[I]]=I;return P})(m),p=Object.keys(f).sort(function(k,I){return k-I}),_=(function(){var k,I,P;for(P=[],k=0,I=p.length;k<I;k++)a=p[k],P.push(f[a]);return P})(),o=this.font.glyf.encode(s,_,m),u=this.font.loca.encode(o.offsets,_),E={cmap:this.font.cmap.raw(),glyf:o.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(E["OS/2"]=this.font.os2.raw()),this.font.directory.encode(E)},t})();Oe.API.PDFObject=(function(){var t;function e(){}return t=function(n,i){return(Array(i+1).join("0")+n).slice(-i)},e.convert=function(n){var i,r,o,s;if(Array.isArray(n))return"["+(function(){var a,c,u;for(u=[],a=0,c=n.length;a<c;a++)i=n[a],u.push(e.convert(i));return u})().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(r in o=["<<"],n)s=n[r],o.push("/"+r+" "+e.convert(s));return o.push(">>"),o.join(`
`)}return""+n},e})();const R5=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Xr(async()=>{const{default:i}=await Promise.resolve().then(()=>Fs);return{default:i}},void 0).then(({default:i})=>i(...n)):e=fetch,(...n)=>e(...n)};class lf extends Error{constructor(e,n="FunctionsError",i){super(e),this.name=n,this.context=i}}class Mp extends lf{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Bp extends lf{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Dp extends lf{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var vd;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(vd||(vd={}));var M5=function(t,e,n,i){function r(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(f){try{u(i.next(f))}catch(p){s(p)}}function c(f){try{u(i.throw(f))}catch(p){s(p)}}function u(f){f.done?o(f.value):r(f.value).then(a,c)}u((i=i.apply(t,e||[])).next())})};class B5{constructor(e,{headers:n={},customFetch:i,region:r=vd.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=R5(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var i;return M5(this,void 0,void 0,function*(){try{const{headers:r,method:o,body:s,signal:a}=n;let c={},{region:u}=n;u||(u=this.region);const f=new URL(`${this.url}/${e}`);u&&u!=="any"&&(c["x-region"]=u,f.searchParams.set("forceFunctionRegion",u));let p;s&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",p=s):typeof s=="string"?(c["Content-Type"]="text/plain",p=s):typeof FormData<"u"&&s instanceof FormData?p=s:(c["Content-Type"]="application/json",p=JSON.stringify(s)));const v=yield this.fetch(f.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),r),body:p,signal:a}).catch(E=>{throw E.name==="AbortError"?E:new Mp(E)}),m=v.headers.get("x-relay-error");if(m&&m==="true")throw new Bp(v);if(!v.ok)throw new Dp(v);let S=((i=v.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),_;return S==="application/json"?_=yield v.json():S==="application/octet-stream"?_=yield v.blob():S==="text/event-stream"?_=v:S==="multipart/form-data"?_=yield v.formData():_=yield v.text(),{data:_,error:null,response:v}}catch(r){return r instanceof Error&&r.name==="AbortError"?{data:null,error:new Mp(r)}:{data:null,error:r,response:r instanceof Dp||r instanceof Bp?r.context:void 0}}})}}var P6=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function D5(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function F5(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}var En={},as={},ls={},cs={},us={},ds={},q5=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ms=q5();const U5=Ms.fetch,Vv=Ms.fetch.bind(Ms),Gv=Ms.Headers,$5=Ms.Request,O5=Ms.Response,Fs=Object.freeze(Object.defineProperty({__proto__:null,Headers:Gv,Request:$5,Response:O5,default:Vv,fetch:U5},Symbol.toStringTag,{value:"Module"})),H5=F5(Fs);var Bl={},Fp;function Wv(){if(Fp)return Bl;Fp=1,Object.defineProperty(Bl,"__esModule",{value:!0});class t extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return Bl.default=t,Bl}var qp;function zv(){if(qp)return ds;qp=1;var t=ds&&ds.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ds,"__esModule",{value:!0});const e=t(H5),n=t(Wv());class i{constructor(o){var s,a;this.shouldThrowOnError=!1,this.method=o.method,this.url=o.url,this.headers=new Headers(o.headers),this.schema=o.schema,this.body=o.body,this.shouldThrowOnError=(s=o.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=o.signal,this.isMaybeSingle=(a=o.isMaybeSingle)!==null&&a!==void 0?a:!1,o.fetch?this.fetch=o.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(o,s){return this.headers=new Headers(this.headers),this.headers.set(o,s),this}then(o,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let c=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async u=>{var f,p,v,m;let S=null,_=null,E=null,C=u.status,k=u.statusText;if(u.ok){if(this.method!=="HEAD"){const ee=await u.text();ee===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((f=this.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?_=ee:_=JSON.parse(ee))}const P=(p=this.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),G=(v=u.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");P&&G&&G.length>1&&(E=parseInt(G[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(_)&&(_.length>1?(S={code:"PGRST116",details:`Results contain ${_.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},_=null,E=null,C=406,k="Not Acceptable"):_.length===1?_=_[0]:_=null)}else{const P=await u.text();try{S=JSON.parse(P),Array.isArray(S)&&u.status===404&&(_=[],S=null,C=200,k="OK")}catch{u.status===404&&P===""?(C=204,k="No Content"):S={message:P}}if(S&&this.isMaybeSingle&&(!((m=S==null?void 0:S.details)===null||m===void 0)&&m.includes("0 rows"))&&(S=null,C=200,k="OK"),S&&this.shouldThrowOnError)throw new n.default(S)}return{error:S,data:_,count:E,status:C,statusText:k}});return this.shouldThrowOnError||(c=c.catch(u=>{var f,p,v;return{error:{message:`${(f=u==null?void 0:u.name)!==null&&f!==void 0?f:"FetchError"}: ${u==null?void 0:u.message}`,details:`${(p=u==null?void 0:u.stack)!==null&&p!==void 0?p:""}`,hint:"",code:`${(v=u==null?void 0:u.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),c.then(o,s)}returns(){return this}overrideTypes(){return this}}return ds.default=i,ds}var Up;function Jv(){if(Up)return us;Up=1;var t=us&&us.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(us,"__esModule",{value:!0});const e=t(zv());class n extends e.default{select(r){let o=!1;const s=(r??"*").split("").map(a=>/\s/.test(a)&&!o?"":(a==='"'&&(o=!o),a)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:o=!0,nullsFirst:s,foreignTable:a,referencedTable:c=a}={}){const u=c?`${c}.order`:"order",f=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${f?`${f},`:""}${r}.${o?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:o,referencedTable:s=o}={}){const a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${r}`),this}range(r,o,{foreignTable:s,referencedTable:a=s}={}){const c=typeof a>"u"?"offset":`${a}.offset`,u=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(c,`${r}`),this.url.searchParams.set(u,`${o-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:o=!1,settings:s=!1,buffers:a=!1,wal:c=!1,format:u="text"}={}){var f;const p=[r?"analyze":null,o?"verbose":null,s?"settings":null,a?"buffers":null,c?"wal":null].filter(Boolean).join("|"),v=(f=this.headers.get("Accept"))!==null&&f!==void 0?f:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${v}"; options=${p};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return us.default=n,us}var $p;function cf(){if($p)return cs;$p=1;var t=cs&&cs.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(cs,"__esModule",{value:!0});const e=t(Jv());class n extends e.default{eq(r,o){return this.url.searchParams.append(r,`eq.${o}`),this}neq(r,o){return this.url.searchParams.append(r,`neq.${o}`),this}gt(r,o){return this.url.searchParams.append(r,`gt.${o}`),this}gte(r,o){return this.url.searchParams.append(r,`gte.${o}`),this}lt(r,o){return this.url.searchParams.append(r,`lt.${o}`),this}lte(r,o){return this.url.searchParams.append(r,`lte.${o}`),this}like(r,o){return this.url.searchParams.append(r,`like.${o}`),this}likeAllOf(r,o){return this.url.searchParams.append(r,`like(all).{${o.join(",")}}`),this}likeAnyOf(r,o){return this.url.searchParams.append(r,`like(any).{${o.join(",")}}`),this}ilike(r,o){return this.url.searchParams.append(r,`ilike.${o}`),this}ilikeAllOf(r,o){return this.url.searchParams.append(r,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(r,o){return this.url.searchParams.append(r,`ilike(any).{${o.join(",")}}`),this}is(r,o){return this.url.searchParams.append(r,`is.${o}`),this}in(r,o){const s=Array.from(new Set(o)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(r,`in.(${s})`),this}contains(r,o){return typeof o=="string"?this.url.searchParams.append(r,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(r,`cs.{${o.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(o)}`),this}containedBy(r,o){return typeof o=="string"?this.url.searchParams.append(r,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(r,`cd.{${o.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(o)}`),this}rangeGt(r,o){return this.url.searchParams.append(r,`sr.${o}`),this}rangeGte(r,o){return this.url.searchParams.append(r,`nxl.${o}`),this}rangeLt(r,o){return this.url.searchParams.append(r,`sl.${o}`),this}rangeLte(r,o){return this.url.searchParams.append(r,`nxr.${o}`),this}rangeAdjacent(r,o){return this.url.searchParams.append(r,`adj.${o}`),this}overlaps(r,o){return typeof o=="string"?this.url.searchParams.append(r,`ov.${o}`):this.url.searchParams.append(r,`ov.{${o.join(",")}}`),this}textSearch(r,o,{config:s,type:a}={}){let c="";a==="plain"?c="pl":a==="phrase"?c="ph":a==="websearch"&&(c="w");const u=s===void 0?"":`(${s})`;return this.url.searchParams.append(r,`${c}fts${u}.${o}`),this}match(r){return Object.entries(r).forEach(([o,s])=>{this.url.searchParams.append(o,`eq.${s}`)}),this}not(r,o,s){return this.url.searchParams.append(r,`not.${o}.${s}`),this}or(r,{foreignTable:o,referencedTable:s=o}={}){const a=s?`${s}.or`:"or";return this.url.searchParams.append(a,`(${r})`),this}filter(r,o,s){return this.url.searchParams.append(r,`${o}.${s}`),this}}return cs.default=n,cs}var Op;function Yv(){if(Op)return ls;Op=1;var t=ls&&ls.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ls,"__esModule",{value:!0});const e=t(cf());class n{constructor(r,{headers:o={},schema:s,fetch:a}){this.url=r,this.headers=new Headers(o),this.schema=s,this.fetch=a}select(r,{head:o=!1,count:s}={}){const a=o?"HEAD":"GET";let c=!1;const u=(r??"*").split("").map(f=>/\s/.test(f)&&!c?"":(f==='"'&&(c=!c),f)).join("");return this.url.searchParams.set("select",u),s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:o,defaultToNull:s=!0}={}){var a;const c="POST";if(o&&this.headers.append("Prefer",`count=${o}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const u=r.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(u.length>0){const f=[...new Set(u)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(r,{onConflict:o,ignoreDuplicates:s=!1,count:a,defaultToNull:c=!0}={}){var u;const f="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),a&&this.headers.append("Prefer",`count=${a}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const p=r.reduce((v,m)=>v.concat(Object.keys(m)),[]);if(p.length>0){const v=[...new Set(p)].map(m=>`"${m}"`);this.url.searchParams.set("columns",v.join(","))}}return new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(r,{count:o}={}){var s;const a="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:r}={}){var o;const s="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new e.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return ls.default=n,ls}var Hp;function V5(){if(Hp)return as;Hp=1;var t=as&&as.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(as,"__esModule",{value:!0});const e=t(Yv()),n=t(cf());class i{constructor(o,{headers:s={},schema:a,fetch:c}={}){this.url=o,this.headers=new Headers(s),this.schemaName=a,this.fetch=c}from(o){const s=new URL(`${this.url}/${o}`);return new e.default(s,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new i(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,s={},{head:a=!1,get:c=!1,count:u}={}){var f;let p;const v=new URL(`${this.url}/rpc/${o}`);let m;a||c?(p=a?"HEAD":"GET",Object.entries(s).filter(([_,E])=>E!==void 0).map(([_,E])=>[_,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([_,E])=>{v.searchParams.append(_,E)})):(p="POST",m=s);const S=new Headers(this.headers);return u&&S.set("Prefer",`count=${u}`),new n.default({method:p,url:v,headers:S,schema:this.schemaName,body:m,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}}return as.default=i,as}var Vp;function G5(){if(Vp)return En;Vp=1;var t=En&&En.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(En,"__esModule",{value:!0}),En.PostgrestError=En.PostgrestBuilder=En.PostgrestTransformBuilder=En.PostgrestFilterBuilder=En.PostgrestQueryBuilder=En.PostgrestClient=void 0;const e=t(V5());En.PostgrestClient=e.default;const n=t(Yv());En.PostgrestQueryBuilder=n.default;const i=t(cf());En.PostgrestFilterBuilder=i.default;const r=t(Jv());En.PostgrestTransformBuilder=r.default;const o=t(zv());En.PostgrestBuilder=o.default;const s=t(Wv());return En.PostgrestError=s.default,En.default={PostgrestClient:e.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:o.default,PostgrestError:s.default},En}var W5=G5();const z5=D5(W5),{PostgrestClient:J5,PostgrestQueryBuilder:N6,PostgrestFilterBuilder:R6,PostgrestTransformBuilder:M6,PostgrestBuilder:B6,PostgrestError:D6}=z5;class Y5{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const i=n.node,r=parseInt(i.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const i=this.getWebSocketConstructor();return new i(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const K5="2.15.5",j5=`realtime-js/${K5}`,Q5="1.0.0",yd=1e4,X5=1e3,Z5=100;var Ca;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ca||(Ca={}));var _n;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(_n||(_n={}));var Bi;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Bi||(Bi={}));var bd;(function(t){t.websocket="websocket"})(bd||(bd={}));var Po;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Po||(Po={}));class ew{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),i=new TextDecoder;return this._decodeBroadcast(e,n,i)}_decodeBroadcast(e,n,i){const r=n.getUint8(1),o=n.getUint8(2);let s=this.HEADER_LENGTH+2;const a=i.decode(e.slice(s,s+r));s=s+r;const c=i.decode(e.slice(s,s+o));s=s+o;const u=JSON.parse(i.decode(e.slice(s,e.byteLength)));return{ref:null,topic:a,event:c,payload:u}}}class Kv{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Wt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Wt||(Wt={}));const Gp=(t,e,n={})=>{var i;const r=(i=n.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(e).reduce((o,s)=>(o[s]=tw(s,t,e,r),o),{})},tw=(t,e,n,i)=>{const r=e.find(a=>a.name===t),o=r==null?void 0:r.type,s=n[t];return o&&!i.includes(o)?jv(o,s):wd(s)},jv=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return ow(e,n)}switch(t){case Wt.bool:return nw(e);case Wt.float4:case Wt.float8:case Wt.int2:case Wt.int4:case Wt.int8:case Wt.numeric:case Wt.oid:return iw(e);case Wt.json:case Wt.jsonb:return rw(e);case Wt.timestamp:return sw(e);case Wt.abstime:case Wt.date:case Wt.daterange:case Wt.int4range:case Wt.int8range:case Wt.money:case Wt.reltime:case Wt.text:case Wt.time:case Wt.timestamptz:case Wt.timetz:case Wt.tsrange:case Wt.tstzrange:return wd(e);default:return wd(e)}},wd=t=>t,nw=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},iw=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},rw=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},ow=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,i=t[n];if(t[0]==="{"&&i==="}"){let o;const s=t.slice(1,n);try{o=JSON.parse("["+s+"]")}catch{o=s?s.split(","):[]}return o.map(a=>jv(e,a))}return t},sw=t=>typeof t=="string"?t.replace(" ","T"):t,Qv=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Bu{constructor(e,n,i={},r=yd){this.channel=e,this.event=n,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var i;return this._hasReceived(e)&&n((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Wp;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Wp||(Wp={}));class Ea{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:o,onLeave:s,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ea.syncState(this.state,r,o,s),this.pendingDiffs.forEach(c=>{this.state=Ea.syncDiff(this.state,c,o,s)}),this.pendingDiffs=[],a()}),this.channel._on(i.diff,{},r=>{const{onJoin:o,onLeave:s,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=Ea.syncDiff(this.state,r,o,s),a())}),this.onJoin((r,o,s)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:o,newPresences:s})}),this.onLeave((r,o,s)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:o,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,i,r){const o=this.cloneDeep(e),s=this.transformState(n),a={},c={};return this.map(o,(u,f)=>{s[u]||(c[u]=f)}),this.map(s,(u,f)=>{const p=o[u];if(p){const v=f.map(E=>E.presence_ref),m=p.map(E=>E.presence_ref),S=f.filter(E=>m.indexOf(E.presence_ref)<0),_=p.filter(E=>v.indexOf(E.presence_ref)<0);S.length>0&&(a[u]=S),_.length>0&&(c[u]=_)}else a[u]=f}),this.syncDiff(o,{joins:a,leaves:c},i,r)}static syncDiff(e,n,i,r){const{joins:o,leaves:s}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(o,(a,c)=>{var u;const f=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(c),f.length>0){const p=e[a].map(m=>m.presence_ref),v=f.filter(m=>p.indexOf(m.presence_ref)<0);e[a].unshift(...v)}i(a,f,c)}),this.map(s,(a,c)=>{let u=e[a];if(!u)return;const f=c.map(p=>p.presence_ref);u=u.filter(p=>f.indexOf(p.presence_ref)<0),e[a]=u,r(a,u,c),u.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(i=>n(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,i)=>{const r=e[i];return"metas"in r?n[i]=r.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):n[i]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var zp;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(zp||(zp={}));var Ta;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Ta||(Ta={}));var vr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(vr||(vr={}));class uf{constructor(e,n={config:{}},i){this.topic=e,this.params=n,this.socket=i,this.bindings={},this.state=_n.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Bu(this,Bi.join,this.params,this.timeout),this.rejoinTimer=new Kv(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=_n.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=_n.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=_n.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=_n.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=_n.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Bi.reply,{},(r,o)=>{this._trigger(this._replyEventName(o),r)}),this.presence=new Ea(this),this.broadcastEndpointURL=Qv(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var i,r,o;if(this.socket.isConnected()||this.socket.connect(),this.state==_n.closed){const{config:{broadcast:s,presence:a,private:c}}=this.params,u=(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(m=>m.filter))!==null&&r!==void 0?r:[],f=!!this.bindings[Ta.PRESENCE]&&this.bindings[Ta.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,p={},v={broadcast:s,presence:Object.assign(Object.assign({},a),{enabled:f}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(vr.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(vr.CLOSED)),this.updateJoinPayload(Object.assign({config:v},p)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:m})=>{var S;if(this.socket.setAuth(),m===void 0){e==null||e(vr.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,E=(S=_==null?void 0:_.length)!==null&&S!==void 0?S:0,C=[];for(let k=0;k<E;k++){const I=_[k],{filter:{event:P,schema:G,table:ee,filter:te}}=I,Y=m&&m[k];if(Y&&Y.event===P&&Y.schema===G&&Y.table===ee&&Y.filter===te)C.push(Object.assign(Object.assign({},I),{id:Y.id}));else{this.unsubscribe(),this.state=_n.errored,e==null||e(vr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=C,e&&e(vr.SUBSCRIBED);return}}).receive("error",m=>{this.state=_n.errored,e==null||e(vr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(vr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,i){return this.state===_n.joined&&e===Ta.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,i)}async send(e,n={}){var i,r;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:s}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:s,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);return await((r=u.body)===null||r===void 0?void 0:r.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var s,a,c;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(a=(s=this.params)===null||s===void 0?void 0:s.config)===null||a===void 0?void 0:a.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),u.receive("ok",()=>o("ok")),u.receive("error",()=>o("error")),u.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=_n.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Bi.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{i=new Bu(this,Bi.leave,{},e),i.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=_n.closed,this.bindings={}}async _fetchWithTimeout(e,n,i){const r=new AbortController,o=setTimeout(()=>r.abort(),i),s=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(o),s}_push(e,n,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Bu(this,e,n,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Z5){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,i){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,i){var r,o;const s=e.toLocaleLowerCase(),{close:a,error:c,leave:u,join:f}=Bi;if(i&&[a,c,u,f].indexOf(s)>=0&&i!==this._joinRef())return;let v=this._onMessage(s,n,i);if(n&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(m=>{var S,_,E;return((S=m.filter)===null||S===void 0?void 0:S.event)==="*"||((E=(_=m.filter)===null||_===void 0?void 0:_.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===s}).map(m=>m.callback(v,i)):(o=this.bindings[s])===null||o===void 0||o.filter(m=>{var S,_,E,C,k,I;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in m){const P=m.id,G=(S=m.filter)===null||S===void 0?void 0:S.event;return P&&((_=n.ids)===null||_===void 0?void 0:_.includes(P))&&(G==="*"||(G==null?void 0:G.toLocaleLowerCase())===((E=n.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const P=(k=(C=m==null?void 0:m.filter)===null||C===void 0?void 0:C.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return P==="*"||P===((I=n==null?void 0:n.event)===null||I===void 0?void 0:I.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===s}).map(m=>{if(typeof v=="object"&&"ids"in v){const S=v.data,{schema:_,table:E,commit_timestamp:C,type:k,errors:I}=S;v=Object.assign(Object.assign({},{schema:_,table:E,commit_timestamp:C,eventType:k,new:{},old:{},errors:I}),this._getPayloadRecords(S))}m.callback(v,i)})}_isClosed(){return this.state===_n.closed}_isJoined(){return this.state===_n.joined}_isJoining(){return this.state===_n.joining}_isLeaving(){return this.state===_n.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,i){const r=e.toLocaleLowerCase(),o={type:r,filter:n,callback:i};return this.bindings[r]?this.bindings[r].push(o):this.bindings[r]=[o],this}_off(e,n){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(r=>{var o;return!(((o=r.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===i&&uf.isEqual(r.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const i in e)if(e[i]!==n[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Bi.close,{},e)}_onError(e){this._on(Bi.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=_n.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Gp(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Gp(e.columns,e.old_record)),n}}const Du=()=>{},Dl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},aw=[1e3,2e3,5e3,1e4],lw=1e4,cw=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class uw{constructor(e,n){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=yd,this.transport=null,this.heartbeatIntervalMs=Dl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Du,this.ref=0,this.reconnectTimer=null,this.logger=Du,this.conn=null,this.sendBuffer=[],this.serializer=new ew,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let o;return r?o=r:typeof fetch>"u"?o=(...s)=>Xr(async()=>{const{default:a}=await Promise.resolve().then(()=>Fs);return{default:a}},void 0).then(({default:a})=>a(...s)).catch(a=>{throw new Error(`Failed to load @supabase/node-fetch: ${a.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...s)=>o(...s)},!(!((i=n==null?void 0:n.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${bd.websocket}`,this.httpEndpoint=Qv(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Y5.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Q5}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,i){this.logger(e,n,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Ca.connecting:return Po.Connecting;case Ca.open:return Po.Open;case Ca.closing:return Po.Closing;default:return Po.Closed}}isConnected(){return this.connectionState()===Po.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const i=`realtime:${e}`,r=this.getChannels().find(o=>o.topic===i);if(r)return r;{const o=new uf(`realtime:${e}`,n,this);return this.channels.push(o),o}}push(e){const{topic:n,event:i,payload:r,ref:o}=e,s=()=>{this.encode(e,a=>{var c;(c=this.conn)===null||c===void 0||c.send(a)})};this.log("push",`${n} ${i} (${o})`,r),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(X5,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Dl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:r,payload:o,ref:s}=n,a=s?`(${s})`:"",c=o.status||"";this.log("receive",`${c} ${i} ${r} ${a}`.trim(),o),this.channels.filter(u=>u._isMember(i)).forEach(u=>u._trigger(r,o,s)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Bi.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const i=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${i}${r}`}_workerObjectUrl(e){let n;if(e)n=e;else{const i=new Blob([cw],{type:"application/javascript"});n=URL.createObjectURL(i)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(i=>{const r={access_token:n,version:j5};n&&i.updateJoinPayload(r),i.joinedOnce&&i._isJoined()&&i._push(Bi.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(n)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new Kv(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Dl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,i,r,o,s,a,c,u,f;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(i=e==null?void 0:e.timeout)!==null&&i!==void 0?i:yd,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:Dl.HEARTBEAT_INTERVAL,this.worker=(o=e==null?void 0:e.worker)!==null&&o!==void 0?o:!1,this.accessToken=(s=e==null?void 0:e.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:Du,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:(p=>aw[p-1]||lw),this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:((p,v)=>v(JSON.stringify(p))),this.decode=(f=e==null?void 0:e.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class df extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function gn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class dw extends df{constructor(e,n,i){super(e),this.name="StorageApiError",this.status=n,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Sd extends df{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var fw=function(t,e,n,i){function r(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(f){try{u(i.next(f))}catch(p){s(p)}}function c(f){try{u(i.throw(f))}catch(p){s(p)}}function u(f){f.done?o(f.value):r(f.value).then(a,c)}u((i=i.apply(t,e||[])).next())})};const Xv=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Xr(async()=>{const{default:i}=await Promise.resolve().then(()=>Fs);return{default:i}},void 0).then(({default:i})=>i(...n)):e=fetch,(...n)=>e(...n)},hw=()=>fw(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Xr(()=>Promise.resolve().then(()=>Fs),void 0)).Response:Response}),_d=t=>{if(Array.isArray(t))return t.map(n=>_d(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,i])=>{const r=n.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[r]=_d(i)}),e},pw=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Ho=function(t,e,n,i){function r(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(f){try{u(i.next(f))}catch(p){s(p)}}function c(f){try{u(i.throw(f))}catch(p){s(p)}}function u(f){f.done?o(f.value):r(f.value).then(a,c)}u((i=i.apply(t,e||[])).next())})};const Fu=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),gw=(t,e,n)=>Ho(void 0,void 0,void 0,function*(){const i=yield hw();t instanceof i&&!(n!=null&&n.noResolveJson)?t.json().then(r=>{const o=t.status||500,s=(r==null?void 0:r.statusCode)||o+"";e(new dw(Fu(r),o,s))}).catch(r=>{e(new Sd(Fu(r),r))}):e(new Sd(Fu(t),t))}),mw=(t,e,n,i)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!i?r:(pw(i)?(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(i)):r.body=i,e!=null&&e.duplex&&(r.duplex=e.duplex),Object.assign(Object.assign({},r),n))};function Oa(t,e,n,i,r,o){return Ho(this,void 0,void 0,function*(){return new Promise((s,a)=>{t(n,mw(e,i,r,o)).then(c=>{if(!c.ok)throw c;return i!=null&&i.noResolveJson?c:c.json()}).then(c=>s(c)).catch(c=>gw(c,a,i))})})}function ac(t,e,n,i){return Ho(this,void 0,void 0,function*(){return Oa(t,"GET",e,n,i)})}function Qi(t,e,n,i,r){return Ho(this,void 0,void 0,function*(){return Oa(t,"POST",e,i,r,n)})}function Cd(t,e,n,i,r){return Ho(this,void 0,void 0,function*(){return Oa(t,"PUT",e,i,r,n)})}function vw(t,e,n,i){return Ho(this,void 0,void 0,function*(){return Oa(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),i)})}function Zv(t,e,n,i,r){return Ho(this,void 0,void 0,function*(){return Oa(t,"DELETE",e,i,r,n)})}var yw=function(t,e,n,i){function r(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(f){try{u(i.next(f))}catch(p){s(p)}}function c(f){try{u(i.throw(f))}catch(p){s(p)}}function u(f){f.done?o(f.value):r(f.value).then(a,c)}u((i=i.apply(t,e||[])).next())})};class bw{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n}then(e,n){return this.execute().then(e,n)}execute(){return yw(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(gn(e))return{data:null,error:e};throw e}})}}var ww=function(t,e,n,i){function r(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(f){try{u(i.next(f))}catch(p){s(p)}}function c(f){try{u(i.throw(f))}catch(p){s(p)}}function u(f){f.done?o(f.value):r(f.value).then(a,c)}u((i=i.apply(t,e||[])).next())})};class Sw{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n}asStream(){return new bw(this.downloadFn,this.shouldThrowOnError)}then(e,n){return this.execute().then(e,n)}execute(){return ww(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(gn(e))return{data:null,error:e};throw e}})}}var Kn=function(t,e,n,i){function r(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(f){try{u(i.next(f))}catch(p){s(p)}}function c(f){try{u(i.throw(f))}catch(p){s(p)}}function u(f){f.done?o(f.value):r(f.value).then(a,c)}u((i=i.apply(t,e||[])).next())})};const _w={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Jp={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Cw{constructor(e,n={},i,r){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=i,this.fetch=Xv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,i,r){return Kn(this,void 0,void 0,function*(){try{let o;const s=Object.assign(Object.assign({},Jp),r);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(s.upsert)});const c=s.metadata;typeof Blob<"u"&&i instanceof Blob?(o=new FormData,o.append("cacheControl",s.cacheControl),c&&o.append("metadata",this.encodeMetadata(c)),o.append("",i)):typeof FormData<"u"&&i instanceof FormData?(o=i,o.append("cacheControl",s.cacheControl),c&&o.append("metadata",this.encodeMetadata(c))):(o=i,a["cache-control"]=`max-age=${s.cacheControl}`,a["content-type"]=s.contentType,c&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),r!=null&&r.headers&&(a=Object.assign(Object.assign({},a),r.headers));const u=this._removeEmptyFolders(n),f=this._getFinalPath(u),p=yield(e=="PUT"?Cd:Qi)(this.fetch,`${this.url}/object/${f}`,o,Object.assign({headers:a},s!=null&&s.duplex?{duplex:s.duplex}:{}));return{data:{path:u,id:p.Id,fullPath:p.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(gn(o))return{data:null,error:o};throw o}})}upload(e,n,i){return Kn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,i)})}uploadToSignedUrl(e,n,i,r){return Kn(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),s=this._getFinalPath(o),a=new URL(this.url+`/object/upload/sign/${s}`);a.searchParams.set("token",n);try{let c;const u=Object.assign({upsert:Jp.upsert},r),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&i instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",i)):typeof FormData<"u"&&i instanceof FormData?(c=i,c.append("cacheControl",u.cacheControl)):(c=i,f["cache-control"]=`max-age=${u.cacheControl}`,f["content-type"]=u.contentType);const p=yield Cd(this.fetch,a.toString(),c,{headers:f});return{data:{path:o,fullPath:p.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(gn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,n){return Kn(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e);const r=Object.assign({},this.headers);n!=null&&n.upsert&&(r["x-upsert"]="true");const o=yield Qi(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),s=new URL(this.url+o.url),a=s.searchParams.get("token");if(!a)throw new df("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:a},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(gn(i))return{data:null,error:i};throw i}})}update(e,n,i){return Kn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,i)})}move(e,n,i){return Kn(this,void 0,void 0,function*(){try{return{data:yield Qi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(gn(r))return{data:null,error:r};throw r}})}copy(e,n,i){return Kn(this,void 0,void 0,function*(){try{return{data:{path:(yield Qi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(gn(r))return{data:null,error:r};throw r}})}createSignedUrl(e,n,i){return Kn(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),o=yield Qi(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const s=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${s}`)},{data:o,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(gn(r))return{data:null,error:r};throw r}})}createSignedUrls(e,n,i){return Kn(this,void 0,void 0,function*(){try{const r=yield Qi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),o=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${o}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(gn(r))return{data:null,error:r};throw r}})}download(e,n){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),s=o?`?${o}`:"",a=this._getFinalPath(e),c=()=>ac(this.fetch,`${this.url}/${r}/${a}${s}`,{headers:this.headers,noResolveJson:!0});return new Sw(c,this.shouldThrowOnError)}info(e){return Kn(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const i=yield ac(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:_d(i),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(gn(i))return{data:null,error:i};throw i}})}exists(e){return Kn(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield vw(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(gn(i)&&i instanceof Sd){const r=i.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:i}}throw i}})}getPublicUrl(e,n){const i=this._getFinalPath(e),r=[],o=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";o!==""&&r.push(o);const a=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});c!==""&&r.push(c);let u=r.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${i}${u}`)}}}remove(e){return Kn(this,void 0,void 0,function*(){try{return{data:yield Zv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gn(n))return{data:null,error:n};throw n}})}list(e,n,i){return Kn(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},_w),n),{prefix:e||""});return{data:yield Qi(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(gn(r))return{data:null,error:r};throw r}})}listV2(e,n){return Kn(this,void 0,void 0,function*(){try{const i=Object.assign({},e);return{data:yield Qi(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(gn(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const Ew="2.12.2",Tw={"X-Client-Info":`storage-js/${Ew}`};var fs=function(t,e,n,i){function r(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(f){try{u(i.next(f))}catch(p){s(p)}}function c(f){try{u(i.throw(f))}catch(p){s(p)}}function u(f){f.done?o(f.value):r(f.value).then(a,c)}u((i=i.apply(t,e||[])).next())})};class Aw{constructor(e,n={},i,r){this.shouldThrowOnError=!1;const o=new URL(e);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href,this.headers=Object.assign(Object.assign({},Tw),n),this.fetch=Xv(i)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return fs(this,void 0,void 0,function*(){try{return{data:yield ac(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(gn(e))return{data:null,error:e};throw e}})}getBucket(e){return fs(this,void 0,void 0,function*(){try{return{data:yield ac(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gn(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return fs(this,void 0,void 0,function*(){try{return{data:yield Qi(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(gn(i))return{data:null,error:i};throw i}})}updateBucket(e,n){return fs(this,void 0,void 0,function*(){try{return{data:yield Cd(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(gn(i))return{data:null,error:i};throw i}})}emptyBucket(e){return fs(this,void 0,void 0,function*(){try{return{data:yield Qi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return fs(this,void 0,void 0,function*(){try{return{data:yield Zv(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gn(n))return{data:null,error:n};throw n}})}}class Iw extends Aw{constructor(e,n={},i,r){super(e,n,i,r)}from(e){return new Cw(this.url,this.headers,e,this.fetch)}}const kw="2.58.0";let wa="";typeof Deno<"u"?wa="deno":typeof document<"u"?wa="web":typeof navigator<"u"&&navigator.product==="ReactNative"?wa="react-native":wa="node";const xw={"X-Client-Info":`supabase-js-${wa}/${kw}`},Lw={headers:xw},Pw={schema:"public"},Nw={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Rw={};var Mw=function(t,e,n,i){function r(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(f){try{u(i.next(f))}catch(p){s(p)}}function c(f){try{u(i.throw(f))}catch(p){s(p)}}function u(f){f.done?o(f.value):r(f.value).then(a,c)}u((i=i.apply(t,e||[])).next())})};const Bw=t=>{let e;return t?e=t:typeof fetch>"u"?e=Vv:e=fetch,(...n)=>e(...n)},Dw=()=>typeof Headers>"u"?Gv:Headers,Fw=(t,e,n)=>{const i=Bw(n),r=Dw();return(o,s)=>Mw(void 0,void 0,void 0,function*(){var a;const c=(a=yield e())!==null&&a!==void 0?a:t;let u=new r(s==null?void 0:s.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),i(o,Object.assign(Object.assign({},s),{headers:u}))})};var qw=function(t,e,n,i){function r(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(f){try{u(i.next(f))}catch(p){s(p)}}function c(f){try{u(i.throw(f))}catch(p){s(p)}}function u(f){f.done?o(f.value):r(f.value).then(a,c)}u((i=i.apply(t,e||[])).next())})};function Uw(t){return t.endsWith("/")?t:t+"/"}function $w(t,e){var n,i;const{db:r,auth:o,realtime:s,global:a}=t,{db:c,auth:u,realtime:f,global:p}=e,v={db:Object.assign(Object.assign({},c),r),auth:Object.assign(Object.assign({},u),o),realtime:Object.assign(Object.assign({},f),s),storage:{},global:Object.assign(Object.assign(Object.assign({},p),a),{headers:Object.assign(Object.assign({},(n=p==null?void 0:p.headers)!==null&&n!==void 0?n:{}),(i=a==null?void 0:a.headers)!==null&&i!==void 0?i:{})}),accessToken:()=>qw(this,void 0,void 0,function*(){return""})};return t.accessToken?v.accessToken=t.accessToken:delete v.accessToken,v}function Ow(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Uw(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const ey="2.72.0",bs=30*1e3,Ed=3,qu=Ed*bs,Hw="http://localhost:9999",Vw="supabase.auth.token",Gw={"X-Client-Info":`gotrue-js/${ey}`},Td="X-Supabase-Api-Version",ty={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Ww=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,zw=600*1e3;class ff extends Error{constructor(e,n,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=i}}function ft(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Jw extends ff{constructor(e,n,i){super(e,n,i),this.name="AuthApiError",this.status=n,this.code=i}}function Yw(t){return ft(t)&&t.name==="AuthApiError"}class ny extends ff{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class eo extends ff{constructor(e,n,i,r){super(e,i,r),this.name=n,this.status=i}}class Jr extends eo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Kw(t){return ft(t)&&t.name==="AuthSessionMissingError"}class ya extends eo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Fl extends eo{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ql extends eo{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function jw(t){return ft(t)&&t.name==="AuthImplicitGrantRedirectError"}class Yp extends eo{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ad extends eo{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Uu(t){return ft(t)&&t.name==="AuthRetryableFetchError"}class Kp extends eo{constructor(e,n,i){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=i}}class Id extends eo{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const lc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),jp=` 	
\r=`.split(""),Qw=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<jp.length;e+=1)t[jp[e].charCodeAt(0)]=-2;for(let e=0;e<lc.length;e+=1)t[lc[e].charCodeAt(0)]=e;return t})();function Qp(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;n(lc[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;n(lc[i]),e.queuedBits-=6}}function iy(t,e,n){const i=Qw[t];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Xp(t){const e=[],n=s=>{e.push(String.fromCodePoint(s))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},o=s=>{eS(s,i,n)};for(let s=0;s<t.length;s+=1)iy(t.charCodeAt(s),r,o);return e.join("")}function Xw(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Zw(t,e){for(let n=0;n<t.length;n+=1){let i=t.charCodeAt(n);if(i>55295&&i<=56319){const r=(i-55296)*1024&65535;i=(t.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}Xw(i,e)}}function eS(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let i=1;i<6;i+=1)if((t>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function tS(t){const e=[],n={queue:0,queuedBits:0},i=r=>{e.push(r)};for(let r=0;r<t.length;r+=1)iy(t.charCodeAt(r),n,i);return new Uint8Array(e)}function nS(t){const e=[];return Zw(t,n=>e.push(n)),new Uint8Array(e)}function iS(t){const e=[],n={queue:0,queuedBits:0},i=r=>{e.push(r)};return t.forEach(r=>Qp(r,n,i)),Qp(null,n,i),e.join("")}function rS(t){return Math.round(Date.now()/1e3)+t}function oS(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const bi=()=>typeof window<"u"&&typeof document<"u",Ao={tested:!1,writable:!1},ry=()=>{if(!bi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ao.tested)return Ao.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ao.tested=!0,Ao.writable=!0}catch{Ao.tested=!0,Ao.writable=!1}return Ao.writable};function sS(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,o)=>{e[o]=r})}catch{}return n.searchParams.forEach((i,r)=>{e[r]=i}),e}const oy=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Xr(async()=>{const{default:i}=await Promise.resolve().then(()=>Fs);return{default:i}},void 0).then(({default:i})=>i(...n)):e=fetch,(...n)=>e(...n)},aS=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",ws=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Io=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Hr=async(t,e)=>{await t.removeItem(e)};class Ic{constructor(){this.promise=new Ic.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Ic.promiseConstructor=Promise;function $u(t){const e=t.split(".");if(e.length!==3)throw new Id("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!Ww.test(e[i]))throw new Id("JWT not in base64url format");return{header:JSON.parse(Xp(e[0])),payload:JSON.parse(Xp(e[1])),signature:tS(e[2]),raw:{header:e[0],payload:e[1]}}}async function lS(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function cS(t,e){return new Promise((i,r)=>{(async()=>{for(let o=0;o<1/0;o++)try{const s=await t(o);if(!e(o,null,s)){i(s);return}}catch(s){if(!e(o,s)){r(s);return}}})()})}function uS(t){return("0"+t.toString(16)).substr(-2)}function dS(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=n.length;let r="";for(let o=0;o<56;o++)r+=n.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(e),Array.from(e,uS).join("")}async function fS(t){const n=new TextEncoder().encode(t),i=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(i);return Array.from(r).map(o=>String.fromCharCode(o)).join("")}async function hS(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await fS(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function hs(t,e,n=!1){const i=dS();let r=i;n&&(r+="/PASSWORD_RECOVERY"),await ws(t,`${e}-code-verifier`,r);const o=await hS(i);return[o,i===o?"plain":"s256"]}const pS=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function gS(t){const e=t.headers.get(Td);if(!e||!e.match(pS))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function mS(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function vS(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const yS=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ps(t){if(!yS.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ou(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Zp(t){return JSON.parse(JSON.stringify(t))}var bS=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const xo=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),wS=[502,503,504];async function eg(t){var e;if(!aS(t))throw new Ad(xo(t),0);if(wS.includes(t.status))throw new Ad(xo(t),t.status);let n;try{n=await t.json()}catch(o){throw new ny(xo(o),o)}let i;const r=gS(t);if(r&&r.getTime()>=ty["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?i=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(i=n.error_code),i){if(i==="weak_password")throw new Kp(xo(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new Jr}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((o,s)=>o&&typeof s=="string",!0))throw new Kp(xo(n),t.status,n.weak_password.reasons);throw new Jw(xo(n),t.status||500,i)}const SS=(t,e,n,i)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),n))};async function wt(t,e,n,i){var r;const o=Object.assign({},i==null?void 0:i.headers);o[Td]||(o[Td]=ty["2024-01-01"].name),i!=null&&i.jwt&&(o.Authorization=`Bearer ${i.jwt}`);const s=(r=i==null?void 0:i.query)!==null&&r!==void 0?r:{};i!=null&&i.redirectTo&&(s.redirect_to=i.redirectTo);const a=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",c=await _S(t,e,n+a,{headers:o,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(c):{data:Object.assign({},c),error:null}}async function _S(t,e,n,i,r,o){const s=SS(e,i,r,o);let a;try{a=await t(n,Object.assign({},s))}catch(c){throw console.error(c),new Ad(xo(c),0)}if(a.ok||await eg(a),i!=null&&i.noResolveJson)return a;try{return await a.json()}catch(c){await eg(c)}}function ji(t){var e;let n=null;AS(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=rS(t.expires_in)));const i=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:i},error:null}}function tg(t){const e=ji(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,i)=>n&&typeof i=="string",!0)&&(e.data.weak_password=t.weak_password),e}function jr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function CS(t){return{data:t,error:null}}function ES(t){const{action_link:e,email_otp:n,hashed_token:i,redirect_to:r,verification_type:o}=t,s=bS(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:i,redirect_to:r,verification_type:o},c=Object.assign({},s);return{data:{properties:a,user:c},error:null}}function TS(t){return t}function AS(t){return t.access_token&&t.refresh_token&&t.expires_in}const Hu=["global","local","others"];var IS=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class kS{constructor({url:e="",headers:n={},fetch:i}){this.url=e,this.headers=n,this.fetch=oy(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=Hu[0]){if(Hu.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Hu.join(", ")}`);try{return await wt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(ft(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,n={}){try{return await wt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:jr})}catch(i){if(ft(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:n}=e,i=IS(e,["options"]),r=Object.assign(Object.assign({},i),n);return"newEmail"in i&&(r.new_email=i==null?void 0:i.newEmail,delete r.newEmail),await wt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:ES,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ft(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await wt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:jr})}catch(n){if(ft(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,i,r,o,s,a,c;try{const u={nextPage:null,lastPage:0,total:0},f=await wt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(o=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:""},xform:TS});if(f.error)throw f.error;const p=await f.json(),v=(s=f.headers.get("x-total-count"))!==null&&s!==void 0?s:0,m=(c=(a=f.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(S=>{const _=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(S.split(";")[1].split("=")[1]);u[`${E}Page`]=_}),u.total=parseInt(v)),{data:Object.assign(Object.assign({},p),u),error:null}}catch(u){if(ft(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){ps(e);try{return await wt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:jr})}catch(n){if(ft(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){ps(e);try{return await wt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:jr})}catch(i){if(ft(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,n=!1){ps(e);try{return await wt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:jr})}catch(i){if(ft(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){ps(e.userId);try{const{data:n,error:i}=await wt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:i}}catch(n){if(ft(n))return{data:null,error:n};throw n}}async _deleteFactor(e){ps(e.userId),ps(e.id);try{return{data:await wt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}}}function ng(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function xS(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const gs={debug:!!(globalThis&&ry()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class sy extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class LS extends sy{}async function PS(t,e,n){gs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),gs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async r=>{if(r){gs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,r.name);try{return await n()}finally{gs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,r.name)}}else{if(e===0)throw gs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new LS(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(gs.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function ay(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function NS(t){return parseInt(t,16)}function RS(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function MS(t){var e;const{chainId:n,domain:i,expirationTime:r,issuedAt:o=new Date,nonce:s,notBefore:a,requestId:c,resources:u,scheme:f,uri:p,version:v}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(s&&s.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${s}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const m=ay(t.address),S=f?`${f}://${i}`:i,_=t.statement?`${t.statement}
`:"",E=`${S} wants you to sign in with your Ethereum account:
${m}

${_}`;let C=`URI: ${p}
Version: ${v}
Chain ID: ${n}${s?`
Nonce: ${s}`:""}
Issued At: ${o.toISOString()}`;if(r&&(C+=`
Expiration Time: ${r.toISOString()}`),a&&(C+=`
Not Before: ${a.toISOString()}`),c&&(C+=`
Request ID: ${c}`),u){let k=`
Resources:`;for(const I of u){if(!I||typeof I!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${I}`);k+=`
- ${I}`}C+=k}return`${E}
${C}`}xS();const BS={url:Hw,storageKey:Vw,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Gw,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ig(t,e,n){return await n()}const ms={};class Da{constructor(e){var n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Da.nextInstanceID,Da.nextInstanceID+=1,this.instanceID>0&&bi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},BS),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new kS({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=oy(r.fetch),this.lock=r.lock||ig,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:bi()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=PS:this.lock=ig,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:ry()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ng(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=ng(this.memoryStorage)),bi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=ms[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){ms[this.storageKey]=Object.assign(Object.assign({},ms[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=ms[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ms[this.storageKey]=Object.assign(Object.assign({},ms[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ey}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=sS(window.location.href);let i="none";if(this._isImplicitGrantCallback(n)?i="implicit":await this._isPKCECallback(n)&&(i="pkce"),bi()&&this.detectSessionInUrl&&i!=="none"){const{data:r,error:o}=await this._getSessionFromURL(n,i);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),jw(o)){const c=(e=o.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:s,redirectType:a}=r;return this._debug("#_initialize()","detected session in URL",s,"redirect type",a),await this._saveSession(s),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ft(n)?{error:n}:{error:new ny("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,i,r;try{const o=await wt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:ji}),{data:s,error:a}=o;if(a||!s)return{data:{user:null,session:null},error:a};const c=s.session,u=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(o){if(ft(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var n,i,r;try{let o;if("email"in e){const{email:f,password:p,options:v}=e;let m=null,S=null;this.flowType==="pkce"&&([m,S]=await hs(this.storage,this.storageKey)),o=await wt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:f,password:p,data:(n=v==null?void 0:v.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:m,code_challenge_method:S},xform:ji})}else if("phone"in e){const{phone:f,password:p,options:v}=e;o=await wt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:p,data:(i=v==null?void 0:v.data)!==null&&i!==void 0?i:{},channel:(r=v==null?void 0:v.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:ji})}else throw new Fl("You must provide either an email or phone number and a password");const{data:s,error:a}=o;if(a||!s)return{data:{user:null,session:null},error:a};const c=s.session,u=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(o){if(ft(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let n;if("email"in e){const{email:o,password:s,options:a}=e;n=await wt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:tg})}else if("phone"in e){const{phone:o,password:s,options:a}=e;n=await wt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:tg})}else throw new Fl("You must provide either an email or phone number and a password");const{data:i,error:r}=n;return r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new ya}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(n){if(ft(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,i,r,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,i,r,o,s,a,c,u,f,p,v;let m,S;if("message"in e)m=e.message,S=e.signature;else{const{chain:_,wallet:E,statement:C,options:k}=e;let I;if(bi())if(typeof E=="object")I=E;else{const D=window;if("ethereum"in D&&typeof D.ethereum=="object"&&"request"in D.ethereum&&typeof D.ethereum.request=="function")I=D.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!(k!=null&&k.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");I=E}const P=new URL((n=k==null?void 0:k.url)!==null&&n!==void 0?n:window.location.href),G=await I.request({method:"eth_requestAccounts"}).then(D=>D).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!G||G.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const ee=ay(G[0]);let te=(i=k==null?void 0:k.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!te){const D=await I.request({method:"eth_chainId"});te=NS(D)}const Y={domain:P.host,address:ee,statement:C,uri:P.href,version:"1",chainId:te,nonce:(r=k==null?void 0:k.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(s=(o=k==null?void 0:k.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&s!==void 0?s:new Date,expirationTime:(a=k==null?void 0:k.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(c=k==null?void 0:k.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=k==null?void 0:k.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(f=k==null?void 0:k.signInWithEthereum)===null||f===void 0?void 0:f.resources};m=MS(Y),S=await I.request({method:"personal_sign",params:[RS(m),ee]})}try{const{data:_,error:E}=await wt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:S},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:ji});if(E)throw E;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new ya}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:E})}catch(_){if(ft(_))return{data:{user:null,session:null},error:_};throw _}}async signInWithSolana(e){var n,i,r,o,s,a,c,u,f,p,v,m;let S,_;if("message"in e)S=e.message,_=e.signature;else{const{chain:E,wallet:C,statement:k,options:I}=e;let P;if(bi())if(typeof C=="object")P=C;else{const ee=window;if("solana"in ee&&typeof ee.solana=="object"&&("signIn"in ee.solana&&typeof ee.solana.signIn=="function"||"signMessage"in ee.solana&&typeof ee.solana.signMessage=="function"))P=ee.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof C!="object"||!(I!=null&&I.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=C}const G=new URL((n=I==null?void 0:I.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in P&&P.signIn){const ee=await P.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},I==null?void 0:I.signInWithSolana),{version:"1",domain:G.host,uri:G.href}),k?{statement:k}:null));let te;if(Array.isArray(ee)&&ee[0]&&typeof ee[0]=="object")te=ee[0];else if(ee&&typeof ee=="object"&&"signedMessage"in ee&&"signature"in ee)te=ee;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in te&&"signature"in te&&(typeof te.signedMessage=="string"||te.signedMessage instanceof Uint8Array)&&te.signature instanceof Uint8Array)S=typeof te.signedMessage=="string"?te.signedMessage:new TextDecoder().decode(te.signedMessage),_=te.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in P)||typeof P.signMessage!="function"||!("publicKey"in P)||typeof P!="object"||!P.publicKey||!("toBase58"in P.publicKey)||typeof P.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${G.host} wants you to sign in with your Solana account:`,P.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${G.href}`,`Issued At: ${(r=(i=I==null?void 0:I.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((o=I==null?void 0:I.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${I.signInWithSolana.notBefore}`]:[],...!((s=I==null?void 0:I.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${I.signInWithSolana.expirationTime}`]:[],...!((a=I==null?void 0:I.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${I.signInWithSolana.chainId}`]:[],...!((c=I==null?void 0:I.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${I.signInWithSolana.nonce}`]:[],...!((u=I==null?void 0:I.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${I.signInWithSolana.requestId}`]:[],...!((p=(f=I==null?void 0:I.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||p===void 0)&&p.length?["Resources",...I.signInWithSolana.resources.map(te=>`- ${te}`)]:[]].join(`
`);const ee=await P.signMessage(new TextEncoder().encode(S),"utf8");if(!ee||!(ee instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=ee}}try{const{data:E,error:C}=await wt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:iS(_)},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:ji});if(C)throw C;return!E||!E.session||!E.user?{data:{user:null,session:null},error:new ya}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),{data:Object.assign({},E),error:C})}catch(E){if(ft(E))return{data:{user:null,session:null},error:E};throw E}}async _exchangeCodeForSession(e){const n=await Io(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(n??"").split("/");try{const{data:o,error:s}=await wt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:ji});if(await Hr(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new ya}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:r??null}),error:s})}catch(o){if(ft(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:n,provider:i,token:r,access_token:o,nonce:s}=e,a=await wt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:o,nonce:s,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:ji}),{data:c,error:u}=a;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new ya}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(n){if(ft(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,i,r,o,s;try{if("email"in e){const{email:a,options:c}=e;let u=null,f=null;this.flowType==="pkce"&&([u,f]=await hs(this.storage,this.storageKey));const{error:p}=await wt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:f},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in e){const{phone:a,options:c}=e,{data:u,error:f}=await wt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(o=c==null?void 0:c.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(s=c==null?void 0:c.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:f}}throw new Fl("You must provide either an email or phone number.")}catch(a){if(ft(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var n,i;try{let r,o;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,o=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:s,error:a}=await wt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:r,xform:ji});if(a)throw a;if(!s)throw new Error("An error occurred on token verification.");const c=s.session,u=s.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(r){if(ft(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var n,i,r;try{let o=null,s=null;return this.flowType==="pkce"&&([o,s]=await hs(this.storage,this.storageKey)),await wt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:s}),headers:this.headers,xform:CS})}catch(o){if(ft(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:i}=e;if(i)throw i;if(!n)throw new Jr;const{error:r}=await wt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(ft(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:i,type:r,options:o}=e,{error:s}=await wt(this.fetch,"POST",n,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in e){const{phone:i,type:r,options:o}=e,{data:s,error:a}=await wt(this.fetch,"POST",n,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:a}}throw new Fl("You must provide either an email or phone number and a type")}catch(n){if(ft(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await i,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=n();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Io(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<qu:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const s=await Io(this.userStorage,this.storageKey+"-user");s!=null&&s.user?e.user=s.user:e.user=Ou()}if(this.storage.isServer&&e.user){let s=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,f)=>(!s&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,f))})}return{data:{session:e},error:null}}const{session:r,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await wt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:jr}):await this._useSession(async n=>{var i,r,o;const{data:s,error:a}=n;if(a)throw a;return!(!((i=s.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Jr}:await wt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0,xform:jr})})}catch(n){if(ft(n))return Kw(n)&&(await this._removeSession(),await Hr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async i=>{const{data:r,error:o}=i;if(o)throw o;if(!r.session)throw new Jr;const s=r.session;let a=null,c=null;this.flowType==="pkce"&&e.email!=null&&([a,c]=await hs(this.storage,this.storageKey));const{data:u,error:f}=await wt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:c}),jwt:s.access_token,xform:jr});if(f)throw f;return s.user=u.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(i){if(ft(i))return{data:{user:null},error:i};throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Jr;const n=Date.now()/1e3;let i=n,r=!0,o=null;const{payload:s}=$u(e.access_token);if(s.exp&&(i=s.exp,r=i<=n),r){const{session:a,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!a)return{data:{user:null,session:null},error:null};o=a}else{const{data:a,error:c}=await this._getUser(e.access_token);if(c)throw c;o={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:i-n,expires_at:i},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(n){if(ft(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var i;if(!e){const{data:s,error:a}=n;if(a)throw a;e=(i=s.session)!==null&&i!==void 0?i:void 0}if(!(e!=null&&e.refresh_token))throw new Jr;const{session:r,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ft(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!bi())throw new ql("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ql(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Yp("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ql("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Yp("No code detected.");const{data:k,error:I}=await this._exchangeCodeForSession(e.code);if(I)throw I;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:r,access_token:o,refresh_token:s,expires_in:a,expires_at:c,token_type:u}=e;if(!o||!a||!s||!u)throw new ql("No session defined in URL");const f=Math.round(Date.now()/1e3),p=parseInt(a);let v=f+p;c&&(v=parseInt(c));const m=v-f;m*1e3<=bs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${p}s`);const S=v-p;f-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,v,f):f-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,v,f);const{data:_,error:E}=await this._getUser(o);if(E)throw E;const C={provider_token:i,provider_refresh_token:r,access_token:o,expires_in:p,expires_at:v,refresh_token:s,token_type:u,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:C,redirectType:e.type},error:null}}catch(i){if(ft(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Io(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var i;const{data:r,error:o}=n;if(o)return{error:o};const s=(i=r.session)===null||i===void 0?void 0:i.access_token;if(s){const{error:a}=await this.admin.signOut(s,e);if(a&&!(Yw(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Hr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=oS(),i={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async n=>{var i,r;try{const{data:{session:o},error:s}=n;if(s)throw s;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,n={}){let i=null,r=null;this.flowType==="pkce"&&([i,r]=await hs(this.storage,this.storageKey,!0));try{return await wt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(o){if(ft(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:n,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:i,error:r}=await this._useSession(async o=>{var s,a,c,u,f;const{data:p,error:v}=o;if(v)throw v;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await wt(this.fetch,"GET",m,{headers:this.headers,jwt:(f=(u=p.session)===null||u===void 0?void 0:u.access_token)!==null&&f!==void 0?f:void 0})});if(r)throw r;return bi()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:e.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(ft(i))return{data:{provider:e.provider,url:null},error:i};throw i}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var i,r;const{data:o,error:s}=n;if(s)throw s;return await wt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(ft(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const i=Date.now();return await cS(async r=>(r>0&&await lS(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await wt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ji})),(r,o)=>{const s=200*Math.pow(2,r);return o&&Uu(o)&&Date.now()+s-i<bs})}catch(i){if(this._debug(n,"error",i),ft(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",i),bi()&&!n.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,n;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const r=await Io(this.storage,this.storageKey);if(r&&this.userStorage){let s=await Io(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:r.user},await ws(this.userStorage,this.storageKey+"-user",s)),r.user=(e=s==null?void 0:s.user)!==null&&e!==void 0?e:Ou()}else if(r&&!r.user&&!r.user){const s=await Io(this.storage,this.storageKey+"-user");s&&(s!=null&&s.user)?(r.user=s.user,await Hr(this.storage,this.storageKey+"-user"),await ws(this.storage,this.storageKey,r)):r.user=Ou()}if(this._debug(i,"session from storage",r),!this._isValidSession(r)){this._debug(i,"session is not valid"),r!==null&&await this._removeSession();return}const o=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<qu;if(this._debug(i,`session has${o?"":" not"} expired with margin of ${qu}s`),o){if(this.autoRefreshToken&&r.refresh_token){const{error:s}=await this._callRefreshToken(r.refresh_token);s&&(console.error(s),Uu(s)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:a}=await this._getUser(r.access_token);!a&&(s!=null&&s.user)?(r.user=s.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(i,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(i,"error",r),console.error(r);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var n,i;if(!e)throw new Jr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Ic;const{data:o,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!o.session)throw new Jr;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const a={session:o.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(o){if(this._debug(r,"error",o),ft(o)){const s={session:null,error:o};return Uu(o)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(s),s}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(o),o}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,i=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:n});const o=[],s=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(c){o.push(c)}});if(await Promise.all(s),o.length>0){for(let a=0;a<o.length;a+=1)console.error(o[a]);throw o[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),i=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&n.user&&await ws(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const o=Zp(r);await ws(this.storage,this.storageKey,o)}else{const r=Zp(n);await ws(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await Hr(this.storage,this.storageKey),await Hr(this.storage,this.storageKey+"-code-verifier"),await Hr(this.storage,this.storageKey+"-user"),this.userStorage&&await Hr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&bi()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),bs);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:i}}=n;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-e)/bs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${bs}ms, refresh threshold is ${Ed} ticks`),r<=Ed&&await this._callRefreshToken(i.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof sy)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!bi()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,i){const r=[`provider=${encodeURIComponent(n)}`];if(i!=null&&i.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[o,s]=await hs(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(s)}`});r.push(a.toString())}if(i!=null&&i.queryParams){const o=new URLSearchParams(i.queryParams);r.push(o.toString())}return i!=null&&i.skipBrowserRedirect&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var i;const{data:r,error:o}=n;return o?{data:null,error:o}:await wt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(ft(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var i,r;const{data:o,error:s}=n;if(s)return{data:null,error:s};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=await wt(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(i=o==null?void 0:o.session)===null||i===void 0?void 0:i.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((r=c==null?void 0:c.totp)===null||r===void 0)&&r.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(n){if(ft(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:o}=n;if(o)return{data:null,error:o};const{data:s,error:a}=await wt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:a})})}catch(n){if(ft(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:o}=n;return o?{data:null,error:o}:await wt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(ft(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:i}=await this._challenge({factorId:e.factorId});return i?{data:null,error:i}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const i=(e==null?void 0:e.factors)||[],r=i.filter(s=>s.factor_type==="totp"&&s.status==="verified"),o=i.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:i,totp:r,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,i;const{data:{session:r},error:o}=e;if(o)return{data:null,error:o};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=$u(r.access_token);let a=null;s.aal&&(a=s.aal);let c=a;((i=(n=r.user.factors)===null||n===void 0?void 0:n.filter(p=>p.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(c="aal2");const f=s.amr||[];return{data:{currentLevel:a,nextLevel:c,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(e,n={keys:[]}){let i=n.keys.find(a=>a.kid===e);if(i)return i;const r=Date.now();if(i=this.jwks.keys.find(a=>a.kid===e),i&&this.jwks_cached_at+zw>r)return i;const{data:o,error:s}=await wt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=r,i=o.keys.find(a=>a.kid===e),!i)?null:i}async getClaims(e,n={}){try{let i=e;if(!i){const{data:m,error:S}=await this.getSession();if(S||!m.session)return{data:null,error:S};i=m.session.access_token}const{header:r,payload:o,signature:s,raw:{header:a,payload:c}}=$u(i);n!=null&&n.allowExpired||mS(o.exp);const u=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:m}=await this.getUser(i);if(m)throw m;return{data:{claims:o,header:r,signature:s},error:null}}const f=vS(r.alg),p=await crypto.subtle.importKey("jwk",u,f,!0,["verify"]);if(!await crypto.subtle.verify(f,p,s,nS(`${a}.${c}`)))throw new Id("Invalid JWT signature");return{data:{claims:o,header:r,signature:s},error:null}}catch(i){if(ft(i))return{data:null,error:i};throw i}}}Da.nextInstanceID=0;const DS=Da;class FS extends DS{constructor(e){super(e)}}var qS=function(t,e,n,i){function r(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(f){try{u(i.next(f))}catch(p){s(p)}}function c(f){try{u(i.throw(f))}catch(p){s(p)}}function u(f){f.done?o(f.value):r(f.value).then(a,c)}u((i=i.apply(t,e||[])).next())})};class US{constructor(e,n,i){var r,o,s;this.supabaseUrl=e,this.supabaseKey=n;const a=Ow(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const c=`sb-${a.hostname.split(".")[0]}-auth-token`,u={db:Pw,realtime:Rw,auth:Object.assign(Object.assign({},Nw),{storageKey:c}),global:Lw},f=$w(i??{},u);this.storageKey=(r=f.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(o=f.global.headers)!==null&&o!==void 0?o:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(p,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=f.auth)!==null&&s!==void 0?s:{},this.headers,f.global.fetch),this.fetch=Fw(n,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new J5(new URL("rest/v1",a).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new Iw(this.storageUrl.href,this.headers,this.fetch,i==null?void 0:i.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new B5(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},i={}){return this.rest.rpc(e,n,i)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return qS(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(n=(e=i.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:i,storage:r,userStorage:o,storageKey:s,flowType:a,lock:c,debug:u},f,p){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new FS({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),f),storageKey:s,autoRefreshToken:e,persistSession:n,detectSessionInUrl:i,storage:r,userStorage:o,flowType:a,lock:c,debug:u,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new uw(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,i)=>{this._handleTokenChanged(n,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(e,n,i){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==i?(this.changedAccessToken=i,this.realtime.setAuth(i)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const $S=(t,e,n)=>new US(t,e,n);function OS(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}OS()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Rn=[];for(let t=0;t<256;++t)Rn.push((t+256).toString(16).slice(1));function HS(t,e=0){return(Rn[t[e+0]]+Rn[t[e+1]]+Rn[t[e+2]]+Rn[t[e+3]]+"-"+Rn[t[e+4]]+Rn[t[e+5]]+"-"+Rn[t[e+6]]+Rn[t[e+7]]+"-"+Rn[t[e+8]]+Rn[t[e+9]]+"-"+Rn[t[e+10]]+Rn[t[e+11]]+Rn[t[e+12]]+Rn[t[e+13]]+Rn[t[e+14]]+Rn[t[e+15]]).toLowerCase()}let Vu;const VS=new Uint8Array(16);function GS(){if(!Vu){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Vu=crypto.getRandomValues.bind(crypto)}return Vu(VS)}const WS=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),rg={randomUUID:WS};function zS(t,e,n){var r;t=t||{};const i=t.random??((r=t.rng)==null?void 0:r.call(t))??GS();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,HS(i)}function JS(t,e,n){return rg.randomUUID&&!t?rg.randomUUID():zS(t)}const YS="https://nlzkghwkdwzjpzdmjuil.supabase.co",KS="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5semtnaHdrZHd6anB6ZG1qdWlsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ3OTYxNzcsImV4cCI6MjA3MDM3MjE3N30.umFzkfIP3Ws5hmXxoEdxrU0V6XyyNZUtapr7411C9N8",In=$S(YS,KS,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}});async function jS(t){var e;try{const{error:n}=await In.from("shipments").insert({id:JS(),service:t.service,tracking_id:t.tracking_id,origin:t.origin,destination:t.destination,cost:t.cost,currency:t.currency,user_email:((e=j.currentUser)==null?void 0:e.email)||null});if(n)throw n;console.log(`Shipment ${t.tracking_id} successfully logged to Supabase.`)}catch(n){console.error("Error logging shipment to Supabase:",n)}}function kc(){if(j.subscriptionTier==="pro")return!0;if(j.isLoggedIn)if(j.aiLookupsRemaining>0){const t=j.aiLookupsRemaining-1;return Ae({aiLookupsRemaining:t}),localStorage.setItem("vcanship_free_lookups",String(t)),od(),!0}else return vh("free"),!1;else{let t=parseInt(localStorage.getItem("vcanship_guest_lookups")||"2",10);return t>0?(t--,localStorage.setItem("vcanship_guest_lookups",String(t)),od(),!0):(vh("guest"),!1)}}function QS(t,e){console.error(`Supabase function error (${e}):`,t);let n=`An error occurred during ${e}. Please try again.`;t.message.includes("QUOTA_EXCEEDED")?n="API quota has been exceeded. Please try again later.":t.message.includes("NetworkError")&&(n="A network error occurred. Please check your connection."),Ee(n,"error")}async function XS(t,e){if(!kc())throw new Error("Usage limit reached.");try{const{data:n,error:i}=await In.functions.invoke(t,{body:e});if(i)throw i;if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n}catch(n){throw QS(n,`AI function ${t}`),n}}async function hf(t){try{return(await XS("get-hs-code",{description:t})).suggestions||[]}catch(e){return console.warn("Could not fetch HS code suggestions:",e),[]}}function ZS(t){const e=t.carrierName||"Carrier",n=`https://logo.clearbit.com/${e.toLowerCase().replace(/\s/g,"")}.com?size=80`,i=JSON.stringify(t).replace(/"/g,"&quot;");return`
        <div class="quote-card ${t.isSpecialOffer?"quote-card-special":""}">
            ${t.isSpecialOffer?'<div class="special-offer-text">Vcanship Direct</div>':""}
            <div class="quote-card-header">
                <img src="${n}" alt="${e} logo" class="carrier-logo" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                <div class="carrier-logo-fallback" style="display: none;">${e.charAt(0)}</div>
                <div class="carrier-info">
                    <span class="carrier-name">${e}</span>
                    <span class="carrier-type">${t.carrierType}</span>
                </div>
                <div class="quote-provider-badge">via ${t.serviceProvider}</div>
            </div>
            <div class="quote-card-body">
                 <div class="quote-card-details">
                    <div class="detail-item">
                        <span>Transit Time</span>
                        <strong>${t.estimatedTransitTime||"N/A"}</strong>
                    </div>
                    <div class="detail-item">
                        <span>Chargeable Weight</span>
                        <strong>${t.chargeableWeight} ${t.chargeableWeightUnit}</strong>
                    </div>
                </div>
                <div class="quote-card-price">
                     <strong>${t.totalCost?`${j.currentCurrency.symbol}${t.totalCost.toFixed(2)}`:"N/A"}</strong>
                     <span>Total Cost</span>
                </div>
            </div>
            ${t.notes?`<div class="quote-card-notes">${t.notes}</div>`:""}
            <div class="quote-card-actions">
                 <button class="secondary-btn view-breakdown-btn" data-quote="${i}" ${t.costBreakdown?"":"disabled"}>Breakdown</button>
                 <button class="main-submit-btn select-quote-btn" data-quote="${i}" ${t.totalCost?"":"disabled"}>Select</button>
            </div>
        </div>
    `}let No=[],kd=[],cc=[],wi=null,qo=null,Di=null,Fa=null,pf=!1;const yt={get modal(){return document.getElementById("locale-modal")},get closeBtn(){return document.getElementById("close-locale-modal-btn")},get cancelBtn(){return document.getElementById("cancel-locale-modal-btn")},get confirmBtn(){return document.getElementById("confirm-locale-btn")},get searchInput(){return document.getElementById("locale-search-input")},get countryList(){return document.getElementById("locale-modal-list")},get previewPanel(){return document.getElementById("locale-selection-preview")},get regionBtn(){return document.getElementById("region-language-btn")},get currencyBtn(){return document.getElementById("currency-selector-btn")},get currencyCodeEl(){return document.getElementById("currency-code")},get currencySymbolEl(){return document.getElementById("currency-symbol")}};function uc(t){if(!t||t.length!==2||!/^[A-Z]{2}$/.test(t.toUpperCase()))return"🏳️";const e=127397;return String.fromCodePoint(...t.toUpperCase().split("").map(n=>e+n.charCodeAt(0)))}const e_=(t,e)=>{let n;return function(...i){clearTimeout(n),n=window.setTimeout(()=>t.apply(this,i),e)}};function ly(){if(!wi||!qo)return;Ae({currentCurrency:wi.currency});const t=new CustomEvent("locale-change",{detail:{country:wi.countryCode,language:qo,currency:wi.currency}});window.dispatchEvent(t)}function gf(){wi&&(yt.currencyCodeEl&&(yt.currencyCodeEl.textContent=wi.currency.code),yt.currencySymbolEl&&(yt.currencySymbolEl.textContent=wi.currency.symbol))}function mf(){if(yt.countryList){if(cc.length===0){yt.countryList.innerHTML='<li class="helper-text" style="padding: 1rem; text-align: center;">No countries found.</li>';return}if(yt.countryList.innerHTML=cc.map(t=>`
        <li class="locale-modal-list-item" role="option" id="country-${t.countryCode}" data-country-code="${t.countryCode}">
            <span class="locale-flag">${uc(t.countryCode)}</span>
            <span class="locale-country-name">${t.countryName}</span>
            <span class="locale-currency-code">${t.currency.code}</span>
        </li>
    `).join(""),Di){const t=yt.countryList.querySelector(`[data-country-code="${Di.countryCode}"]`);t==null||t.classList.add("selected")}}}function cy(){if(!yt.previewPanel)return;if(!Di){yt.previewPanel.innerHTML='<p class="helper-text">Select a country from the list to see options.</p>';return}yt.previewPanel.innerHTML=`
        <div class="locale-preview-flag">${uc(Di.countryCode)}</div>
        <h4 class="locale-preview-name">${Di.countryName}</h4>
        <div class="locale-preview-details" style="width: 100%;">
            <div class="input-wrapper" style="margin-bottom: 1rem;">
                <label for="modal-language-select">Language</label>
                <select id="modal-language-select">
                    ${kd.map(e=>`<option value="${e.code}">${e.name}</option>`).join("")}
                </select>
            </div>
            <div class="input-wrapper">
                 <label>Currency</label>
                 <p style="font-weight: bold;">${Di.currency.code} (${Di.currency.symbol})</p>
            </div>
        </div>
    `;const t=document.getElementById("modal-language-select");t.value=Fa||"en",t.addEventListener("change",()=>{Fa=t.value,yt.confirmBtn&&(yt.confirmBtn.disabled=!1)})}function og(){var n;if(!yt.modal)return;Di=wi,Fa=qo,yt.modal.classList.add("active"),pf=!0;const t=document.getElementById("locale-modal-title"),e=yt.modal.querySelector(".modal-desc");t&&(t.textContent=ze("modals.locale.title")),e&&(e.textContent=ze("modals.locale.description")),yt.cancelBtn&&(yt.cancelBtn.textContent=ze("modals.locale.cancel")),yt.confirmBtn&&(yt.confirmBtn.textContent=ze("modals.locale.confirm")),yt.searchInput&&(yt.searchInput.placeholder=ze("modals.locale.search_placeholder")),mf(),cy(),yt.confirmBtn&&(yt.confirmBtn.disabled=!0),(n=yt.searchInput)==null||n.focus()}function Kl(){yt.modal&&(yt.modal.classList.remove("active"),pf=!1)}const t_=e_(()=>{if(!yt.searchInput)return;const t=yt.searchInput.value.toLowerCase();cc=No.filter(e=>e.countryName.toLowerCase().includes(t)||e.countryCode.toLowerCase().includes(t)),mf()},200);function n_(t){const n=t.target.closest(".locale-modal-list-item");if(n!=null&&n.dataset.countryCode){const i=No.find(r=>r.countryCode===n.dataset.countryCode);i&&(Di=i,mf(),cy(),yt.confirmBtn&&(yt.confirmBtn.disabled=!1))}}function i_(){!Di||!Fa||(wi=Di,qo=Fa,localStorage.setItem("vcanship_country",wi.countryCode),localStorage.setItem("vcanship_language",qo),gf(),ly(),Kl())}function r_(){var t,e,n,i,r,o,s;(t=yt.regionBtn)==null||t.addEventListener("click",og),(e=yt.currencyBtn)==null||e.addEventListener("click",og),(n=yt.searchInput)==null||n.addEventListener("input",t_),(i=yt.countryList)==null||i.addEventListener("click",n_),(r=yt.confirmBtn)==null||r.addEventListener("click",i_),(o=yt.closeBtn)==null||o.addEventListener("click",Kl),(s=yt.cancelBtn)==null||s.addEventListener("click",Kl),document.addEventListener("keydown",a=>{a.key==="Escape"&&pf&&Kl()}),window.addEventListener("locale-change",gf)}async function o_(){try{const[t,e]=await Promise.all([fetch("/locales.json"),fetch("/languages.json")]);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);No=await t.json(),kd=await e.json(),cc=[...No],r_();let n=localStorage.getItem("vcanship_country");if(!n)try{const o=await fetch("https://ipapi.co/json/");if(o.ok){const s=await o.json();No.some(a=>a.countryCode===s.country_code)&&(n=s.country_code,Ee(`Welcome! Your region has been set to ${s.country_name}.`,"info"))}}catch(o){console.warn("Could not detect user country.",o)}n||(n="GB");const i=localStorage.getItem("vcanship_language");wi=No.find(o=>o.countryCode===n)||No[0],qo=i&&kd.some(o=>o.code===i)?i:"en",localStorage.setItem("vcanship_country",wi.countryCode),localStorage.setItem("vcanship_language",qo),gf(),ly()}catch(t){console.error("Failed to initialize Locale Switcher:",t),yt.currencyBtn&&(yt.currencyBtn.textContent="Error")}}const s_=[{name:"Diwali",month:10,relevantCountries:["IN","GB","US","CA","MY"],theme:"family_parcel"},{name:"Christmas",month:11,relevantCountries:["GB","US","DE","FR","AU"],theme:"holiday_parcel"},{name:"Chinese New Year",month:1,relevantCountries:["CN","SG","MY","US"],theme:"cny_freight"},{name:"African Festivals",month:7,relevantCountries:["NG","GH","GB"],theme:"africa_home"}],a_=[{id:"fcl1",service:"fcl",title:"FCL Hot Deal!",description:"Limited slots available on our most popular trade lane.",origin:{city:"Shanghai",countryCode:"CN"},destination:{city:"Rotterdam",countryCode:"NL"},urgencyText:"3 slots left!",price:"$2,800",theme:"generic_fcl"},{id:"fcl2",service:"fcl",title:"Empty Leg FCL",description:"Container repositioning special offer. Book now!",origin:{city:"Los Angeles",countryCode:"US"},destination:{city:"Singapore",countryCode:"SG"},urgencyText:"Ends in 48h",price:"$1,950",theme:"generic_fcl"},{id:"lcl1",service:"lcl",title:"LCL Consolidation",description:"Secure your spot in our weekly shared container.",origin:{city:"Hamburg",countryCode:"DE"},destination:{city:"New York",countryCode:"US"},urgencyText:"Filling up fast!",price:"$95/cbm",theme:"generic_lcl"},{id:"air1",service:"airfreight",title:"Air Freight Capacity",description:"Available capacity on our daily flights. Fast and reliable.",origin:{city:"Hong Kong",countryCode:"HK"},destination:{city:"Frankfurt",countryCode:"DE"},urgencyText:"Daily Flights",price:"$4.50/kg",theme:"generic_air"},{id:"veh1",service:"vehicle",title:"RoRo Vehicle Special",description:"Discounted rate for standard sedans on this route.",origin:{city:"Yokohama",countryCode:"JP"},destination:{city:"Bremerhaven",countryCode:"DE"},price:"$1,600",theme:"generic_vehicle"}];let sg=[];function l_(){const t=localStorage.getItem("vcanship_country")||"GB",e=new Date().getMonth();let n=[];const i=s_.filter(r=>{const o=r.month;return r.relevantCountries.includes(t)&&(e===o||e===o-1)});for(const r of i)r.theme==="family_parcel"&&n.push({id:`promo_${r.name}_${t}`,service:"parcel",title:`Send ${r.name} Gifts!`,description:"Missing home? Send gifts and sweets to family for the festival.",origin:{city:"Mumbai",countryCode:"IN"},destination:{city:t==="GB"?"London":"New York",countryCode:t},theme:"event_parcel"}),r.theme==="cny_freight"&&n.push({id:"promo_cny_fcl",service:"fcl",title:"Pre-CNY Rush!",description:"Beat the holiday rush. Ship your containers before the factories close.",origin:{city:"Qingdao",countryCode:"CN"},destination:{city:"Los Angeles",countryCode:"US"},urgencyText:"Book before peak season!",theme:"event_freight"}),r.theme==="africa_home"&&n.push({id:"promo_africa_parcel",service:"parcel",title:"Bring Home Closer",description:"Send personal effects, fabrics, and food items home for the festival season.",origin:{city:"London",countryCode:"GB"},destination:{city:"Lagos",countryCode:"NG"},theme:"event_parcel"});sg=[...n,...a_],Ae({promotions:sg})}function c_(t){return`
        <div class="deal-card">
            <div class="deal-card-header">
                <h4>${t.title}</h4>
                <span class="service-badge">${t.service.toUpperCase()}</span>
            </div>
            ${t.origin&&t.destination?`
            <p class="deal-card-route">
                <span class="flag-icon">${uc(t.origin.countryCode)}</span> ${t.origin.city} &rarr; 
                <span class="flag-icon">${uc(t.destination.countryCode)}</span> ${t.destination.city}
            </p>`:""}
            <p class="deal-card-desc">${t.description}</p>
            <div class="deal-card-bottom">
                ${t.price?`<p class="deal-card-price">${t.price} <small>Est.</small></p>`:""}
                ${t.urgencyText?`<span class="urgency-badge">${t.urgencyText}</span>`:""}
            </div>
        </div>
    `}function u_(t){j.activePromotionInterval&&clearInterval(j.activePromotionInterval);const e=document.getElementById(t);if(!e)return;let n=0;const i=j.promotions,r=()=>{i.length!==0&&(e.style.opacity="0",setTimeout(()=>{e.innerHTML="";const s=[];for(let a=0;a<4;a++)i.length>0&&s.push(i[(n+a)%i.length]);e.innerHTML=s.map(c_).join(""),e.style.opacity="1",n=(n+4)%(i.length||1)},300))},o=window.setInterval(r,5e3);Ae({activePromotionInterval:o}),r()}let jl=null;function d_(t){const e=document.getElementById("page-container");if(!e)return;dc();const n=document.createElement("div");n.id="service-promo-banner",n.className="service-promo-banner";const i=e.querySelector(".service-page-header");i?i.insertAdjacentElement("afterend",n):e.prepend(n);const r=j.promotions.filter(a=>a.service===t||a.service==="general");if(r.length===0){dc();return}let o=0;const s=()=>{const a=r[o];n.innerHTML=`
            <div class="promo-banner-content">
                <i class="fa-solid fa-tags promo-icon"></i>
                <div class="promo-text">
                    <strong>${a.title}</strong>
                    <span>${a.description} ${a.origin?`${a.origin.city} -> ${a.destination.city}`:""}</span>
                </div>
                ${a.urgencyText?`<span class="urgency-badge">${a.urgencyText}</span>`:""}
            </div>
        `,n.style.opacity="1"};s(),r.length>1&&(jl=window.setInterval(()=>{n.style.opacity="0",setTimeout(()=>{o=(o+1)%r.length,s()},300)},5e3))}function dc(){jl&&(clearInterval(jl),jl=null);const t=document.getElementById("service-promo-banner");t&&t.remove()}function uy(){const t=Le.pageLanding;if(!t)return;t.innerHTML=`
      <div class="hero-parcel-form-card card">
          <div class="landing-form-header">
              <div class="send-parcel-icon-wrapper">
                  <i class="fa-solid fa-truck-fast large-icon"></i>
              </div>
              <div class="header-text">
                  <h3>${ze("landing.parcel_title")}</h3>
                  <p class="subtitle">${ze("landing.parcel_subtitle")}</p>
              </div>
          </div>
          <form id="landing-parcel-form">
                <div class="landing-toggle-grid">
                    <div class="landing-toggle-group">
                        <button type="button" class="toggle-btn active" data-group="ship-type" data-value="local">Local</button>
                        <button type="button" class="toggle-btn" data-group="ship-type" data-value="international">International</button>
                    </div>
                    <div class="landing-toggle-group">
                        <button type="button" class="toggle-btn active" data-group="delivery-type" data-value="pickup">Schedule Pickup</button>
                        <button type="button" class="toggle-btn" data-group="delivery-type" data-value="dropoff">I'll Drop Off</button>
                    </div>
                </div>
                <div class="landing-form-actions">
                    <button type="submit" class="cta-button">${ze("landing.parcel_cta")}</button>
                </div>
          </form>
      </div>

      <section class="landing-hero">
        <div class="seo-rotator-container">
            <div id="seo-rotator-text-1" class="seo-rotator-line seo-rotator-text"></div>
            <div id="seo-rotator-text-2" class="seo-rotator-line seo-rotator-text"></div>
        </div>
        <div id="welcome-banner" class="${j.isLoggedIn?"":"hidden"}"></div>
      </section>

      <section class="landing-section services-overview">
        <h2 class="landing-section-title">Our Core Services</h2>
        <p class="landing-section-subtitle">From a single document to a full container load, we've got you covered.</p>
        <div class="services-overview-grid">
            <div class="service-promo-card card" data-service="parcel">
                <i class="fa-solid fa-box card-icon"></i><h4>Parcel</h4><p>Global door-to-door delivery with the best carriers.</p>
            </div>
            <div class="service-promo-card card" data-service="airfreight">
                <i class="fa-solid fa-plane-departure card-icon card-icon-air"></i><h4>Air Freight</h4><p>Fast and reliable air cargo for time-sensitive shipments.</p>
            </div>
            <div class="service-promo-card card" data-service="fcl">
                <i class="fa-solid fa-boxes-stacked card-icon"></i><h4>Sea Freight FCL</h4><p>Exclusive use of a full container for your goods.</p>
            </div>
            <div class="service-promo-card card" data-service="lcl">
                <i class="fa-solid fa-boxes-packing card-icon"></i><h4>Sea Freight LCL</h4><p>Cost-effective shared container space for smaller loads.</p>
            </div>
            <div class="service-promo-card card" data-service="ecommerce">
                <i class="fa-solid fa-store card-icon"></i><h4>${ze("landing.ecommerce_title")}</h4><p>${ze("landing.ecommerce_subtitle")}</p>
            </div>
        </div>
      </section>

      <section class="landing-section secure-trade-promo">
        <div class="secure-trade-content">
            <div class="secure-trade-text">
                <h2 class="landing-section-title">Trade with Confidence. Ship without Surprises.</h2>
                <p class="landing-section-subtitle" style="text-align: left; margin-left: 0; max-width: 500px;">Introducing <strong>Vcanship Secure Trade</strong>, our new escrow and verification service that eliminates risks for buyers and sellers in global trade.</p>
                <button class="main-submit-btn" data-service="secure-trade">Learn More & Start a Secure Trade</button>
            </div>
            <div class="secure-trade-steps">
                <div class="step-item"><span>1</span><div><h4>Buyer Pays Vcanship</h4><p>The buyer funds the transaction securely in our escrow account.</p></div></div>
                <div class="step-item"><span>2</span><div><h4>Seller Delivers to Us</h4><p>Seller delivers goods to a Vcanship warehouse for verification.</p></div></div>
                <div class="step-item"><span>3</span><div><h4>We Verify & Ship</h4><p>We inspect the cargo, send a report to the buyer, and ship upon approval.</p></div></div>
                <div class="step-item"><span>4</span><div><h4>Seller Gets Paid</h4><p>We release the funds to the seller once the shipment is underway.</p></div></div>
            </div>
        </div>
      </section>

      <section class="landing-section why-us-section">
        <h2 class="landing-section-title">Why Vcanship?</h2>
        <p class="landing-section-subtitle">We're not just a platform; we're your logistics partner.</p>
        <div class="why-us-grid">
            <div class="feature-item">
                <i class="fa-solid fa-brain feature-item-icon"></i>
                <div><h4>AI-Powered Insights</h4><p>Our intelligent platform analyzes millions of data points to find you optimal routes and pricing.</p></div>
            </div>
            <div class="feature-item">
                <i class="fa-solid fa-globe feature-item-icon"></i>
                <div><h4>Global Reach</h4><p>Access a vast network of carriers and partners covering over 220 countries and territories.</p></div>
            </div>
            <div class="feature-item">
                <i class="fa-solid fa-magnifying-glass-dollar feature-item-icon"></i>
                <div><h4>Transparent Pricing</h4><p>No hidden fees. Get detailed cost breakdowns before you book, every single time.</p></div>
            </div>
        </div>
      </section>
      
      <section class="landing-section live-deals-section">
        <h2 class="landing-section-title">Live Shipping Deals</h2>
        <p class="landing-section-subtitle">Check out our latest hot rates on popular trade lanes, updated daily.</p>
        <div id="live-deals-container" class="live-deals-container">
            <!-- Dynamic promotions will be rendered here by promotions.ts -->
        </div>
      </section>
    `;const e=ze("landing.seo.business").split("|"),n=ze("landing.seo.emotional").split("|"),i=document.getElementById("seo-rotator-text-1"),r=document.getElementById("seo-rotator-text-2");let o=0,s=0;i&&(i.textContent=e[o],i.classList.add("visible"),setInterval(()=>{i.classList.remove("visible"),setTimeout(()=>{o=(o+1)%e.length,i.textContent=e[o],i.classList.add("visible")},500)},4e3)),r&&(r.textContent=n[s],setTimeout(()=>{r.classList.add("visible"),setInterval(()=>{r.classList.remove("visible"),setTimeout(()=>{s=(s+1)%n.length,r.textContent=n[s],r.classList.add("visible")},500)},6e3)},2e3));const a=document.getElementById("landing-parcel-form"),c=a==null?void 0:a.querySelector(".landing-toggle-grid");c==null||c.addEventListener("click",u=>{const f=u.target;if(f.matches(".toggle-btn")){const p=f.dataset.group;p&&(c.querySelectorAll(`.toggle-btn[data-group="${p}"]`).forEach(v=>v.classList.remove("active")),f.classList.add("active"))}}),a==null||a.addEventListener("submit",u=>{var p;u.preventDefault();const f=(p=a.querySelector('.toggle-btn[data-group="delivery-type"].active'))==null?void 0:p.dataset.value;Ae({parcelPickupType:f||"pickup",parcelOrigin:void 0,parcelDestination:void 0,parcelInitialWeight:void 0,parcelInitialLength:void 0,parcelInitialWidth:void 0,parcelInitialHeight:void 0}),_i("parcel")})}function dy(){var E;const t=Le.pageHelp;if(!t)return;const e=[{category:"General",question:"What is Vcanship?",answer:"Vcanship is an advanced, AI-driven platform designed to simplify global logistics. We connect you with a vast network of carriers to find the most competitive rates for shipping everything from small parcels to full container loads."},{category:"General",question:"How does the AI-powered platform work?",answer:"Our AI analyzes millions of data points, including carrier availability, historical pricing, route efficiency, and fuel costs, to provide you with optimized, real-time quotes. It also helps with compliance by suggesting necessary documents and HS codes for international shipments."},{category:"General",question:"What countries do you ship to?",answer:"We have a global network that covers over 220 countries and territories. Whether you're shipping locally or across continents, we have a solution for you."},{category:"General",question:"Do you offer shipping insurance?",answer:"Yes, we offer optional shipping insurance for most services. You can add it during the booking process to protect your shipment's declared value against loss or damage."},{category:"Shipping",question:"What is the difference between FCL and LCL?",answer:"FCL (Full Container Load) means you book an entire container for your exclusive use. LCL (Less than Container Load) means you share container space with other shippers, which is a cost-effective option for smaller shipments that don't require a full container."},{category:"Shipping",question:"When should I use Air Freight?",answer:"Air Freight is the fastest shipping method and is ideal for time-sensitive cargo, high-value goods, or items that need to travel long distances quickly. It is generally more expensive than sea freight."},{category:"Shipping",question:"Can I ship my personal baggage?",answer:"Yes! Our Baggage service is a great way to avoid expensive airline excess baggage fees. We can ship your suitcases and personal effects to your destination, often at a lower cost."},{category:"Shipping",question:"Can I ship a vehicle?",answer:"Absolutely. We offer specialized vehicle shipping services, including Roll-on/Roll-off (RoRo) and container shipping for cars, motorcycles, and other vehicles."},{category:"Shipping",question:"Do you offer inland transport like trucking and rail?",answer:"Yes, we provide comprehensive inland transport solutions. This includes Full Truckload (FTL) and Less than Truckload (LTL) services, as well as railway freight for efficient overland logistics across continents."},{category:"Shipping",question:"What items are prohibited?",answer:"Prohibited items typically include hazardous materials, flammable liquids, lithium batteries (unless properly declared), illegal substances, and perishable goods. Regulations vary by country and carrier, so please check our detailed guide or contact support if you are unsure."},{category:"Booking",question:"How do I get a quote?",answer:"Simply select the service you need from our homepage, enter your origin, destination, and shipment details. Our platform will provide you with instant, AI-powered estimates or guide you through the inquiry process for more complex services."},{category:"Booking",question:"What is an HS Code and do I need one?",answer:"The Harmonized System (HS) Code is a standardized numerical method of classifying traded products. It is used by customs authorities around the world to identify products when assessing duties and taxes. For international shipments, an HS code is usually required. Our platform can help suggest a code based on your item description."},{category:"Booking",question:"How do I track my shipment?",answer:'You can track your shipment by clicking the "Track" button in the header and entering your Tracking ID provided after booking. Real-time tracking is available for many of our services.'},{category:"Billing",question:"What payment methods do you accept?",answer:"We accept all major credit cards. All transactions are processed securely through our payment provider, Stripe."},{category:"Billing",question:"How are customs and duties handled?",answer:"The recipient of the shipment is typically responsible for any customs, duties, or taxes levied by the destination country. Vcanship provides estimates for these costs where possible, but the final amount is determined by local customs authorities and is not included in our shipping quote unless specified."},{category:"Billing",question:"Is the price I see on the quote page final?",answer:"For services like Parcel, the quote is typically very accurate. For more complex freight services (FCL, LCL, Air), the initial quote is an AI-powered estimate. A Vcanship agent will contact you to confirm all details and provide a final, all-inclusive price before you are charged."},{category:"Account",question:"What are the benefits of creating a Vcanship account?",answer:"Creating an account allows you to save addresses, view your complete shipment history, manage payments, and access your dashboard. It makes booking future shipments much faster and easier."},{category:"Account",question:"How can I view my past shipments?",answer:"Once logged in, you can access your full shipment history, including costs and statuses, from your personal Dashboard."},{category:"Account",question:"How do I use the API Hub?",answer:"Our API Hub is for developers who want to integrate Vcanship's quoting and booking capabilities into their own applications or e-commerce stores. You can find your API key and code snippets in the API Hub section after logging in."}],n=["All Topics",...new Set(e.map(C=>C.category))],i={"All Topics":"fa-solid fa-grip",General:"fa-solid fa-circle-info",Shipping:"fa-solid fa-truck-fast",Booking:"fa-solid fa-calendar-check",Billing:"fa-solid fa-file-invoice-dollar",Account:"fa-solid fa-user-gear"};t.innerHTML=`
        <div class="service-page-header">
            <h2>Help Center</h2>
            <p class="subtitle">Find answers to common questions about our services.</p>
        </div>
        <div class="help-center-container">
            <div class="help-search-bar">
                <i class="fa-solid fa-magnifying-glass"></i>
                <input type="search" id="help-search-input" placeholder="Search or ask a question...">
                 <button id="voice-search-btn" aria-label="Search by voice">
                    <i class="fa-solid fa-microphone"></i>
                </button>
            </div>
            
            <div class="faq-categories">
                ${n.map(C=>`
                    <button class="faq-category-card" data-category="${C}">
                        <i class="${i[C]}"></i>
                        <span>${C}</span>
                    </button>
                `).join("")}
            </div>
            
            <div id="faq-list" class="card" style="padding: 1rem 2rem;">
                <!-- FAQs will be rendered here -->
            </div>
            
            <div id="faq-not-found" class="hidden" style="text-align: center; padding: 2rem;">
                <p>No results found. Please try different keywords.</p>
            </div>

            <div class="card contact-support-card">
                <h3>Still have questions?</h3>
                <p>Our support team is ready to help you with any issues.</p>
                <div class="form-actions" style="justify-content: center; gap: 1rem;">
                     <a href="tel:+12513166847" class="secondary-btn" style="text-decoration: none; display: inline-flex; align-items: center; gap: 0.75rem;">
                        <i class="fa-solid fa-phone"></i>
                        <span>Call Support</span>
                    </a>
                    <a href="mailto:support@vcanresources.com" class="main-submit-btn">
                        <i class="fa-regular fa-envelope"></i>
                        <span>Email Support</span>
                    </a>
                </div>
                <div class="contact-support-fallback">
                    <span>Or copy our email:</span>
                    <div class="api-key-display" style="margin-top: 0.5rem; justify-content: center;">
                        <code id="support-email-text">support@vcanresources.com</code>
                        <button class="secondary-btn copy-btn" data-copy-target="#support-email-text">
                            <i class="fa-regular fa-copy"></i>
                            <span>Copy</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    `;const r=t.querySelector("#help-search-input"),o=t.querySelector(".faq-categories"),s=t.querySelector("#faq-list"),a=t.querySelector("#faq-not-found");let c="All Topics",u="";function f(C,k){if(!k)return C;const I=new RegExp(`(${k.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return C.replace(I,"<mark>$1</mark>")}function p(){const C=e.filter(k=>{const I=c==="All Topics"||k.category===c,P=!u||k.question.toLowerCase().includes(u)||k.answer.toLowerCase().includes(u);return I&&P});C.length===0?(s.innerHTML="",a.classList.remove("hidden")):(s.innerHTML=C.map(k=>`
                <div class="faq-item">
                    <div class="faq-question">${f(k.question,u)}</div>
                    <div class="faq-answer">
                        <p>${f(k.answer,u)}</p>
                    </div>
                </div>
            `).join(""),a.classList.add("hidden"))}(E=o.querySelector('[data-category="All Topics"]'))==null||E.classList.add("active"),p(),r.addEventListener("input",()=>{u=r.value.toLowerCase().trim(),p()}),o.addEventListener("click",C=>{const I=C.target.closest(".faq-category-card");I&&(c=I.dataset.category||"All Topics",o.querySelectorAll(".faq-category-card").forEach(P=>P.classList.remove("active")),I.classList.add("active"),p())}),s.addEventListener("click",C=>{var P;const I=C.target.closest(".faq-question");I&&((P=I.parentElement)==null||P.classList.toggle("active"))}),t.querySelectorAll(".copy-btn").forEach(C=>{C.addEventListener("click",k=>{const I=k.currentTarget,P=I.dataset.copyTarget;if(!P)return;const G=t.querySelector(P);if(!G)return;const ee=G.innerText;navigator.clipboard.writeText(ee).then(()=>{var D,Z;const te=((D=I.querySelector("i"))==null?void 0:D.className)||"fa-regular fa-copy",Y=((Z=I.querySelector("span"))==null?void 0:Z.textContent)||"Copy";I.classList.add("copied"),I.querySelector("i")&&(I.querySelector("i").className="fa-solid fa-check"),I.querySelector("span")&&(I.querySelector("span").textContent="Copied!"),I.disabled=!0,setTimeout(()=>{I.classList.remove("copied"),I.querySelector("i")&&(I.querySelector("i").className=te),I.querySelector("span")&&(I.querySelector("span").textContent=Y),I.disabled=!1},2e3)}).catch(te=>{console.error("Failed to copy text: ",te),Ee("Failed to copy text.","error")})})});const v=t.querySelector("#voice-search-btn"),m=r.placeholder,S=window.SpeechRecognition||window.webkitSpeechRecognition;let _=null;S?(_=new S,_.continuous=!1,_.lang="en-US",_.interimResults=!1,_.maxAlternatives=1,v.addEventListener("click",()=>{v.classList.contains("listening")?_==null||_.stop():_==null||_.start()}),_.onstart=()=>{v.classList.add("listening"),r.placeholder="Listening..."},_.onend=()=>{v.classList.remove("listening"),r.placeholder=m},_.onerror=C=>{let k="An error occurred during voice recognition.";C.error==="no-speech"?k="I didn't hear anything. Please try again.":C.error==="not-allowed"&&(k="Microphone access was denied. Please allow access in your browser settings."),Ee(k,"error")},_.onresult=C=>{const k=C.results[0][0].transcript;r.value=k;const I=new Event("input",{bubbles:!0,cancelable:!0});r.dispatchEvent(I)}):(v.style.display="none",console.warn("Speech Recognition API not supported in this browser."))}function fy(){const t=Le.pageApiHub;if(!t)return;const e=`vcan_live_${"•".repeat(20)}abcdef123`;t.innerHTML=`
        <div class="service-page-header">
            <h2>API Hub</h2>
            <p class="subtitle">Integrate Vcanship's logistics capabilities into your applications.</p>
        </div>
        <div class="api-grid">
            <div class="api-key-card">
                <h3>Your API Key</h3>
                <p class="subtitle" style="text-align: left; margin: 0.5rem 0 1rem 0;">Use this key in the 'Authorization' header of your requests.</p>
                <div class="api-key-display">
                    <code id="api-key-text">${e}</code>
                    <button class="secondary-btn copy-btn" data-copy-target="#api-key-text">
                        <i class="fa-regular fa-copy"></i>
                        <span>Copy</span>
                    </button>
                </div>
            </div>

            <div class="code-snippet-card">
                <h4>Get Parcel Rates (JavaScript)</h4>
                <pre>
                    <button class="secondary-btn copy-btn" data-copy-target="#js-code-snippet">
                        <i class="fa-regular fa-copy"></i>
                        <span>Copy</span>
                    </button>
                    <code id="js-code-snippet">
const apiKey = 'YOUR_API_KEY';
const quoteData = {
  origin: { postcode: 'SW1A 0AA', country: 'GB' },
  destination: { postcode: '90210', country: 'US' },
  weight_kg: 2.5
};

fetch('https://api.vcanship.com/v1/parcel/rates', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': \`Bearer \${apiKey}\`
  },
  body: JSON.stringify(quoteData)
})
.then(response => response.json())
.then(data => console.log(data.quotes))
.catch(error => console.error('Error:', error));
                    </code>
                </pre>
            </div>

            <div class="code-snippet-card">
                <h4>Track a Shipment (Python)</h4>
                <pre>
                    <button class="secondary-btn copy-btn" data-copy-target="#python-code-snippet">
                        <i class="fa-regular fa-copy"></i>
                        <span>Copy</span>
                    </button>
                    <code id="python-code-snippet">
import requests

api_key = 'YOUR_API_KEY'
tracking_id = 'PAR-123456'

url = f"https://api.vcanship.com/v1/tracking/{tracking_id}"
headers = {
    "Authorization": f"Bearer {api_key}"
}

response = requests.get(url, headers=headers)

if response.status_code == 200:
    print(response.json())
else:
    print(f"Error: {response.status_code}")
                    </code>
                </pre>
            </div>
            
            <div class="use-case-card">
                <i class="fa-solid fa-store"></i>
                <h4>E-commerce Integration</h4>
                <p>Automate shipping cost calculation at checkout for your online store.</p>
            </div>
             <div class="use-case-card">
                <i class="fa-solid fa-boxes-stacked"></i>
                <h4>Warehouse Management</h4>
                <p>Integrate with your WMS to book freight and print labels automatically.</p>
            </div>
        </div>
    `,t.querySelectorAll(".copy-btn").forEach(n=>{n.addEventListener("click",i=>{const r=i.currentTarget,o=r.dataset.copyTarget;if(!o)return;const s=t.querySelector(o);if(!s)return;const a=s.innerText;navigator.clipboard.writeText(a).then(()=>{var f,p;const c=((f=r.querySelector("i"))==null?void 0:f.className)||"fa-regular fa-copy",u=((p=r.querySelector("span"))==null?void 0:p.textContent)||"Copy";r.classList.add("copied"),r.querySelector("i")&&(r.querySelector("i").className="fa-solid fa-check"),r.querySelector("span")&&(r.querySelector("span").textContent="Copied!"),r.disabled=!0,setTimeout(()=>{r.classList.remove("copied"),r.querySelector("i")&&(r.querySelector("i").className=c),r.querySelector("span")&&(r.querySelector("span").textContent=u),r.disabled=!1},2e3)}).catch(c=>{console.error("Failed to copy text: ",c),Ee("Failed to copy text.","error")})})})}function hy(){const t=Le.pagePrivacy;t&&(t.innerHTML=`
        <div class="service-page-header"><h2>Privacy Policy</h2><p class="subtitle">Coming soon.</p></div>
    `)}function py(){const t=Le.pageTerms;t&&(t.innerHTML=`
        <div class="service-page-header"><h2>Terms of Service</h2><p class="subtitle">Coming soon.</p></div>
    `)}function f_(){const t=document.getElementById("top-ticker-banner");if(t){const n=["Welcome to Vcanship","Global Shipping, Intelligently Simplified.","AI-POWERED LOGISTICS","REAL-TIME QUOTES","CONNECTING CONTINENTS"].map(i=>`<span>${i}</span>`).join("");t.innerHTML=`<div class="ticker-content">${n.repeat(5)}</div>`}uy(),l_(),u_("live-deals-container")}function vf(){var e,n,i;const t=Le.pageDashboard;if(t){if(!j.isLoggedIn){t.innerHTML='<div class="form-container" style="text-align: center;"><p>Please log in to view your dashboard.</p></div>';return}t.innerHTML=`
        <div class="dashboard-ecom-hub">
            <h2 class="ecom-hub-title">E-commerce Hub</h2>
            <div class="ecom-hub-actions">
                <button class="ecom-action-card" id="ecom-hub-dashboard-card">
                    <div class="ecom-action-card-icon">
                        <i class="fa-solid fa-table-columns"></i>
                    </div>
                    <span>Hub Dashboard</span>
                </button>
                <button class="ecom-action-card" id="ecom-hub-myproducts-card">
                    <div class="ecom-action-card-icon">
                       <i class="fa-solid fa-boxes-stacked"></i>
                    </div>
                    <span>My Products</span>
                </button>
                <button class="ecom-action-card" id="ecom-hub-addproduct-card">
                    <div class="ecom-action-card-icon">
                        <i class="fa-solid fa-circle-plus"></i>
                    </div>
                    <span>Add New Product</span>
                </button>
            </div>
            <div id="ecom-hub-content-view">
                <!-- Content for stats or product list will be injected here if needed in future -->
            </div>
        </div>
    `,(e=document.getElementById("ecom-hub-dashboard-card"))==null||e.addEventListener("click",()=>{Ae({ecomInitialView:"hub"}),_i("ecommerce")}),(n=document.getElementById("ecom-hub-myproducts-card"))==null||n.addEventListener("click",()=>{Ae({ecomInitialView:"my-products"}),_i("ecommerce")}),(i=document.getElementById("ecom-hub-addproduct-card"))==null||i.addEventListener("click",()=>{Ae({ecomInitialView:"add-product"}),_i("ecommerce")})}}function h_(){const t=Le.pageDashboard;t&&new MutationObserver(n=>{for(const i of n)i.type==="attributes"&&i.attributeName==="class"&&i.target.classList.contains("active")&&vf()}).observe(t,{attributes:!0})}let br=[{id:1,label:"My Office",name:"John Doe",company:"Vcanship",street:"123 Global Logistics Ave",city:"Shipping City",postcode:"12345",country:"USA",isDefault:!0},{id:2,label:"Warehouse A",name:"Receiving Dept",company:"Supplier Inc.",street:"456 Supplier St",city:"Factory Town",postcode:"54321",country:"China",isDefault:!1}];function Ha(){const t=Le.pageAddressBook;if(!t)return;const e=br.length>0?br.map(n=>`
            <div class="address-card">
                <div class="address-card-header">
                    <h4>${n.label} ${n.isDefault?'<span class="default-badge">Default</span>':""}</h4>
                    <div class="address-card-actions">
                        <button class="secondary-btn edit-address-btn" data-id="${n.id}">Edit</button>
                        <button class="secondary-btn delete-address-btn" data-id="${n.id}">Delete</button>
                    </div>
                </div>
                <div class="address-card-body">
                    <p>${n.name}</p>
                    <p>${n.street}, ${n.city}, ${n.postcode}</p>
                    <p>${n.country}</p>
                </div>
            </div>
        `).join(""):`
        <div class="address-empty-state-card">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="empty-state-icon">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
            </svg>
            <h3>Your Address Book is Empty</h3>
            <p>Save addresses here to make booking your future shipments even faster.</p>
            <button id="add-address-from-empty-btn" class="main-submit-btn">Add Your First Address</button>
        </div>
        `;t.innerHTML=`
        <div class="service-page-header">
            <h2>Address Book</h2>
            <p class="subtitle">Manage your saved addresses for faster bookings.</p>
        </div>
        <div class="account-grid">
            <div class="address-list">
                ${e}
            </div>
            <div class="form-container">
                <h3 id="address-form-title">Add New Address</h3>
                <form id="address-form">
                    <input type="hidden" id="address-id">
                    <div class="input-wrapper"><label for="address-label">Label (e.g., Home, Office)</label><input type="text" id="address-label" required></div>
                    <div class="input-wrapper"><label for="address-name">Full Name</label><input type="text" id="address-name" required></div>
                    <div class="input-wrapper"><label for="address-street">Street</label><input type="text" id="address-street" required></div>
                    <div class="input-wrapper"><label for="address-city">City</label><input type="text" id="address-city" required></div>
                    <div class="input-wrapper"><label for="address-country">Country</label><input type="text" id="address-country" required></div>
                    <div class="form-actions">
                        <button type="button" id="cancel-edit-btn" class="secondary-btn hidden">Cancel</button>
                        <button type="submit" class="main-submit-btn">Save Address</button>
                    </div>
                </form>
            </div>
        </div>
    `,y_()}function p_(t){t.preventDefault();const e=t.target,n=parseInt(e.querySelector("#address-id").value,10),i={id:n||Date.now(),label:e.querySelector("#address-label").value,name:e.querySelector("#address-name").value,street:e.querySelector("#address-street").value,city:e.querySelector("#address-city").value,country:e.querySelector("#address-country").value,company:"",postcode:"",isDefault:n?br.find(r=>r.id===n).isDefault:!1};n?(br=br.map(r=>r.id===n?i:r),Ee("Address updated successfully!","success")):(br.push(i),Ee("Address added successfully!","success")),Ha()}function g_(t){const e=br.find(i=>i.id===t);if(!e)return;const n=document.getElementById("address-form");n.querySelector("#address-id").value=String(t),n.querySelector("#address-label").value=e.label,n.querySelector("#address-name").value=e.name,n.querySelector("#address-street").value=e.street,n.querySelector("#address-city").value=e.city,n.querySelector("#address-country").value=e.country,document.getElementById("address-form-title").textContent="Edit Address",document.getElementById("cancel-edit-btn").classList.remove("hidden"),n.scrollIntoView({behavior:"smooth"})}function m_(t){confirm("Are you sure you want to delete this address?")&&(br=br.filter(e=>e.id!==t),Ee("Address deleted.","success"),Ha())}function v_(){document.getElementById("address-form").reset(),document.getElementById("address-id").value="",document.getElementById("address-form-title").textContent="Add New Address",document.getElementById("cancel-edit-btn").classList.add("hidden")}function y_(){var t,e,n;(t=document.getElementById("address-form"))==null||t.addEventListener("submit",p_),document.querySelectorAll(".edit-address-btn").forEach(i=>{i.addEventListener("click",r=>g_(Number(r.currentTarget.dataset.id)))}),document.querySelectorAll(".delete-address-btn").forEach(i=>{i.addEventListener("click",r=>m_(Number(r.currentTarget.dataset.id)))}),(e=document.getElementById("cancel-edit-btn"))==null||e.addEventListener("click",v_),(n=document.getElementById("add-address-from-empty-btn"))==null||n.addEventListener("click",()=>{const i=document.getElementById("address-form"),r=document.getElementById("address-label");i&&(i.scrollIntoView({behavior:"smooth"}),r==null||r.focus())})}function yf(){var e;const t=Le.pageSettings;!t||!j.currentUser||(t.innerHTML=`
         <div class="service-page-header">
            <h2>Account Settings</h2>
            <p class="subtitle">Manage your profile and communication preferences.</p>
        </div>
        <div class="form-container">
            <form id="settings-form">
                <div class="form-section">
                    <h3>Profile Information</h3>
                    <div class="input-wrapper">
                        <label for="settings-name">Full Name</label>
                        <input type="text" id="settings-name" value="${j.currentUser.name}" required>
                    </div>
                     <div class="input-wrapper">
                        <label for="settings-email">Email Address</label>
                        <input type="email" id="settings-email" value="${j.currentUser.email}" required>
                    </div>
                </div>
                 <div class="form-section">
                    <h3>Change Password</h3>
                    <div class="input-wrapper"><label for="current-password">Current Password</label><input type="password" id="current-password"></div>
                    <div class="input-wrapper"><label for="new-password">New Password</label><input type="password" id="new-password"></div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="main-submit-btn">Save Changes</button>
                </div>
            </form>
        </div>
    `,(e=document.getElementById("settings-form"))==null||e.addEventListener("submit",n=>{n.preventDefault(),Ee("Account settings saved!","success")}))}function b_(){[{el:Le.pageAddressBook,renderFn:Ha},{el:Le.pageSettings,renderFn:yf}].forEach(({el:e,renderFn:n})=>{e&&new MutationObserver(r=>{r.some(o=>o.attributeName==="class"&&o.target.classList.contains("active"))&&(j.isLoggedIn?n():e.innerHTML='<div class="form-container"><p>Please log in to manage your account.</p></div>')}).observe(e,{attributes:!0})})}function gy(){const t=document.getElementById("app-sidebar");if(!t)return;const e=[{id:"landing",name:ze("sidebar.services"),icon:"fa-solid fa-box-open",active:!0},{id:"api-hub",name:ze("sidebar.apiHub"),icon:"fa-solid fa-code"},{id:"help",name:ze("sidebar.helpCenter"),icon:"fa-solid fa-question-circle"}],n=[{id:"secure-trade",name:"Secure Trade",icon:"fa-solid fa-shield-halved"},{id:"vehicle",name:ze("sidebar.vehicle"),icon:"fa-solid fa-truck-fast"},{id:"railway",name:ze("sidebar.railway"),icon:"fa-solid fa-train-subway"},{id:"inland",name:ze("sidebar.inland"),icon:"fa-solid fa-truck"},{id:"bulk",name:ze("sidebar.bulk"),icon:"fa-solid fa-anchor"},{id:"rivertug",name:ze("sidebar.rivertug"),icon:"fa-solid fa-ship"},{id:"warehouse",name:ze("sidebar.warehouse"),icon:"fa-solid fa-warehouse"},{id:"schedules",name:ze("sidebar.schedules"),icon:"fa-solid fa-calendar-days"},{id:"register",name:ze("sidebar.tradeFinance"),icon:"fa-solid fa-money-check-dollar"},{id:"service-provider-register",name:ze("sidebar.partner"),icon:"fa-solid fa-handshake"}],i=o=>`<button class="sidebar-btn static-link ${o.active?"active":""}" data-page="${o.id}"><i class="${o.icon}"></i> ${o.name}</button>`,r=o=>`<button class="sidebar-btn-service" data-service="${o.id}"><i class="${o.icon}"></i> ${o.name}</button>`;t.innerHTML=`
        <div class="sidebar-section">
            ${e.map(i).join("")}
        </div>
        <div class="sidebar-section">
            ${n.map(r).join("")}
        </div>
    `}let xd={},my="en";const w_=["ar"];function ze(t){const e=t.split(".");let n=xd;for(const i of e)if(n=n==null?void 0:n[i],n===void 0)return console.warn(`Translation key not found: ${t}`),t;return n}async function Ld(t){try{const e=await fetch(`/locales/${t}.json`);if(!e.ok)throw new Error(`Could not load translation file for ${t}`);xd=await e.json(),console.log(`✅ Loaded translations for language: ${t}`,xd),my=t,document.documentElement.lang=t,w_.includes(t)?document.documentElement.dir="rtl":document.documentElement.dir="ltr"}catch(e){if(console.error(e),t!=="en")await Ld("en");else throw e}}function ag(){Le.trackBtn.textContent=ze("header.track"),Le.loginSignupBtn.textContent=ze("header.loginSignup"),document.querySelector('.footer-links a[data-page="help"]').textContent=ze("footer.helpCenter"),document.querySelector('.footer-links a[data-page="privacy"]').textContent=ze("footer.privacyPolicy"),document.querySelector('.footer-links a[data-page="terms"]').textContent=ze("footer.termsOfService"),Le.complianceBtn.textContent=ze("footer.inspectorPortal"),document.querySelector(".footer-copyright").textContent=ze("footer.copyright");const t=document.querySelector("#tracking-modal h3");t&&(t.textContent=ze("modals.track.title"))}async function S_(){try{const t=localStorage.getItem("vcanship_language")||"en";await Ld(t)}catch(t){console.error("Fatal: Could not load critical translation files. UI text may not appear correctly.",t)}ag(),window.addEventListener("locale-change",async t=>{const e=t.detail;if(e.language&&e.language!==my){await Ld(e.language),ag(),gy();const n=j.currentPage;if(j.currentService)_i(j.currentService);else switch(n){case"landing":uy();break;case"help":dy();break;case"api-hub":fy();break;case"privacy":hy();break;case"terms":py();break;case"dashboard":vf();break;case"address-book":Ha();break;case"settings":yf();break;default:console.warn(`Unhandled page re-render for translation on page: ${n}`);break}}})}const __={GB:{regex:/^(GIR 0AA|[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2})$/i,placeholder:"e.g., SW1A 1AA",errorMessage:"Please enter a valid UK postcode format (e.g., SW1A 1AA)."},US:{regex:/^\d{5}(-\d{4})?$/,placeholder:"e.g., 90210 or 90210-1234",errorMessage:"Please enter a valid 5 or 9-digit ZIP code."},CA:{regex:/^[A-Z]\d[A-Z] ?\d[A-Z]\d$/i,placeholder:"e.g., A1A 1A1",errorMessage:"Please enter a valid Canadian postal code format (e.g., A1A 1A1)."},AU:{regex:/^\d{4}$/,placeholder:"e.g., 2000",errorMessage:"Please enter a valid 4-digit Australian postcode."},DE:{regex:/^\d{5}$/,placeholder:"e.g., 10117",errorMessage:"Please enter a valid 5-digit German postal code."},FR:{regex:/^\d{5}$/,placeholder:"e.g., 75001",errorMessage:"Please enter a valid 5-digit French postal code."},IN:{regex:/^\d{6}$/,placeholder:"e.g., 110001",errorMessage:"Please enter a valid 6-digit Indian PIN code."}},C_={regex:/^.{2,15}$/,placeholder:"Enter postcode",errorMessage:"Please enter a valid postcode (2-15 characters)."},E_={"united kingdom":"GB",uk:"GB",britain:"GB","united states":"US",usa:"US",america:"US","united states of america":"US",canada:"CA",australia:"AU",germany:"DE",deutschland:"DE",france:"FR",india:"IN",china:"CN",japan:"JP",brazil:"BR",netherlands:"NL"};function T_(t){const e=t.toLowerCase().trim();return e.length===2?e.toUpperCase():E_[e]||e.toUpperCase()}function A_(t){const e=T_(t);return __[e]||C_}function lg(t,e){const n=()=>{const i=A_(t.value);e.placeholder=i.placeholder,e.pattern=i.regex.source,e.dataset.errorMessage=i.errorMessage;const r=e.closest(".input-wrapper");if(r&&r.classList.contains("input-error")){r.classList.remove("input-error");const o=r.querySelector(".error-text");o&&(o.classList.add("hidden"),o.textContent="")}};t.addEventListener("change",n),t.addEventListener("blur",n),t.value&&n()}const An={parcel:{standard:.18,express:.3},baggage:{standard:.2,express:.35},airfreight:{standard:.2,priority:.35,charter:.15},fcl:{standard:.12},lcl:{standard:.25,priority:.35,express:.45},vehicle:{standard:.15},bulk:{commission:.04},railway:{standard:.15,express:.28},rivertug:{standard:.15},inland:{standard:.18},warehousing:{standard:.3},ecommerce:{commission:.15},trade_finance:{min_fee:1.5,max_fee:3}};async function I_(t,e="GET",n){try{const{data:i,error:r}=await In.functions.invoke("shippo-proxy",{body:{endpoint:t,method:e,data:n}});if(r)throw console.error("Shippo API error:",r),r;return i}catch(i){throw console.error("Shippo API call failed:",i),i}}async function k_(t,e,n){try{const r=await I_("/shipments/","POST",{address_from:t,address_to:e,parcels:[n],async:!1});if(!r||!r.rates)throw new Error("No rates returned from Shippo");const o=r.rates.filter(s=>s.available===!0&&parseFloat(s.amount)>0).sort((s,a)=>parseFloat(s.amount)-parseFloat(a.amount));return console.log(`📦 Shippo: Found ${o.length} rates from carriers`),o}catch(i){throw console.error("Failed to get parcel rates:",i),i}}function Gu(t){return t/2.54}function x_(t){return t*2.20462}function L_(t){return{carrier:t.provider||t.carrier,service:t.servicelevel_name||t.service,price:parseFloat(t.amount),currency:t.currency,days:t.estimated_days?`${t.estimated_days} ${t.estimated_days===1?"day":"days"}`:t.duration_terms||"N/A",logo:t.provider_image_200||t.provider_image_75||""}}function P_(){console.log(`
    ═══════════════════════════════════════
    📦 Shippo API Status
    ═══════════════════════════════════════
    Service: Parcel Shipping
    Carriers: USPS, FedEx, UPS, DHL
    Features: 
      ✓ Real-time rate shopping
      ✓ Label generation
      ✓ Tracking integration
      ✓ Address validation
    Status: Active
    ═══════════════════════════════════════
    `)}let Ql=[];function cg(t){const e={"united states":"US",usa:"US","united kingdom":"GB",uk:"GB",canada:"CA",australia:"AU",germany:"DE",france:"FR",italy:"IT",spain:"ES",netherlands:"NL",belgium:"BE",switzerland:"CH",austria:"AT",sweden:"SE",norway:"NO",denmark:"DK",finland:"FI",poland:"PL","czech republic":"CZ",ireland:"IE",portugal:"PT",greece:"GR",hungary:"HU",romania:"RO",bulgaria:"BG",croatia:"HR",slovakia:"SK",slovenia:"SI",lithuania:"LT",latvia:"LV",estonia:"EE",japan:"JP",china:"CN","south korea":"KR",korea:"KR",singapore:"SG","hong kong":"HK",india:"IN",brazil:"BR",mexico:"MX",argentina:"AR",chile:"CL",colombia:"CO",peru:"PE","new zealand":"NZ","south africa":"ZA",uae:"AE","united arab emirates":"AE",dubai:"AE","saudi arabia":"SA",israel:"IL",turkey:"TR",russia:"RU",ukraine:"UA",malaysia:"MY",thailand:"TH",indonesia:"ID",philippines:"PH",vietnam:"VN",egypt:"EG",nigeria:"NG",kenya:"KE"},n=t.toLowerCase().trim();return e[n]||t.substring(0,2).toUpperCase()}function fc(t){const e=document.getElementById("page-parcel");if(!e)return;const n=e.querySelector(".service-step.active"),i=document.getElementById(`parcel-step-${t}`);if(n!==i&&(n&&(n.classList.add("exiting"),n.addEventListener("animationend",()=>{n.classList.remove("active","exiting")},{once:!0})),i&&(e.querySelectorAll(".service-step").forEach(r=>r.classList.remove("active")),i.classList.add("active")),t===4)){const r=document.getElementById("parcel-print-label-btn");r&&r.classList.remove("hidden")}}function vy(){const t=document.getElementById("package-weight"),e=document.getElementById("heavy-item-banner");if(!t||!e)return;const n=parseFloat(t.value);e.classList.toggle("hidden",isNaN(n)||n<=30)}function N_(){const t=document.getElementById("origin-country"),e=document.getElementById("dest-country"),n=document.getElementById("hs-code-section");if(!e||!n)return;const i=j.parcelPickupType;let r="";if(i==="pickup"){if(!t)return;r=t.value.trim().toLowerCase()}else{const c=localStorage.getItem("vcanship_country");c&&(r=c.toLowerCase())}const o=e.value.trim().toLowerCase(),s=c=>({gb:"uk","united kingdom":"uk",usa:"us","united states":"us","united states of america":"us"})[c]||c,a=s(r)===s(o)&&r!==""&&o!=="";n.classList.toggle("hidden",a)}async function R_(t){t.preventDefault();const e=t.target.closest("form");if(!e)return;let n=!0;const i={"dest-name":"Please enter the recipient's name.","dest-street":"Please enter the recipient's street address.","dest-city":"Please enter the recipient's city.","dest-postcode":"Please enter a postcode.","dest-country":"Please enter a country.","package-weight":"Please enter the package weight.","package-length":"Please enter the package length.","package-width":"Please enter the package width.","package-height":"Please enter the package height.","item-description":"Please provide a description of the item.","origin-name":"Please enter the sender's name.","origin-street":"Please enter the sender's street address.","origin-city":"Please enter the sender's city.","origin-postcode":"Please enter a postcode.","origin-country":"Please enter a country.","parcel-dropoff-postcode":"Please enter your postcode to get a quote."},r=["dest-name","dest-street","dest-city","dest-postcode","dest-country","package-weight","package-length","package-width","package-height","item-description"];j.parcelPickupType==="pickup"&&r.push("origin-name","origin-street","origin-city","origin-postcode","origin-country"),e.querySelectorAll(".input-wrapper").forEach(v=>{v.classList.remove("input-error");const m=v.querySelector(".error-text");m&&(m.classList.add("hidden"),m.textContent="")}),r.forEach(v=>{const m=document.getElementById(v);if(m&&!m.value.trim()){n=!1;const S=m.closest(".input-wrapper"),_=S==null?void 0:S.querySelector(".error-text");S&&_&&(S.classList.add("input-error"),_.textContent=i[v]||"This field is required.",_.classList.remove("hidden"))}});const o=[];if(j.parcelPickupType==="pickup"&&o.push(document.getElementById("origin-postcode")),o.push(document.getElementById("dest-postcode")),o.forEach(v=>{if(!v)return;const m=v.closest(".input-wrapper");if(v.value.trim()&&m&&!m.classList.contains("input-error")&&!new RegExp(v.pattern,"i").test(v.value.trim())){n=!1;const _=m.querySelector(".error-text");_&&(m.classList.add("input-error"),_.textContent=v.dataset.errorMessage||"Invalid format.",_.classList.remove("hidden"))}}),j.parcelInsuranceAdded){const v=document.getElementById("parcel-declared-value"),m=parseFloat(v.value);if(!v.value.trim()||isNaN(m)||m<=0){n=!1;const S=v.closest(".input-wrapper"),_=S==null?void 0:S.querySelector(".error-text");S&&_&&(S.classList.add("input-error"),_.textContent="Please enter a valid declared value greater than zero.",_.classList.remove("hidden"))}}if(!n){Ee("Please fill out all required fields and correct any errors.","error");return}if(!kc())return;let s;const a={name:document.getElementById("dest-name").value,street:document.getElementById("dest-street").value,city:document.getElementById("dest-city").value,postcode:document.getElementById("dest-postcode").value,country:document.getElementById("dest-country").value};if(j.parcelPickupType==="pickup")s={name:document.getElementById("origin-name").value,street:document.getElementById("origin-street").value,city:document.getElementById("origin-city").value,postcode:document.getElementById("origin-postcode").value,country:document.getElementById("origin-country").value};else{const v=document.getElementById("parcel-dropoff-postcode").value,m=localStorage.getItem("vcanship_country");s={name:"Customer Drop-off",street:v,city:"",country:m||"",postcode:v}}Ae({parcelOrigin:s,parcelDestination:a});const c={origin:s,destination:a,weight:parseFloat(document.getElementById("package-weight").value),length:parseInt(document.getElementById("package-length").value),width:parseInt(document.getElementById("package-width").value),height:parseInt(document.getElementById("package-height").value),description:document.getElementById("item-description").value,hsCode:document.getElementById("hs-code").value};fc(2);const u=Le.parcel.quotesContainer,f=Le.parcel.warningsContainer,p=document.getElementById("parcel-sidebar-container");u&&(u.innerHTML=`
            <div id="quotes-skeleton">
                <div class="quote-card-skeleton"></div><div class="quote-card-skeleton"></div><div class="quote-card-skeleton"></div>
            </div>`),f&&(f.innerHTML=""),p&&(p.innerHTML=`
            <div class="results-section"><div class="compliance-checklist-skeleton" style="height: 150px;"></div></div>
            <div class="results-section"><div class="compliance-checklist-skeleton" style="height: 120px;"></div></div>
        `);try{P_();const v={name:c.origin.name||"Sender",street1:c.origin.street||c.origin.city,city:c.origin.city,state:"",zip:c.origin.postcode,country:cg(c.origin.country),phone:c.origin.phone||"",email:c.origin.email||""},m={name:c.destination.name||"Recipient",street1:c.destination.street||c.destination.city,city:c.destination.city,state:"",zip:c.destination.postcode,country:cg(c.destination.country),phone:c.destination.phone||"",email:c.destination.email||""},S={length:Gu(c.length),width:Gu(c.width),height:Gu(c.height),weight:x_(c.weight),distance_unit:"in",mass_unit:"lb"},_=await k_(v,m,S);if(!_||_.length===0)throw new Error("No rates available for this route");const E=_.map(I=>{const P=L_(I),G=P.price,ee=An.parcel.standard,te=G*ee,Y=G+te;return{carrierName:P.carrier,carrierType:"Express Courier",estimatedTransitTime:P.days,chargeableWeight:c.weight,chargeableWeightUnit:"KG",weightBasis:"Actual Weight",isSpecialOffer:!1,totalCost:Y,costBreakdown:{baseShippingCost:G,fuelSurcharge:0,estimatedCustomsAndTaxes:0,optionalInsuranceCost:0,ourServiceFee:te},serviceProvider:`Shippo (${P.carrier})`,notes:P.service,shippoRateId:I.object_id}}),C={status:"Information",summary:"Standard shipping documentation required.",requirements:[{title:"Commercial Invoice",details:"Required for international shipments. Include item description, value, and HS code."},{title:"Customs Declaration",details:"Declare contents accurately for customs clearance."}]},k={itemWarning:c.weight>30?"Heavy parcel - additional handling fees may apply":null,complianceReport:C,quotes:E,costSavingOpportunities:[{title:"Bundle Shipments",description:"Save up to 15% by combining multiple parcels into one shipment."}],nextSteps:"Select a carrier rate to proceed with booking and label generation."};Ee("Real-time carrier rates loaded from Shippo!","success",3e3),D_(k,s,a)}catch(v){console.error("Error getting quotes:",v);const m=v.message||"Unknown error";Ee(`API Error: ${m}. Check console for details.`,"error",5e3),u&&(u.innerHTML=`
                <div style="text-align:center; padding: 2rem;">
                    <p class="error-text" style="margin-bottom: 1rem;">❌ Could not fetch carrier rates</p>
                    <p style="color: var(--medium-gray); font-size: 0.9rem;">Error: ${m}</p>
                    <p style="color: var(--medium-gray); font-size: 0.9rem; margin-top: 0.5rem;">
                        This usually means the Shippo API is not configured. Please contact support.
                    </p>
                </div>
            `)}}function M_(t){const e=Le.parcel.quotesContainer;e&&(t&&t.length>0?e.innerHTML=t.map(ZS).join(""):e.innerHTML='<p class="helper-text" style="text-align: center; padding: 2rem;">No quotes available for this route. This may be due to compliance restrictions on the item you are trying to send.</p>')}function B_(t){const e=[...Ql];e.sort((n,i)=>n.totalCost-i.totalCost),M_(e),document.querySelectorAll(".sort-btn").forEach(n=>{n.classList.toggle("active",n.getAttribute("data-sort")===t)})}function D_(t,e,n){const{complianceReport:i,quotes:r,costSavingOpportunities:o,nextSteps:s}=t;Ql=r;const a=document.getElementById("parcel-sidebar-container"),c=document.getElementById("parcel-main-subtitle");if(c){const p=j.parcelPickupType==="dropoff"?e.postcode:e.country;c.textContent=`We've found the best rates for your shipment from ${p} to ${n.country}.`}let u="";if(i){const p=`compliance-status-${i.status.toLowerCase().replace(/\s/g,"-")}`;u+=`
            <div class="results-section">
                <h3><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 1a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 10 1Zm3.536 2.464a.75.75 0 0 1 1.06 0l1.06 1.06a.75.75 0 0 1-1.06 1.06l-1.06-1.06a.75.75 0 0 1 0-1.06ZM18 10a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 18 10ZM10 18a.75.75 0 0 1 .75-.75h.01a.75.75 0 0 1 0 1.5H10.75a.75.75 0 0 1-.75-.75ZM4.464 15.536a.75.75 0 0 1 0-1.06l1.06-1.06a.75.75 0 0 1 1.06 1.06l-1.06 1.06a.75.75 0 0 1-1.06 0ZM2 10a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 0 1.5h-1.5A.75.75 0 0 1 2 10ZM5.536 4.464a.75.75 0 0 1 1.06 0l1.06 1.06a.75.75 0 0 1-1.06 1.06L5.536 5.524a.75.75 0 0 1 0-1.06ZM10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12Z" clip-rule="evenodd" /></svg> Compliance Report</h3>
                <div class="compliance-report">
                    <div class="compliance-report-header">
                        <span class="compliance-status-badge ${p}">${i.status}</span>
                        <p>${i.summary}</p>
                    </div>
                    ${i.requirements.length>0?`<ul>${i.requirements.map(v=>`<li><strong>${v.title}:</strong> ${v.details}</li>`).join("")}</ul>`:""}
                </div>
            </div>`}o&&o.length>0&&(u+=`
            <div class="results-section">
                <h3><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M10 9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" /><path fill-rule="evenodd" d="M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm.75-11.25a.75.75 0 0 0-1.5 0v4.59L7.3 9.24a.75.75 0 0 0-1.1 1.02l3.25 3.5a.75.75 0 0 0 1.1 0l3.25-3.5a.75.75 0 1 0-1.1-1.02l-1.95 2.1v-4.59Z" clip-rule="evenodd" /></svg> AI Savings Advisor</h3>
                ${o.map(p=>`<div class="cost-saving-opportunity"><h4>${p.title}</h4><p>${p.description}</p></div>`).join("")}
            </div>`),s&&(u+=`<div class="results-section"><h3>Next Steps</h3><p>${s}</p></div>`),a&&(a.innerHTML=u);const f=j.parcelInsuranceCost;f>0&&(Ql=Ql.map(p=>{const v=JSON.parse(JSON.stringify(p));return v.costBreakdown.optionalInsuranceCost=f,v.totalCost+=f,v})),B_("price")}function F_(t){const e=t.target.closest(".select-quote-btn");if(!(e!=null&&e.dataset.quote))return;const n=JSON.parse(e.dataset.quote.replace(/&quot;/g,'"')),i=[];j.parcelPremiumTrackingAdded&&i.push({name:"Premium Tracking",cost:j.parcelPremiumTrackingCost});const r=`PAR-${Date.now().toString().slice(-6)}`;Ae({parcelSelectedQuote:n,paymentContext:{service:"parcel",quote:n,addons:i,shipmentId:r,origin:j.parcelOrigin,destination:j.parcelDestination}}),bt("payment")}function q_(t){var r;const e=t.target.closest(".view-breakdown-btn");if(!(e!=null&&e.dataset.quote))return;const n=JSON.parse(e.dataset.quote.replace(/&quot;/g,'"')),i=document.getElementById("price-breakdown-modal");if(i){document.getElementById("breakdown-modal-subtitle").textContent=`Details for your ${n.carrierName} quote.`;const o=n.costBreakdown.optionalInsuranceCost>0?`<div class="review-item"><span>Parcel Insurance:</span> <strong>${j.currentCurrency.symbol}${n.costBreakdown.optionalInsuranceCost.toFixed(2)}</strong></div>`:"";document.getElementById("breakdown-details-container").innerHTML=`
            <div class="review-item"><span>Base Shipping:</span> <strong>${j.currentCurrency.symbol}${n.costBreakdown.baseShippingCost.toFixed(2)}</strong></div>
            <div class="review-item"><span>Fuel Surcharge:</span> <strong>${j.currentCurrency.symbol}${n.costBreakdown.fuelSurcharge.toFixed(2)}</strong></div>
            <div class="review-item"><span>Est. Customs & Taxes:</span> <strong>${j.currentCurrency.symbol}${n.costBreakdown.estimatedCustomsAndTaxes.toFixed(2)}</strong></div>
            ${o}
            <div class="review-item"><span>Our Service Fee (incl. ${An.parcel.standard*100}% markup):</span> <strong>${j.currentCurrency.symbol}${n.costBreakdown.ourServiceFee.toFixed(2)}</strong></div>
            <hr>
            <div class="review-item total"><span>Total:</span> <strong>${j.currentCurrency.symbol}${n.totalCost.toFixed(2)}</strong></div>
        `,i.classList.add("active"),(r=document.getElementById("close-breakdown-modal-btn"))==null||r.addEventListener("click",()=>i.classList.remove("active"),{once:!0})}}function U_(t,e,n){const i=document.getElementById("parcel-confirmation-title"),r=document.getElementById("parcel-confirmation-message"),o=document.getElementById("parcel-confirmation-tracking-id"),s=e>0?` Your parcel is insured for a declared value of ${j.currentCurrency.symbol}${e.toFixed(2)}.`:"",a=n?" Your premium live tracking is now active.":"";i&&(i.innerHTML=`
            <div class="confirmation-icon-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /></svg>
            </div>
            <span>Shipment Confirmed!</span>
        `),r&&(r.textContent="Your parcel has been booked. Details have been sent to your email."+s+a),o&&(o.textContent=t),fc(4)}function $_(){if(!j.parcelOrigin||!j.parcelDestination||!j.parcelSelectedQuote){Ee("Missing data to generate label.","error");return}const t=new Oe,e=document.getElementById("parcel-confirmation-tracking-id").textContent;t.setFontSize(10),t.text(`Carrier: ${j.parcelSelectedQuote.carrierName}`,10,10),t.rect(5,15,100,50),t.setFontSize(8),t.text("FROM:",10,20),t.setFontSize(10),t.text(j.parcelOrigin.name||"",10,25),t.text(j.parcelOrigin.street||"",10,30),t.text(`${j.parcelOrigin.city}, ${j.parcelOrigin.country}`,10,35),t.rect(5,70,100,50),t.setFontSize(8),t.text("TO:",10,75),t.setFontSize(12),t.setFont("helvetica","bold"),t.text(j.parcelDestination.name||"",10,82),t.text(j.parcelDestination.street||"",10,89),t.text(`${j.parcelDestination.city}, ${j.parcelDestination.country}`,10,96),t.setFont("helvetica","normal"),t.setFont("Libre Barcode 39"),t.setFontSize(36),t.text(`*${e}*`,105,140,{align:"center"}),t.save(`Shipping_Label_${e}.pdf`)}function O_(){const t=document.getElementById("page-parcel");t&&(t.innerHTML=`
        <button class="back-btn">${ze("parcel.back_to_services")}</button>
        <div class="service-page-header">
            <h2>${ze("parcel.title")}</h2>
            <p id="parcel-main-subtitle" class="subtitle">${ze("parcel.subtitle")}</p>
        </div>

        <!-- Step 1: Details -->
        <div id="parcel-step-1" class="service-step">
             <form id="parcel-quote-form" class="form-container" novalidate>
                <div class="form-section two-column">
                    <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                        <div id="parcel-pickup-fields">
                            <div class="progressive-form-section" id="origin-address-section">
                                <h3>${ze("parcel.origin")}</h3>
                                <div class="input-wrapper progressive-field" data-step="1"><label for="origin-name">${ze("parcel.full_name")}</label><input type="text" id="origin-name" required><p class="error-text hidden"></p></div>
                                <div class="input-wrapper progressive-field hidden" data-step="2"><label for="origin-street">${ze("parcel.street_address")}</label><input type="text" id="origin-street" required><p class="error-text hidden"></p></div>
                                <div class="input-wrapper progressive-field hidden" data-step="3"><label for="origin-city">${ze("parcel.city")}</label><input type="text" id="origin-city" required><p class="error-text hidden"></p></div>
                                <div class="input-wrapper progressive-field hidden" data-step="5"><label for="origin-country">${ze("parcel.country")}</label><input type="text" id="origin-country" required><p class="error-text hidden"></p></div>
                                <div class="input-wrapper progressive-field hidden" data-step="4"><label for="origin-postcode">${ze("parcel.postcode")}</label><input type="text" id="origin-postcode" required><p class="error-text hidden"></p></div>
                            </div>
                        </div>
                        <div id="parcel-dropoff-fields" class="hidden">
                             <h3>Drop-off Information</h3>
                            <p class="helper-text">Drop-off quotes are based on your current country selection.</p>
                            <div class="input-wrapper">
                                <label for="parcel-dropoff-postcode">Your Postcode / City</label>
                                <input type="text" id="parcel-dropoff-postcode" placeholder="Enter postcode">
                                <p class="error-text hidden"></p>
                            </div>
                        </div>
                        <div>
                            <h3>${ze("parcel.package_details")}</h3>
                            <div class="form-grid" style="grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));">
                                <div class="input-wrapper"><label for="package-weight">${ze("parcel.weight_kg")}</label><input type="number" id="package-weight" required min="0.1" step="0.1"><p class="error-text hidden"></p></div>
                                <div class="input-wrapper"><label for="package-length">${ze("parcel.length_cm")}</label><input type="number" id="package-length" required min="1"><p class="error-text hidden"></p></div>
                                <div class="input-wrapper"><label for="package-width">${ze("parcel.width_cm")}</label><input type="number" id="package-width" required min="1"><p class="error-text hidden"></p></div>
                                <div class="input-wrapper"><label for="package-height">${ze("parcel.height_cm")}</label><input type="number" id="package-height" required min="1"><p class="error-text hidden"></p></div>
                            </div>
                            <div id="heavy-item-banner" class="info-banner hidden" style="margin-top: 1.5rem;">
                                <div class="info-banner-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z" /></svg>
                                </div>
                                <div class="info-banner-text">
                                    <h4>Heavy Item?</h4>
                                    <p>For items over 30kg, consider our LCL or Air Freight services for better value and handling.</p>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3>Optional Add-ons</h3>
                            <div class="checkbox-wrapper">
                                <input type="checkbox" id="parcel-insurance-checkbox">
                                <label for="parcel-insurance-checkbox">Add Parcel Insurance</label>
                            </div>
                            <div class="conditional-fields" id="parcel-insurance-fields">
                                <div class="input-wrapper">
                                    <label for="parcel-declared-value">Declared Value (${j.currentCurrency.symbol})</label>
                                    <input type="number" id="parcel-declared-value" min="1" step="0.01" placeholder="e.g., 500">
                                    <p class="helper-text" id="parcel-insurance-cost-display"></p>
                                    <p class="error-text hidden"></p>
                                </div>
                            </div>
                        </div>
                         <div id="item-details-section">
                            <h3>${ze("parcel.item_details")}</h3>
                            <div class="input-wrapper"><label for="item-description">${ze("parcel.description")}</label><textarea id="item-description" required placeholder="e.g., Men's Cotton T-Shirts"></textarea><p class="error-text hidden"></p></div>
                            <div id="hs-code-section" class="hs-code-suggester-wrapper hidden" style="margin-top: 1rem;">
                                <div class="input-wrapper">
                                    <label for="hs-code">${ze("parcel.hs_code_optional")}</label>
                                    <input type="text" id="hs-code" autocomplete="off" placeholder="Auto-suggested from description">
                                    <div class="hs-code-suggestions" id="parcel-hs-code-suggestions"></div>
                                     <p class="helper-text">HS Code is auto-suggested for international shipments.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                     <div class="progressive-form-section" id="destination-address-section">
                        <h3>${ze("parcel.destination")}</h3>
                        <div class="input-wrapper progressive-field" data-step="1"><label for="dest-name">${ze("parcel.full_name")}</label><input type="text" id="dest-name" required><p class="error-text hidden"></p></div>
                        <div class="input-wrapper progressive-field hidden" data-step="2"><label for="dest-street">${ze("parcel.street_address")}</label><input type="text" id="dest-street" required><p class="error-text hidden"></p></div>
                        <div class="input-wrapper progressive-field hidden" data-step="3"><label for="dest-city">${ze("parcel.city")}</label><input type="text" id="dest-city" required><p class="error-text hidden"></p></div>
                        <div class="input-wrapper progressive-field hidden" data-step="5"><label for="dest-country">${ze("parcel.country")}</label><input type="text" id="dest-country" required><p class="error-text hidden"></p></div>
                        <div class="input-wrapper progressive-field hidden" data-step="4"><label for="dest-postcode">${ze("parcel.postcode")}</label><input type="text" id="dest-postcode" required><p class="error-text hidden"></p></div>
                    </div>
                </div>
                <div class="form-actions"><button type="submit" class="main-submit-btn">${ze("parcel.get_quotes")}</button></div>
            </form>
        </div>

        <!-- Step 2: Quotes -->
        <div id="parcel-step-2" class="service-step">
            <div id="parcel-warnings-container"></div>
            <div class="results-controls">
                <h3>Sort By:</h3>
                <div class="sort-buttons">
                    <button class="sort-btn active" data-sort="price">Cheapest First</button>
                    <button class="sort-btn" data-sort="speed">Fastest First</button>
                </div>
            </div>
            <div class="results-layout-grid">
                <main id="parcel-quotes-container" class="results-main-content">
                    <div id="quotes-skeleton">
                        <div class="quote-card-skeleton"></div>
                        <div class="quote-card-skeleton"></div>
                        <div class="quote-card-skeleton"></div>
                    </div>
                </main>
                <aside id="parcel-sidebar-container" class="results-sidebar"></aside>
            </div>
            <div class="form-actions" style="justify-content: flex-start; margin-top: 2rem;">
                <button id="parcel-back-to-details" class="secondary-btn">Back to Details</button>
            </div>
        </div>
        
        <!-- Step 3 is now the main payment page -->

        <!-- Step 4: Confirmation -->
        <div id="parcel-step-4" class="service-step">
            <div class="confirmation-container">
                <h3 id="parcel-confirmation-title"></h3><p id="parcel-confirmation-message"></p>
                <div class="confirmation-tracking">
                    <h4>Your Tracking ID</h4>
                    <div class="tracking-id-display" id="parcel-confirmation-tracking-id"></div>
                     <button class="main-submit-btn" id="parcel-confirmation-track-shipment-btn" style="margin-top: 1rem; display: inline-flex; align-items: center; gap: 0.5rem;">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 1.25em; height: 1.25em;"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" /></svg>
                        <span>Track Your Shipment</span>
                    </button>
                </div>
                <div class="confirmation-actions">
                     <button id="parcel-print-label-btn" class="secondary-btn">Print Label (PDF)</button>
                     <button id="parcel-new-shipment-btn" class="main-submit-btn">New Shipment</button>
                </div>
            </div>
        </div>
    `)}function ug(){const t=document.getElementById("parcel-insurance-checkbox"),e=document.getElementById("parcel-declared-value"),n=document.getElementById("parcel-insurance-cost-display");if(!t||!e||!n)return;if(!t.checked){Ae({parcelInsuranceAdded:!1,parcelDeclaredValue:0,parcelInsuranceCost:0}),n.textContent="";return}const i=parseFloat(e.value)||0;if(i<=0){Ae({parcelInsuranceAdded:!0,parcelDeclaredValue:0,parcelInsuranceCost:0}),n.textContent="";return}const r=5,s=i*.005,a=Math.max(s,r);Ae({parcelInsuranceAdded:!0,parcelDeclaredValue:i,parcelInsuranceCost:a}),n.textContent=`Insurance cost: ${j.currentCurrency.symbol}${a.toFixed(2)}`}function H_(){const{parcelOrigin:t,parcelDestination:e,parcelInitialWeight:n,parcelInitialLength:i,parcelInitialWidth:r,parcelInitialHeight:o}=j,s=(a,c)=>{const u=document.getElementById(a);u&&(c||c===0)&&(u.value=String(c))};t&&(s("origin-name",t.name),s("origin-street",t.street),s("origin-city",t.city),s("origin-postcode",t.postcode),s("origin-country",t.country)),e&&(s("dest-name",e.name),s("dest-street",e.street),s("dest-city",e.city),s("dest-postcode",e.postcode),s("dest-country",e.country)),n&&(s("package-weight",n),vy()),i&&s("package-length",i),r&&s("package-width",r),o&&s("package-height",o)}function yy(){var s;Ae({currentService:"parcel"}),O_(),bt("parcel"),(s=document.querySelector("#page-parcel .back-btn"))==null||s.addEventListener("click",()=>{mh(),bt("landing")});const t=document.getElementById("page-parcel");if(!t)return;t.addEventListener("click",a=>{var u;F_(a),q_(a);const c=a.target;if(c.id==="parcel-back-to-details"&&fc(1),c.id==="parcel-new-shipment-btn"&&(mh(),yy()),c.id==="parcel-print-label-btn"&&$_(),c.id==="parcel-confirmation-track-shipment-btn"){const f=(u=document.getElementById("parcel-confirmation-tracking-id"))==null?void 0:u.textContent;if(f){const p=Le.trackingIdInput;p&&(p.value=f),Le.trackingModal.classList.add("active")}}}),t.addEventListener("submit",a=>{a.target.id==="parcel-quote-form"&&R_(a)}),t.addEventListener("change",a=>{var u;const c=a.target;c.id==="parcel-insurance-checkbox"&&((u=document.getElementById("parcel-insurance-fields"))==null||u.classList.toggle("active",c.checked),ug())}),t.addEventListener("input",a=>{const c=a.target;if(["origin-country","dest-country"].includes(c.id)&&N_(),c.id==="package-weight"&&vy(),["origin-name","dest-name"].includes(c.id)){const u=c.closest(".progressive-form-section");if(u){const f=u.querySelector('[data-step="2"]');f&&f.classList.remove("hidden")}}if(["origin-street","dest-street"].includes(c.id)){const u=c.closest(".progressive-form-section");if(u){const f=u.querySelector('[data-step="3"]');f&&f.classList.remove("hidden")}}if(["origin-city","dest-city"].includes(c.id)){const u=c.closest(".progressive-form-section");if(u){const f=u.querySelector('[data-step="4"]');f&&f.classList.remove("hidden")}}if(["origin-postcode","dest-postcode"].includes(c.id)){const u=c.closest(".progressive-form-section");if(u){const f=u.querySelector('[data-step="5"]');f&&f.classList.remove("hidden")}}if(c.id==="parcel-declared-value"&&ug(),c.id==="item-description"){const u=document.getElementById("hs-code"),f=document.getElementById("parcel-hs-code-suggestions");if(!u||!f)return;const p=c.value.trim();p.length>10?hf(p).then(v=>{v.length>0?(u.value=v[0].code,f.innerHTML=v.map(m=>`<div class="hs-code-suggestion-item" data-code="${m.code}"><strong>${m.code}</strong> - ${m.description}</div>`).join(""),f.classList.add("active")):f.classList.remove("active")}):f.classList.remove("active")}});const e=document.getElementById("origin-country"),n=document.getElementById("origin-postcode");e&&n&&lg(e,n);const i=document.getElementById("dest-country"),r=document.getElementById("dest-postcode");i&&r&&lg(i,r);const o=sessionStorage.getItem("vcanship_show_confirmation");if(o){const a=JSON.parse(o);a.service==="parcel"&&(U_(a.shipmentId,j.parcelDeclaredValue,j.parcelPremiumTrackingAdded),sessionStorage.removeItem("vcanship_show_confirmation"))}else fc(1);H_()}function Aa(t){var r;if(!document.getElementById("page-baggage"))return;const i=["details","quote","payment","confirmation"].indexOf(t);Ei("baggage",i),document.querySelectorAll("#page-baggage .service-step").forEach(o=>o.classList.remove("active")),(r=document.getElementById(`baggage-step-${t}`))==null||r.classList.add("active")}function by(){const t=document.getElementById("page-baggage");t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div class="service-page-header">
            <h2>Send Personal Baggage</h2>
            <p class="subtitle">Avoid excess airline fees. Ship your bags ahead with us.</p>
        </div>
        <div class="form-container">
            <div class="visual-progress-bar" id="progress-bar-baggage">
                <div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div>
            </div>

            <!-- Step 1: Details -->
            <div id="baggage-step-details" class="service-step">
                <form id="baggage-details-form">
                    <h3>Shipment Details</h3>
                    <div class="input-wrapper">
                        <label for="baggage-service-type">Service Type</label>
                        <select id="baggage-service-type">
                            <option value="door-to-door">Door-to-Door</option>
                            <option value="door-to-airport">Door-to-Airport</option>
                            <option value="airport-to-door">Airport-to-Door</option>
                            <option value="airport-to-airport">Airport-to-Airport</option>
                        </select>
                    </div>

                    <div id="baggage-origin-fields">
                        <h4>Origin</h4>
                        <!-- Dynamic fields based on selection -->
                    </div>
                    <div id="baggage-destination-fields">
                        <h4>Destination</h4>
                        <!-- Dynamic fields based on selection -->
                    </div>

                    <div class="input-wrapper">
                        <label for="baggage-weight">Total Weight (kg)</label>
                        <input type="number" id="baggage-weight" required min="1">
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="main-submit-btn">Get Estimated Quote</button>
                    </div>
                </form>
            </div>

            <!-- Step 2: Quote -->
            <div id="baggage-step-quote" class="service-step">
                <h3>Your AI-Powered Estimate</h3>
                <div id="baggage-quote-container"></div>
                 <div class="quote-confirmation-panel">
                    <h4>Please Note: This is an AI Estimate</h4>
                    <p>This price is an estimate generated by our AI based on current market rates. A Vcanship agent will contact you via email to confirm the final details and provide an exact quote for your approval before any payment is required.</p>
                </div>
                <div class="form-actions">
                    <button type="button" id="baggage-back-to-details" class="secondary-btn">Back</button>
                    <button type="button" id="baggage-request-booking" class="main-submit-btn">Request Final Quote</button>
                </div>
            </div>
            
            <!-- Step 3 is skipped as it's an offline booking -->

            <!-- Step 4: Confirmation -->
            <div id="baggage-step-confirmation" class="service-step">
                 <div class="confirmation-container">
                    <h3>Booking Request Sent!</h3>
                    <p>Your baggage shipment request has been received. Our team will email you shortly with a final quote and booking instructions.</p>
                    <div class="confirmation-tracking">
                        <h4>Reference ID</h4>
                        <div class="tracking-id-display" id="baggage-reference-id"></div>
                    </div>
                    <div class="confirmation-actions">
                         <button id="baggage-new-shipment-btn" class="main-submit-btn">Book Another Shipment</button>
                    </div>
                </div>
            </div>
        </div>
    `)}function Pd(t){const e=document.getElementById("baggage-origin-fields"),n=document.getElementById("baggage-destination-fields");if(!e||!n)return;const i=o=>`
        <div class="input-wrapper"><label for="baggage-${o}-street">Street Address</label><input type="text" id="baggage-${o}-street" required></div>
        <div class="form-grid">
            <div class="input-wrapper"><label for="baggage-${o}-city">City</label><input type="text" id="baggage-${o}-city" required></div>
            <div class="input-wrapper"><label for="baggage-${o}-country">Country</label><input type="text" id="baggage-${o}-country" required></div>
        </div>
    `,r=o=>`
        <div class="input-wrapper"><label for="baggage-${o}-airport">Airport Code (IATA)</label><input type="text" id="baggage-${o}-airport" required placeholder="e.g., LHR"></div>
    `;t.startsWith("door-to")?e.innerHTML=i("origin"):e.innerHTML=r("origin"),t.endsWith("-to-door")?n.innerHTML=i("destination"):n.innerHTML=r("destination")}async function V_(t){t.preventDefault(),rt(!0,"Calculating your estimate...");const e=document.getElementById("baggage-service-type").value,n=document.getElementById("baggage-weight").value;let i,r;e.startsWith("door-to")?i=`${document.getElementById("baggage-origin-city").value}, ${document.getElementById("baggage-origin-country").value}`:i=document.getElementById("baggage-origin-airport").value,e.endsWith("-to-door")?r=`${document.getElementById("baggage-destination-city").value}, ${document.getElementById("baggage-destination-country").value}`:r=document.getElementById("baggage-destination-airport").value;const o=`
        Act as a logistics pricing expert. Provide an estimated cost for shipping personal baggage.
        - Service Type: ${e}
        - Origin: ${i}
        - Destination: ${r}
        - Total Weight: ${n} kg
        - Currency: ${j.currentCurrency.code}

        Provide a single estimated base cost as a number. Do not add any other text or formatting.
    `;try{if(!j.api)throw new Error("AI API not initialized.");const s=await j.api.models.generateContent({model:"gemini-2.5-flash",contents:o}),a=parseFloat(s.text);if(isNaN(a))throw new Error("Invalid AI response.");const c=An.baggage.standard,u=a*(1+c),f=document.getElementById("baggage-quote-container");f&&(f.innerHTML=`
                <div class="payment-overview">
                    <div class="review-item"><span>Service:</span><strong>${e}</strong></div>
                    <div class="review-item"><span>Route:</span><strong>${i} &rarr; ${r}</strong></div>
                    <div class="review-item"><span>Weight:</span><strong>${n} kg</strong></div>
                    <hr>
                    <div class="review-item total"><span>Estimated Total:</span><strong>${j.currentCurrency.symbol}${u.toFixed(2)}</strong></div>
                </div>
            `),Aa("quote")}catch(s){console.error("Baggage quote error:",s),Ee("Could not generate an estimate. Please try again.","error")}finally{rt(!1)}}function wy(){var e,n,i,r,o;(e=document.querySelector("#page-baggage .back-btn"))==null||e.addEventListener("click",()=>bt("landing"));const t=document.getElementById("baggage-service-type");t==null||t.addEventListener("change",()=>Pd(t.value)),(n=document.getElementById("baggage-details-form"))==null||n.addEventListener("submit",V_),(i=document.getElementById("baggage-back-to-details"))==null||i.addEventListener("click",()=>Aa("details")),(r=document.getElementById("baggage-request-booking"))==null||r.addEventListener("click",()=>{const s=`BGG-${Date.now().toString().slice(-6)}`;document.getElementById("baggage-reference-id").textContent=s,Aa("confirmation"),Ee("Request sent! We will be in touch.","success")}),(o=document.getElementById("baggage-new-shipment-btn"))==null||o.addEventListener("click",()=>{zm(),by(),wy(),Aa("details"),Pd("door-to-door")})}function G_(){Ae({currentService:"baggage"}),zm(),by(),bt("baggage"),wy(),Aa("details"),Pd("door-to-door")}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let W_,z_;function J_(){return{geminiUrl:W_,vertexUrl:z_}}function Y_(t,e,n,i){var r,o;if(!(t!=null&&t.baseUrl)){const s=J_();return e?(r=s.vertexUrl)!==null&&r!==void 0?r:n:(o=s.geminiUrl)!==null&&o!==void 0?o:i}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vo{}function De(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const o=e[r];return o!=null?String(o):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function d(t,e,n){for(let o=0;o<e.length-1;o++){const s=e[o];if(s.endsWith("[]")){const a=s.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${s}`);if(Array.isArray(t[a])){const c=t[a];if(Array.isArray(n))for(let u=0;u<c.length;u++){const f=c[u];d(f,e.slice(o+1),n[u])}else for(const u of c)d(u,e.slice(o+1),n)}return}else if(s.endsWith("[0]")){const a=s.slice(0,-3);a in t||(t[a]=[{}]);const c=t[a];d(c[0],e.slice(o+1),n);return}(!t[s]||typeof t[s]!="object")&&(t[s]={}),t=t[s]}const i=e[e.length-1],r=t[i];if(r!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===r)return;if(typeof r=="object"&&typeof n=="object"&&r!==null&&n!==null)Object.assign(r,n);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[i]=n}function l(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const i=e[n];if(i.endsWith("[]")){const r=i.slice(0,-2);if(r in t){const o=t[r];return Array.isArray(o)?o.map(s=>l(s,e.slice(n+1))):void 0}else return}else t=t[i]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bf(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function K_(t){const e={},n=l(t,["operationName"]);n!=null&&d(e,["operationName"],n);const i=l(t,["resourceName"]);return i!=null&&d(e,["_url","resourceName"],i),e}function j_(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const i=l(t,["metadata"]);i!=null&&d(e,["metadata"],i);const r=l(t,["done"]);r!=null&&d(e,["done"],r);const o=l(t,["error"]);o!=null&&d(e,["error"],o);const s=l(t,["response","generateVideoResponse"]);return s!=null&&d(e,["response"],X_(s)),e}function Q_(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const i=l(t,["metadata"]);i!=null&&d(e,["metadata"],i);const r=l(t,["done"]);r!=null&&d(e,["done"],r);const o=l(t,["error"]);o!=null&&d(e,["error"],o);const s=l(t,["response"]);return s!=null&&d(e,["response"],Z_(s)),e}function X_(t){const e={},n=l(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>eC(s))),d(e,["generatedVideos"],o)}const i=l(t,["raiMediaFilteredCount"]);i!=null&&d(e,["raiMediaFilteredCount"],i);const r=l(t,["raiMediaFilteredReasons"]);return r!=null&&d(e,["raiMediaFilteredReasons"],r),e}function Z_(t){const e={},n=l(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>tC(s))),d(e,["generatedVideos"],o)}const i=l(t,["raiMediaFilteredCount"]);i!=null&&d(e,["raiMediaFilteredCount"],i);const r=l(t,["raiMediaFilteredReasons"]);return r!=null&&d(e,["raiMediaFilteredReasons"],r),e}function eC(t){const e={},n=l(t,["_self"]);return n!=null&&d(e,["video"],rC(n)),e}function tC(t){const e={},n=l(t,["_self"]);return n!=null&&d(e,["video"],oC(n)),e}function nC(t){const e={},n=l(t,["operationName"]);return n!=null&&d(e,["_url","operationName"],n),e}function iC(t){const e={},n=l(t,["operationName"]);return n!=null&&d(e,["_url","operationName"],n),e}function rC(t){const e={},n=l(t,["video","uri"]);n!=null&&d(e,["uri"],n);const i=l(t,["video","encodedVideo"]);i!=null&&d(e,["videoBytes"],bf(i));const r=l(t,["encoding"]);return r!=null&&d(e,["mimeType"],r),e}function oC(t){const e={},n=l(t,["gcsUri"]);n!=null&&d(e,["uri"],n);const i=l(t,["bytesBase64Encoded"]);i!=null&&d(e,["videoBytes"],bf(i));const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var dg;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(dg||(dg={}));var fg;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(fg||(fg={}));var Wn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Wn||(Wn={}));var hg;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(hg||(hg={}));var pg;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(pg||(pg={}));var gg;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(gg||(gg={}));var mg;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(mg||(mg={}));var vg;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(vg||(vg={}));var yg;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(yg||(yg={}));var bg;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(bg||(bg={}));var wg;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(wg||(wg={}));var Sg;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Sg||(Sg={}));var _g;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(_g||(_g={}));var Cg;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(Cg||(Cg={}));var Eg;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Eg||(Eg={}));var hc;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(hc||(hc={}));var Tg;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Tg||(Tg={}));var Nd;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Nd||(Nd={}));var Ag;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Ag||(Ag={}));var Ig;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Ig||(Ig={}));var kg;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(kg||(kg={}));var xg;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(xg||(xg={}));var Lg;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Lg||(Lg={}));var Pg;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Pg||(Pg={}));var Ng;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(Ng||(Ng={}));var Rg;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Rg||(Rg={}));var Mg;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Mg||(Mg={}));var Bg;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Bg||(Bg={}));var Dg;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Dg||(Dg={}));var Fg;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Fg||(Fg={}));var qg;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(qg||(qg={}));var Ug;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Ug||(Ug={}));var $g;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})($g||($g={}));var Og;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(Og||(Og={}));var Hg;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(Hg||(Hg={}));var Vg;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(Vg||(Vg={}));var Gg;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Gg||(Gg={}));var Wg;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(Wg||(Wg={}));var zg;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(zg||(zg={}));var Jg;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Jg||(Jg={}));var Yg;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Yg||(Yg={}));var Kg;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Kg||(Kg={}));var jg;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(jg||(jg={}));var Qg;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Qg||(Qg={}));var Xg;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Xg||(Xg={}));var Zg;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Zg||(Zg={}));var em;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(em||(em={}));var Cs;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Cs||(Cs={}));class Rd{constructor(e){const n={};for(const i of e.headers.entries())n[i[0]]=i[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class ba{get text(){var e,n,i,r,o,s,a,c;if(((r=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",f=!1;const p=[];for(const v of(c=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[m,S]of Object.entries(v))m!=="text"&&m!=="thought"&&(S!==null||S!==void 0)&&p.push(m);if(typeof v.text=="string"){if(typeof v.thought=="boolean"&&v.thought)continue;f=!0,u+=v.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?u:void 0}get data(){var e,n,i,r,o,s,a,c;if(((r=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const f=[];for(const p of(c=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[v,m]of Object.entries(p))v!=="inlineData"&&(m!==null||m!==void 0)&&f.push(v);p.inlineData&&typeof p.inlineData.data=="string"&&(u+=atob(p.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,i,r,o,s,a,c;if(((r=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(c=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,i,r,o,s,a,c,u;if(((r=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(c=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,i,r,o,s,a,c,u;if(((r=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(c=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.output}}class tm{}class nm{}class sC{}class aC{}class lC{}class cC{}class im{}class rm{}class om{}class uC{}class pc{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const i=new pc;let r;const o=e;return n?r=Q_(o):r=j_(o),Object.assign(i,r),i}}class sm{}class am{}class lm{}class dC{}class fC{}class hC{}class cm{}class pC{get text(){var e,n,i;let r="",o=!1;const s=[];for(const a of(i=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[c,u]of Object.entries(a))c!=="text"&&c!=="thought"&&u!==null&&s.push(c);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;o=!0,r+=a.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?r:void 0}get data(){var e,n,i;let r="";const o=[];for(const s of(i=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[a,c]of Object.entries(s))a!=="inlineData"&&c!==null&&o.push(a);s.inlineData&&typeof s.inlineData.data=="string"&&(r+=atob(s.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class gC{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function At(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Sy(t,e){const n=At(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function _y(t){return Array.isArray(t)?t.map(e=>gc(e)):[gc(t)]}function gc(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function Cy(t){const e=gc(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Ey(t){const e=gc(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function um(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function Ty(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>um(e)):[um(t)]}function Md(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function dm(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function fm(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function On(t){if(t==null)throw new Error("ContentUnion is required");return Md(t)?t:{role:"user",parts:Ty(t)}}function wf(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const i=On(n);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(t.isVertexAI()){const n=On(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>On(n)):[On(e)]}function Si(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(dm(t)||fm(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[On(t)]}const e=[],n=[],i=Md(t[0]);for(const r of t){const o=Md(r);if(o!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(r);else{if(dm(r)||fm(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(r)}}return i||e.push({role:"user",parts:Ty(n)}),e}function mC(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(i=>i!=="null");if(n.length===1)e.type=Object.values(Wn).includes(n[0].toUpperCase())?n[0].toUpperCase():Wn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of n)e.anyOf.push({type:Object.values(Wn).includes(i.toUpperCase())?i.toUpperCase():Wn.TYPE_UNSPECIFIED})}}function xs(t){const e={},n=["items"],i=["anyOf"],r=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=t.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,t=o[1]):o[1].type==="null"&&(e.nullable=!0,t=o[0])),t.type instanceof Array&&mC(t.type,e);for(const[s,a]of Object.entries(t))if(a!=null)if(s=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(Wn).includes(a.toUpperCase())?a.toUpperCase():Wn.TYPE_UNSPECIFIED}else if(n.includes(s))e[s]=xs(a);else if(i.includes(s)){const c=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}c.push(xs(u))}e[s]=c}else if(r.includes(s)){const c={};for(const[u,f]of Object.entries(a))c[u]=xs(f);e[s]=c}else{if(s==="additionalProperties")continue;e[s]=a}return e}function Sf(t){return xs(t)}function _f(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Cf(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function qs(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=xs(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=xs(e.response));return t}function Us(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function vC(t,e,n,i=1){const r=!e.startsWith(`${n}/`)&&e.split("/").length===i;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:r?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:r?`${n}/${e}`:e}function _r(t,e){if(typeof e!="string")throw new Error("name must be a string");return vC(t,e,"cachedContents")}function Ay(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Go(t){return bf(t)}function yC(t){return t!=null&&typeof t=="object"&&"name"in t}function bC(t){return t!=null&&typeof t=="object"&&"video"in t}function wC(t){return t!=null&&typeof t=="object"&&"uri"in t}function Iy(t){var e;let n;if(yC(t)&&(n=t.name),!(wC(t)&&(n=t.uri,n===void 0))&&!(bC(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const r=n.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${n}`);n=r[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function ky(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function xy(t){for(const e of["models","tunedModels","publisherModels"])if(SC(t,e))return t[e];return[]}function SC(t,e){return t!==null&&typeof t=="object"&&e in t}function _C(t,e={}){const n=t,i={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(i.responseJsonSchema=n.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function CC(t,e={}){const n=[],i=new Set;for(const r of t){const o=r.name;if(i.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);i.add(o);const s=_C(r,e);s.functionDeclarations&&n.push(...s.functionDeclarations)}return{functionDeclarations:n}}function Ly(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const i=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,r=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function EC(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Py(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const r=n.inlinedResponses;if(!Array.isArray(r)||r.length===0)return t;let o=!1;for(const s of r){if(typeof s!="object"||s===null)continue;const c=s.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function $s(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function Ny(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TC(t){const e={},n=l(t,["responsesFile"]);n!=null&&d(e,["fileName"],n);const i=l(t,["inlinedResponses","inlinedResponses"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>dE(s))),d(e,["inlinedResponses"],o)}const r=l(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>cE(s))),d(e,["inlinedEmbedContentResponses"],o)}return e}function AC(t){const e={},n=l(t,["predictionsFormat"]);n!=null&&d(e,["format"],n);const i=l(t,["gcsDestination","outputUriPrefix"]);i!=null&&d(e,["gcsUri"],i);const r=l(t,["bigqueryDestination","outputUri"]);return r!=null&&d(e,["bigqueryUri"],r),e}function IC(t){const e={},n=l(t,["format"]);n!=null&&d(e,["predictionsFormat"],n);const i=l(t,["gcsUri"]);i!=null&&d(e,["gcsDestination","outputUriPrefix"],i);const r=l(t,["bigqueryUri"]);if(r!=null&&d(e,["bigqueryDestination","outputUri"],r),l(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(l(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Ss(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const i=l(t,["metadata","displayName"]);i!=null&&d(e,["displayName"],i);const r=l(t,["metadata","state"]);r!=null&&d(e,["state"],Ny(r));const o=l(t,["metadata","createTime"]);o!=null&&d(e,["createTime"],o);const s=l(t,["metadata","endTime"]);s!=null&&d(e,["endTime"],s);const a=l(t,["metadata","updateTime"]);a!=null&&d(e,["updateTime"],a);const c=l(t,["metadata","model"]);c!=null&&d(e,["model"],c);const u=l(t,["metadata","output"]);return u!=null&&d(e,["dest"],TC(Py(u))),e}function Bd(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const i=l(t,["displayName"]);i!=null&&d(e,["displayName"],i);const r=l(t,["state"]);r!=null&&d(e,["state"],Ny(r));const o=l(t,["error"]);o!=null&&d(e,["error"],My(o));const s=l(t,["createTime"]);s!=null&&d(e,["createTime"],s);const a=l(t,["startTime"]);a!=null&&d(e,["startTime"],a);const c=l(t,["endTime"]);c!=null&&d(e,["endTime"],c);const u=l(t,["updateTime"]);u!=null&&d(e,["updateTime"],u);const f=l(t,["model"]);f!=null&&d(e,["model"],f);const p=l(t,["inputConfig"]);p!=null&&d(e,["src"],kC(p));const v=l(t,["outputConfig"]);return v!=null&&d(e,["dest"],AC(Py(v))),e}function kC(t){const e={},n=l(t,["instancesFormat"]);n!=null&&d(e,["format"],n);const i=l(t,["gcsSource","uris"]);i!=null&&d(e,["gcsUri"],i);const r=l(t,["bigquerySource","inputUri"]);return r!=null&&d(e,["bigqueryUri"],r),e}function xC(t,e){const n={};if(l(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(l(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=l(e,["fileName"]);i!=null&&d(n,["fileName"],i);const r=l(e,["inlinedRequests"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>uE(t,s))),d(n,["requests","requests"],o)}return n}function LC(t){const e={},n=l(t,["format"]);n!=null&&d(e,["instancesFormat"],n);const i=l(t,["gcsUri"]);i!=null&&d(e,["gcsSource","uris"],i);const r=l(t,["bigqueryUri"]);if(r!=null&&d(e,["bigquerySource","inputUri"],r),l(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function PC(t){const e={},n=l(t,["data"]);n!=null&&d(e,["data"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function NC(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&d(e,["data"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function RC(t,e){const n={},i=l(e,["name"]);return i!=null&&d(n,["_url","name"],$s(t,i)),n}function MC(t,e){const n={},i=l(e,["name"]);return i!=null&&d(n,["_url","name"],$s(t,i)),n}function BC(t){const e={},n=l(t,["content"]);n!=null&&d(e,["content"],qC(n));const i=l(t,["citationMetadata"]);i!=null&&d(e,["citationMetadata"],DC(i));const r=l(t,["tokenCount"]);r!=null&&d(e,["tokenCount"],r);const o=l(t,["finishReason"]);o!=null&&d(e,["finishReason"],o);const s=l(t,["urlContextMetadata"]);s!=null&&d(e,["urlContextMetadata"],ME(s));const a=l(t,["avgLogprobs"]);a!=null&&d(e,["avgLogprobs"],a);const c=l(t,["groundingMetadata"]);c!=null&&d(e,["groundingMetadata"],c);const u=l(t,["index"]);u!=null&&d(e,["index"],u);const f=l(t,["logprobsResult"]);f!=null&&d(e,["logprobsResult"],f);const p=l(t,["safetyRatings"]);return p!=null&&d(e,["safetyRatings"],p),e}function DC(t){const e={},n=l(t,["citationSources"]);return n!=null&&d(e,["citations"],n),e}function FC(t){const e={},n=l(t,["values"]);return n!=null&&d(e,["values"],n),e}function qC(t){const e={},n=l(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>SE(o))),d(e,["parts"],r)}const i=l(t,["role"]);return i!=null&&d(e,["role"],i),e}function Ry(t){const e={},n=l(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>_E(o))),d(e,["parts"],r)}const i=l(t,["role"]);return i!=null&&d(e,["role"],i),e}function UC(t,e){const n={},i=l(t,["displayName"]);if(e!==void 0&&i!=null&&d(e,["batch","displayName"],i),l(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function $C(t,e){const n={},i=l(t,["displayName"]);e!==void 0&&i!=null&&d(e,["displayName"],i);const r=l(t,["dest"]);return e!==void 0&&r!=null&&d(e,["outputConfig"],IC(EC(r))),n}function Wu(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["src"]);r!=null&&d(n,["batch","inputConfig"],xC(t,Ly(t,r)));const o=l(e,["config"]);return o!=null&&UC(o,n),n}function OC(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["model"],At(t,i));const r=l(e,["src"]);r!=null&&d(n,["inputConfig"],LC(Ly(t,r)));const o=l(e,["config"]);return o!=null&&$C(o,n),n}function HC(t,e){const n={},i=l(t,["displayName"]);return e!==void 0&&i!=null&&d(e,["batch","displayName"],i),n}function zu(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["src"]);r!=null&&d(n,["batch","inputConfig"],jC(t,r));const o=l(e,["config"]);return o!=null&&HC(o,n),n}function VC(t,e){const n={},i=l(e,["name"]);return i!=null&&d(n,["_url","name"],$s(t,i)),n}function GC(t,e){const n={},i=l(e,["name"]);return i!=null&&d(n,["_url","name"],$s(t,i)),n}function WC(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["name"]);i!=null&&d(e,["name"],i);const r=l(t,["done"]);r!=null&&d(e,["done"],r);const o=l(t,["error"]);return o!=null&&d(e,["error"],Ef(o)),e}function zC(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["name"]);i!=null&&d(e,["name"],i);const r=l(t,["done"]);r!=null&&d(e,["done"],r);const o=l(t,["error"]);return o!=null&&d(e,["error"],My(o)),e}function JC(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const i=l(t,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function YC(t,e){const n={},i=l(e,["contents"]);i!=null&&d(n,["requests[]","request","content"],wf(t,i));const r=l(e,["config"]);return r!=null&&d(n,["config"],KC(r,n)),n}function KC(t,e){const n={},i=l(t,["taskType"]);e!==void 0&&i!=null&&d(e,["requests[]","taskType"],i);const r=l(t,["title"]);e!==void 0&&r!=null&&d(e,["requests[]","title"],r);const o=l(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&d(e,["requests[]","outputDimensionality"],o),l(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function jC(t,e){const n={},i=l(e,["fileName"]);i!=null&&d(n,["file_name"],i);const r=l(e,["inlinedRequests"]);return r!=null&&d(n,["requests"],YC(t,r)),n}function QC(t){const e={},n=l(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function XC(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function ZC(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const i=l(t,["args"]);i!=null&&d(e,["args"],i);const r=l(t,["name"]);return r!=null&&d(e,["name"],r),e}function eE(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const i=l(t,["args"]);i!=null&&d(e,["args"],i);const r=l(t,["name"]);return r!=null&&d(e,["name"],r),e}function tE(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const i=l(t,["allowedFunctionNames"]);return i!=null&&d(e,["allowedFunctionNames"],i),e}function nE(t){const e={},n=l(t,["behavior"]);n!=null&&d(e,["behavior"],n);const i=l(t,["description"]);i!=null&&d(e,["description"],i);const r=l(t,["name"]);r!=null&&d(e,["name"],r);const o=l(t,["parameters"]);o!=null&&d(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&d(e,["parametersJsonSchema"],s);const a=l(t,["response"]);a!=null&&d(e,["response"],a);const c=l(t,["responseJsonSchema"]);return c!=null&&d(e,["responseJsonSchema"],c),e}function iE(t,e,n){const i={},r=l(e,["systemInstruction"]);n!==void 0&&r!=null&&d(n,["systemInstruction"],Ry(On(r)));const o=l(e,["temperature"]);o!=null&&d(i,["temperature"],o);const s=l(e,["topP"]);s!=null&&d(i,["topP"],s);const a=l(e,["topK"]);a!=null&&d(i,["topK"],a);const c=l(e,["candidateCount"]);c!=null&&d(i,["candidateCount"],c);const u=l(e,["maxOutputTokens"]);u!=null&&d(i,["maxOutputTokens"],u);const f=l(e,["stopSequences"]);f!=null&&d(i,["stopSequences"],f);const p=l(e,["responseLogprobs"]);p!=null&&d(i,["responseLogprobs"],p);const v=l(e,["logprobs"]);v!=null&&d(i,["logprobs"],v);const m=l(e,["presencePenalty"]);m!=null&&d(i,["presencePenalty"],m);const S=l(e,["frequencyPenalty"]);S!=null&&d(i,["frequencyPenalty"],S);const _=l(e,["seed"]);_!=null&&d(i,["seed"],_);const E=l(e,["responseMimeType"]);E!=null&&d(i,["responseMimeType"],E);const C=l(e,["responseSchema"]);C!=null&&d(i,["responseSchema"],AE(Sf(C)));const k=l(e,["responseJsonSchema"]);if(k!=null&&d(i,["responseJsonSchema"],k),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const I=l(e,["safetySettings"]);if(n!==void 0&&I!=null){let N=I;Array.isArray(N)&&(N=N.map(F=>TE(F))),d(n,["safetySettings"],N)}const P=l(e,["tools"]);if(n!==void 0&&P!=null){let N=Us(P);Array.isArray(N)&&(N=N.map(F=>RE(qs(F)))),d(n,["tools"],N)}const G=l(e,["toolConfig"]);if(n!==void 0&&G!=null&&d(n,["toolConfig"],NE(G)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const ee=l(e,["cachedContent"]);n!==void 0&&ee!=null&&d(n,["cachedContent"],_r(t,ee));const te=l(e,["responseModalities"]);te!=null&&d(i,["responseModalities"],te);const Y=l(e,["mediaResolution"]);Y!=null&&d(i,["mediaResolution"],Y);const D=l(e,["speechConfig"]);if(D!=null&&d(i,["speechConfig"],xE(_f(D))),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Z=l(e,["thinkingConfig"]);return Z!=null&&d(i,["thinkingConfig"],LE(Z)),i}function rE(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(u=>BC(u))),d(e,["candidates"],c)}const r=l(t,["modelVersion"]);r!=null&&d(e,["modelVersion"],r);const o=l(t,["promptFeedback"]);o!=null&&d(e,["promptFeedback"],o);const s=l(t,["responseId"]);s!=null&&d(e,["responseId"],s);const a=l(t,["usageMetadata"]);return a!=null&&d(e,["usageMetadata"],a),e}function oE(t,e){const n={},i=l(e,["name"]);return i!=null&&d(n,["_url","name"],$s(t,i)),n}function sE(t,e){const n={},i=l(e,["name"]);return i!=null&&d(n,["_url","name"],$s(t,i)),n}function aE(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&d(e,["dynamicRetrievalConfig"],JC(n)),e}function lE(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&d(e,["timeRangeFilter"],fE(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function cE(t){const e={},n=l(t,["response"]);n!=null&&d(e,["response"],IE(n));const i=l(t,["error"]);return i!=null&&d(e,["error"],Ef(i)),e}function uE(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["request","model"],At(t,i));const r=l(e,["contents"]);if(r!=null){let s=Si(r);Array.isArray(s)&&(s=s.map(a=>Ry(a))),d(n,["request","contents"],s)}const o=l(e,["config"]);return o!=null&&d(n,["request","generationConfig"],iE(t,o,n)),n}function dE(t){const e={},n=l(t,["response"]);n!=null&&d(e,["response"],rE(n));const i=l(t,["error"]);return i!=null&&d(e,["error"],Ef(i)),e}function fE(t){const e={},n=l(t,["startTime"]);n!=null&&d(e,["startTime"],n);const i=l(t,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function Ef(t){const e={},n=l(t,["details"]);n!=null&&d(e,["details"],n);const i=l(t,["code"]);i!=null&&d(e,["code"],i);const r=l(t,["message"]);return r!=null&&d(e,["message"],r),e}function My(t){const e={},n=l(t,["details"]);n!=null&&d(e,["details"],n);const i=l(t,["code"]);i!=null&&d(e,["code"],i);const r=l(t,["message"]);return r!=null&&d(e,["message"],r),e}function hE(t){const e={},n=l(t,["latitude"]);n!=null&&d(e,["latitude"],n);const i=l(t,["longitude"]);return i!=null&&d(e,["longitude"],i),e}function pE(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=l(t,["pageToken"]);if(e!==void 0&&r!=null&&d(e,["_query","pageToken"],r),l(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function gE(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=l(t,["pageToken"]);e!==void 0&&r!=null&&d(e,["_query","pageToken"],r);const o=l(t,["filter"]);return e!==void 0&&o!=null&&d(e,["_query","filter"],o),n}function mE(t){const e={},n=l(t,["config"]);return n!=null&&pE(n,e),e}function vE(t){const e={},n=l(t,["config"]);return n!=null&&gE(n,e),e}function yE(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=l(t,["operations"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Ss(s))),d(e,["batchJobs"],o)}return e}function bE(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=l(t,["batchPredictionJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Bd(s))),d(e,["batchJobs"],o)}return e}function wE(t){const e={},n=l(t,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>kE(r))),d(e,["speakerVoiceConfigs"],i)}return e}function SE(t){const e={},n=l(t,["videoMetadata"]);n!=null&&d(e,["videoMetadata"],FE(n));const i=l(t,["thought"]);i!=null&&d(e,["thought"],i);const r=l(t,["inlineData"]);r!=null&&d(e,["inlineData"],PC(r));const o=l(t,["fileData"]);o!=null&&d(e,["fileData"],QC(o));const s=l(t,["thoughtSignature"]);s!=null&&d(e,["thoughtSignature"],s);const a=l(t,["functionCall"]);a!=null&&d(e,["functionCall"],ZC(a));const c=l(t,["codeExecutionResult"]);c!=null&&d(e,["codeExecutionResult"],c);const u=l(t,["executableCode"]);u!=null&&d(e,["executableCode"],u);const f=l(t,["functionResponse"]);f!=null&&d(e,["functionResponse"],f);const p=l(t,["text"]);return p!=null&&d(e,["text"],p),e}function _E(t){const e={},n=l(t,["videoMetadata"]);n!=null&&d(e,["videoMetadata"],qE(n));const i=l(t,["thought"]);i!=null&&d(e,["thought"],i);const r=l(t,["inlineData"]);r!=null&&d(e,["inlineData"],NC(r));const o=l(t,["fileData"]);o!=null&&d(e,["fileData"],XC(o));const s=l(t,["thoughtSignature"]);s!=null&&d(e,["thoughtSignature"],s);const a=l(t,["functionCall"]);a!=null&&d(e,["functionCall"],eE(a));const c=l(t,["codeExecutionResult"]);c!=null&&d(e,["codeExecutionResult"],c);const u=l(t,["executableCode"]);u!=null&&d(e,["executableCode"],u);const f=l(t,["functionResponse"]);f!=null&&d(e,["functionResponse"],f);const p=l(t,["text"]);return p!=null&&d(e,["text"],p),e}function CE(t){const e={},n=l(t,["voiceName"]);return n!=null&&d(e,["voiceName"],n),e}function EE(t){const e={},n=l(t,["latLng"]);n!=null&&d(e,["latLng"],hE(n));const i=l(t,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function TE(t){const e={};if(l(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=l(t,["category"]);n!=null&&d(e,["category"],n);const i=l(t,["threshold"]);return i!=null&&d(e,["threshold"],i),e}function AE(t){const e={},n=l(t,["anyOf"]);n!=null&&d(e,["anyOf"],n);const i=l(t,["default"]);i!=null&&d(e,["default"],i);const r=l(t,["description"]);r!=null&&d(e,["description"],r);const o=l(t,["enum"]);o!=null&&d(e,["enum"],o);const s=l(t,["example"]);s!=null&&d(e,["example"],s);const a=l(t,["format"]);a!=null&&d(e,["format"],a);const c=l(t,["items"]);c!=null&&d(e,["items"],c);const u=l(t,["maxItems"]);u!=null&&d(e,["maxItems"],u);const f=l(t,["maxLength"]);f!=null&&d(e,["maxLength"],f);const p=l(t,["maxProperties"]);p!=null&&d(e,["maxProperties"],p);const v=l(t,["maximum"]);v!=null&&d(e,["maximum"],v);const m=l(t,["minItems"]);m!=null&&d(e,["minItems"],m);const S=l(t,["minLength"]);S!=null&&d(e,["minLength"],S);const _=l(t,["minProperties"]);_!=null&&d(e,["minProperties"],_);const E=l(t,["minimum"]);E!=null&&d(e,["minimum"],E);const C=l(t,["nullable"]);C!=null&&d(e,["nullable"],C);const k=l(t,["pattern"]);k!=null&&d(e,["pattern"],k);const I=l(t,["properties"]);I!=null&&d(e,["properties"],I);const P=l(t,["propertyOrdering"]);P!=null&&d(e,["propertyOrdering"],P);const G=l(t,["required"]);G!=null&&d(e,["required"],G);const ee=l(t,["title"]);ee!=null&&d(e,["title"],ee);const te=l(t,["type"]);return te!=null&&d(e,["type"],te),e}function IE(t){const e={},n=l(t,["embedding"]);n!=null&&d(e,["embedding"],FC(n));const i=l(t,["tokenCount"]);return i!=null&&d(e,["tokenCount"],i),e}function kE(t){const e={},n=l(t,["speaker"]);n!=null&&d(e,["speaker"],n);const i=l(t,["voiceConfig"]);return i!=null&&d(e,["voiceConfig"],By(i)),e}function xE(t){const e={},n=l(t,["voiceConfig"]);n!=null&&d(e,["voiceConfig"],By(n));const i=l(t,["multiSpeakerVoiceConfig"]);i!=null&&d(e,["multiSpeakerVoiceConfig"],wE(i));const r=l(t,["languageCode"]);return r!=null&&d(e,["languageCode"],r),e}function LE(t){const e={},n=l(t,["includeThoughts"]);n!=null&&d(e,["includeThoughts"],n);const i=l(t,["thinkingBudget"]);return i!=null&&d(e,["thinkingBudget"],i),e}function PE(t){const e={},n=l(t,["environment"]);n!=null&&d(e,["environment"],n);const i=l(t,["excludedPredefinedFunctions"]);return i!=null&&d(e,["excludedPredefinedFunctions"],i),e}function NE(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&d(e,["functionCallingConfig"],tE(n));const i=l(t,["retrievalConfig"]);return i!=null&&d(e,["retrievalConfig"],EE(i)),e}function RE(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(u=>nE(u))),d(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=l(t,["googleSearch"]);i!=null&&d(e,["googleSearch"],lE(i));const r=l(t,["googleSearchRetrieval"]);if(r!=null&&d(e,["googleSearchRetrieval"],aE(r)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&d(e,["urlContext"],BE());const s=l(t,["computerUse"]);s!=null&&d(e,["computerUse"],PE(s));const a=l(t,["codeExecution"]);return a!=null&&d(e,["codeExecution"],a),e}function ME(t){const e={},n=l(t,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>DE(r))),d(e,["urlMetadata"],i)}return e}function BE(){return{}}function DE(t){const e={},n=l(t,["retrievedUrl"]);n!=null&&d(e,["retrievedUrl"],n);const i=l(t,["urlRetrievalStatus"]);return i!=null&&d(e,["urlRetrievalStatus"],i),e}function FE(t){const e={},n=l(t,["fps"]);n!=null&&d(e,["fps"],n);const i=l(t,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=l(t,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function qE(t){const e={},n=l(t,["fps"]);n!=null&&d(e,["fps"],n);const i=l(t,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=l(t,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function By(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&d(e,["prebuiltVoiceConfig"],CE(n)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Uo;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Uo||(Uo={}));class Va{constructor(e,n,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,i,r)}init(e,n,i){var r,o;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let s={config:{}};!i||Object.keys(i).length===0?s={config:{}}:typeof i=="object"?s=Object.assign({},i):s=i,s.config&&(s.config.pageToken=n.nextPageToken),this.paramsInternal=s,this.pageInternalSize=(o=(r=s.config)===null||r===void 0?void 0:r.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UE extends Vo{constructor(e){super(),this.apiClient=e,this.create=async n=>{var i,r;if(this.apiClient.isVertexAI())return n.config=this.formatDestination(n.src,n.config),this.createInternal(n);const o=n.src;if(!(Array.isArray(n.src)||o.inlinedRequests!==void 0))return this.createInternal(n);const a=this.createInlinedGenerateContentRequest(n),c=a.path,u=a.body,f=Wu(this.apiClient,n)._query||{};return this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=n.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(v=>v.json()).then(v=>Ss(v))},this.createEmbeddings=async n=>{var i,r;if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");if(!(n.src.inlinedRequests!==void 0))return this.createEmbeddingsInternal(n);const a=this.createInlinedEmbedContentRequest(n),c=a.path,u=a.body,f=zu(this.apiClient,n)._query||{};return this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=n.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(v=>v.json()).then(v=>Ss(v))},this.list=async(n={})=>new Va(Uo.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=Wu(this.apiClient,e),i=n._url,r=De("{model}:batchGenerateContent",i),a=n.batch.inputConfig.requests,c=a.requests,u=[];for(const f of c){const p=Object.assign({},f);if(p.systemInstruction){const v=p.systemInstruction;delete p.systemInstruction;const m=p.request;m.systemInstruction=v,p.request=m}u.push(p)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:r,body:n}}createInlinedEmbedContentRequest(e){const n=zu(this.apiClient,e),i=n._url,r=De("{model}:asyncBatchEmbedContent",i),a=n.batch.inputConfig.requests,c=a.requests,u=[];delete a.config;for(const f of c){const p=Object.assign({},f),v=p.request;for(const m in p)m!=="request"&&(v[m]=p[m],delete p[m]);u.push(p)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:r,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const i=n?Object.assign({},n):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){const o=this.getGcsUri(e),s=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?i.dest=`${o.slice(0,-6)}/dest`:i.dest=`${o}_dest_${r}`;else if(s)i.dest=`${s}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=OC(this.apiClient,e);return a=De("batchPredictionJobs",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>Bd(f))}else{const u=Wu(this.apiClient,e);return a=De("{model}:batchGenerateContent",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>Ss(f))}}async createEmbeddingsInternal(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=zu(this.apiClient,e);return o=De("{model}:asyncBatchEmbedContent",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>Ss(c))}}async get(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=sE(this.apiClient,e);return a=De("batchPredictionJobs/{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>Bd(f))}else{const u=oE(this.apiClient,e);return a=De("batches/{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>Ss(f))}}async cancel(e){var n,i,r,o;let s="",a={};if(this.apiClient.isVertexAI()){const c=MC(this.apiClient,e);s=De("batchPredictionJobs/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const c=RC(this.apiClient,e);s=De("batches/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=vE(e);return a=De("batchPredictionJobs",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=bE(f),v=new cm;return Object.assign(v,p),v})}else{const u=mE(e);return a=De("batches",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=yE(f),v=new cm;return Object.assign(v,p),v})}}async delete(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=GC(this.apiClient,e);return a=De("batchPredictionJobs/{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>zC(f))}else{const u=VC(this.apiClient,e);return a=De("batches/{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>WC(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $E(t){const e={},n=l(t,["apiKeyString"]);return n!=null&&d(e,["apiKeyString"],n),e}function OE(t){const e={},n=l(t,["apiKeyConfig"]);n!=null&&d(e,["apiKeyConfig"],$E(n));const i=l(t,["authType"]);i!=null&&d(e,["authType"],i);const r=l(t,["googleServiceAccountConfig"]);r!=null&&d(e,["googleServiceAccountConfig"],r);const o=l(t,["httpBasicAuthConfig"]);o!=null&&d(e,["httpBasicAuthConfig"],o);const s=l(t,["oauthConfig"]);s!=null&&d(e,["oauthConfig"],s);const a=l(t,["oidcConfig"]);return a!=null&&d(e,["oidcConfig"],a),e}function HE(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&d(e,["data"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function VE(t){const e={},n=l(t,["displayName"]);n!=null&&d(e,["displayName"],n);const i=l(t,["data"]);i!=null&&d(e,["data"],i);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function Xl(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const i=l(t,["displayName"]);i!=null&&d(e,["displayName"],i);const r=l(t,["model"]);r!=null&&d(e,["model"],r);const o=l(t,["createTime"]);o!=null&&d(e,["createTime"],o);const s=l(t,["updateTime"]);s!=null&&d(e,["updateTime"],s);const a=l(t,["expireTime"]);a!=null&&d(e,["expireTime"],a);const c=l(t,["usageMetadata"]);return c!=null&&d(e,["usageMetadata"],c),e}function Zl(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const i=l(t,["displayName"]);i!=null&&d(e,["displayName"],i);const r=l(t,["model"]);r!=null&&d(e,["model"],r);const o=l(t,["createTime"]);o!=null&&d(e,["createTime"],o);const s=l(t,["updateTime"]);s!=null&&d(e,["updateTime"],s);const a=l(t,["expireTime"]);a!=null&&d(e,["expireTime"],a);const c=l(t,["usageMetadata"]);return c!=null&&d(e,["usageMetadata"],c),e}function hm(t){const e={},n=l(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>AT(o))),d(e,["parts"],r)}const i=l(t,["role"]);return i!=null&&d(e,["role"],i),e}function pm(t){const e={},n=l(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>IT(o))),d(e,["parts"],r)}const i=l(t,["role"]);return i!=null&&d(e,["role"],i),e}function GE(t,e){const n={},i=l(t,["ttl"]);e!==void 0&&i!=null&&d(e,["ttl"],i);const r=l(t,["expireTime"]);e!==void 0&&r!=null&&d(e,["expireTime"],r);const o=l(t,["displayName"]);e!==void 0&&o!=null&&d(e,["displayName"],o);const s=l(t,["contents"]);if(e!==void 0&&s!=null){let f=Si(s);Array.isArray(f)&&(f=f.map(p=>hm(p))),d(e,["contents"],f)}const a=l(t,["systemInstruction"]);e!==void 0&&a!=null&&d(e,["systemInstruction"],hm(On(a)));const c=l(t,["tools"]);if(e!==void 0&&c!=null){let f=c;Array.isArray(f)&&(f=f.map(p=>MT(p))),d(e,["tools"],f)}const u=l(t,["toolConfig"]);if(e!==void 0&&u!=null&&d(e,["toolConfig"],NT(u)),l(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function WE(t,e){const n={},i=l(t,["ttl"]);e!==void 0&&i!=null&&d(e,["ttl"],i);const r=l(t,["expireTime"]);e!==void 0&&r!=null&&d(e,["expireTime"],r);const o=l(t,["displayName"]);e!==void 0&&o!=null&&d(e,["displayName"],o);const s=l(t,["contents"]);if(e!==void 0&&s!=null){let p=Si(s);Array.isArray(p)&&(p=p.map(v=>pm(v))),d(e,["contents"],p)}const a=l(t,["systemInstruction"]);e!==void 0&&a!=null&&d(e,["systemInstruction"],pm(On(a)));const c=l(t,["tools"]);if(e!==void 0&&c!=null){let p=c;Array.isArray(p)&&(p=p.map(v=>BT(v))),d(e,["tools"],p)}const u=l(t,["toolConfig"]);e!==void 0&&u!=null&&d(e,["toolConfig"],RT(u));const f=l(t,["kmsKeyName"]);return e!==void 0&&f!=null&&d(e,["encryption_spec","kmsKeyName"],f),n}function zE(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["model"],Sy(t,i));const r=l(e,["config"]);return r!=null&&GE(r,n),n}function JE(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["model"],Sy(t,i));const r=l(e,["config"]);return r!=null&&WE(r,n),n}function YE(t,e){const n={},i=l(e,["name"]);return i!=null&&d(n,["_url","name"],_r(t,i)),n}function KE(t,e){const n={},i=l(e,["name"]);return i!=null&&d(n,["_url","name"],_r(t,i)),n}function jE(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function QE(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function XE(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const i=l(t,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function ZE(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const i=l(t,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function eT(t){const e={},n=l(t,["excludeDomains"]);return n!=null&&d(e,["excludeDomains"],n),e}function tT(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function nT(t){const e={},n=l(t,["displayName"]);n!=null&&d(e,["displayName"],n);const i=l(t,["fileUri"]);i!=null&&d(e,["fileUri"],i);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function iT(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const i=l(t,["args"]);i!=null&&d(e,["args"],i);const r=l(t,["name"]);return r!=null&&d(e,["name"],r),e}function rT(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const i=l(t,["args"]);i!=null&&d(e,["args"],i);const r=l(t,["name"]);return r!=null&&d(e,["name"],r),e}function oT(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const i=l(t,["allowedFunctionNames"]);return i!=null&&d(e,["allowedFunctionNames"],i),e}function sT(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const i=l(t,["allowedFunctionNames"]);return i!=null&&d(e,["allowedFunctionNames"],i),e}function aT(t){const e={},n=l(t,["behavior"]);n!=null&&d(e,["behavior"],n);const i=l(t,["description"]);i!=null&&d(e,["description"],i);const r=l(t,["name"]);r!=null&&d(e,["name"],r);const o=l(t,["parameters"]);o!=null&&d(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&d(e,["parametersJsonSchema"],s);const a=l(t,["response"]);a!=null&&d(e,["response"],a);const c=l(t,["responseJsonSchema"]);return c!=null&&d(e,["responseJsonSchema"],c),e}function lT(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&d(e,["description"],n);const i=l(t,["name"]);i!=null&&d(e,["name"],i);const r=l(t,["parameters"]);r!=null&&d(e,["parameters"],r);const o=l(t,["parametersJsonSchema"]);o!=null&&d(e,["parametersJsonSchema"],o);const s=l(t,["response"]);s!=null&&d(e,["response"],s);const a=l(t,["responseJsonSchema"]);return a!=null&&d(e,["responseJsonSchema"],a),e}function cT(t,e){const n={},i=l(e,["name"]);return i!=null&&d(n,["_url","name"],_r(t,i)),n}function uT(t,e){const n={},i=l(e,["name"]);return i!=null&&d(n,["_url","name"],_r(t,i)),n}function dT(t){const e={},n=l(t,["authConfig"]);return n!=null&&d(e,["authConfig"],OE(n)),e}function fT(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&d(e,["dynamicRetrievalConfig"],XE(n)),e}function hT(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&d(e,["dynamicRetrievalConfig"],ZE(n)),e}function pT(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&d(e,["timeRangeFilter"],mT(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function gT(t){const e={},n=l(t,["timeRangeFilter"]);n!=null&&d(e,["timeRangeFilter"],vT(n));const i=l(t,["excludeDomains"]);return i!=null&&d(e,["excludeDomains"],i),e}function mT(t){const e={},n=l(t,["startTime"]);n!=null&&d(e,["startTime"],n);const i=l(t,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function vT(t){const e={},n=l(t,["startTime"]);n!=null&&d(e,["startTime"],n);const i=l(t,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function yT(t){const e={},n=l(t,["latitude"]);n!=null&&d(e,["latitude"],n);const i=l(t,["longitude"]);return i!=null&&d(e,["longitude"],i),e}function bT(t){const e={},n=l(t,["latitude"]);n!=null&&d(e,["latitude"],n);const i=l(t,["longitude"]);return i!=null&&d(e,["longitude"],i),e}function wT(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=l(t,["pageToken"]);return e!==void 0&&r!=null&&d(e,["_query","pageToken"],r),n}function ST(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=l(t,["pageToken"]);return e!==void 0&&r!=null&&d(e,["_query","pageToken"],r),n}function _T(t){const e={},n=l(t,["config"]);return n!=null&&wT(n,e),e}function CT(t){const e={},n=l(t,["config"]);return n!=null&&ST(n,e),e}function ET(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=l(t,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Xl(s))),d(e,["cachedContents"],o)}return e}function TT(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=l(t,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Zl(s))),d(e,["cachedContents"],o)}return e}function AT(t){const e={},n=l(t,["videoMetadata"]);n!=null&&d(e,["videoMetadata"],HT(n));const i=l(t,["thought"]);i!=null&&d(e,["thought"],i);const r=l(t,["inlineData"]);r!=null&&d(e,["inlineData"],HE(r));const o=l(t,["fileData"]);o!=null&&d(e,["fileData"],tT(o));const s=l(t,["thoughtSignature"]);s!=null&&d(e,["thoughtSignature"],s);const a=l(t,["functionCall"]);a!=null&&d(e,["functionCall"],iT(a));const c=l(t,["codeExecutionResult"]);c!=null&&d(e,["codeExecutionResult"],c);const u=l(t,["executableCode"]);u!=null&&d(e,["executableCode"],u);const f=l(t,["functionResponse"]);f!=null&&d(e,["functionResponse"],f);const p=l(t,["text"]);return p!=null&&d(e,["text"],p),e}function IT(t){const e={},n=l(t,["videoMetadata"]);n!=null&&d(e,["videoMetadata"],VT(n));const i=l(t,["thought"]);i!=null&&d(e,["thought"],i);const r=l(t,["inlineData"]);r!=null&&d(e,["inlineData"],VE(r));const o=l(t,["fileData"]);o!=null&&d(e,["fileData"],nT(o));const s=l(t,["thoughtSignature"]);s!=null&&d(e,["thoughtSignature"],s);const a=l(t,["functionCall"]);a!=null&&d(e,["functionCall"],rT(a));const c=l(t,["codeExecutionResult"]);c!=null&&d(e,["codeExecutionResult"],c);const u=l(t,["executableCode"]);u!=null&&d(e,["executableCode"],u);const f=l(t,["functionResponse"]);f!=null&&d(e,["functionResponse"],f);const p=l(t,["text"]);return p!=null&&d(e,["text"],p),e}function kT(t){const e={},n=l(t,["latLng"]);n!=null&&d(e,["latLng"],yT(n));const i=l(t,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function xT(t){const e={},n=l(t,["latLng"]);n!=null&&d(e,["latLng"],bT(n));const i=l(t,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function LT(t){const e={},n=l(t,["environment"]);n!=null&&d(e,["environment"],n);const i=l(t,["excludedPredefinedFunctions"]);return i!=null&&d(e,["excludedPredefinedFunctions"],i),e}function PT(t){const e={},n=l(t,["environment"]);n!=null&&d(e,["environment"],n);const i=l(t,["excludedPredefinedFunctions"]);return i!=null&&d(e,["excludedPredefinedFunctions"],i),e}function NT(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&d(e,["functionCallingConfig"],oT(n));const i=l(t,["retrievalConfig"]);return i!=null&&d(e,["retrievalConfig"],kT(i)),e}function RT(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&d(e,["functionCallingConfig"],sT(n));const i=l(t,["retrievalConfig"]);return i!=null&&d(e,["retrievalConfig"],xT(i)),e}function MT(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(u=>aT(u))),d(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=l(t,["googleSearch"]);i!=null&&d(e,["googleSearch"],pT(i));const r=l(t,["googleSearchRetrieval"]);if(r!=null&&d(e,["googleSearchRetrieval"],fT(r)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&d(e,["urlContext"],$T());const s=l(t,["computerUse"]);s!=null&&d(e,["computerUse"],LT(s));const a=l(t,["codeExecution"]);return a!=null&&d(e,["codeExecution"],a),e}function BT(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(v=>lT(v))),d(e,["functionDeclarations"],p)}const i=l(t,["retrieval"]);i!=null&&d(e,["retrieval"],i);const r=l(t,["googleSearch"]);r!=null&&d(e,["googleSearch"],gT(r));const o=l(t,["googleSearchRetrieval"]);o!=null&&d(e,["googleSearchRetrieval"],hT(o));const s=l(t,["enterpriseWebSearch"]);s!=null&&d(e,["enterpriseWebSearch"],eT(s));const a=l(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],dT(a)),l(t,["urlContext"])!=null&&d(e,["urlContext"],OT());const u=l(t,["computerUse"]);u!=null&&d(e,["computerUse"],PT(u));const f=l(t,["codeExecution"]);return f!=null&&d(e,["codeExecution"],f),e}function DT(t,e){const n={},i=l(t,["ttl"]);e!==void 0&&i!=null&&d(e,["ttl"],i);const r=l(t,["expireTime"]);return e!==void 0&&r!=null&&d(e,["expireTime"],r),n}function FT(t,e){const n={},i=l(t,["ttl"]);e!==void 0&&i!=null&&d(e,["ttl"],i);const r=l(t,["expireTime"]);return e!==void 0&&r!=null&&d(e,["expireTime"],r),n}function qT(t,e){const n={},i=l(e,["name"]);i!=null&&d(n,["_url","name"],_r(t,i));const r=l(e,["config"]);return r!=null&&DT(r,n),n}function UT(t,e){const n={},i=l(e,["name"]);i!=null&&d(n,["_url","name"],_r(t,i));const r=l(e,["config"]);return r!=null&&FT(r,n),n}function $T(){return{}}function OT(){return{}}function HT(t){const e={},n=l(t,["fps"]);n!=null&&d(e,["fps"],n);const i=l(t,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=l(t,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function VT(t){const e={},n=l(t,["fps"]);n!=null&&d(e,["fps"],n);const i=l(t,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=l(t,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GT extends Vo{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Va(Uo.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(n),n)}async create(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=JE(this.apiClient,e);return a=De("cachedContents",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>Zl(f))}else{const u=zE(this.apiClient,e);return a=De("cachedContents",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>Xl(f))}}async get(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=uT(this.apiClient,e);return a=De("{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>Zl(f))}else{const u=cT(this.apiClient,e);return a=De("{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>Xl(f))}}async delete(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=KE(this.apiClient,e);return a=De("{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=QE(f),v=new am;return Object.assign(v,p),v})}else{const u=YE(this.apiClient,e);return a=De("{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=jE(f),v=new am;return Object.assign(v,p),v})}}async update(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=UT(this.apiClient,e);return a=De("{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>Zl(f))}else{const u=qT(this.apiClient,e);return a=De("{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>Xl(f))}}async listInternal(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=CT(e);return a=De("cachedContents",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=TT(f),v=new lm;return Object.assign(v,p),v})}else{const u=_T(e);return a=De("cachedContents",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=ET(f),v=new lm;return Object.assign(v,p),v})}}}function gm(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Jt(t){return this instanceof Jt?(this.v=t,this):new Jt(t)}function Ls(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(m){return function(S){return Promise.resolve(S).then(m,p)}}function a(m,S){i[m]&&(r[m]=function(_){return new Promise(function(E,C){o.push([m,_,E,C])>1||c(m,_)})},S&&(r[m]=S(r[m])))}function c(m,S){try{u(i[m](S))}catch(_){v(o[0][3],_)}}function u(m){m.value instanceof Jt?Promise.resolve(m.value.v).then(f,p):v(o[0][2],m)}function f(m){c("next",m)}function p(m){c("throw",m)}function v(m,S){m(S),o.shift(),o.length&&c(o[0][0],o[0][1])}}function Ia(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof gm=="function"?gm(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(o){n[o]=t[o]&&function(s){return new Promise(function(a,c){s=t[o](s),r(a,c,s.done,s.value)})}}function r(o,s,a,c){Promise.resolve(c).then(function(u){o({value:u,done:a})},s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WT(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:Dy(n)}function Dy(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function zT(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function mm(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let i=0;for(;i<n;)if(t[i].role==="user")e.push(t[i]),i++;else{const r=[];let o=!0;for(;i<n&&t[i].role==="model";)r.push(t[i]),o&&!Dy(t[i])&&(o=!1),i++;o?e.push(...r):e.pop()}return e}class JT{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new YT(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class YT{constructor(e,n,i,r={},o=[]){this.apiClient=e,this.modelsModule=n,this.model=i,this.config=r,this.history=o,this.sendPromise=Promise.resolve(),zT(o)}async sendMessage(e){var n;await this.sendPromise;const i=On(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var o,s,a;const c=await r,u=(s=(o=c.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content,f=c.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let v=[];f!=null&&(v=(a=f.slice(p))!==null&&a!==void 0?a:[]);const m=u?[u]:[];this.recordHistory(i,m,v)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var n;await this.sendPromise;const i=On(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const o=await r;return this.processStreamResponse(o,i)}getHistory(e=!1){const n=e?mm(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var i,r;return Ls(this,arguments,function*(){var s,a,c,u;const f=[];try{for(var p=!0,v=Ia(e),m;m=yield Jt(v.next()),s=m.done,!s;p=!0){u=m.value,p=!1;const S=u;if(WT(S)){const _=(r=(i=S.candidates)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.content;_!==void 0&&f.push(_)}yield yield Jt(S)}}catch(S){a={error:S}}finally{try{!p&&!s&&(c=v.return)&&(yield Jt(c.call(v)))}finally{if(a)throw a.error}}this.recordHistory(n,f)})}recordHistory(e,n,i){let r=[];n.length>0&&n.every(o=>o.role!==void 0)?r=n:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...mm(i)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xc extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,xc.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KT(t){const e={},n=l(t,["file"]);return n!=null&&d(e,["file"],tA(n)),e}function jT(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function QT(t){const e={},n=l(t,["name"]);return n!=null&&d(e,["_url","file"],Iy(n)),e}function XT(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function Dd(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const i=l(t,["displayName"]);i!=null&&d(e,["displayName"],i);const r=l(t,["mimeType"]);r!=null&&d(e,["mimeType"],r);const o=l(t,["sizeBytes"]);o!=null&&d(e,["sizeBytes"],o);const s=l(t,["createTime"]);s!=null&&d(e,["createTime"],s);const a=l(t,["expirationTime"]);a!=null&&d(e,["expirationTime"],a);const c=l(t,["updateTime"]);c!=null&&d(e,["updateTime"],c);const u=l(t,["sha256Hash"]);u!=null&&d(e,["sha256Hash"],u);const f=l(t,["uri"]);f!=null&&d(e,["uri"],f);const p=l(t,["downloadUri"]);p!=null&&d(e,["downloadUri"],p);const v=l(t,["state"]);v!=null&&d(e,["state"],v);const m=l(t,["source"]);m!=null&&d(e,["source"],m);const S=l(t,["videoMetadata"]);S!=null&&d(e,["videoMetadata"],S);const _=l(t,["error"]);return _!=null&&d(e,["error"],ZT(_)),e}function ZT(t){const e={},n=l(t,["details"]);n!=null&&d(e,["details"],n);const i=l(t,["message"]);i!=null&&d(e,["message"],i);const r=l(t,["code"]);return r!=null&&d(e,["code"],r),e}function eA(t){const e={},n=l(t,["details"]);n!=null&&d(e,["details"],n);const i=l(t,["message"]);i!=null&&d(e,["message"],i);const r=l(t,["code"]);return r!=null&&d(e,["code"],r),e}function tA(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const i=l(t,["displayName"]);i!=null&&d(e,["displayName"],i);const r=l(t,["mimeType"]);r!=null&&d(e,["mimeType"],r);const o=l(t,["sizeBytes"]);o!=null&&d(e,["sizeBytes"],o);const s=l(t,["createTime"]);s!=null&&d(e,["createTime"],s);const a=l(t,["expirationTime"]);a!=null&&d(e,["expirationTime"],a);const c=l(t,["updateTime"]);c!=null&&d(e,["updateTime"],c);const u=l(t,["sha256Hash"]);u!=null&&d(e,["sha256Hash"],u);const f=l(t,["uri"]);f!=null&&d(e,["uri"],f);const p=l(t,["downloadUri"]);p!=null&&d(e,["downloadUri"],p);const v=l(t,["state"]);v!=null&&d(e,["state"],v);const m=l(t,["source"]);m!=null&&d(e,["source"],m);const S=l(t,["videoMetadata"]);S!=null&&d(e,["videoMetadata"],S);const _=l(t,["error"]);return _!=null&&d(e,["error"],eA(_)),e}function nA(t){const e={},n=l(t,["name"]);return n!=null&&d(e,["_url","file"],Iy(n)),e}function iA(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=l(t,["pageToken"]);return e!==void 0&&r!=null&&d(e,["_query","pageToken"],r),n}function rA(t){const e={},n=l(t,["config"]);return n!=null&&iA(n,e),e}function oA(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=l(t,["files"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Dd(s))),d(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sA extends Vo{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Va(Uo.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>Dd(n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=rA(e);return o=De("files",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:c.headers},f})),r.then(c=>{const u=oA(c),f=new dC;return Object.assign(f,u),f})}}async createInternal(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=KT(e);return o=De("upload/v1beta/files",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const u=jT(c),f=new fC;return Object.assign(f,u),f})}}async get(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=nA(e);return o=De("files/{file}",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>Dd(c))}}async delete(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=QT(e);return o=De("files/{file}",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:c.headers},f})),r.then(c=>{const u=XT(c),f=new hC;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aA(){return{}}function lA(){return{}}function cA(){return{}}function uA(){return{}}function dA(t){const e={},n=l(t,["apiKeyString"]);return n!=null&&d(e,["apiKeyString"],n),e}function fA(t){const e={},n=l(t,["data"]);n!=null&&d(e,["data"],n);const i=l(t,["mimeType"]);i!=null&&d(e,["mimeType"],i);const r=l(t,["sourceMetadata"]);return r!=null&&d(e,["sourceMetadata"],nI(r)),e}function vm(){return{}}function ym(){return{}}function hA(t){const e={},n=l(t,["apiKeyConfig"]);n!=null&&d(e,["apiKeyConfig"],dA(n));const i=l(t,["authType"]);i!=null&&d(e,["authType"],i);const r=l(t,["googleServiceAccountConfig"]);r!=null&&d(e,["googleServiceAccountConfig"],r);const o=l(t,["httpBasicAuthConfig"]);o!=null&&d(e,["httpBasicAuthConfig"],o);const s=l(t,["oauthConfig"]);s!=null&&d(e,["oauthConfig"],s);const a=l(t,["oidcConfig"]);return a!=null&&d(e,["oidcConfig"],a),e}function pA(t){const e={},n=l(t,["disabled"]);n!=null&&d(e,["disabled"],n);const i=l(t,["startOfSpeechSensitivity"]);i!=null&&d(e,["startOfSpeechSensitivity"],i);const r=l(t,["endOfSpeechSensitivity"]);r!=null&&d(e,["endOfSpeechSensitivity"],r);const o=l(t,["prefixPaddingMs"]);o!=null&&d(e,["prefixPaddingMs"],o);const s=l(t,["silenceDurationMs"]);return s!=null&&d(e,["silenceDurationMs"],s),e}function gA(t){const e={},n=l(t,["disabled"]);n!=null&&d(e,["disabled"],n);const i=l(t,["startOfSpeechSensitivity"]);i!=null&&d(e,["startOfSpeechSensitivity"],i);const r=l(t,["endOfSpeechSensitivity"]);r!=null&&d(e,["endOfSpeechSensitivity"],r);const o=l(t,["prefixPaddingMs"]);o!=null&&d(e,["prefixPaddingMs"],o);const s=l(t,["silenceDurationMs"]);return s!=null&&d(e,["silenceDurationMs"],s),e}function mA(t){const e={},n=l(t,["data"]);n!=null&&d(e,["data"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function vA(t){const e={},n=l(t,["displayName"]);n!=null&&d(e,["displayName"],n);const i=l(t,["data"]);i!=null&&d(e,["data"],i);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function yA(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&d(e,["data"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function bA(t){const e={},n=l(t,["displayName"]);n!=null&&d(e,["displayName"],n);const i=l(t,["data"]);i!=null&&d(e,["data"],i);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function wA(t){const e={},n=l(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>wI(o))),d(e,["parts"],r)}const i=l(t,["role"]);return i!=null&&d(e,["role"],i),e}function SA(t){const e={},n=l(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>SI(o))),d(e,["parts"],r)}const i=l(t,["role"]);return i!=null&&d(e,["role"],i),e}function _A(t){const e={},n=l(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>_I(o))),d(e,["parts"],r)}const i=l(t,["role"]);return i!=null&&d(e,["role"],i),e}function CA(t){const e={},n=l(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>CI(o))),d(e,["parts"],r)}const i=l(t,["role"]);return i!=null&&d(e,["role"],i),e}function EA(t){const e={},n=l(t,["triggerTokens"]);n!=null&&d(e,["triggerTokens"],n);const i=l(t,["slidingWindow"]);return i!=null&&d(e,["slidingWindow"],NI(i)),e}function TA(t){const e={},n=l(t,["triggerTokens"]);n!=null&&d(e,["triggerTokens"],n);const i=l(t,["slidingWindow"]);return i!=null&&d(e,["slidingWindow"],RI(i)),e}function AA(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const i=l(t,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function IA(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const i=l(t,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function kA(t){const e={},n=l(t,["excludeDomains"]);return n!=null&&d(e,["excludeDomains"],n),e}function xA(t){const e={},n=l(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function LA(t){const e={},n=l(t,["displayName"]);n!=null&&d(e,["displayName"],n);const i=l(t,["fileUri"]);i!=null&&d(e,["fileUri"],i);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function PA(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function NA(t){const e={},n=l(t,["displayName"]);n!=null&&d(e,["displayName"],n);const i=l(t,["fileUri"]);i!=null&&d(e,["fileUri"],i);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function Fy(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const i=l(t,["args"]);i!=null&&d(e,["args"],i);const r=l(t,["name"]);return r!=null&&d(e,["name"],r),e}function qy(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const i=l(t,["args"]);i!=null&&d(e,["args"],i);const r=l(t,["name"]);return r!=null&&d(e,["name"],r),e}function RA(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const i=l(t,["args"]);i!=null&&d(e,["args"],i);const r=l(t,["name"]);return r!=null&&d(e,["name"],r),e}function MA(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const i=l(t,["args"]);i!=null&&d(e,["args"],i);const r=l(t,["name"]);return r!=null&&d(e,["name"],r),e}function BA(t){const e={},n=l(t,["behavior"]);n!=null&&d(e,["behavior"],n);const i=l(t,["description"]);i!=null&&d(e,["description"],i);const r=l(t,["name"]);r!=null&&d(e,["name"],r);const o=l(t,["parameters"]);o!=null&&d(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&d(e,["parametersJsonSchema"],s);const a=l(t,["response"]);a!=null&&d(e,["response"],a);const c=l(t,["responseJsonSchema"]);return c!=null&&d(e,["responseJsonSchema"],c),e}function DA(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&d(e,["description"],n);const i=l(t,["name"]);i!=null&&d(e,["name"],i);const r=l(t,["parameters"]);r!=null&&d(e,["parameters"],r);const o=l(t,["parametersJsonSchema"]);o!=null&&d(e,["parametersJsonSchema"],o);const s=l(t,["response"]);s!=null&&d(e,["response"],s);const a=l(t,["responseJsonSchema"]);return a!=null&&d(e,["responseJsonSchema"],a),e}function FA(t){const e={},n=l(t,["authConfig"]);return n!=null&&d(e,["authConfig"],hA(n)),e}function qA(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&d(e,["dynamicRetrievalConfig"],AA(n)),e}function UA(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&d(e,["dynamicRetrievalConfig"],IA(n)),e}function $A(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&d(e,["timeRangeFilter"],HA(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function OA(t){const e={},n=l(t,["timeRangeFilter"]);n!=null&&d(e,["timeRangeFilter"],VA(n));const i=l(t,["excludeDomains"]);return i!=null&&d(e,["excludeDomains"],i),e}function HA(t){const e={},n=l(t,["startTime"]);n!=null&&d(e,["startTime"],n);const i=l(t,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function VA(t){const e={},n=l(t,["startTime"]);n!=null&&d(e,["startTime"],n);const i=l(t,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function GA(t,e){const n={},i=l(t,["generationConfig"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig"],i);const r=l(t,["responseModalities"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig","responseModalities"],r);const o=l(t,["temperature"]);e!==void 0&&o!=null&&d(e,["setup","generationConfig","temperature"],o);const s=l(t,["topP"]);e!==void 0&&s!=null&&d(e,["setup","generationConfig","topP"],s);const a=l(t,["topK"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","topK"],a);const c=l(t,["maxOutputTokens"]);e!==void 0&&c!=null&&d(e,["setup","generationConfig","maxOutputTokens"],c);const u=l(t,["mediaResolution"]);e!==void 0&&u!=null&&d(e,["setup","generationConfig","mediaResolution"],u);const f=l(t,["seed"]);e!==void 0&&f!=null&&d(e,["setup","generationConfig","seed"],f);const p=l(t,["speechConfig"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","speechConfig"],BI(Cf(p)));const v=l(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],v);const m=l(t,["systemInstruction"]);e!==void 0&&m!=null&&d(e,["setup","systemInstruction"],_A(On(m)));const S=l(t,["tools"]);if(e!==void 0&&S!=null){let G=Us(S);Array.isArray(G)&&(G=G.map(ee=>UI(qs(ee)))),d(e,["setup","tools"],G)}const _=l(t,["sessionResumption"]);e!==void 0&&_!=null&&d(e,["setup","sessionResumption"],LI(_));const E=l(t,["inputAudioTranscription"]);e!==void 0&&E!=null&&d(e,["setup","inputAudioTranscription"],vm());const C=l(t,["outputAudioTranscription"]);e!==void 0&&C!=null&&d(e,["setup","outputAudioTranscription"],vm());const k=l(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&d(e,["setup","realtimeInputConfig"],kI(k));const I=l(t,["contextWindowCompression"]);e!==void 0&&I!=null&&d(e,["setup","contextWindowCompression"],EA(I));const P=l(t,["proactivity"]);return e!==void 0&&P!=null&&d(e,["setup","proactivity"],AI(P)),n}function WA(t,e){const n={},i=l(t,["generationConfig"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig"],i);const r=l(t,["responseModalities"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig","responseModalities"],r);const o=l(t,["temperature"]);e!==void 0&&o!=null&&d(e,["setup","generationConfig","temperature"],o);const s=l(t,["topP"]);e!==void 0&&s!=null&&d(e,["setup","generationConfig","topP"],s);const a=l(t,["topK"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","topK"],a);const c=l(t,["maxOutputTokens"]);e!==void 0&&c!=null&&d(e,["setup","generationConfig","maxOutputTokens"],c);const u=l(t,["mediaResolution"]);e!==void 0&&u!=null&&d(e,["setup","generationConfig","mediaResolution"],u);const f=l(t,["seed"]);e!==void 0&&f!=null&&d(e,["setup","generationConfig","seed"],f);const p=l(t,["speechConfig"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","speechConfig"],DI(Cf(p)));const v=l(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],v);const m=l(t,["systemInstruction"]);e!==void 0&&m!=null&&d(e,["setup","systemInstruction"],CA(On(m)));const S=l(t,["tools"]);if(e!==void 0&&S!=null){let G=Us(S);Array.isArray(G)&&(G=G.map(ee=>$I(qs(ee)))),d(e,["setup","tools"],G)}const _=l(t,["sessionResumption"]);e!==void 0&&_!=null&&d(e,["setup","sessionResumption"],PI(_));const E=l(t,["inputAudioTranscription"]);e!==void 0&&E!=null&&d(e,["setup","inputAudioTranscription"],ym());const C=l(t,["outputAudioTranscription"]);e!==void 0&&C!=null&&d(e,["setup","outputAudioTranscription"],ym());const k=l(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&d(e,["setup","realtimeInputConfig"],xI(k));const I=l(t,["contextWindowCompression"]);e!==void 0&&I!=null&&d(e,["setup","contextWindowCompression"],TA(I));const P=l(t,["proactivity"]);return e!==void 0&&P!=null&&d(e,["setup","proactivity"],II(P)),n}function zA(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["setup","model"],At(t,i));const r=l(e,["config"]);return r!=null&&d(n,["config"],GA(r,n)),n}function JA(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["setup","model"],At(t,i));const r=l(e,["config"]);return r!=null&&d(n,["config"],WA(r,n)),n}function YA(t){const e={},n=l(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>XI(r))),d(e,["weightedPrompts"],i)}return e}function Uy(t){const e={},n=l(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>Vy(r))),d(e,["weightedPrompts"],i)}return e}function Fd(t){const e={},n=l(t,["setup"]);n!=null&&d(e,["setup"],$y(n));const i=l(t,["clientContent"]);i!=null&&d(e,["clientContent"],Uy(i));const r=l(t,["musicGenerationConfig"]);r!=null&&d(e,["musicGenerationConfig"],Oy(r));const o=l(t,["playbackControl"]);return o!=null&&d(e,["playbackControl"],o),e}function $y(t){const e={},n=l(t,["model"]);return n!=null&&d(e,["model"],n),e}function KA(t){const e={},n=l(t,["text"]);n!=null&&d(e,["text"],n);const i=l(t,["filteredReason"]);return i!=null&&d(e,["filteredReason"],i),e}function jA(t){const e={},n=l(t,["temperature"]);n!=null&&d(e,["temperature"],n);const i=l(t,["topK"]);i!=null&&d(e,["topK"],i);const r=l(t,["seed"]);r!=null&&d(e,["seed"],r);const o=l(t,["guidance"]);o!=null&&d(e,["guidance"],o);const s=l(t,["bpm"]);s!=null&&d(e,["bpm"],s);const a=l(t,["density"]);a!=null&&d(e,["density"],a);const c=l(t,["brightness"]);c!=null&&d(e,["brightness"],c);const u=l(t,["scale"]);u!=null&&d(e,["scale"],u);const f=l(t,["muteBass"]);f!=null&&d(e,["muteBass"],f);const p=l(t,["muteDrums"]);p!=null&&d(e,["muteDrums"],p);const v=l(t,["onlyBassAndDrums"]);v!=null&&d(e,["onlyBassAndDrums"],v);const m=l(t,["musicGenerationMode"]);return m!=null&&d(e,["musicGenerationMode"],m),e}function Oy(t){const e={},n=l(t,["temperature"]);n!=null&&d(e,["temperature"],n);const i=l(t,["topK"]);i!=null&&d(e,["topK"],i);const r=l(t,["seed"]);r!=null&&d(e,["seed"],r);const o=l(t,["guidance"]);o!=null&&d(e,["guidance"],o);const s=l(t,["bpm"]);s!=null&&d(e,["bpm"],s);const a=l(t,["density"]);a!=null&&d(e,["density"],a);const c=l(t,["brightness"]);c!=null&&d(e,["brightness"],c);const u=l(t,["scale"]);u!=null&&d(e,["scale"],u);const f=l(t,["muteBass"]);f!=null&&d(e,["muteBass"],f);const p=l(t,["muteDrums"]);p!=null&&d(e,["muteDrums"],p);const v=l(t,["onlyBassAndDrums"]);v!=null&&d(e,["onlyBassAndDrums"],v);const m=l(t,["musicGenerationMode"]);return m!=null&&d(e,["musicGenerationMode"],m),e}function QA(t){const e={},n=l(t,["audioChunks"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>fA(r))),d(e,["audioChunks"],i)}return e}function XA(t){const e={};l(t,["setupComplete"])!=null&&d(e,["setupComplete"],ZA());const i=l(t,["serverContent"]);i!=null&&d(e,["serverContent"],QA(i));const r=l(t,["filteredPrompt"]);return r!=null&&d(e,["filteredPrompt"],KA(r)),e}function ZA(){return{}}function eI(t){const e={},n=l(t,["musicGenerationConfig"]);return n!=null&&d(e,["musicGenerationConfig"],Oy(n)),e}function tI(t){const e={},n=l(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>Vy(r))),d(e,["weightedPrompts"],i)}return e}function nI(t){const e={},n=l(t,["clientContent"]);n!=null&&d(e,["clientContent"],YA(n));const i=l(t,["musicGenerationConfig"]);return i!=null&&d(e,["musicGenerationConfig"],jA(i)),e}function iI(t){const e={},n=l(t,["media"]);if(n!=null){let u=_y(n);Array.isArray(u)&&(u=u.map(f=>f)),d(e,["mediaChunks"],u)}const i=l(t,["audio"]);i!=null&&d(e,["audio"],Ey(i));const r=l(t,["audioStreamEnd"]);r!=null&&d(e,["audioStreamEnd"],r);const o=l(t,["video"]);o!=null&&d(e,["video"],Cy(o));const s=l(t,["text"]);return s!=null&&d(e,["text"],s),l(t,["activityStart"])!=null&&d(e,["activityStart"],cA()),l(t,["activityEnd"])!=null&&d(e,["activityEnd"],aA()),e}function rI(t){const e={},n=l(t,["media"]);if(n!=null){let u=_y(n);Array.isArray(u)&&(u=u.map(f=>f)),d(e,["mediaChunks"],u)}const i=l(t,["audio"]);i!=null&&d(e,["audio"],Ey(i));const r=l(t,["audioStreamEnd"]);r!=null&&d(e,["audioStreamEnd"],r);const o=l(t,["video"]);o!=null&&d(e,["video"],Cy(o));const s=l(t,["text"]);return s!=null&&d(e,["text"],s),l(t,["activityStart"])!=null&&d(e,["activityStart"],uA()),l(t,["activityEnd"])!=null&&d(e,["activityEnd"],lA()),e}function oI(t){const e={},n=l(t,["modelTurn"]);n!=null&&d(e,["modelTurn"],wA(n));const i=l(t,["turnComplete"]);i!=null&&d(e,["turnComplete"],i);const r=l(t,["interrupted"]);r!=null&&d(e,["interrupted"],r);const o=l(t,["groundingMetadata"]);o!=null&&d(e,["groundingMetadata"],o);const s=l(t,["generationComplete"]);s!=null&&d(e,["generationComplete"],s);const a=l(t,["inputTranscription"]);a!=null&&d(e,["inputTranscription"],bm(a));const c=l(t,["outputTranscription"]);c!=null&&d(e,["outputTranscription"],bm(c));const u=l(t,["urlContextMetadata"]);u!=null&&d(e,["urlContextMetadata"],OI(u));const f=l(t,["turnCompleteReason"]);f!=null&&d(e,["turnCompleteReason"],f);const p=l(t,["waitingForInput"]);return p!=null&&d(e,["waitingForInput"],p),e}function sI(t){const e={},n=l(t,["modelTurn"]);n!=null&&d(e,["modelTurn"],SA(n));const i=l(t,["turnComplete"]);i!=null&&d(e,["turnComplete"],i);const r=l(t,["interrupted"]);r!=null&&d(e,["interrupted"],r);const o=l(t,["groundingMetadata"]);o!=null&&d(e,["groundingMetadata"],o);const s=l(t,["generationComplete"]);s!=null&&d(e,["generationComplete"],s);const a=l(t,["inputTranscription"]);a!=null&&d(e,["inputTranscription"],wm(a));const c=l(t,["outputTranscription"]);c!=null&&d(e,["outputTranscription"],wm(c));const u=l(t,["turnCompleteReason"]);u!=null&&d(e,["turnCompleteReason"],u);const f=l(t,["waitingForInput"]);return f!=null&&d(e,["waitingForInput"],f),e}function aI(t){const e={},n=l(t,["timeLeft"]);return n!=null&&d(e,["timeLeft"],n),e}function lI(t){const e={},n=l(t,["timeLeft"]);return n!=null&&d(e,["timeLeft"],n),e}function cI(t){const e={};l(t,["setupComplete"])!=null&&d(e,["setupComplete"],hI());const i=l(t,["serverContent"]);i!=null&&d(e,["serverContent"],oI(i));const r=l(t,["toolCall"]);r!=null&&d(e,["toolCall"],vI(r));const o=l(t,["toolCallCancellation"]);o!=null&&d(e,["toolCallCancellation"],gI(o));const s=l(t,["usageMetadata"]);s!=null&&d(e,["usageMetadata"],WI(s));const a=l(t,["goAway"]);a!=null&&d(e,["goAway"],aI(a));const c=l(t,["sessionResumptionUpdate"]);return c!=null&&d(e,["sessionResumptionUpdate"],dI(c)),e}function uI(t){const e={},n=l(t,["setupComplete"]);n!=null&&d(e,["setupComplete"],pI(n));const i=l(t,["serverContent"]);i!=null&&d(e,["serverContent"],sI(i));const r=l(t,["toolCall"]);r!=null&&d(e,["toolCall"],yI(r));const o=l(t,["toolCallCancellation"]);o!=null&&d(e,["toolCallCancellation"],mI(o));const s=l(t,["usageMetadata"]);s!=null&&d(e,["usageMetadata"],zI(s));const a=l(t,["goAway"]);a!=null&&d(e,["goAway"],lI(a));const c=l(t,["sessionResumptionUpdate"]);return c!=null&&d(e,["sessionResumptionUpdate"],fI(c)),e}function dI(t){const e={},n=l(t,["newHandle"]);n!=null&&d(e,["newHandle"],n);const i=l(t,["resumable"]);i!=null&&d(e,["resumable"],i);const r=l(t,["lastConsumedClientMessageIndex"]);return r!=null&&d(e,["lastConsumedClientMessageIndex"],r),e}function fI(t){const e={},n=l(t,["newHandle"]);n!=null&&d(e,["newHandle"],n);const i=l(t,["resumable"]);i!=null&&d(e,["resumable"],i);const r=l(t,["lastConsumedClientMessageIndex"]);return r!=null&&d(e,["lastConsumedClientMessageIndex"],r),e}function hI(){return{}}function pI(t){const e={},n=l(t,["sessionId"]);return n!=null&&d(e,["sessionId"],n),e}function gI(t){const e={},n=l(t,["ids"]);return n!=null&&d(e,["ids"],n),e}function mI(t){const e={},n=l(t,["ids"]);return n!=null&&d(e,["ids"],n),e}function vI(t){const e={},n=l(t,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>Fy(r))),d(e,["functionCalls"],i)}return e}function yI(t){const e={},n=l(t,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>qy(r))),d(e,["functionCalls"],i)}return e}function Ul(t){const e={},n=l(t,["modality"]);n!=null&&d(e,["modality"],n);const i=l(t,["tokenCount"]);return i!=null&&d(e,["tokenCount"],i),e}function $l(t){const e={},n=l(t,["modality"]);n!=null&&d(e,["modality"],n);const i=l(t,["tokenCount"]);return i!=null&&d(e,["tokenCount"],i),e}function bI(t){const e={},n=l(t,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>MI(r))),d(e,["speakerVoiceConfigs"],i)}return e}function wI(t){const e={},n=l(t,["videoMetadata"]);n!=null&&d(e,["videoMetadata"],JI(n));const i=l(t,["thought"]);i!=null&&d(e,["thought"],i);const r=l(t,["inlineData"]);r!=null&&d(e,["inlineData"],mA(r));const o=l(t,["fileData"]);o!=null&&d(e,["fileData"],xA(o));const s=l(t,["thoughtSignature"]);s!=null&&d(e,["thoughtSignature"],s);const a=l(t,["functionCall"]);a!=null&&d(e,["functionCall"],Fy(a));const c=l(t,["codeExecutionResult"]);c!=null&&d(e,["codeExecutionResult"],c);const u=l(t,["executableCode"]);u!=null&&d(e,["executableCode"],u);const f=l(t,["functionResponse"]);f!=null&&d(e,["functionResponse"],f);const p=l(t,["text"]);return p!=null&&d(e,["text"],p),e}function SI(t){const e={},n=l(t,["videoMetadata"]);n!=null&&d(e,["videoMetadata"],YI(n));const i=l(t,["thought"]);i!=null&&d(e,["thought"],i);const r=l(t,["inlineData"]);r!=null&&d(e,["inlineData"],vA(r));const o=l(t,["fileData"]);o!=null&&d(e,["fileData"],LA(o));const s=l(t,["thoughtSignature"]);s!=null&&d(e,["thoughtSignature"],s);const a=l(t,["functionCall"]);a!=null&&d(e,["functionCall"],qy(a));const c=l(t,["codeExecutionResult"]);c!=null&&d(e,["codeExecutionResult"],c);const u=l(t,["executableCode"]);u!=null&&d(e,["executableCode"],u);const f=l(t,["functionResponse"]);f!=null&&d(e,["functionResponse"],f);const p=l(t,["text"]);return p!=null&&d(e,["text"],p),e}function _I(t){const e={},n=l(t,["videoMetadata"]);n!=null&&d(e,["videoMetadata"],KI(n));const i=l(t,["thought"]);i!=null&&d(e,["thought"],i);const r=l(t,["inlineData"]);r!=null&&d(e,["inlineData"],yA(r));const o=l(t,["fileData"]);o!=null&&d(e,["fileData"],PA(o));const s=l(t,["thoughtSignature"]);s!=null&&d(e,["thoughtSignature"],s);const a=l(t,["functionCall"]);a!=null&&d(e,["functionCall"],RA(a));const c=l(t,["codeExecutionResult"]);c!=null&&d(e,["codeExecutionResult"],c);const u=l(t,["executableCode"]);u!=null&&d(e,["executableCode"],u);const f=l(t,["functionResponse"]);f!=null&&d(e,["functionResponse"],f);const p=l(t,["text"]);return p!=null&&d(e,["text"],p),e}function CI(t){const e={},n=l(t,["videoMetadata"]);n!=null&&d(e,["videoMetadata"],jI(n));const i=l(t,["thought"]);i!=null&&d(e,["thought"],i);const r=l(t,["inlineData"]);r!=null&&d(e,["inlineData"],bA(r));const o=l(t,["fileData"]);o!=null&&d(e,["fileData"],NA(o));const s=l(t,["thoughtSignature"]);s!=null&&d(e,["thoughtSignature"],s);const a=l(t,["functionCall"]);a!=null&&d(e,["functionCall"],MA(a));const c=l(t,["codeExecutionResult"]);c!=null&&d(e,["codeExecutionResult"],c);const u=l(t,["executableCode"]);u!=null&&d(e,["executableCode"],u);const f=l(t,["functionResponse"]);f!=null&&d(e,["functionResponse"],f);const p=l(t,["text"]);return p!=null&&d(e,["text"],p),e}function EI(t){const e={},n=l(t,["voiceName"]);return n!=null&&d(e,["voiceName"],n),e}function TI(t){const e={},n=l(t,["voiceName"]);return n!=null&&d(e,["voiceName"],n),e}function AI(t){const e={},n=l(t,["proactiveAudio"]);return n!=null&&d(e,["proactiveAudio"],n),e}function II(t){const e={},n=l(t,["proactiveAudio"]);return n!=null&&d(e,["proactiveAudio"],n),e}function kI(t){const e={},n=l(t,["automaticActivityDetection"]);n!=null&&d(e,["automaticActivityDetection"],pA(n));const i=l(t,["activityHandling"]);i!=null&&d(e,["activityHandling"],i);const r=l(t,["turnCoverage"]);return r!=null&&d(e,["turnCoverage"],r),e}function xI(t){const e={},n=l(t,["automaticActivityDetection"]);n!=null&&d(e,["automaticActivityDetection"],gA(n));const i=l(t,["activityHandling"]);i!=null&&d(e,["activityHandling"],i);const r=l(t,["turnCoverage"]);return r!=null&&d(e,["turnCoverage"],r),e}function LI(t){const e={},n=l(t,["handle"]);if(n!=null&&d(e,["handle"],n),l(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function PI(t){const e={},n=l(t,["handle"]);n!=null&&d(e,["handle"],n);const i=l(t,["transparent"]);return i!=null&&d(e,["transparent"],i),e}function NI(t){const e={},n=l(t,["targetTokens"]);return n!=null&&d(e,["targetTokens"],n),e}function RI(t){const e={},n=l(t,["targetTokens"]);return n!=null&&d(e,["targetTokens"],n),e}function MI(t){const e={},n=l(t,["speaker"]);n!=null&&d(e,["speaker"],n);const i=l(t,["voiceConfig"]);return i!=null&&d(e,["voiceConfig"],Hy(i)),e}function BI(t){const e={},n=l(t,["voiceConfig"]);n!=null&&d(e,["voiceConfig"],Hy(n));const i=l(t,["multiSpeakerVoiceConfig"]);i!=null&&d(e,["multiSpeakerVoiceConfig"],bI(i));const r=l(t,["languageCode"]);return r!=null&&d(e,["languageCode"],r),e}function DI(t){const e={},n=l(t,["voiceConfig"]);if(n!=null&&d(e,["voiceConfig"],QI(n)),l(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=l(t,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function FI(t){const e={},n=l(t,["environment"]);n!=null&&d(e,["environment"],n);const i=l(t,["excludedPredefinedFunctions"]);return i!=null&&d(e,["excludedPredefinedFunctions"],i),e}function qI(t){const e={},n=l(t,["environment"]);n!=null&&d(e,["environment"],n);const i=l(t,["excludedPredefinedFunctions"]);return i!=null&&d(e,["excludedPredefinedFunctions"],i),e}function UI(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(u=>BA(u))),d(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=l(t,["googleSearch"]);i!=null&&d(e,["googleSearch"],$A(i));const r=l(t,["googleSearchRetrieval"]);if(r!=null&&d(e,["googleSearchRetrieval"],qA(r)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&d(e,["urlContext"],HI());const s=l(t,["computerUse"]);s!=null&&d(e,["computerUse"],FI(s));const a=l(t,["codeExecution"]);return a!=null&&d(e,["codeExecution"],a),e}function $I(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(v=>DA(v))),d(e,["functionDeclarations"],p)}const i=l(t,["retrieval"]);i!=null&&d(e,["retrieval"],i);const r=l(t,["googleSearch"]);r!=null&&d(e,["googleSearch"],OA(r));const o=l(t,["googleSearchRetrieval"]);o!=null&&d(e,["googleSearchRetrieval"],UA(o));const s=l(t,["enterpriseWebSearch"]);s!=null&&d(e,["enterpriseWebSearch"],kA(s));const a=l(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],FA(a)),l(t,["urlContext"])!=null&&d(e,["urlContext"],VI());const u=l(t,["computerUse"]);u!=null&&d(e,["computerUse"],qI(u));const f=l(t,["codeExecution"]);return f!=null&&d(e,["codeExecution"],f),e}function bm(t){const e={},n=l(t,["text"]);n!=null&&d(e,["text"],n);const i=l(t,["finished"]);return i!=null&&d(e,["finished"],i),e}function wm(t){const e={},n=l(t,["text"]);n!=null&&d(e,["text"],n);const i=l(t,["finished"]);return i!=null&&d(e,["finished"],i),e}function OI(t){const e={},n=l(t,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>GI(r))),d(e,["urlMetadata"],i)}return e}function HI(){return{}}function VI(){return{}}function GI(t){const e={},n=l(t,["retrievedUrl"]);n!=null&&d(e,["retrievedUrl"],n);const i=l(t,["urlRetrievalStatus"]);return i!=null&&d(e,["urlRetrievalStatus"],i),e}function WI(t){const e={},n=l(t,["promptTokenCount"]);n!=null&&d(e,["promptTokenCount"],n);const i=l(t,["cachedContentTokenCount"]);i!=null&&d(e,["cachedContentTokenCount"],i);const r=l(t,["responseTokenCount"]);r!=null&&d(e,["responseTokenCount"],r);const o=l(t,["toolUsePromptTokenCount"]);o!=null&&d(e,["toolUsePromptTokenCount"],o);const s=l(t,["thoughtsTokenCount"]);s!=null&&d(e,["thoughtsTokenCount"],s);const a=l(t,["totalTokenCount"]);a!=null&&d(e,["totalTokenCount"],a);const c=l(t,["promptTokensDetails"]);if(c!=null){let v=c;Array.isArray(v)&&(v=v.map(m=>Ul(m))),d(e,["promptTokensDetails"],v)}const u=l(t,["cacheTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(m=>Ul(m))),d(e,["cacheTokensDetails"],v)}const f=l(t,["responseTokensDetails"]);if(f!=null){let v=f;Array.isArray(v)&&(v=v.map(m=>Ul(m))),d(e,["responseTokensDetails"],v)}const p=l(t,["toolUsePromptTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(m=>Ul(m))),d(e,["toolUsePromptTokensDetails"],v)}return e}function zI(t){const e={},n=l(t,["promptTokenCount"]);n!=null&&d(e,["promptTokenCount"],n);const i=l(t,["cachedContentTokenCount"]);i!=null&&d(e,["cachedContentTokenCount"],i);const r=l(t,["candidatesTokenCount"]);r!=null&&d(e,["responseTokenCount"],r);const o=l(t,["toolUsePromptTokenCount"]);o!=null&&d(e,["toolUsePromptTokenCount"],o);const s=l(t,["thoughtsTokenCount"]);s!=null&&d(e,["thoughtsTokenCount"],s);const a=l(t,["totalTokenCount"]);a!=null&&d(e,["totalTokenCount"],a);const c=l(t,["promptTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(S=>$l(S))),d(e,["promptTokensDetails"],m)}const u=l(t,["cacheTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(S=>$l(S))),d(e,["cacheTokensDetails"],m)}const f=l(t,["candidatesTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(S=>$l(S))),d(e,["responseTokensDetails"],m)}const p=l(t,["toolUsePromptTokensDetails"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(S=>$l(S))),d(e,["toolUsePromptTokensDetails"],m)}const v=l(t,["trafficType"]);return v!=null&&d(e,["trafficType"],v),e}function JI(t){const e={},n=l(t,["fps"]);n!=null&&d(e,["fps"],n);const i=l(t,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=l(t,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function YI(t){const e={},n=l(t,["fps"]);n!=null&&d(e,["fps"],n);const i=l(t,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=l(t,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function KI(t){const e={},n=l(t,["fps"]);n!=null&&d(e,["fps"],n);const i=l(t,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=l(t,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function jI(t){const e={},n=l(t,["fps"]);n!=null&&d(e,["fps"],n);const i=l(t,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=l(t,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function Hy(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&d(e,["prebuiltVoiceConfig"],EI(n)),e}function QI(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&d(e,["prebuiltVoiceConfig"],TI(n)),e}function XI(t){const e={},n=l(t,["text"]);n!=null&&d(e,["text"],n);const i=l(t,["weight"]);return i!=null&&d(e,["weight"],i),e}function Vy(t){const e={},n=l(t,["text"]);n!=null&&d(e,["text"],n);const i=l(t,["weight"]);return i!=null&&d(e,["weight"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZI(t){const e={},n=l(t,["apiKeyString"]);return n!=null&&d(e,["apiKeyString"],n),e}function ek(t){const e={},n=l(t,["apiKeyConfig"]);n!=null&&d(e,["apiKeyConfig"],ZI(n));const i=l(t,["authType"]);i!=null&&d(e,["authType"],i);const r=l(t,["googleServiceAccountConfig"]);r!=null&&d(e,["googleServiceAccountConfig"],r);const o=l(t,["httpBasicAuthConfig"]);o!=null&&d(e,["httpBasicAuthConfig"],o);const s=l(t,["oauthConfig"]);s!=null&&d(e,["oauthConfig"],s);const a=l(t,["oidcConfig"]);return a!=null&&d(e,["oidcConfig"],a),e}function tk(t){const e={},n=l(t,["data"]);n!=null&&d(e,["data"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function nk(t){const e={},n=l(t,["displayName"]);n!=null&&d(e,["displayName"],n);const i=l(t,["data"]);i!=null&&d(e,["data"],i);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function ik(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&d(e,["data"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function rk(t){const e={},n=l(t,["displayName"]);n!=null&&d(e,["displayName"],n);const i=l(t,["data"]);i!=null&&d(e,["data"],i);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function ok(t){const e={},n=l(t,["content"]);n!=null&&d(e,["content"],gk(n));const i=l(t,["citationMetadata"]);i!=null&&d(e,["citationMetadata"],lk(i));const r=l(t,["tokenCount"]);r!=null&&d(e,["tokenCount"],r);const o=l(t,["finishReason"]);o!=null&&d(e,["finishReason"],o);const s=l(t,["urlContextMetadata"]);s!=null&&d(e,["urlContextMetadata"],B3(s));const a=l(t,["avgLogprobs"]);a!=null&&d(e,["avgLogprobs"],a);const c=l(t,["groundingMetadata"]);c!=null&&d(e,["groundingMetadata"],c);const u=l(t,["index"]);u!=null&&d(e,["index"],u);const f=l(t,["logprobsResult"]);f!=null&&d(e,["logprobsResult"],f);const p=l(t,["safetyRatings"]);return p!=null&&d(e,["safetyRatings"],p),e}function sk(t){const e={},n=l(t,["content"]);n!=null&&d(e,["content"],mk(n));const i=l(t,["citationMetadata"]);i!=null&&d(e,["citationMetadata"],ck(i));const r=l(t,["finishMessage"]);r!=null&&d(e,["finishMessage"],r);const o=l(t,["finishReason"]);o!=null&&d(e,["finishReason"],o);const s=l(t,["urlContextMetadata"]);s!=null&&d(e,["urlContextMetadata"],D3(s));const a=l(t,["avgLogprobs"]);a!=null&&d(e,["avgLogprobs"],a);const c=l(t,["groundingMetadata"]);c!=null&&d(e,["groundingMetadata"],c);const u=l(t,["index"]);u!=null&&d(e,["index"],u);const f=l(t,["logprobsResult"]);f!=null&&d(e,["logprobsResult"],f);const p=l(t,["safetyRatings"]);return p!=null&&d(e,["safetyRatings"],p),e}function ak(t){const e={},n=l(t,["checkpointId"]);n!=null&&d(e,["checkpointId"],n);const i=l(t,["epoch"]);i!=null&&d(e,["epoch"],i);const r=l(t,["step"]);return r!=null&&d(e,["step"],r),e}function lk(t){const e={},n=l(t,["citationSources"]);return n!=null&&d(e,["citations"],n),e}function ck(t){const e={},n=l(t,["citations"]);return n!=null&&d(e,["citations"],n),e}function uk(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["contents"]);if(r!=null){let o=Si(r);Array.isArray(o)&&(o=o.map(s=>Os(s))),d(n,["contents"],o)}return n}function dk(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["tokensInfo"]);return i!=null&&d(e,["tokensInfo"],i),e}function fk(t){const e={},n=l(t,["values"]);return n!=null&&d(e,["values"],n),e}function hk(t){const e={},n=l(t,["values"]);n!=null&&d(e,["values"],n);const i=l(t,["statistics"]);return i!=null&&d(e,["statistics"],pk(i)),e}function pk(t){const e={},n=l(t,["truncated"]);n!=null&&d(e,["truncated"],n);const i=l(t,["token_count"]);return i!=null&&d(e,["tokenCount"],i),e}function gk(t){const e={},n=l(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>Wx(o))),d(e,["parts"],r)}const i=l(t,["role"]);return i!=null&&d(e,["role"],i),e}function mk(t){const e={},n=l(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>zx(o))),d(e,["parts"],r)}const i=l(t,["role"]);return i!=null&&d(e,["role"],i),e}function Lc(t){const e={},n=l(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>Jx(o))),d(e,["parts"],r)}const i=l(t,["role"]);return i!=null&&d(e,["role"],i),e}function Os(t){const e={},n=l(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>Yx(o))),d(e,["parts"],r)}const i=l(t,["role"]);return i!=null&&d(e,["role"],i),e}function vk(t){const e={},n=l(t,["controlType"]);n!=null&&d(e,["controlType"],n);const i=l(t,["enableControlImageComputation"]);return i!=null&&d(e,["computeControl"],i),e}function yk(t){const e={};if(l(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(l(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(l(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function bk(t,e){const n={},i=l(t,["systemInstruction"]);e!==void 0&&i!=null&&d(e,["systemInstruction"],Os(On(i)));const r=l(t,["tools"]);if(e!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>Yy(a))),d(e,["tools"],s)}const o=l(t,["generationConfig"]);return e!==void 0&&o!=null&&d(e,["generationConfig"],o),n}function wk(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["contents"]);if(r!=null){let s=Si(r);Array.isArray(s)&&(s=s.map(a=>Lc(a))),d(n,["contents"],s)}const o=l(e,["config"]);return o!=null&&yk(o),n}function Sk(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["contents"]);if(r!=null){let s=Si(r);Array.isArray(s)&&(s=s.map(a=>Os(a))),d(n,["contents"],s)}const o=l(e,["config"]);return o!=null&&bk(o,n),n}function _k(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["totalTokens"]);i!=null&&d(e,["totalTokens"],i);const r=l(t,["cachedContentTokenCount"]);return r!=null&&d(e,["cachedContentTokenCount"],r),e}function Ck(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["totalTokens"]);return i!=null&&d(e,["totalTokens"],i),e}function Ek(t,e){const n={},i=l(e,["model"]);return i!=null&&d(n,["_url","name"],At(t,i)),n}function Tk(t,e){const n={},i=l(e,["model"]);return i!=null&&d(n,["_url","name"],At(t,i)),n}function Ak(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function Ik(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function kk(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const i=l(t,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function xk(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const i=l(t,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function Lk(t,e){const n={},i=l(t,["outputGcsUri"]);e!==void 0&&i!=null&&d(e,["parameters","storageUri"],i);const r=l(t,["negativePrompt"]);e!==void 0&&r!=null&&d(e,["parameters","negativePrompt"],r);const o=l(t,["numberOfImages"]);e!==void 0&&o!=null&&d(e,["parameters","sampleCount"],o);const s=l(t,["aspectRatio"]);e!==void 0&&s!=null&&d(e,["parameters","aspectRatio"],s);const a=l(t,["guidanceScale"]);e!==void 0&&a!=null&&d(e,["parameters","guidanceScale"],a);const c=l(t,["seed"]);e!==void 0&&c!=null&&d(e,["parameters","seed"],c);const u=l(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&d(e,["parameters","safetySetting"],u);const f=l(t,["personGeneration"]);e!==void 0&&f!=null&&d(e,["parameters","personGeneration"],f);const p=l(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&d(e,["parameters","includeSafetyAttributes"],p);const v=l(t,["includeRaiReason"]);e!==void 0&&v!=null&&d(e,["parameters","includeRaiReason"],v);const m=l(t,["language"]);e!==void 0&&m!=null&&d(e,["parameters","language"],m);const S=l(t,["outputMimeType"]);e!==void 0&&S!=null&&d(e,["parameters","outputOptions","mimeType"],S);const _=l(t,["outputCompressionQuality"]);e!==void 0&&_!=null&&d(e,["parameters","outputOptions","compressionQuality"],_);const E=l(t,["addWatermark"]);e!==void 0&&E!=null&&d(e,["parameters","addWatermark"],E);const C=l(t,["editMode"]);e!==void 0&&C!=null&&d(e,["parameters","editMode"],C);const k=l(t,["baseSteps"]);return e!==void 0&&k!=null&&d(e,["parameters","editConfig","baseSteps"],k),n}function Pk(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["prompt"]);r!=null&&d(n,["instances[0]","prompt"],r);const o=l(e,["referenceImages"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(c=>n3(c))),d(n,["instances[0]","referenceImages"],a)}const s=l(e,["config"]);return s!=null&&Lk(s,n),n}function Nk(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>Pc(o))),d(e,["generatedImages"],r)}return e}function Rk(t,e){const n={},i=l(t,["taskType"]);e!==void 0&&i!=null&&d(e,["requests[]","taskType"],i);const r=l(t,["title"]);e!==void 0&&r!=null&&d(e,["requests[]","title"],r);const o=l(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&d(e,["requests[]","outputDimensionality"],o),l(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Mk(t,e){const n={},i=l(t,["taskType"]);e!==void 0&&i!=null&&d(e,["instances[]","task_type"],i);const r=l(t,["title"]);e!==void 0&&r!=null&&d(e,["instances[]","title"],r);const o=l(t,["outputDimensionality"]);e!==void 0&&o!=null&&d(e,["parameters","outputDimensionality"],o);const s=l(t,["mimeType"]);e!==void 0&&s!=null&&d(e,["instances[]","mimeType"],s);const a=l(t,["autoTruncate"]);return e!==void 0&&a!=null&&d(e,["parameters","autoTruncate"],a),n}function Bk(){return{}}function Dk(t){const e={},n=l(t,["billableCharacterCount"]);return n!=null&&d(e,["billableCharacterCount"],n),e}function Fk(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["contents"]);r!=null&&d(n,["requests[]","content"],wf(t,r));const o=l(e,["config"]);o!=null&&Rk(o,n);const s=l(e,["model"]);return s!==void 0&&d(n,["requests[]","model"],At(t,s)),n}function qk(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["contents"]);r!=null&&d(n,["instances[]","content"],wf(t,r));const o=l(e,["config"]);return o!=null&&Mk(o,n),n}function Uk(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>fk(s))),d(e,["embeddings"],o)}return l(t,["metadata"])!=null&&d(e,["metadata"],Bk()),e}function $k(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["predictions[]","embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>hk(s))),d(e,["embeddings"],o)}const r=l(t,["metadata"]);return r!=null&&d(e,["metadata"],Dk(r)),e}function Ok(t){const e={},n=l(t,["endpoint"]);n!=null&&d(e,["name"],n);const i=l(t,["deployedModelId"]);return i!=null&&d(e,["deployedModelId"],i),e}function Hk(t){const e={},n=l(t,["excludeDomains"]);return n!=null&&d(e,["excludeDomains"],n),e}function Vk(t){const e={},n=l(t,["label"]);n!=null&&d(e,["label"],n);const i=l(t,["score"]);return i!=null&&d(e,["score"],i),e}function Gk(t){const e={},n=l(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function Wk(t){const e={},n=l(t,["displayName"]);n!=null&&d(e,["displayName"],n);const i=l(t,["fileUri"]);i!=null&&d(e,["fileUri"],i);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function zk(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function Jk(t){const e={},n=l(t,["displayName"]);n!=null&&d(e,["displayName"],n);const i=l(t,["fileUri"]);i!=null&&d(e,["fileUri"],i);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function Yk(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const i=l(t,["args"]);i!=null&&d(e,["args"],i);const r=l(t,["name"]);return r!=null&&d(e,["name"],r),e}function Kk(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const i=l(t,["args"]);i!=null&&d(e,["args"],i);const r=l(t,["name"]);return r!=null&&d(e,["name"],r),e}function jk(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const i=l(t,["args"]);i!=null&&d(e,["args"],i);const r=l(t,["name"]);return r!=null&&d(e,["name"],r),e}function Qk(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const i=l(t,["args"]);i!=null&&d(e,["args"],i);const r=l(t,["name"]);return r!=null&&d(e,["name"],r),e}function Xk(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const i=l(t,["allowedFunctionNames"]);return i!=null&&d(e,["allowedFunctionNames"],i),e}function Zk(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const i=l(t,["allowedFunctionNames"]);return i!=null&&d(e,["allowedFunctionNames"],i),e}function ex(t){const e={},n=l(t,["behavior"]);n!=null&&d(e,["behavior"],n);const i=l(t,["description"]);i!=null&&d(e,["description"],i);const r=l(t,["name"]);r!=null&&d(e,["name"],r);const o=l(t,["parameters"]);o!=null&&d(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&d(e,["parametersJsonSchema"],s);const a=l(t,["response"]);a!=null&&d(e,["response"],a);const c=l(t,["responseJsonSchema"]);return c!=null&&d(e,["responseJsonSchema"],c),e}function tx(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&d(e,["description"],n);const i=l(t,["name"]);i!=null&&d(e,["name"],i);const r=l(t,["parameters"]);r!=null&&d(e,["parameters"],r);const o=l(t,["parametersJsonSchema"]);o!=null&&d(e,["parametersJsonSchema"],o);const s=l(t,["response"]);s!=null&&d(e,["response"],s);const a=l(t,["responseJsonSchema"]);return a!=null&&d(e,["responseJsonSchema"],a),e}function nx(t,e,n){const i={},r=l(e,["systemInstruction"]);n!==void 0&&r!=null&&d(n,["systemInstruction"],Lc(On(r)));const o=l(e,["temperature"]);o!=null&&d(i,["temperature"],o);const s=l(e,["topP"]);s!=null&&d(i,["topP"],s);const a=l(e,["topK"]);a!=null&&d(i,["topK"],a);const c=l(e,["candidateCount"]);c!=null&&d(i,["candidateCount"],c);const u=l(e,["maxOutputTokens"]);u!=null&&d(i,["maxOutputTokens"],u);const f=l(e,["stopSequences"]);f!=null&&d(i,["stopSequences"],f);const p=l(e,["responseLogprobs"]);p!=null&&d(i,["responseLogprobs"],p);const v=l(e,["logprobs"]);v!=null&&d(i,["logprobs"],v);const m=l(e,["presencePenalty"]);m!=null&&d(i,["presencePenalty"],m);const S=l(e,["frequencyPenalty"]);S!=null&&d(i,["frequencyPenalty"],S);const _=l(e,["seed"]);_!=null&&d(i,["seed"],_);const E=l(e,["responseMimeType"]);E!=null&&d(i,["responseMimeType"],E);const C=l(e,["responseSchema"]);C!=null&&d(i,["responseSchema"],a3(Sf(C)));const k=l(e,["responseJsonSchema"]);if(k!=null&&d(i,["responseJsonSchema"],k),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const I=l(e,["safetySettings"]);if(n!==void 0&&I!=null){let N=I;Array.isArray(N)&&(N=N.map(F=>o3(F))),d(n,["safetySettings"],N)}const P=l(e,["tools"]);if(n!==void 0&&P!=null){let N=Us(P);Array.isArray(N)&&(N=N.map(F=>T3(qs(F)))),d(n,["tools"],N)}const G=l(e,["toolConfig"]);if(n!==void 0&&G!=null&&d(n,["toolConfig"],C3(G)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const ee=l(e,["cachedContent"]);n!==void 0&&ee!=null&&d(n,["cachedContent"],_r(t,ee));const te=l(e,["responseModalities"]);te!=null&&d(i,["responseModalities"],te);const Y=l(e,["mediaResolution"]);Y!=null&&d(i,["mediaResolution"],Y);const D=l(e,["speechConfig"]);if(D!=null&&d(i,["speechConfig"],g3(_f(D))),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Z=l(e,["thinkingConfig"]);return Z!=null&&d(i,["thinkingConfig"],b3(Z)),i}function ix(t,e,n){const i={},r=l(e,["systemInstruction"]);n!==void 0&&r!=null&&d(n,["systemInstruction"],Os(On(r)));const o=l(e,["temperature"]);o!=null&&d(i,["temperature"],o);const s=l(e,["topP"]);s!=null&&d(i,["topP"],s);const a=l(e,["topK"]);a!=null&&d(i,["topK"],a);const c=l(e,["candidateCount"]);c!=null&&d(i,["candidateCount"],c);const u=l(e,["maxOutputTokens"]);u!=null&&d(i,["maxOutputTokens"],u);const f=l(e,["stopSequences"]);f!=null&&d(i,["stopSequences"],f);const p=l(e,["responseLogprobs"]);p!=null&&d(i,["responseLogprobs"],p);const v=l(e,["logprobs"]);v!=null&&d(i,["logprobs"],v);const m=l(e,["presencePenalty"]);m!=null&&d(i,["presencePenalty"],m);const S=l(e,["frequencyPenalty"]);S!=null&&d(i,["frequencyPenalty"],S);const _=l(e,["seed"]);_!=null&&d(i,["seed"],_);const E=l(e,["responseMimeType"]);E!=null&&d(i,["responseMimeType"],E);const C=l(e,["responseSchema"]);C!=null&&d(i,["responseSchema"],l3(Sf(C)));const k=l(e,["responseJsonSchema"]);k!=null&&d(i,["responseJsonSchema"],k);const I=l(e,["routingConfig"]);I!=null&&d(i,["routingConfig"],I);const P=l(e,["modelSelectionConfig"]);P!=null&&d(i,["modelConfig"],Vx(P));const G=l(e,["safetySettings"]);if(n!==void 0&&G!=null){let ce=G;Array.isArray(ce)&&(ce=ce.map(fe=>s3(fe))),d(n,["safetySettings"],ce)}const ee=l(e,["tools"]);if(n!==void 0&&ee!=null){let ce=Us(ee);Array.isArray(ce)&&(ce=ce.map(fe=>Yy(qs(fe)))),d(n,["tools"],ce)}const te=l(e,["toolConfig"]);n!==void 0&&te!=null&&d(n,["toolConfig"],E3(te));const Y=l(e,["labels"]);n!==void 0&&Y!=null&&d(n,["labels"],Y);const D=l(e,["cachedContent"]);n!==void 0&&D!=null&&d(n,["cachedContent"],_r(t,D));const Z=l(e,["responseModalities"]);Z!=null&&d(i,["responseModalities"],Z);const N=l(e,["mediaResolution"]);N!=null&&d(i,["mediaResolution"],N);const F=l(e,["speechConfig"]);F!=null&&d(i,["speechConfig"],m3(_f(F)));const J=l(e,["audioTimestamp"]);J!=null&&d(i,["audioTimestamp"],J);const W=l(e,["thinkingConfig"]);return W!=null&&d(i,["thinkingConfig"],w3(W)),i}function Sm(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["contents"]);if(r!=null){let s=Si(r);Array.isArray(s)&&(s=s.map(a=>Lc(a))),d(n,["contents"],s)}const o=l(e,["config"]);return o!=null&&d(n,["generationConfig"],nx(t,o,n)),n}function _m(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["contents"]);if(r!=null){let s=Si(r);Array.isArray(s)&&(s=s.map(a=>Os(a))),d(n,["contents"],s)}const o=l(e,["config"]);return o!=null&&d(n,["generationConfig"],ix(t,o,n)),n}function Cm(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(u=>ok(u))),d(e,["candidates"],c)}const r=l(t,["modelVersion"]);r!=null&&d(e,["modelVersion"],r);const o=l(t,["promptFeedback"]);o!=null&&d(e,["promptFeedback"],o);const s=l(t,["responseId"]);s!=null&&d(e,["responseId"],s);const a=l(t,["usageMetadata"]);return a!=null&&d(e,["usageMetadata"],a),e}function Em(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["candidates"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(f=>sk(f))),d(e,["candidates"],u)}const r=l(t,["createTime"]);r!=null&&d(e,["createTime"],r);const o=l(t,["modelVersion"]);o!=null&&d(e,["modelVersion"],o);const s=l(t,["promptFeedback"]);s!=null&&d(e,["promptFeedback"],s);const a=l(t,["responseId"]);a!=null&&d(e,["responseId"],a);const c=l(t,["usageMetadata"]);return c!=null&&d(e,["usageMetadata"],c),e}function rx(t,e){const n={};if(l(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=l(t,["numberOfImages"]);e!==void 0&&i!=null&&d(e,["parameters","sampleCount"],i);const r=l(t,["aspectRatio"]);e!==void 0&&r!=null&&d(e,["parameters","aspectRatio"],r);const o=l(t,["guidanceScale"]);if(e!==void 0&&o!=null&&d(e,["parameters","guidanceScale"],o),l(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=l(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&d(e,["parameters","safetySetting"],s);const a=l(t,["personGeneration"]);e!==void 0&&a!=null&&d(e,["parameters","personGeneration"],a);const c=l(t,["includeSafetyAttributes"]);e!==void 0&&c!=null&&d(e,["parameters","includeSafetyAttributes"],c);const u=l(t,["includeRaiReason"]);e!==void 0&&u!=null&&d(e,["parameters","includeRaiReason"],u);const f=l(t,["language"]);e!==void 0&&f!=null&&d(e,["parameters","language"],f);const p=l(t,["outputMimeType"]);e!==void 0&&p!=null&&d(e,["parameters","outputOptions","mimeType"],p);const v=l(t,["outputCompressionQuality"]);if(e!==void 0&&v!=null&&d(e,["parameters","outputOptions","compressionQuality"],v),l(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");const m=l(t,["imageSize"]);if(e!==void 0&&m!=null&&d(e,["parameters","sampleImageSize"],m),l(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function ox(t,e){const n={},i=l(t,["outputGcsUri"]);e!==void 0&&i!=null&&d(e,["parameters","storageUri"],i);const r=l(t,["negativePrompt"]);e!==void 0&&r!=null&&d(e,["parameters","negativePrompt"],r);const o=l(t,["numberOfImages"]);e!==void 0&&o!=null&&d(e,["parameters","sampleCount"],o);const s=l(t,["aspectRatio"]);e!==void 0&&s!=null&&d(e,["parameters","aspectRatio"],s);const a=l(t,["guidanceScale"]);e!==void 0&&a!=null&&d(e,["parameters","guidanceScale"],a);const c=l(t,["seed"]);e!==void 0&&c!=null&&d(e,["parameters","seed"],c);const u=l(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&d(e,["parameters","safetySetting"],u);const f=l(t,["personGeneration"]);e!==void 0&&f!=null&&d(e,["parameters","personGeneration"],f);const p=l(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&d(e,["parameters","includeSafetyAttributes"],p);const v=l(t,["includeRaiReason"]);e!==void 0&&v!=null&&d(e,["parameters","includeRaiReason"],v);const m=l(t,["language"]);e!==void 0&&m!=null&&d(e,["parameters","language"],m);const S=l(t,["outputMimeType"]);e!==void 0&&S!=null&&d(e,["parameters","outputOptions","mimeType"],S);const _=l(t,["outputCompressionQuality"]);e!==void 0&&_!=null&&d(e,["parameters","outputOptions","compressionQuality"],_);const E=l(t,["addWatermark"]);e!==void 0&&E!=null&&d(e,["parameters","addWatermark"],E);const C=l(t,["imageSize"]);e!==void 0&&C!=null&&d(e,["parameters","sampleImageSize"],C);const k=l(t,["enhancePrompt"]);return e!==void 0&&k!=null&&d(e,["parameters","enhancePrompt"],k),n}function sx(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["prompt"]);r!=null&&d(n,["instances[0]","prompt"],r);const o=l(e,["config"]);return o!=null&&rx(o,n),n}function ax(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["prompt"]);r!=null&&d(n,["instances[0]","prompt"],r);const o=l(e,["config"]);return o!=null&&ox(o,n),n}function lx(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>wx(s))),d(e,["generatedImages"],o)}const r=l(t,["positivePromptSafetyAttributes"]);return r!=null&&d(e,["positivePromptSafetyAttributes"],zy(r)),e}function cx(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>Pc(s))),d(e,["generatedImages"],o)}const r=l(t,["positivePromptSafetyAttributes"]);return r!=null&&d(e,["positivePromptSafetyAttributes"],Jy(r)),e}function ux(t,e){const n={},i=l(t,["numberOfVideos"]);if(e!==void 0&&i!=null&&d(e,["parameters","sampleCount"],i),l(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=l(t,["durationSeconds"]);if(e!==void 0&&r!=null&&d(e,["parameters","durationSeconds"],r),l(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=l(t,["aspectRatio"]);e!==void 0&&o!=null&&d(e,["parameters","aspectRatio"],o);const s=l(t,["resolution"]);e!==void 0&&s!=null&&d(e,["parameters","resolution"],s);const a=l(t,["personGeneration"]);if(e!==void 0&&a!=null&&d(e,["parameters","personGeneration"],a),l(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=l(t,["negativePrompt"]);e!==void 0&&c!=null&&d(e,["parameters","negativePrompt"],c);const u=l(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&d(e,["parameters","enhancePrompt"],u),l(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(l(t,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(l(t,["referenceImages"])!==void 0)throw new Error("referenceImages parameter is not supported in Gemini API.");if(l(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(l(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function dx(t,e){const n={},i=l(t,["numberOfVideos"]);e!==void 0&&i!=null&&d(e,["parameters","sampleCount"],i);const r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&d(e,["parameters","storageUri"],r);const o=l(t,["fps"]);e!==void 0&&o!=null&&d(e,["parameters","fps"],o);const s=l(t,["durationSeconds"]);e!==void 0&&s!=null&&d(e,["parameters","durationSeconds"],s);const a=l(t,["seed"]);e!==void 0&&a!=null&&d(e,["parameters","seed"],a);const c=l(t,["aspectRatio"]);e!==void 0&&c!=null&&d(e,["parameters","aspectRatio"],c);const u=l(t,["resolution"]);e!==void 0&&u!=null&&d(e,["parameters","resolution"],u);const f=l(t,["personGeneration"]);e!==void 0&&f!=null&&d(e,["parameters","personGeneration"],f);const p=l(t,["pubsubTopic"]);e!==void 0&&p!=null&&d(e,["parameters","pubsubTopic"],p);const v=l(t,["negativePrompt"]);e!==void 0&&v!=null&&d(e,["parameters","negativePrompt"],v);const m=l(t,["enhancePrompt"]);e!==void 0&&m!=null&&d(e,["parameters","enhancePrompt"],m);const S=l(t,["generateAudio"]);e!==void 0&&S!=null&&d(e,["parameters","generateAudio"],S);const _=l(t,["lastFrame"]);e!==void 0&&_!=null&&d(e,["instances[0]","lastFrame"],$i(_));const E=l(t,["referenceImages"]);if(e!==void 0&&E!=null){let I=E;Array.isArray(I)&&(I=I.map(P=>G3(P))),d(e,["instances[0]","referenceImages"],I)}const C=l(t,["mask"]);e!==void 0&&C!=null&&d(e,["instances[0]","mask"],V3(C));const k=l(t,["compressionQuality"]);return e!==void 0&&k!=null&&d(e,["parameters","compressionQuality"],k),n}function fx(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const i=l(t,["metadata"]);i!=null&&d(e,["metadata"],i);const r=l(t,["done"]);r!=null&&d(e,["done"],r);const o=l(t,["error"]);o!=null&&d(e,["error"],o);const s=l(t,["response","generateVideoResponse"]);return s!=null&&d(e,["response"],mx(s)),e}function hx(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const i=l(t,["metadata"]);i!=null&&d(e,["metadata"],i);const r=l(t,["done"]);r!=null&&d(e,["done"],r);const o=l(t,["error"]);o!=null&&d(e,["error"],o);const s=l(t,["response"]);return s!=null&&d(e,["response"],vx(s)),e}function px(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["prompt"]);r!=null&&d(n,["instances[0]","prompt"],r);const o=l(e,["image"]);if(o!=null&&d(n,["instances[0]","image"],Wy(o)),l(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const s=l(e,["source"]);s!=null&&yx(s,n);const a=l(e,["config"]);return a!=null&&ux(a,n),n}function gx(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["prompt"]);r!=null&&d(n,["instances[0]","prompt"],r);const o=l(e,["image"]);o!=null&&d(n,["instances[0]","image"],$i(o));const s=l(e,["video"]);s!=null&&d(n,["instances[0]","video"],Ky(s));const a=l(e,["source"]);a!=null&&bx(a,n);const c=l(e,["config"]);return c!=null&&dx(c,n),n}function mx(t){const e={},n=l(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>_x(s))),d(e,["generatedVideos"],o)}const i=l(t,["raiMediaFilteredCount"]);i!=null&&d(e,["raiMediaFilteredCount"],i);const r=l(t,["raiMediaFilteredReasons"]);return r!=null&&d(e,["raiMediaFilteredReasons"],r),e}function vx(t){const e={},n=l(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>Cx(s))),d(e,["generatedVideos"],o)}const i=l(t,["raiMediaFilteredCount"]);i!=null&&d(e,["raiMediaFilteredCount"],i);const r=l(t,["raiMediaFilteredReasons"]);return r!=null&&d(e,["raiMediaFilteredReasons"],r),e}function yx(t,e){const n={},i=l(t,["prompt"]);e!==void 0&&i!=null&&d(e,["instances[0]","prompt"],i);const r=l(t,["image"]);if(e!==void 0&&r!=null&&d(e,["instances[0]","image"],Wy(r)),l(t,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");return n}function bx(t,e){const n={},i=l(t,["prompt"]);e!==void 0&&i!=null&&d(e,["instances[0]","prompt"],i);const r=l(t,["image"]);e!==void 0&&r!=null&&d(e,["instances[0]","image"],$i(r));const o=l(t,["video"]);return e!==void 0&&o!=null&&d(e,["instances[0]","video"],Ky(o)),n}function wx(t){const e={},n=l(t,["_self"]);n!=null&&d(e,["image"],Px(n));const i=l(t,["raiFilteredReason"]);i!=null&&d(e,["raiFilteredReason"],i);const r=l(t,["_self"]);return r!=null&&d(e,["safetyAttributes"],zy(r)),e}function Pc(t){const e={},n=l(t,["_self"]);n!=null&&d(e,["image"],Gy(n));const i=l(t,["raiFilteredReason"]);i!=null&&d(e,["raiFilteredReason"],i);const r=l(t,["_self"]);r!=null&&d(e,["safetyAttributes"],Jy(r));const o=l(t,["prompt"]);return o!=null&&d(e,["enhancedPrompt"],o),e}function Sx(t){const e={},n=l(t,["_self"]);n!=null&&d(e,["mask"],Gy(n));const i=l(t,["labels"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>Vk(o))),d(e,["labels"],r)}return e}function _x(t){const e={},n=l(t,["_self"]);return n!=null&&d(e,["video"],O3(n)),e}function Cx(t){const e={},n=l(t,["_self"]);return n!=null&&d(e,["video"],H3(n)),e}function Ex(t,e){const n={},i=l(e,["model"]);return i!=null&&d(n,["_url","name"],At(t,i)),n}function Tx(t,e){const n={},i=l(e,["model"]);return i!=null&&d(n,["_url","name"],At(t,i)),n}function Ax(t){const e={},n=l(t,["authConfig"]);return n!=null&&d(e,["authConfig"],ek(n)),e}function Ix(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&d(e,["dynamicRetrievalConfig"],kk(n)),e}function kx(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&d(e,["dynamicRetrievalConfig"],xk(n)),e}function xx(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&d(e,["timeRangeFilter"],Nx(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function Lx(t){const e={},n=l(t,["timeRangeFilter"]);n!=null&&d(e,["timeRangeFilter"],Rx(n));const i=l(t,["excludeDomains"]);return i!=null&&d(e,["excludeDomains"],i),e}function Px(t){const e={},n=l(t,["bytesBase64Encoded"]);n!=null&&d(e,["imageBytes"],Go(n));const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function Gy(t){const e={},n=l(t,["gcsUri"]);n!=null&&d(e,["gcsUri"],n);const i=l(t,["bytesBase64Encoded"]);i!=null&&d(e,["imageBytes"],Go(i));const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function Wy(t){const e={};if(l(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=l(t,["imageBytes"]);n!=null&&d(e,["bytesBase64Encoded"],Go(n));const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function $i(t){const e={},n=l(t,["gcsUri"]);n!=null&&d(e,["gcsUri"],n);const i=l(t,["imageBytes"]);i!=null&&d(e,["bytesBase64Encoded"],Go(i));const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function Nx(t){const e={},n=l(t,["startTime"]);n!=null&&d(e,["startTime"],n);const i=l(t,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function Rx(t){const e={},n=l(t,["startTime"]);n!=null&&d(e,["startTime"],n);const i=l(t,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function Mx(t){const e={},n=l(t,["latitude"]);n!=null&&d(e,["latitude"],n);const i=l(t,["longitude"]);return i!=null&&d(e,["longitude"],i),e}function Bx(t){const e={},n=l(t,["latitude"]);n!=null&&d(e,["latitude"],n);const i=l(t,["longitude"]);return i!=null&&d(e,["longitude"],i),e}function Dx(t,e,n){const i={},r=l(e,["pageSize"]);n!==void 0&&r!=null&&d(n,["_query","pageSize"],r);const o=l(e,["pageToken"]);n!==void 0&&o!=null&&d(n,["_query","pageToken"],o);const s=l(e,["filter"]);n!==void 0&&s!=null&&d(n,["_query","filter"],s);const a=l(e,["queryBase"]);return n!==void 0&&a!=null&&d(n,["_url","models_url"],ky(t,a)),i}function Fx(t,e,n){const i={},r=l(e,["pageSize"]);n!==void 0&&r!=null&&d(n,["_query","pageSize"],r);const o=l(e,["pageToken"]);n!==void 0&&o!=null&&d(n,["_query","pageToken"],o);const s=l(e,["filter"]);n!==void 0&&s!=null&&d(n,["_query","filter"],s);const a=l(e,["queryBase"]);return n!==void 0&&a!=null&&d(n,["_url","models_url"],ky(t,a)),i}function qx(t,e){const n={},i=l(e,["config"]);return i!=null&&Dx(t,i,n),n}function Ux(t,e){const n={},i=l(e,["config"]);return i!=null&&Fx(t,i,n),n}function $x(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=l(t,["_self"]);if(r!=null){let o=xy(r);Array.isArray(o)&&(o=o.map(s=>qd(s))),d(e,["models"],o)}return e}function Ox(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=l(t,["_self"]);if(r!=null){let o=xy(r);Array.isArray(o)&&(o=o.map(s=>Ud(s))),d(e,["models"],o)}return e}function Hx(t){const e={},n=l(t,["maskMode"]);n!=null&&d(e,["maskMode"],n);const i=l(t,["segmentationClasses"]);i!=null&&d(e,["maskClasses"],i);const r=l(t,["maskDilation"]);return r!=null&&d(e,["dilation"],r),e}function qd(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const i=l(t,["displayName"]);i!=null&&d(e,["displayName"],i);const r=l(t,["description"]);r!=null&&d(e,["description"],r);const o=l(t,["version"]);o!=null&&d(e,["version"],o);const s=l(t,["_self"]);s!=null&&d(e,["tunedModelInfo"],A3(s));const a=l(t,["inputTokenLimit"]);a!=null&&d(e,["inputTokenLimit"],a);const c=l(t,["outputTokenLimit"]);c!=null&&d(e,["outputTokenLimit"],c);const u=l(t,["supportedGenerationMethods"]);return u!=null&&d(e,["supportedActions"],u),e}function Ud(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const i=l(t,["displayName"]);i!=null&&d(e,["displayName"],i);const r=l(t,["description"]);r!=null&&d(e,["description"],r);const o=l(t,["versionId"]);o!=null&&d(e,["version"],o);const s=l(t,["deployedModels"]);if(s!=null){let p=s;Array.isArray(p)&&(p=p.map(v=>Ok(v))),d(e,["endpoints"],p)}const a=l(t,["labels"]);a!=null&&d(e,["labels"],a);const c=l(t,["_self"]);c!=null&&d(e,["tunedModelInfo"],I3(c));const u=l(t,["defaultCheckpointId"]);u!=null&&d(e,["defaultCheckpointId"],u);const f=l(t,["checkpoints"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(v=>ak(v))),d(e,["checkpoints"],p)}return e}function Vx(t){const e={},n=l(t,["featureSelectionPreference"]);return n!=null&&d(e,["featureSelectionPreference"],n),e}function Gx(t){const e={},n=l(t,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>p3(r))),d(e,["speakerVoiceConfigs"],i)}return e}function Wx(t){const e={},n=l(t,["videoMetadata"]);n!=null&&d(e,["videoMetadata"],W3(n));const i=l(t,["thought"]);i!=null&&d(e,["thought"],i);const r=l(t,["inlineData"]);r!=null&&d(e,["inlineData"],tk(r));const o=l(t,["fileData"]);o!=null&&d(e,["fileData"],Gk(o));const s=l(t,["thoughtSignature"]);s!=null&&d(e,["thoughtSignature"],s);const a=l(t,["functionCall"]);a!=null&&d(e,["functionCall"],Yk(a));const c=l(t,["codeExecutionResult"]);c!=null&&d(e,["codeExecutionResult"],c);const u=l(t,["executableCode"]);u!=null&&d(e,["executableCode"],u);const f=l(t,["functionResponse"]);f!=null&&d(e,["functionResponse"],f);const p=l(t,["text"]);return p!=null&&d(e,["text"],p),e}function zx(t){const e={},n=l(t,["videoMetadata"]);n!=null&&d(e,["videoMetadata"],z3(n));const i=l(t,["thought"]);i!=null&&d(e,["thought"],i);const r=l(t,["inlineData"]);r!=null&&d(e,["inlineData"],nk(r));const o=l(t,["fileData"]);o!=null&&d(e,["fileData"],Wk(o));const s=l(t,["thoughtSignature"]);s!=null&&d(e,["thoughtSignature"],s);const a=l(t,["functionCall"]);a!=null&&d(e,["functionCall"],Kk(a));const c=l(t,["codeExecutionResult"]);c!=null&&d(e,["codeExecutionResult"],c);const u=l(t,["executableCode"]);u!=null&&d(e,["executableCode"],u);const f=l(t,["functionResponse"]);f!=null&&d(e,["functionResponse"],f);const p=l(t,["text"]);return p!=null&&d(e,["text"],p),e}function Jx(t){const e={},n=l(t,["videoMetadata"]);n!=null&&d(e,["videoMetadata"],J3(n));const i=l(t,["thought"]);i!=null&&d(e,["thought"],i);const r=l(t,["inlineData"]);r!=null&&d(e,["inlineData"],ik(r));const o=l(t,["fileData"]);o!=null&&d(e,["fileData"],zk(o));const s=l(t,["thoughtSignature"]);s!=null&&d(e,["thoughtSignature"],s);const a=l(t,["functionCall"]);a!=null&&d(e,["functionCall"],jk(a));const c=l(t,["codeExecutionResult"]);c!=null&&d(e,["codeExecutionResult"],c);const u=l(t,["executableCode"]);u!=null&&d(e,["executableCode"],u);const f=l(t,["functionResponse"]);f!=null&&d(e,["functionResponse"],f);const p=l(t,["text"]);return p!=null&&d(e,["text"],p),e}function Yx(t){const e={},n=l(t,["videoMetadata"]);n!=null&&d(e,["videoMetadata"],Y3(n));const i=l(t,["thought"]);i!=null&&d(e,["thought"],i);const r=l(t,["inlineData"]);r!=null&&d(e,["inlineData"],rk(r));const o=l(t,["fileData"]);o!=null&&d(e,["fileData"],Jk(o));const s=l(t,["thoughtSignature"]);s!=null&&d(e,["thoughtSignature"],s);const a=l(t,["functionCall"]);a!=null&&d(e,["functionCall"],Qk(a));const c=l(t,["codeExecutionResult"]);c!=null&&d(e,["codeExecutionResult"],c);const u=l(t,["executableCode"]);u!=null&&d(e,["executableCode"],u);const f=l(t,["functionResponse"]);f!=null&&d(e,["functionResponse"],f);const p=l(t,["text"]);return p!=null&&d(e,["text"],p),e}function Kx(t){const e={},n=l(t,["voiceName"]);return n!=null&&d(e,["voiceName"],n),e}function jx(t){const e={},n=l(t,["voiceName"]);return n!=null&&d(e,["voiceName"],n),e}function Qx(t){const e={},n=l(t,["productImage"]);return n!=null&&d(e,["image"],$i(n)),e}function Xx(t,e){const n={},i=l(t,["numberOfImages"]);e!==void 0&&i!=null&&d(e,["parameters","sampleCount"],i);const r=l(t,["baseSteps"]);e!==void 0&&r!=null&&d(e,["parameters","editConfig","baseSteps"],r);const o=l(t,["outputGcsUri"]);e!==void 0&&o!=null&&d(e,["parameters","storageUri"],o);const s=l(t,["seed"]);e!==void 0&&s!=null&&d(e,["parameters","seed"],s);const a=l(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&d(e,["parameters","safetySetting"],a);const c=l(t,["personGeneration"]);e!==void 0&&c!=null&&d(e,["parameters","personGeneration"],c);const u=l(t,["addWatermark"]);e!==void 0&&u!=null&&d(e,["parameters","addWatermark"],u);const f=l(t,["outputMimeType"]);e!==void 0&&f!=null&&d(e,["parameters","outputOptions","mimeType"],f);const p=l(t,["outputCompressionQuality"]);e!==void 0&&p!=null&&d(e,["parameters","outputOptions","compressionQuality"],p);const v=l(t,["enhancePrompt"]);return e!==void 0&&v!=null&&d(e,["parameters","enhancePrompt"],v),n}function Zx(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["source"]);r!=null&&t3(r,n);const o=l(e,["config"]);return o!=null&&Xx(o,n),n}function e3(t){const e={},n=l(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>Pc(r))),d(e,["generatedImages"],i)}return e}function t3(t,e){const n={},i=l(t,["prompt"]);e!==void 0&&i!=null&&d(e,["instances[0]","prompt"],i);const r=l(t,["personImage"]);e!==void 0&&r!=null&&d(e,["instances[0]","personImage","image"],$i(r));const o=l(t,["productImages"]);if(e!==void 0&&o!=null){let s=o;Array.isArray(s)&&(s=s.map(a=>Qx(a))),d(e,["instances[0]","productImages"],s)}return n}function n3(t){const e={},n=l(t,["referenceImage"]);n!=null&&d(e,["referenceImage"],$i(n));const i=l(t,["referenceId"]);i!=null&&d(e,["referenceId"],i);const r=l(t,["referenceType"]);r!=null&&d(e,["referenceType"],r);const o=l(t,["maskImageConfig"]);o!=null&&d(e,["maskImageConfig"],Hx(o));const s=l(t,["controlImageConfig"]);s!=null&&d(e,["controlImageConfig"],vk(s));const a=l(t,["styleImageConfig"]);a!=null&&d(e,["styleImageConfig"],v3(a));const c=l(t,["subjectImageConfig"]);return c!=null&&d(e,["subjectImageConfig"],y3(c)),e}function i3(t){const e={},n=l(t,["latLng"]);n!=null&&d(e,["latLng"],Mx(n));const i=l(t,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function r3(t){const e={},n=l(t,["latLng"]);n!=null&&d(e,["latLng"],Bx(n));const i=l(t,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function zy(t){const e={},n=l(t,["safetyAttributes","categories"]);n!=null&&d(e,["categories"],n);const i=l(t,["safetyAttributes","scores"]);i!=null&&d(e,["scores"],i);const r=l(t,["contentType"]);return r!=null&&d(e,["contentType"],r),e}function Jy(t){const e={},n=l(t,["safetyAttributes","categories"]);n!=null&&d(e,["categories"],n);const i=l(t,["safetyAttributes","scores"]);i!=null&&d(e,["scores"],i);const r=l(t,["contentType"]);return r!=null&&d(e,["contentType"],r),e}function o3(t){const e={};if(l(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=l(t,["category"]);n!=null&&d(e,["category"],n);const i=l(t,["threshold"]);return i!=null&&d(e,["threshold"],i),e}function s3(t){const e={},n=l(t,["method"]);n!=null&&d(e,["method"],n);const i=l(t,["category"]);i!=null&&d(e,["category"],i);const r=l(t,["threshold"]);return r!=null&&d(e,["threshold"],r),e}function a3(t){const e={},n=l(t,["anyOf"]);n!=null&&d(e,["anyOf"],n);const i=l(t,["default"]);i!=null&&d(e,["default"],i);const r=l(t,["description"]);r!=null&&d(e,["description"],r);const o=l(t,["enum"]);o!=null&&d(e,["enum"],o);const s=l(t,["example"]);s!=null&&d(e,["example"],s);const a=l(t,["format"]);a!=null&&d(e,["format"],a);const c=l(t,["items"]);c!=null&&d(e,["items"],c);const u=l(t,["maxItems"]);u!=null&&d(e,["maxItems"],u);const f=l(t,["maxLength"]);f!=null&&d(e,["maxLength"],f);const p=l(t,["maxProperties"]);p!=null&&d(e,["maxProperties"],p);const v=l(t,["maximum"]);v!=null&&d(e,["maximum"],v);const m=l(t,["minItems"]);m!=null&&d(e,["minItems"],m);const S=l(t,["minLength"]);S!=null&&d(e,["minLength"],S);const _=l(t,["minProperties"]);_!=null&&d(e,["minProperties"],_);const E=l(t,["minimum"]);E!=null&&d(e,["minimum"],E);const C=l(t,["nullable"]);C!=null&&d(e,["nullable"],C);const k=l(t,["pattern"]);k!=null&&d(e,["pattern"],k);const I=l(t,["properties"]);I!=null&&d(e,["properties"],I);const P=l(t,["propertyOrdering"]);P!=null&&d(e,["propertyOrdering"],P);const G=l(t,["required"]);G!=null&&d(e,["required"],G);const ee=l(t,["title"]);ee!=null&&d(e,["title"],ee);const te=l(t,["type"]);return te!=null&&d(e,["type"],te),e}function l3(t){const e={},n=l(t,["anyOf"]);n!=null&&d(e,["anyOf"],n);const i=l(t,["default"]);i!=null&&d(e,["default"],i);const r=l(t,["description"]);r!=null&&d(e,["description"],r);const o=l(t,["enum"]);o!=null&&d(e,["enum"],o);const s=l(t,["example"]);s!=null&&d(e,["example"],s);const a=l(t,["format"]);a!=null&&d(e,["format"],a);const c=l(t,["items"]);c!=null&&d(e,["items"],c);const u=l(t,["maxItems"]);u!=null&&d(e,["maxItems"],u);const f=l(t,["maxLength"]);f!=null&&d(e,["maxLength"],f);const p=l(t,["maxProperties"]);p!=null&&d(e,["maxProperties"],p);const v=l(t,["maximum"]);v!=null&&d(e,["maximum"],v);const m=l(t,["minItems"]);m!=null&&d(e,["minItems"],m);const S=l(t,["minLength"]);S!=null&&d(e,["minLength"],S);const _=l(t,["minProperties"]);_!=null&&d(e,["minProperties"],_);const E=l(t,["minimum"]);E!=null&&d(e,["minimum"],E);const C=l(t,["nullable"]);C!=null&&d(e,["nullable"],C);const k=l(t,["pattern"]);k!=null&&d(e,["pattern"],k);const I=l(t,["properties"]);I!=null&&d(e,["properties"],I);const P=l(t,["propertyOrdering"]);P!=null&&d(e,["propertyOrdering"],P);const G=l(t,["required"]);G!=null&&d(e,["required"],G);const ee=l(t,["title"]);ee!=null&&d(e,["title"],ee);const te=l(t,["type"]);return te!=null&&d(e,["type"],te),e}function c3(t){const e={},n=l(t,["image"]);return n!=null&&d(e,["image"],$i(n)),e}function u3(t,e){const n={},i=l(t,["mode"]);e!==void 0&&i!=null&&d(e,["parameters","mode"],i);const r=l(t,["maxPredictions"]);e!==void 0&&r!=null&&d(e,["parameters","maxPredictions"],r);const o=l(t,["confidenceThreshold"]);e!==void 0&&o!=null&&d(e,["parameters","confidenceThreshold"],o);const s=l(t,["maskDilation"]);e!==void 0&&s!=null&&d(e,["parameters","maskDilation"],s);const a=l(t,["binaryColorThreshold"]);return e!==void 0&&a!=null&&d(e,["parameters","binaryColorThreshold"],a),n}function d3(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["source"]);r!=null&&h3(r,n);const o=l(e,["config"]);return o!=null&&u3(o,n),n}function f3(t){const e={},n=l(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>Sx(r))),d(e,["generatedMasks"],i)}return e}function h3(t,e){const n={},i=l(t,["prompt"]);e!==void 0&&i!=null&&d(e,["instances[0]","prompt"],i);const r=l(t,["image"]);e!==void 0&&r!=null&&d(e,["instances[0]","image"],$i(r));const o=l(t,["scribbleImage"]);return e!==void 0&&o!=null&&d(e,["instances[0]","scribble"],c3(o)),n}function p3(t){const e={},n=l(t,["speaker"]);n!=null&&d(e,["speaker"],n);const i=l(t,["voiceConfig"]);return i!=null&&d(e,["voiceConfig"],jy(i)),e}function g3(t){const e={},n=l(t,["voiceConfig"]);n!=null&&d(e,["voiceConfig"],jy(n));const i=l(t,["multiSpeakerVoiceConfig"]);i!=null&&d(e,["multiSpeakerVoiceConfig"],Gx(i));const r=l(t,["languageCode"]);return r!=null&&d(e,["languageCode"],r),e}function m3(t){const e={},n=l(t,["voiceConfig"]);if(n!=null&&d(e,["voiceConfig"],K3(n)),l(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=l(t,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function v3(t){const e={},n=l(t,["styleDescription"]);return n!=null&&d(e,["styleDescription"],n),e}function y3(t){const e={},n=l(t,["subjectType"]);n!=null&&d(e,["subjectType"],n);const i=l(t,["subjectDescription"]);return i!=null&&d(e,["subjectDescription"],i),e}function b3(t){const e={},n=l(t,["includeThoughts"]);n!=null&&d(e,["includeThoughts"],n);const i=l(t,["thinkingBudget"]);return i!=null&&d(e,["thinkingBudget"],i),e}function w3(t){const e={},n=l(t,["includeThoughts"]);n!=null&&d(e,["includeThoughts"],n);const i=l(t,["thinkingBudget"]);return i!=null&&d(e,["thinkingBudget"],i),e}function S3(t){const e={},n=l(t,["environment"]);n!=null&&d(e,["environment"],n);const i=l(t,["excludedPredefinedFunctions"]);return i!=null&&d(e,["excludedPredefinedFunctions"],i),e}function _3(t){const e={},n=l(t,["environment"]);n!=null&&d(e,["environment"],n);const i=l(t,["excludedPredefinedFunctions"]);return i!=null&&d(e,["excludedPredefinedFunctions"],i),e}function C3(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&d(e,["functionCallingConfig"],Xk(n));const i=l(t,["retrievalConfig"]);return i!=null&&d(e,["retrievalConfig"],i3(i)),e}function E3(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&d(e,["functionCallingConfig"],Zk(n));const i=l(t,["retrievalConfig"]);return i!=null&&d(e,["retrievalConfig"],r3(i)),e}function T3(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(u=>ex(u))),d(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=l(t,["googleSearch"]);i!=null&&d(e,["googleSearch"],xx(i));const r=l(t,["googleSearchRetrieval"]);if(r!=null&&d(e,["googleSearchRetrieval"],Ix(r)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&d(e,["urlContext"],F3());const s=l(t,["computerUse"]);s!=null&&d(e,["computerUse"],S3(s));const a=l(t,["codeExecution"]);return a!=null&&d(e,["codeExecution"],a),e}function Yy(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(v=>tx(v))),d(e,["functionDeclarations"],p)}const i=l(t,["retrieval"]);i!=null&&d(e,["retrieval"],i);const r=l(t,["googleSearch"]);r!=null&&d(e,["googleSearch"],Lx(r));const o=l(t,["googleSearchRetrieval"]);o!=null&&d(e,["googleSearchRetrieval"],kx(o));const s=l(t,["enterpriseWebSearch"]);s!=null&&d(e,["enterpriseWebSearch"],Hk(s));const a=l(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],Ax(a)),l(t,["urlContext"])!=null&&d(e,["urlContext"],q3());const u=l(t,["computerUse"]);u!=null&&d(e,["computerUse"],_3(u));const f=l(t,["codeExecution"]);return f!=null&&d(e,["codeExecution"],f),e}function A3(t){const e={},n=l(t,["baseModel"]);n!=null&&d(e,["baseModel"],n);const i=l(t,["createTime"]);i!=null&&d(e,["createTime"],i);const r=l(t,["updateTime"]);return r!=null&&d(e,["updateTime"],r),e}function I3(t){const e={},n=l(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&d(e,["baseModel"],n);const i=l(t,["createTime"]);i!=null&&d(e,["createTime"],i);const r=l(t,["updateTime"]);return r!=null&&d(e,["updateTime"],r),e}function k3(t,e){const n={},i=l(t,["displayName"]);e!==void 0&&i!=null&&d(e,["displayName"],i);const r=l(t,["description"]);e!==void 0&&r!=null&&d(e,["description"],r);const o=l(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&d(e,["defaultCheckpointId"],o),n}function x3(t,e){const n={},i=l(t,["displayName"]);e!==void 0&&i!=null&&d(e,["displayName"],i);const r=l(t,["description"]);e!==void 0&&r!=null&&d(e,["description"],r);const o=l(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&d(e,["defaultCheckpointId"],o),n}function L3(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","name"],At(t,i));const r=l(e,["config"]);return r!=null&&k3(r,n),n}function P3(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["config"]);return r!=null&&x3(r,n),n}function N3(t,e){const n={},i=l(t,["outputGcsUri"]);e!==void 0&&i!=null&&d(e,["parameters","storageUri"],i);const r=l(t,["includeRaiReason"]);e!==void 0&&r!=null&&d(e,["parameters","includeRaiReason"],r);const o=l(t,["outputMimeType"]);e!==void 0&&o!=null&&d(e,["parameters","outputOptions","mimeType"],o);const s=l(t,["outputCompressionQuality"]);e!==void 0&&s!=null&&d(e,["parameters","outputOptions","compressionQuality"],s);const a=l(t,["enhanceInputImage"]);e!==void 0&&a!=null&&d(e,["parameters","upscaleConfig","enhanceInputImage"],a);const c=l(t,["imagePreservationFactor"]);e!==void 0&&c!=null&&d(e,["parameters","upscaleConfig","imagePreservationFactor"],c);const u=l(t,["numberOfImages"]);e!==void 0&&u!=null&&d(e,["parameters","sampleCount"],u);const f=l(t,["mode"]);return e!==void 0&&f!=null&&d(e,["parameters","mode"],f),n}function R3(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["_url","model"],At(t,i));const r=l(e,["image"]);r!=null&&d(n,["instances[0]","image"],$i(r));const o=l(e,["upscaleFactor"]);o!=null&&d(n,["parameters","upscaleConfig","upscaleFactor"],o);const s=l(e,["config"]);return s!=null&&N3(s,n),n}function M3(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>Pc(o))),d(e,["generatedImages"],r)}return e}function B3(t){const e={},n=l(t,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>U3(r))),d(e,["urlMetadata"],i)}return e}function D3(t){const e={},n=l(t,["urlMetadata"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>$3(r))),d(e,["urlMetadata"],i)}return e}function F3(){return{}}function q3(){return{}}function U3(t){const e={},n=l(t,["retrievedUrl"]);n!=null&&d(e,["retrievedUrl"],n);const i=l(t,["urlRetrievalStatus"]);return i!=null&&d(e,["urlRetrievalStatus"],i),e}function $3(t){const e={},n=l(t,["retrievedUrl"]);n!=null&&d(e,["retrievedUrl"],n);const i=l(t,["urlRetrievalStatus"]);return i!=null&&d(e,["urlRetrievalStatus"],i),e}function O3(t){const e={},n=l(t,["video","uri"]);n!=null&&d(e,["uri"],n);const i=l(t,["video","encodedVideo"]);i!=null&&d(e,["videoBytes"],Go(i));const r=l(t,["encoding"]);return r!=null&&d(e,["mimeType"],r),e}function H3(t){const e={},n=l(t,["gcsUri"]);n!=null&&d(e,["uri"],n);const i=l(t,["bytesBase64Encoded"]);i!=null&&d(e,["videoBytes"],Go(i));const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function V3(t){const e={},n=l(t,["image"]);n!=null&&d(e,["_self"],$i(n));const i=l(t,["maskMode"]);return i!=null&&d(e,["maskMode"],i),e}function G3(t){const e={},n=l(t,["image"]);n!=null&&d(e,["image"],$i(n));const i=l(t,["referenceType"]);return i!=null&&d(e,["referenceType"],i),e}function W3(t){const e={},n=l(t,["fps"]);n!=null&&d(e,["fps"],n);const i=l(t,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=l(t,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function z3(t){const e={},n=l(t,["fps"]);n!=null&&d(e,["fps"],n);const i=l(t,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=l(t,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function J3(t){const e={},n=l(t,["fps"]);n!=null&&d(e,["fps"],n);const i=l(t,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=l(t,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function Y3(t){const e={},n=l(t,["fps"]);n!=null&&d(e,["fps"],n);const i=l(t,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=l(t,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function Ky(t){const e={},n=l(t,["uri"]);n!=null&&d(e,["gcsUri"],n);const i=l(t,["videoBytes"]);i!=null&&d(e,["bytesBase64Encoded"],Go(i));const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function jy(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&d(e,["prebuiltVoiceConfig"],Kx(n)),e}function K3(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&d(e,["prebuiltVoiceConfig"],jx(n)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const j3="Content-Type",Q3="X-Server-Timeout",X3="User-Agent",$d="x-goog-api-client",Z3="1.21.0",e4=`google-genai-sdk/${Z3}`,t4="v1beta1",n4="v1beta",Tm=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class i4{constructor(e){var n,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:t4,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:n4,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,i){const r=[this.getRequestUrlInternal(n)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,n,i);if(e.queryParams)for(const[s,a]of Object.entries(e.queryParams))r.searchParams.append(s,String(a));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,n,e.abortSignal),this.unaryApiCall(r,o,e.httpMethod)}patchHttpOptions(e,n){const i=JSON.parse(JSON.stringify(e));for(const[r,o]of Object.entries(n))typeof o=="object"?i[r]=Object.assign(Object.assign({},i[r]),o):o!==void 0&&(i[r]=o);return i}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,n,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,n,e.abortSignal),this.streamApiCall(r,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,i){if(n&&n.timeout||i){const r=new AbortController,o=r.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const s=setTimeout(()=>r.abort(),n.timeout);s&&typeof s.unref=="function"&&s.unref()}i&&i.addEventListener("abort",()=>{r.abort()}),e.signal=o}return n&&n.extraBody!==null&&r4(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:i})).then(async r=>(await Am(r),new Rd(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,n,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:i})).then(async r=>(await Am(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var n;return Ls(this,arguments,function*(){const r=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),o=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let s="";for(;;){const{done:a,value:c}=yield Jt(r.read());if(a){if(s.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=o.decode(c,{stream:!0});try{const p=JSON.parse(u);if("error"in p){const v=JSON.parse(JSON.stringify(p.error)),m=v.status,S=v.code,_=`got status: ${m}. ${JSON.stringify(p)}`;if(S>=400&&S<600)throw new xc({message:_,status:S})}}catch(p){if(p.name==="ApiError")throw p}s+=u;let f=s.match(Tm);for(;f;){const p=f[1];try{const v=new Response(p,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Jt(new Rd(v)),s=s.slice(f[0].length),f=s.match(Tm)}catch(v){throw new Error(`exception parsing stream chunk ${p}. ${v}`)}}}}finally{r.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},n=e4+" "+this.clientOptions.userAgentExtra;return e[X3]=n,e[$d]=n,e[j3]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[i,r]of Object.entries(e.headers))n.append(i,r);e.timeout&&e.timeout>0&&n.append(Q3,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var i;const r={};n!=null&&(r.mimeType=n.mimeType,r.name=n.name,r.displayName=n.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const o=this.clientOptions.uploader,s=await o.stat(e);r.sizeBytes=String(s.size);const a=(i=n==null?void 0:n.mimeType)!==null&&i!==void 0?i:s.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=a;const c=await this.fetchUploadUrl(r,n);return o.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var i;let r={};n!=null&&n.httpOptions?r=n.httpOptions:r={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const o={file:e},s=await this.request({path:De("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:r});if(!s||!(s!=null&&s.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const a=(i=s==null?void 0:s.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(a===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return a}}async function Am(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let i;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await t.json():i={error:{message:await t.text(),code:t.status,status:t.statusText}};const r=JSON.stringify(i);throw n>=400&&n<600?new xc({message:r,status:n}):new Error(r)}}function r4(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const o=JSON.parse(t.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))n=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(o,s){const a=Object.assign({},o);for(const c in s)if(Object.prototype.hasOwnProperty.call(s,c)){const u=s[c],f=a[c];u&&typeof u=="object"&&!Array.isArray(u)&&f&&typeof f=="object"&&!Array.isArray(f)?a[c]=i(f,u):(f&&u&&typeof f!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof f}, New type: ${typeof u}. Overwriting.`),a[c]=u)}return a}const r=i(n,e);t.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const o4="mcp_used/unknown";let s4=!1;function Qy(t){for(const e of t)if(a4(e)||typeof e=="object"&&"inputSchema"in e)return!0;return s4}function Xy(t){var e;const n=(e=t[$d])!==null&&e!==void 0?e:"";t[$d]=(n+` ${o4}`).trimStart()}function a4(t){return t!==null&&typeof t=="object"&&t instanceof Tf}function l4(t,e=100){return Ls(this,arguments,function*(){let i,r=0;for(;r<e;){const o=yield Jt(t.listTools({cursor:i}));for(const s of o.tools)yield yield Jt(s),r++;if(!o.nextCursor)break;i=o.nextCursor}})}class Tf{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Tf(e,n)}async initialize(){var e,n,i,r;if(this.mcpTools.length>0)return;const o={},s=[];for(const f of this.mcpClients)try{for(var a=!0,c=(n=void 0,Ia(l4(f))),u;u=await c.next(),e=u.done,!e;a=!0){r=u.value,a=!1;const p=r;s.push(p);const v=p.name;if(o[v])throw new Error(`Duplicate function name ${v} found in MCP tools. Please ensure function names are unique.`);o[v]=f}}catch(p){n={error:p}}finally{try{!a&&!e&&(i=c.return)&&await i.call(c)}finally{if(n)throw n.error}}this.mcpTools=s,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),CC(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const s=await r.callTool({name:i.name,arguments:i.args},void 0,o);n.push({functionResponse:{name:i.name,response:s.isError?{error:s}:s}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function c4(t,e,n){const i=new gC;let r;n.data instanceof Blob?r=JSON.parse(await n.data.text()):r=JSON.parse(n.data);const o=XA(r);Object.assign(i,o),e(i)}class u4{constructor(e,n,i){this.apiClient=e,this.auth=n,this.webSocketFactory=i}async connect(e){var n,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),s=h4(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),c=`${r}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const f=new Promise(I=>{u=I}),p=e.callbacks,v=function(){u({})},m=this.apiClient,S={onopen:v,onmessage:I=>{c4(m,p.onmessage,I)},onerror:(n=p==null?void 0:p.onerror)!==null&&n!==void 0?n:function(I){},onclose:(i=p==null?void 0:p.onclose)!==null&&i!==void 0?i:function(I){}},_=this.webSocketFactory.create(c,f4(s),S);_.connect(),await f;const E=At(this.apiClient,e.model),C=$y({model:E}),k=Fd({setup:C});return _.send(JSON.stringify(k)),new d4(_,this.apiClient)}}class d4{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=tI(e),i=Uy(n);this.conn.send(JSON.stringify({clientContent:i}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=eI(e),i=Fd(n);this.conn.send(JSON.stringify(i))}sendPlaybackControl(e){const n=Fd({playbackControl:e});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Cs.PLAY)}pause(){this.sendPlaybackControl(Cs.PAUSE)}stop(){this.sendPlaybackControl(Cs.STOP)}resetContext(){this.sendPlaybackControl(Cs.RESET_CONTEXT)}close(){this.conn.close()}}function f4(t){const e={};return t.forEach((n,i)=>{e[i]=n}),e}function h4(t){const e=new Headers;for(const[n,i]of Object.entries(t))e.append(n,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const p4="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function g4(t,e,n){const i=new pC;let r;n.data instanceof Blob?r=await n.data.text():n.data instanceof ArrayBuffer?r=new TextDecoder().decode(n.data):r=n.data;const o=JSON.parse(r);if(t.isVertexAI()){const s=uI(o);Object.assign(i,s)}else{const s=cI(o);Object.assign(i,s)}e(i)}class m4{constructor(e,n,i){this.apiClient=e,this.auth=n,this.webSocketFactory=i,this.music=new u4(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,i,r,o,s,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const c=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let f;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&Qy(e.config.tools)&&Xy(p);const v=w4(p);if(this.apiClient.isVertexAI())f=`${c}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(v);else{const D=this.apiClient.getApiKey();let Z="BidiGenerateContent",N="key";D!=null&&D.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),Z="BidiGenerateContentConstrained",N="access_token"),f=`${c}/ws/google.ai.generativelanguage.${u}.GenerativeService.${Z}?${N}=${D}`}let m=()=>{};const S=new Promise(D=>{m=D}),_=e.callbacks,E=function(){var D;(D=_==null?void 0:_.onopen)===null||D===void 0||D.call(_),m({})},C=this.apiClient,k={onopen:E,onmessage:D=>{g4(C,_.onmessage,D)},onerror:(n=_==null?void 0:_.onerror)!==null&&n!==void 0?n:function(D){},onclose:(i=_==null?void 0:_.onclose)!==null&&i!==void 0?i:function(D){}},I=this.webSocketFactory.create(f,b4(v),k);I.connect(),await S;let P=At(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const D=this.apiClient.getProject(),Z=this.apiClient.getLocation();P=`projects/${D}/locations/${Z}/`+P}let G={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[hc.AUDIO]}:e.config.responseModalities=[hc.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const ee=(a=(s=e.config)===null||s===void 0?void 0:s.tools)!==null&&a!==void 0?a:[],te=[];for(const D of ee)if(this.isCallableTool(D)){const Z=D;te.push(await Z.tool())}else te.push(D);te.length>0&&(e.config.tools=te);const Y={model:P,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?G=JA(this.apiClient,Y):G=zA(this.apiClient,Y),delete G.config,I.send(JSON.stringify(G)),new y4(I,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const v4={turnComplete:!0};class y4{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let i=[];try{i=Si(n.turns),e.isVertexAI()?i=i.map(r=>Os(r)):i=i.map(r=>Lc(r))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:i,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let i=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?i=n.functionResponses:i=[n.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const o of i){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(p4)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},v4),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:rI(e)}:n={realtimeInput:iI(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function b4(t){const e={};return t.forEach((n,i)=>{e[i]=n}),e}function w4(t){const e=new Headers;for(const[n,i]of Object.entries(t))e.append(n,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Im=10;function km(t){var e,n,i;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const s of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(Ps(s)){r=!0;break}if(!r)return!0;const o=(i=t==null?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function Ps(t){return"callTool"in t&&typeof t.callTool=="function"}function S4(t){var e,n,i;return(i=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(r=>Ps(r)))!==null&&i!==void 0?i:!1}function _4(t){var e,n,i;return(i=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(r=>!Ps(r)))!==null&&i!==void 0?i:!1}function xm(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class C4 extends Vo{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var i,r,o,s,a;const c=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!S4(n)||km(n.config))return await this.generateContentInternal(c);if(_4(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u,f;const p=Si(c.contents),v=(o=(r=(i=c.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&o!==void 0?o:Im;let m=0;for(;m<v&&(u=await this.generateContentInternal(c),!(!u.functionCalls||u.functionCalls.length===0));){const S=u.candidates[0].content,_=[];for(const E of(a=(s=n.config)===null||s===void 0?void 0:s.tools)!==null&&a!==void 0?a:[])if(Ps(E)){const k=await E.callTool(u.functionCalls);_.push(...k)}m++,f={role:"user",parts:_},c.contents=Si(c.contents),c.contents.push(S),c.contents.push(f),xm(c.config)&&(p.push(S),p.push(f))}return xm(c.config)&&(u.automaticFunctionCallingHistory=p),u},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),km(n.config)){const i=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(i)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(i=>{var r;let o;const s=[];if(i!=null&&i.generatedImages)for(const c of i.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((r=c==null?void 0:c.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?o=c==null?void 0:c.safetyAttributes:s.push(c);let a;return o?a={generatedImages:s,positivePromptSafetyAttributes:o,sdkHttpResponse:i.sdkHttpResponse}:a={generatedImages:s,sdkHttpResponse:i.sdkHttpResponse},a}),this.list=async n=>{var i;const s={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!s.config.queryBase){if(!((i=s.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");s.config.filter="labels.tune-type:*"}return new Va(Uo.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(s),s)},this.editImage=async n=>{const i={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(i.referenceImages=n.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async n=>{let i={numberOfImages:1,mode:"upscale"};n.config&&(i=Object.assign(Object.assign({},i),n.config));const r={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async n=>{if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,i,r;const o=(n=e.config)===null||n===void 0?void 0:n.tools;if(!o)return e;const s=await Promise.all(o.map(async c=>Ps(c)?await c.tool():c)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(a.config.tools=s,e.config&&e.config.tools&&Qy(e.config.tools)){const c=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let u=Object.assign({},c);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),Xy(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,i,r;const o=new Map;for(const s of(i=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&i!==void 0?i:[])if(Ps(s)){const a=s,c=await a.tool();for(const u of(r=c.functionDeclarations)!==null&&r!==void 0?r:[]){if(!u.name)throw new Error("Function declaration name is required.");if(o.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);o.set(u.name,a)}}return o}async processAfcStream(e){var n,i,r;const o=(r=(i=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:Im;let s=!1,a=0;const c=await this.initAfcToolsMap(e);return(function(u,f,p){var v,m;return Ls(this,arguments,function*(){for(var S,_,E,C;a<o;){s&&(a++,s=!1);const G=yield Jt(u.processParamsMaybeAddMcpUsage(p)),ee=yield Jt(u.generateContentStreamInternal(G)),te=[],Y=[];try{for(var k=!0,I=(_=void 0,Ia(ee)),P;P=yield Jt(I.next()),S=P.done,!S;k=!0){C=P.value,k=!1;const D=C;if(yield yield Jt(D),D.candidates&&(!((v=D.candidates[0])===null||v===void 0)&&v.content)){Y.push(D.candidates[0].content);for(const Z of(m=D.candidates[0].content.parts)!==null&&m!==void 0?m:[])if(a<o&&Z.functionCall){if(!Z.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(Z.functionCall.name)){const N=yield Jt(f.get(Z.functionCall.name).callTool([Z.functionCall]));te.push(...N)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${Z.functionCall.name}`)}}}}catch(D){_={error:D}}finally{try{!k&&!S&&(E=I.return)&&(yield Jt(E.call(I)))}finally{if(_)throw _.error}}if(te.length>0){s=!0;const D=new ba;D.candidates=[{content:{role:"user",parts:te}}],yield yield Jt(D);const Z=[];Z.push(...Y),Z.push({role:"user",parts:te});const N=Si(p.contents).concat(Z);p.contents=N}else break}})})(this,c,e)}async generateContentInternal(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=_m(this.apiClient,e);return a=De("{model}:generateContent",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=Em(f),v=new ba;return Object.assign(v,p),v})}else{const u=Sm(this.apiClient,e);return a=De("{model}:generateContent",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=Cm(f),v=new ba;return Object.assign(v,p),v})}}async generateContentStreamInternal(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=_m(this.apiClient,e);return a=De("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),s.then(function(p){return Ls(this,arguments,function*(){var v,m,S,_;try{for(var E=!0,C=Ia(p),k;k=yield Jt(C.next()),v=k.done,!v;E=!0){_=k.value,E=!1;const I=_,P=Em(yield Jt(I.json()));P.sdkHttpResponse={headers:I.headers};const G=new ba;Object.assign(G,P),yield yield Jt(G)}}catch(I){m={error:I}}finally{try{!E&&!v&&(S=C.return)&&(yield Jt(S.call(C)))}finally{if(m)throw m.error}}})})}else{const u=Sm(this.apiClient,e);return a=De("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),s.then(function(p){return Ls(this,arguments,function*(){var v,m,S,_;try{for(var E=!0,C=Ia(p),k;k=yield Jt(C.next()),v=k.done,!v;E=!0){_=k.value,E=!1;const I=_,P=Cm(yield Jt(I.json()));P.sdkHttpResponse={headers:I.headers};const G=new ba;Object.assign(G,P),yield yield Jt(G)}}catch(I){m={error:I}}finally{try{!E&&!v&&(S=C.return)&&(yield Jt(S.call(C)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=qk(this.apiClient,e);return a=De("{model}:predict",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=$k(f),v=new tm;return Object.assign(v,p),v})}else{const u=Fk(this.apiClient,e);return a=De("{model}:batchEmbedContents",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=Uk(f),v=new tm;return Object.assign(v,p),v})}}async generateImagesInternal(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=ax(this.apiClient,e);return a=De("{model}:predict",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=cx(f),v=new nm;return Object.assign(v,p),v})}else{const u=sx(this.apiClient,e);return a=De("{model}:predict",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=lx(f),v=new nm;return Object.assign(v,p),v})}}async editImageInternal(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI()){const a=Pk(this.apiClient,e);return o=De("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:c.headers},f})),r.then(c=>{const u=Nk(c),f=new sC;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI()){const a=R3(this.apiClient,e);return o=De("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:c.headers},f})),r.then(c=>{const u=M3(c),f=new aC;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI()){const a=Zx(this.apiClient,e);return o=De("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const u=e3(c),f=new lC;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI()){const a=d3(this.apiClient,e);return o=De("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const u=f3(c),f=new cC;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=Tx(this.apiClient,e);return a=De("{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>Ud(f))}else{const u=Ex(this.apiClient,e);return a=De("{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>qd(f))}}async listInternal(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=Ux(this.apiClient,e);return a=De("{models_url}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=Ox(f),v=new im;return Object.assign(v,p),v})}else{const u=qx(this.apiClient,e);return a=De("{models_url}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=$x(f),v=new im;return Object.assign(v,p),v})}}async update(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=P3(this.apiClient,e);return a=De("{model}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>Ud(f))}else{const u=L3(this.apiClient,e);return a=De("{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>qd(f))}}async delete(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=Tk(this.apiClient,e);return a=De("{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=Ik(f),v=new rm;return Object.assign(v,p),v})}else{const u=Ek(this.apiClient,e);return a=De("{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=Ak(f),v=new rm;return Object.assign(v,p),v})}}async countTokens(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=Sk(this.apiClient,e);return a=De("{model}:countTokens",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=Ck(f),v=new om;return Object.assign(v,p),v})}else{const u=wk(this.apiClient,e);return a=De("{model}:countTokens",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=_k(f),v=new om;return Object.assign(v,p),v})}}async computeTokens(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI()){const a=uk(this.apiClient,e);return o=De("{model}:computeTokens",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:c.headers},f})),r.then(c=>{const u=dk(c),f=new uC;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=gx(this.apiClient,e);return a=De("{model}:predictLongRunning",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=hx(f),v=new pc;return Object.assign(v,p),v})}else{const u=px(this.apiClient,e);return a=De("{model}:predictLongRunning",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>{const p=fx(f),v=new pc;return Object.assign(v,p),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class E4 extends Vo{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,i=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=n.name.split("/operations/")[0];let o;i&&"httpOptions"in i&&(o=i.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:r,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:s,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:n.name,config:i});return n._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async get(e){const n=e.operation,i=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=n.name.split("/operations/")[0];let o;i&&"httpOptions"in i&&(o=i.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:r,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:s,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:n.name,config:i});return n._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=iC(e);return a=De("{operationName}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s}else{const u=nC(e);return a=De("{operationName}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s}}async fetchPredictVideosOperationInternal(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI()){const a=K_(e);return o=De("{resourceName}:fetchPredictOperation",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lm(){return{}}function T4(t){const e={},n=l(t,["name"]);return n!=null&&d(e,["name"],n),e}function A4(t){const e={},n=l(t,["disabled"]);n!=null&&d(e,["disabled"],n);const i=l(t,["startOfSpeechSensitivity"]);i!=null&&d(e,["startOfSpeechSensitivity"],i);const r=l(t,["endOfSpeechSensitivity"]);r!=null&&d(e,["endOfSpeechSensitivity"],r);const o=l(t,["prefixPaddingMs"]);o!=null&&d(e,["prefixPaddingMs"],o);const s=l(t,["silenceDurationMs"]);return s!=null&&d(e,["silenceDurationMs"],s),e}function I4(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&d(e,["data"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function k4(t){const e={},n=l(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>H4(o))),d(e,["parts"],r)}const i=l(t,["role"]);return i!=null&&d(e,["role"],i),e}function x4(t){const e={},n=l(t,["triggerTokens"]);n!=null&&d(e,["triggerTokens"],n);const i=l(t,["slidingWindow"]);return i!=null&&d(e,["slidingWindow"],J4(i)),e}function L4(t,e,n){const i={},r=l(e,["expireTime"]);n!==void 0&&r!=null&&d(n,["expireTime"],r);const o=l(e,["newSessionExpireTime"]);n!==void 0&&o!=null&&d(n,["newSessionExpireTime"],o);const s=l(e,["uses"]);n!==void 0&&s!=null&&d(n,["uses"],s);const a=l(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&d(n,["bidiGenerateContentSetup"],$4(t,a));const c=l(e,["lockAdditionalFields"]);return n!==void 0&&c!=null&&d(n,["fieldMask"],c),i}function P4(t,e){const n={},i=l(e,["config"]);return i!=null&&d(n,["config"],L4(t,i,n)),n}function N4(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const i=l(t,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function R4(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const i=l(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function M4(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const i=l(t,["args"]);i!=null&&d(e,["args"],i);const r=l(t,["name"]);return r!=null&&d(e,["name"],r),e}function B4(t){const e={},n=l(t,["behavior"]);n!=null&&d(e,["behavior"],n);const i=l(t,["description"]);i!=null&&d(e,["description"],i);const r=l(t,["name"]);r!=null&&d(e,["name"],r);const o=l(t,["parameters"]);o!=null&&d(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&d(e,["parametersJsonSchema"],s);const a=l(t,["response"]);a!=null&&d(e,["response"],a);const c=l(t,["responseJsonSchema"]);return c!=null&&d(e,["responseJsonSchema"],c),e}function D4(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&d(e,["dynamicRetrievalConfig"],N4(n)),e}function F4(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&d(e,["timeRangeFilter"],q4(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function q4(t){const e={},n=l(t,["startTime"]);n!=null&&d(e,["startTime"],n);const i=l(t,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function U4(t,e){const n={},i=l(t,["generationConfig"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig"],i);const r=l(t,["responseModalities"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig","responseModalities"],r);const o=l(t,["temperature"]);e!==void 0&&o!=null&&d(e,["setup","generationConfig","temperature"],o);const s=l(t,["topP"]);e!==void 0&&s!=null&&d(e,["setup","generationConfig","topP"],s);const a=l(t,["topK"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","topK"],a);const c=l(t,["maxOutputTokens"]);e!==void 0&&c!=null&&d(e,["setup","generationConfig","maxOutputTokens"],c);const u=l(t,["mediaResolution"]);e!==void 0&&u!=null&&d(e,["setup","generationConfig","mediaResolution"],u);const f=l(t,["seed"]);e!==void 0&&f!=null&&d(e,["setup","generationConfig","seed"],f);const p=l(t,["speechConfig"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","speechConfig"],K4(Cf(p)));const v=l(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],v);const m=l(t,["systemInstruction"]);e!==void 0&&m!=null&&d(e,["setup","systemInstruction"],k4(On(m)));const S=l(t,["tools"]);if(e!==void 0&&S!=null){let G=Us(S);Array.isArray(G)&&(G=G.map(ee=>Q4(qs(ee)))),d(e,["setup","tools"],G)}const _=l(t,["sessionResumption"]);e!==void 0&&_!=null&&d(e,["setup","sessionResumption"],z4(_));const E=l(t,["inputAudioTranscription"]);e!==void 0&&E!=null&&d(e,["setup","inputAudioTranscription"],Lm());const C=l(t,["outputAudioTranscription"]);e!==void 0&&C!=null&&d(e,["setup","outputAudioTranscription"],Lm());const k=l(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&d(e,["setup","realtimeInputConfig"],W4(k));const I=l(t,["contextWindowCompression"]);e!==void 0&&I!=null&&d(e,["setup","contextWindowCompression"],x4(I));const P=l(t,["proactivity"]);return e!==void 0&&P!=null&&d(e,["setup","proactivity"],G4(P)),n}function $4(t,e){const n={},i=l(e,["model"]);i!=null&&d(n,["setup","model"],At(t,i));const r=l(e,["config"]);return r!=null&&d(n,["config"],U4(r,n)),n}function O4(t){const e={},n=l(t,["speakerVoiceConfigs"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>Y4(r))),d(e,["speakerVoiceConfigs"],i)}return e}function H4(t){const e={},n=l(t,["videoMetadata"]);n!=null&&d(e,["videoMetadata"],Z4(n));const i=l(t,["thought"]);i!=null&&d(e,["thought"],i);const r=l(t,["inlineData"]);r!=null&&d(e,["inlineData"],I4(r));const o=l(t,["fileData"]);o!=null&&d(e,["fileData"],R4(o));const s=l(t,["thoughtSignature"]);s!=null&&d(e,["thoughtSignature"],s);const a=l(t,["functionCall"]);a!=null&&d(e,["functionCall"],M4(a));const c=l(t,["codeExecutionResult"]);c!=null&&d(e,["codeExecutionResult"],c);const u=l(t,["executableCode"]);u!=null&&d(e,["executableCode"],u);const f=l(t,["functionResponse"]);f!=null&&d(e,["functionResponse"],f);const p=l(t,["text"]);return p!=null&&d(e,["text"],p),e}function V4(t){const e={},n=l(t,["voiceName"]);return n!=null&&d(e,["voiceName"],n),e}function G4(t){const e={},n=l(t,["proactiveAudio"]);return n!=null&&d(e,["proactiveAudio"],n),e}function W4(t){const e={},n=l(t,["automaticActivityDetection"]);n!=null&&d(e,["automaticActivityDetection"],A4(n));const i=l(t,["activityHandling"]);i!=null&&d(e,["activityHandling"],i);const r=l(t,["turnCoverage"]);return r!=null&&d(e,["turnCoverage"],r),e}function z4(t){const e={},n=l(t,["handle"]);if(n!=null&&d(e,["handle"],n),l(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function J4(t){const e={},n=l(t,["targetTokens"]);return n!=null&&d(e,["targetTokens"],n),e}function Y4(t){const e={},n=l(t,["speaker"]);n!=null&&d(e,["speaker"],n);const i=l(t,["voiceConfig"]);return i!=null&&d(e,["voiceConfig"],Zy(i)),e}function K4(t){const e={},n=l(t,["voiceConfig"]);n!=null&&d(e,["voiceConfig"],Zy(n));const i=l(t,["multiSpeakerVoiceConfig"]);i!=null&&d(e,["multiSpeakerVoiceConfig"],O4(i));const r=l(t,["languageCode"]);return r!=null&&d(e,["languageCode"],r),e}function j4(t){const e={},n=l(t,["environment"]);n!=null&&d(e,["environment"],n);const i=l(t,["excludedPredefinedFunctions"]);return i!=null&&d(e,["excludedPredefinedFunctions"],i),e}function Q4(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(u=>B4(u))),d(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=l(t,["googleSearch"]);i!=null&&d(e,["googleSearch"],F4(i));const r=l(t,["googleSearchRetrieval"]);if(r!=null&&d(e,["googleSearchRetrieval"],D4(r)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&d(e,["urlContext"],X4());const s=l(t,["computerUse"]);s!=null&&d(e,["computerUse"],j4(s));const a=l(t,["codeExecution"]);return a!=null&&d(e,["codeExecution"],a),e}function X4(){return{}}function Z4(t){const e={},n=l(t,["fps"]);n!=null&&d(e,["fps"],n);const i=l(t,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=l(t,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function Zy(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&d(e,["prebuiltVoiceConfig"],V4(n)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eL(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(o=>`${n}.${o}`);e.push(...r)}else e.push(n)}return e.join(",")}function tL(t,e){let n=null;const i=t.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const o=i.setup;typeof o=="object"&&o!==null?(t.bidiGenerateContentSetup=o,n=o):delete t.bidiGenerateContentSetup}else i!==void 0&&delete t.bidiGenerateContentSetup;const r=t.fieldMask;if(n){const o=eL(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?t.fieldMask=o:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const s=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];r.length>0&&(a=r.map(u=>s.includes(u)?`generationConfig.${u}`:u));const c=[];o&&c.push(o),a.length>0&&c.push(...a),c.length>0?t.fieldMask=c.join(","):delete t.fieldMask}else delete t.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?t.fieldMask=r.join(","):delete t.fieldMask;return t}class nL extends Vo{constructor(e){super(),this.apiClient=e}async create(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=P4(this.apiClient,e);o=De("auth_tokens",a._url),s=a._query,delete a.config,delete a._url,delete a._query;const c=tL(a,e.config);return r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),r.then(u=>T4(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iL(t){const e={},n=l(t,["name"]);return n!=null&&d(e,["_url","name"],n),e}function rL(t){const e={},n=l(t,["name"]);return n!=null&&d(e,["_url","name"],n),e}function oL(t,e){const n={};if(l(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=l(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&d(e,["displayName"],i),l(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=l(t,["epochCount"]);e!==void 0&&r!=null&&d(e,["tuningTask","hyperparameters","epochCount"],r);const o=l(t,["learningRateMultiplier"]);if(o!=null&&d(n,["tuningTask","hyperparameters","learningRateMultiplier"],o),l(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(l(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(l(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const s=l(t,["batchSize"]);e!==void 0&&s!=null&&d(e,["tuningTask","hyperparameters","batchSize"],s);const a=l(t,["learningRate"]);if(e!==void 0&&a!=null&&d(e,["tuningTask","hyperparameters","learningRate"],a),l(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return n}function sL(t,e){const n={},i=l(t,["validationDataset"]);e!==void 0&&i!=null&&d(e,["supervisedTuningSpec"],EL(i,n));const r=l(t,["tunedModelDisplayName"]);e!==void 0&&r!=null&&d(e,["tunedModelDisplayName"],r);const o=l(t,["description"]);e!==void 0&&o!=null&&d(e,["description"],o);const s=l(t,["epochCount"]);e!==void 0&&s!=null&&d(e,["supervisedTuningSpec","hyperParameters","epochCount"],s);const a=l(t,["learningRateMultiplier"]);e!==void 0&&a!=null&&d(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],a);const c=l(t,["exportLastCheckpointOnly"]);e!==void 0&&c!=null&&d(e,["supervisedTuningSpec","exportLastCheckpointOnly"],c);const u=l(t,["adapterSize"]);if(e!==void 0&&u!=null&&d(e,["supervisedTuningSpec","hyperParameters","adapterSize"],u),l(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(l(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const f=l(t,["labels"]);return e!==void 0&&f!=null&&d(e,["labels"],f),n}function aL(t){const e={},n=l(t,["baseModel"]);n!=null&&d(e,["baseModel"],n);const i=l(t,["preTunedModel"]);i!=null&&d(e,["preTunedModel"],i);const r=l(t,["trainingDataset"]);r!=null&&d(e,["tuningTask","trainingData"],wL(r));const o=l(t,["config"]);return o!=null&&oL(o,e),e}function lL(t){const e={},n=l(t,["baseModel"]);n!=null&&d(e,["baseModel"],n);const i=l(t,["preTunedModel"]);i!=null&&d(e,["preTunedModel"],i);const r=l(t,["trainingDataset"]);r!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],SL(r,e));const o=l(t,["config"]);return o!=null&&sL(o,e),e}function cL(t){const e={},n=l(t,["name"]);return n!=null&&d(e,["_url","name"],n),e}function uL(t){const e={},n=l(t,["name"]);return n!=null&&d(e,["_url","name"],n),e}function dL(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=l(t,["pageToken"]);e!==void 0&&r!=null&&d(e,["_query","pageToken"],r);const o=l(t,["filter"]);return e!==void 0&&o!=null&&d(e,["_query","filter"],o),n}function fL(t,e){const n={},i=l(t,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=l(t,["pageToken"]);e!==void 0&&r!=null&&d(e,["_query","pageToken"],r);const o=l(t,["filter"]);return e!==void 0&&o!=null&&d(e,["_query","filter"],o),n}function hL(t){const e={},n=l(t,["config"]);return n!=null&&dL(n,e),e}function pL(t){const e={},n=l(t,["config"]);return n!=null&&fL(n,e),e}function gL(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=l(t,["tunedModels"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>e0(s))),d(e,["tuningJobs"],o)}return e}function mL(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=l(t,["tuningJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Od(s))),d(e,["tuningJobs"],o)}return e}function vL(t){const e={},n=l(t,["checkpointId"]);n!=null&&d(e,["checkpointId"],n);const i=l(t,["epoch"]);i!=null&&d(e,["epoch"],i);const r=l(t,["step"]);r!=null&&d(e,["step"],r);const o=l(t,["endpoint"]);return o!=null&&d(e,["endpoint"],o),e}function yL(t){const e={},n=l(t,["name"]);n!=null&&d(e,["model"],n);const i=l(t,["name"]);return i!=null&&d(e,["endpoint"],i),e}function bL(t){const e={},n=l(t,["model"]);n!=null&&d(e,["model"],n);const i=l(t,["endpoint"]);i!=null&&d(e,["endpoint"],i);const r=l(t,["checkpoints"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>vL(s))),d(e,["checkpoints"],o)}return e}function wL(t){const e={};if(l(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=l(t,["examples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>_L(r))),d(e,["examples","examples"],i)}return e}function SL(t,e){const n={},i=l(t,["gcsUri"]);e!==void 0&&i!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],i);const r=l(t,["vertexDatasetResource"]);if(e!==void 0&&r!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],r),l(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function _L(t){const e={},n=l(t,["textInput"]);n!=null&&d(e,["textInput"],n);const i=l(t,["output"]);return i!=null&&d(e,["output"],i),e}function e0(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["name"]);i!=null&&d(e,["name"],i);const r=l(t,["state"]);r!=null&&d(e,["state"],Ay(r));const o=l(t,["createTime"]);o!=null&&d(e,["createTime"],o);const s=l(t,["tuningTask","startTime"]);s!=null&&d(e,["startTime"],s);const a=l(t,["tuningTask","completeTime"]);a!=null&&d(e,["endTime"],a);const c=l(t,["updateTime"]);c!=null&&d(e,["updateTime"],c);const u=l(t,["description"]);u!=null&&d(e,["description"],u);const f=l(t,["baseModel"]);f!=null&&d(e,["baseModel"],f);const p=l(t,["_self"]);p!=null&&d(e,["tunedModel"],yL(p));const v=l(t,["customBaseModel"]);v!=null&&d(e,["customBaseModel"],v);const m=l(t,["experiment"]);m!=null&&d(e,["experiment"],m);const S=l(t,["labels"]);S!=null&&d(e,["labels"],S);const _=l(t,["outputUri"]);_!=null&&d(e,["outputUri"],_);const E=l(t,["pipelineJob"]);E!=null&&d(e,["pipelineJob"],E);const C=l(t,["serviceAccount"]);C!=null&&d(e,["serviceAccount"],C);const k=l(t,["tunedModelDisplayName"]);return k!=null&&d(e,["tunedModelDisplayName"],k),e}function Od(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["name"]);i!=null&&d(e,["name"],i);const r=l(t,["state"]);r!=null&&d(e,["state"],Ay(r));const o=l(t,["createTime"]);o!=null&&d(e,["createTime"],o);const s=l(t,["startTime"]);s!=null&&d(e,["startTime"],s);const a=l(t,["endTime"]);a!=null&&d(e,["endTime"],a);const c=l(t,["updateTime"]);c!=null&&d(e,["updateTime"],c);const u=l(t,["error"]);u!=null&&d(e,["error"],u);const f=l(t,["description"]);f!=null&&d(e,["description"],f);const p=l(t,["baseModel"]);p!=null&&d(e,["baseModel"],p);const v=l(t,["tunedModel"]);v!=null&&d(e,["tunedModel"],bL(v));const m=l(t,["preTunedModel"]);m!=null&&d(e,["preTunedModel"],m);const S=l(t,["supervisedTuningSpec"]);S!=null&&d(e,["supervisedTuningSpec"],S);const _=l(t,["tuningDataStats"]);_!=null&&d(e,["tuningDataStats"],_);const E=l(t,["encryptionSpec"]);E!=null&&d(e,["encryptionSpec"],E);const C=l(t,["partnerModelTuningSpec"]);C!=null&&d(e,["partnerModelTuningSpec"],C);const k=l(t,["customBaseModel"]);k!=null&&d(e,["customBaseModel"],k);const I=l(t,["experiment"]);I!=null&&d(e,["experiment"],I);const P=l(t,["labels"]);P!=null&&d(e,["labels"],P);const G=l(t,["outputUri"]);G!=null&&d(e,["outputUri"],G);const ee=l(t,["pipelineJob"]);ee!=null&&d(e,["pipelineJob"],ee);const te=l(t,["serviceAccount"]);te!=null&&d(e,["serviceAccount"],te);const Y=l(t,["tunedModelDisplayName"]);return Y!=null&&d(e,["tunedModelDisplayName"],Y),e}function CL(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const i=l(t,["name"]);i!=null&&d(e,["name"],i);const r=l(t,["metadata"]);r!=null&&d(e,["metadata"],r);const o=l(t,["done"]);o!=null&&d(e,["done"],o);const s=l(t,["error"]);return s!=null&&d(e,["error"],s),e}function EL(t,e){const n={},i=l(t,["gcsUri"]);i!=null&&d(n,["validationDatasetUri"],i);const r=l(t,["vertexDatasetResource"]);return e!==void 0&&r!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],r),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class TL extends Vo{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Va(Uo.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.tune=async n=>{var i;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const r={tunedModelName:n.baseModel};!((i=n.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=n.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},n),{preTunedModel:r});return o.baseModel=void 0,await this.tuneInternal(o)}else{const r=Object.assign({},n);return await this.tuneInternal(r)}else{const r=Object.assign({},n),o=await this.tuneMldevInternal(r);let s="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?s=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(s=o.name.split("/operations/")[0]),{name:s,state:Nd.JOB_STATE_QUEUED}}}}async getInternal(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=uL(e);return a=De("{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>Od(f))}else{const u=cL(e);return a=De("{name}",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>e0(f))}}async listInternal(e){var n,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){const u=pL(e);return a=De("tuningJobs",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=mL(f),v=new sm;return Object.assign(v,p),v})}else{const u=hL(e);return a=De("tunedModels",u._url),c=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:f.headers},v})),s.then(f=>{const p=gL(f),v=new sm;return Object.assign(v,p),v})}}async cancel(e){var n,i,r,o;let s="",a={};if(this.apiClient.isVertexAI()){const c=rL(e);s=De("{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const c=iL(e);s=De("{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async tuneInternal(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI()){const a=lL(e);return o=De("tuningJobs",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:c.headers},f})),r.then(c=>Od(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=aL(e);return o=De("tunedModels",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:c.headers},f})),r.then(c=>CL(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class AL{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const IL=1024*1024*8,kL=3,xL=1e3,LL=2,Ju="x-goog-upload-status";async function PL(t,e,n){var i,r,o;let s=0,a=0,c=new Rd(new Response),u="upload";for(s=t.size;a<s;){const p=Math.min(IL,s-a),v=t.slice(a,a+p);a+p>=s&&(u+=", finalize");let m=0,S=xL;for(;m<kL&&(c=await n.request({path:"",body:v,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(p)}}}),!(!((i=c==null?void 0:c.headers)===null||i===void 0)&&i[Ju]));)m++,await RL(S),S=S*LL;if(a+=p,((r=c==null?void 0:c.headers)===null||r===void 0?void 0:r[Ju])!=="active")break;if(s<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(c==null?void 0:c.json());if(((o=c==null?void 0:c.headers)===null||o===void 0?void 0:o[Ju])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function NL(t){return{size:t.size,type:t.type}}function RL(t){return new Promise(e=>setTimeout(e,t))}class ML{async upload(e,n,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await PL(e,n,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await NL(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class BL{create(e,n,i){return new DL(e,n,i)}}class DL{constructor(e,n,i){this.url=e,this.headers=n,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Pm="x-goog-api-key";class FL{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(Pm)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Pm,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qL="gl-node/";class UL{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const i=Y_(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const r=new FL(this.apiKey);this.apiClient=new i4({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:qL+"web",uploader:new ML,downloader:new AL}),this.models=new C4(this.apiClient),this.live=new m4(this.apiClient,r,new BL),this.batches=new UE(this.apiClient),this.chats=new JT(this.models,this.apiClient),this.caches=new GT(this.apiClient),this.files=new sA(this.apiClient),this.operations=new E4(this.apiClient),this.authTokens=new nL(this.apiClient),this.tunings=new TL(this.apiClient)}}const mc=50;function Af(){const e=`searates_calls_${new Date().toISOString().substring(0,7)}`,n=parseInt(localStorage.getItem(e)||"0",10),i=mc-n,r=n/mc*100;return{used:n,remaining:i,percentage:r}}function t0(t){return t>=80?"critical":t>=60?"warning":"good"}function If(t){const e=document.getElementById(t);if(!e){console.error(`Container ${t} not found`);return}const n=Af(),i=t0(n.percentage),r={good:"#10b981",warning:"#f59e0b",critical:"#ef4444"},o={good:"Healthy API usage",warning:"Approaching limit",critical:"Critical - Near limit!"};e.innerHTML=`
        <div class="api-usage-widget" style="
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
        ">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h4 style="margin: 0; font-size: 1rem; color: var(--text-color);">
                    📊 SeaRates API Usage
                </h4>
                <span style="
                    background: ${r[i]}22;
                    color: ${r[i]};
                    padding: 0.25rem 0.75rem;
                    border-radius: 20px;
                    font-size: 0.75rem;
                    font-weight: 600;
                ">${o[i]}</span>
            </div>
            
            <div style="margin-bottom: 1rem;">
                <div style="
                    display: flex;
                    justify-content: space-between;
                    align-items: baseline;
                    margin-bottom: 0.5rem;
                ">
                    <span style="font-size: 2rem; font-weight: 700; color: var(--text-color);">
                        ${n.used}
                    </span>
                    <span style="font-size: 0.875rem; color: var(--text-muted);">
                        of ${mc} calls used
                    </span>
                </div>
                
                <div style="
                    width: 100%;
                    height: 8px;
                    background: var(--light-gray);
                    border-radius: 4px;
                    overflow: hidden;
                    position: relative;
                ">
                    <div style="
                        width: ${n.percentage}%;
                        height: 100%;
                        background: linear-gradient(to right, ${r[i]}, ${r[i]}dd);
                        border-radius: 4px;
                        transition: width 0.3s ease;
                    "></div>
                </div>
            </div>
            
            <div style="
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1rem;
                padding-top: 1rem;
                border-top: 1px solid var(--border-color);
            ">
                <div>
                    <p style="margin: 0; font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase;">
                        Remaining
                    </p>
                    <p style="margin: 0; font-size: 1.25rem; font-weight: 600; color: var(--text-color);">
                        ${n.remaining}
                    </p>
                </div>
                <div>
                    <p style="margin: 0; font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase;">
                        Resets
                    </p>
                    <p style="margin: 0; font-size: 1.25rem; font-weight: 600; color: var(--text-color);">
                        ${$L()}
                    </p>
                </div>
            </div>
            
            ${n.remaining<=5?`
                <div style="
                    margin-top: 1rem;
                    padding: 0.75rem;
                    background: ${r.critical}15;
                    border-left: 3px solid ${r.critical};
                    border-radius: 4px;
                ">
                    <p style="margin: 0; font-size: 0.875rem; color: var(--text-color);">
                        ⚠️ <strong>Low API Credits:</strong> Switching to AI estimates soon. 
                        Contact sales to upgrade your plan.
                    </p>
                </div>
            `:""}
        </div>
    `}function $L(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,1),n={month:"short",day:"numeric"};return e.toLocaleDateString("en-US",n)}function n0(t){const e=document.getElementById(t);if(!e)return;const n=Af(),i=t0(n.percentage),r={good:"#10b981",warning:"#f59e0b",critical:"#ef4444"};e.innerHTML=`
        <div class="api-usage-badge" style="
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
        " title="SeaRates API Usage">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="${r[i]}" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M12 6v6l4 2"/>
            </svg>
            <span style="font-size: 0.875rem; font-weight: 600; color: var(--text-color);">
                ${n.remaining}/${mc}
            </span>
        </div>
    `;const o=e.querySelector(".api-usage-badge");o&&(o.addEventListener("mouseenter",()=>{o.style.transform="translateY(-2px)",o.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)"}),o.addEventListener("mouseleave",()=>{o.style.transform="translateY(0)",o.style.boxShadow="none"}))}function OL(){Af();const t={good:"#10b981",warning:"#f59e0b"},e=document.createElement("div");e.id="api-usage-modal-overlay",e.style.cssText=`
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        backdrop-filter: blur(4px);
    `,e.innerHTML=`
        <div style="
            background: var(--card-bg);
            border-radius: 16px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        ">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h3 style="margin: 0; color: var(--text-color);">API Usage Details</h3>
                <button id="close-usage-modal" style="
                    background: none;
                    border: none;
                    font-size: 1.5rem;
                    cursor: pointer;
                    color: var(--text-muted);
                ">&times;</button>
            </div>
            
            <div id="modal-widget-container"></div>
            
            <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color);">
                <h4 style="margin: 0 0 1rem 0; font-size: 0.875rem; color: var(--text-muted);">
                    SERVICE BREAKDOWN
                </h4>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: var(--text-color);">🚢 FCL Container Quotes</span>
                        <span style="color: ${t.good}; font-weight: 600;">✓ Real-time</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: var(--text-color);">📦 LCL Ocean Freight</span>
                        <span style="color: ${t.good}; font-weight: 600;">✓ Real-time</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: var(--text-color);">✈️ Air Freight</span>
                        <span style="color: ${t.good}; font-weight: 600;">✓ Real-time</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: var(--text-color);">🚂 Railway Freight</span>
                        <span style="color: ${t.warning}; font-weight: 600;">○ AI Estimate</span>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 1.5rem;">
                <p style="margin: 0; font-size: 0.75rem; color: var(--text-muted); line-height: 1.6;">
                    <strong>Note:</strong> When API quota is exhausted, all services automatically switch to 
                    AI-powered estimates. Customer contact information is captured for manual rate confirmation 
                    within 24 hours.
                </p>
            </div>
        </div>
    `,document.body.appendChild(e),If("modal-widget-container");const n=document.getElementById("close-usage-modal");n==null||n.addEventListener("click",()=>{document.body.removeChild(e)}),e.addEventListener("click",i=>{i.target===e&&document.body.removeChild(e)})}async function Ga(){try{if(!j.isLoggedIn||!j.currentUser)return console.log("[Subscription] User not logged in"),!1;const{data:{user:t}}=await In.auth.getUser();if(!t)return!1;const{data:e,error:n}=await In.from("subscriptions").select("*").eq("user_id",t.id).in("status",["active","trialing"]).single();if(n)return n.code==="PGRST116"?(console.log("[Subscription] No active subscription found"),!1):(console.error("[Subscription] Error checking status:",n),!1);if(!e)return console.log("[Subscription] No subscription data"),!1;const i=new Date(e.current_period_end);return i<new Date?(console.log("[Subscription] Subscription expired:",i),!1):(console.log(`[Subscription] Active ${e.plan} subscription until ${i.toLocaleDateString()}`),j.subscription={isActive:!0,plan:e.plan,periodEnd:e.current_period_end,cancelAtPeriodEnd:e.cancel_at_period_end},!0)}catch(t){return console.error("[Subscription] Unexpected error:",t),!1}}async function HL(){try{if(!j.isLoggedIn||!j.currentUser)return null;const{data:{user:t}}=await In.auth.getUser();if(!t)return null;const{data:e,error:n}=await In.from("subscriptions").select("*").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(1).single();if(n){if(n.code==="PGRST116")return null;throw n}return e}catch(t){return console.error("[Subscription] Error fetching subscription:",t),null}}async function kf(){if(!j.isLoggedIn)return"Please log in to access live carrier rates";const t=await HL();if(!t)return"Upgrade to Premium to get real-time rates from actual carriers";switch(t.status){case"past_due":return"Your payment failed. Please update your payment method to restore access";case"canceled":return"Your subscription was canceled. Resubscribe to access live rates";case"incomplete":return"Please complete your payment to activate your subscription";default:return"Subscription expired. Renew to access live carrier rates"}}async function VL(){if(!await Ga()){console.log("ℹ️ API usage badge hidden for free users (AI estimates only)");return}const e=document.querySelector(".header-user-actions");if(e){const n=document.createElement("div");n.id="api-usage-badge-container",n.style.cssText="display: inline-block; margin-right: 0.5rem;";const i=document.getElementById("region-language-btn");i&&(e.insertBefore(n,i),n0("api-usage-badge-container"),n.addEventListener("click",()=>{OL()}))}GL(),console.log("✅ API usage tracking initialized")}function GL(){const t=document.getElementById("page-dashboard");if(t){const e=document.createElement("div");e.id="api-usage-widget-container";const n=t.querySelector(".dashboard-ecom-hub");n&&(t.insertBefore(e,n),If("api-usage-widget-container"))}}async function WL(){if(!await Ga())return;document.getElementById("api-usage-badge-container")&&n0("api-usage-badge-container"),document.getElementById("api-usage-widget-container")&&If("api-usage-widget-container")}const zL="K-21EB16AA-B6A6-4D41-9365-5882597F9B11",qa=50,Ol={shanghai:"CNSHA",shenzhen:"CNSZX",ningbo:"CNNGB",guangzhou:"CNGZS","los angeles":"USLAX","new york":"USNYC","long beach":"USLGB",oakland:"USOAK",rotterdam:"NLRTM",hamburg:"DEHAM",antwerp:"BEANR",felixstowe:"GBFXT",london:"GBLGP",southampton:"GBSOU",singapore:"SGSIN","hong kong":"HKHKG",busan:"KRPUS",tokyo:"JPTYO",dubai:"AEDXB","jebel ali":"AEJEA",default:"CNSHA"};async function i0(){try{const e=`searates_calls_${new Date().toISOString().substring(0,7)}`,n=parseInt(localStorage.getItem(e)||"0",10);return qa-n}catch(t){return console.error("Error getting remaining calls:",t),0}}async function JL(){try{const e=`searates_calls_${new Date().toISOString().substring(0,7)}`,n=parseInt(localStorage.getItem(e)||"0",10);localStorage.setItem(e,String(n+1));const i=qa-(n+1);console.log(`SeaRates API calls remaining this month: ${i}/${qa}`),i<=5&&Ee(`Warning: Only ${i} SeaRates API calls left this month`,"warning",5e3)}catch(t){console.error("Error incrementing call counter:",t)}}function Nm(t,e){const n=t.toLowerCase();if(Ol[n])return Ol[n];for(const[r,o]of Object.entries(Ol))if(n.includes(r)||r.includes(n))return o;const i=e.toUpperCase();return i.includes("CN")||i.includes("CHINA")?"CNSHA":i.includes("US")||i.includes("USA")?"USLAX":i.includes("GB")||i.includes("UK")?"GBLGP":i.includes("DE")||i.includes("GERMANY")?"DEHAM":i.includes("NL")||i.includes("NETHERLANDS")?"NLRTM":Ol.default}async function xf(t){if(await i0()<=0)throw new Error("QUOTA_EXCEEDED");try{const n=t.mode==="air"?"/sea-rates-proxy/air/rates":"/sea-rates-api-db-config/rates/search",{data:i,error:r}=await In.functions.invoke("sea-rates-proxy",{body:{endpoint:n,method:"POST",apiKey:zL,data:{...t,origin:{...t.origin,port:t.origin.port||Nm(t.origin.city||t.origin.country,t.origin.country)},destination:{...t.destination,port:t.destination.port||Nm(t.destination.city||t.destination.country,t.destination.country)}}}});if(r)throw console.error("SeaRates API error:",r),r;await JL();try{WL()}catch(o){console.log("Could not refresh API usage display:",o)}return YL(i,t.mode)}catch(n){throw console.error("SeaRates API call failed:",n),n}}function YL(t,e){return!t||!t.rates?[]:t.rates.map(n=>({carrier:n.carrier||n.airline||"Carrier",service:n.service||"Standard",transitTime:n.transit_time||n.transitTime||"N/A",price:parseFloat(n.total_price||n.price||0),currency:n.currency||"USD",validUntil:n.valid_until||n.validUntil,route:n.route||`${e.toUpperCase()} Freight`})).filter(n=>n.price>0)}async function KL(t,e,n){try{return await xf({mode:"fcl",origin:t,destination:e,containers:n})}catch(i){throw i.message==="QUOTA_EXCEEDED"&&Ee("Monthly API limit reached. Generating AI estimate...","warning",3e3),i}}async function jL(t,e,n){try{return await xf({mode:"lcl",origin:t,destination:e,cargo:n})}catch(i){throw i.message==="QUOTA_EXCEEDED"&&Ee("Monthly API limit reached. Generating AI estimate...","warning",3e3),i}}async function QL(t,e,n){try{return await xf({mode:"air",origin:t,destination:e,cargo:n})}catch(i){throw i.message==="QUOTA_EXCEEDED"&&Ee("Monthly API limit reached. Generating AI estimate...","warning",3e3),i}}async function Nc(){const t=await i0(),e=qa-t;console.log(`
    ═══════════════════════════════════════
    📊 SeaRates API Usage (Current Month)
    ═══════════════════════════════════════
    Subscription: Logistics Explorer
    Calls Used: ${e}/${qa}
    Calls Remaining: ${t}
    ═══════════════════════════════════════
    `)}async function Rc(t){try{const{data:e,error:n}=await In.functions.invoke("submit-quote-request",{body:{serviceType:t.serviceType,customerInfo:t.customerInfo,shipmentDetails:t.shipmentDetails,aiEstimate:t.aiEstimate||null,timestamp:new Date().toISOString()}});return n?(console.error("Error submitting quote request:",n),Ee("Unable to submit request. Please try again or contact support.","error"),!1):(console.log("Quote request submitted successfully:",e),Ee("Request submitted! We'll email you a confirmed quote within 24 hours.","success",5e3),!0)}catch(e){return console.error("Quote request submission failed:",e),Ee("Unable to submit request. Please try again.","error"),!1}}async function Mc(t){return new Promise(e=>{const n=`
            <div class="modal active" id="customer-info-modal" style="z-index: 10000;">
                <div class="modal-content" style="max-width: 500px;">
                    <button class="close-btn" id="close-customer-modal">&times;</button>
                    <h3>Get Your Quote</h3>
                    <p style="margin-bottom: 1.5rem; color: var(--text-secondary);">
                        Enter your contact details to receive your ${t} quote. 
                        We'll also email you a confirmed rate from our partners.
                    </p>
                    <form id="customer-info-form">
                        <div class="input-wrapper">
                            <label for="customer-name">Full Name *</label>
                            <input type="text" id="customer-name" required placeholder="John Smith">
                        </div>
                        <div class="input-wrapper">
                            <label for="customer-email">Email Address *</label>
                            <input type="email" id="customer-email" required placeholder="john@example.com">
                        </div>
                        <div class="input-wrapper">
                            <label for="customer-phone">Phone Number (Optional)</label>
                            <input type="tel" id="customer-phone" placeholder="+1 234 567 8900">
                        </div>
                        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                            <button type="button" class="secondary-btn" id="cancel-customer-btn" style="flex: 1;">Cancel</button>
                            <button type="submit" class="primary-btn" style="flex: 1;">Get Quote</button>
                        </div>
                    </form>
                </div>
            </div>
        `,i=document.createElement("div");i.innerHTML=n,document.body.appendChild(i);const r=document.getElementById("customer-info-modal"),o=document.getElementById("customer-info-form"),s=document.getElementById("close-customer-modal"),a=document.getElementById("cancel-customer-btn"),c=()=>{r==null||r.remove(),i.remove()},u=()=>{c(),e(null)};s==null||s.addEventListener("click",u),a==null||a.addEventListener("click",u),o==null||o.addEventListener("submit",f=>{f.preventDefault();const p=document.getElementById("customer-name").value.trim(),v=document.getElementById("customer-email").value.trim(),m=document.getElementById("customer-phone").value.trim();if(!p||!v){Ee("Please enter your name and email","error");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v)){Ee("Please enter a valid email address","error");return}c(),e({name:p,email:v,phone:m||void 0})})})}const Rm=1440*60*1e3;function vc(t,e,n,i){const r=JSON.stringify(i,Object.keys(i).sort()),o=`${e}-${n}`.toLowerCase().replace(/[^a-z0-9-]/g,"");return`rate_cache_${t}_${o}_${XL(r)}`}function XL(t){let e=0;for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);e=(e<<5)-e+i,e=e&e}return Math.abs(e).toString(36)}function Lf(t,e,n,i){try{const r=vc(t,e,n,i),o=localStorage.getItem(r);if(!o)return console.log(`[Cache] No cached rates for ${t}: ${e} → ${n}`),null;const s=JSON.parse(o),a=Date.now();if(a>s.expiresAt)return console.log(`[Cache] Expired rates for ${t}: ${e} → ${n}`),localStorage.removeItem(r),null;const c=Math.ceil((s.expiresAt-a)/(1e3*60*60));return console.log(`[Cache] HIT! Using cached ${t} rates (valid for ${c}h)`),s.quotes}catch(r){return console.error("[Cache] Error reading cache:",r),null}}function Pf(t,e,n,i,r){try{const o=vc(t,e,n,i),s=Date.now(),a=s+Rm,c={service:t,route:{origin:e,destination:n},requestParams:i,quotes:r,cachedAt:s,expiresAt:a,source:"searates"};localStorage.setItem(o,JSON.stringify(c));const u=new Date(a);console.log(`[Cache] Saved ${t} rates until ${u.toLocaleString()}`)}catch(o){if(console.error("[Cache] Error saving cache:",o),o instanceof DOMException&&o.name==="QuotaExceededError"){r0();try{const s=vc(t,e,n,i),a={service:t,route:{origin:e,destination:n},requestParams:i,quotes:r,cachedAt:Date.now(),expiresAt:Date.now()+Rm,source:"searates"};localStorage.setItem(s,JSON.stringify(a))}catch(s){console.error("[Cache] Failed to cache even after cleanup:",s)}}}}function r0(){try{const t=Date.now();let e=0;for(let n=localStorage.length-1;n>=0;n--){const i=localStorage.key(n);if(!(!i||!i.startsWith("rate_cache_")))try{const r=JSON.parse(localStorage.getItem(i));t>r.expiresAt&&(localStorage.removeItem(i),e++)}catch{localStorage.removeItem(i),e++}}e>0&&console.log(`[Cache] Cleared ${e} expired cache entries`)}catch(t){console.error("[Cache] Error clearing expired caches:",t)}}function Nf(t,e,n,i){try{const r=vc(t,e,n,i),o=localStorage.getItem(r);if(!o)return{exists:!1,expiresAt:null,hoursRemaining:null};const s=JSON.parse(o),a=Date.now();if(a>s.expiresAt)return{exists:!1,expiresAt:null,hoursRemaining:null};const c=Math.ceil((s.expiresAt-a)/(1e3*60*60));return{exists:!0,expiresAt:new Date(s.expiresAt),hoursRemaining:c}}catch{return{exists:!1,expiresAt:null,hoursRemaining:null}}}r0();let Ri,Vr,Yu=!1;function Es(t){var e;Ae({currentFclStep:t}),Ei("trade-finance",t-1),document.querySelectorAll("#page-fcl .service-step").forEach(n=>n.classList.remove("active")),(e=document.getElementById(`fcl-step-${t}`))==null||e.classList.add("active"),t===3&&iP()}function ZL(){const t=document.getElementById("page-fcl");t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div class="service-page-header">
            <h2>Book Full Container Load (FCL)</h2>
            <p class="subtitle">Secure exclusive use of a container for your large shipments.</p>
        </div>
        <div class="form-container">
             <div class="visual-progress-bar" id="progress-bar-trade-finance">
                <div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div>
            </div>

            <!-- Step 1: Details -->
            <div id="fcl-step-1" class="service-step">
                <form id="fcl-quote-form" novalidate>
                    <div class="form-section">
                        <h3>Service Type</h3>
                        <div id="fcl-service-type-selector" class="service-type-selector">
                            <button type="button" class="service-type-btn" data-type="port-to-port"><strong>Port-to-Port</strong><span>You handle transport to/from ports.</span></button>
                            <button type="button" class="service-type-btn" data-type="door-to-port"><strong>Door-to-Port</strong><span>We pick up from your door.</span></button>
                            <button type="button" class="service-type-btn" data-type="port-to-door"><strong>Port-to-Door</strong><span>We deliver to their door.</span></button>
                            <button type="button" class="service-type-btn" data-type="door-to-door"><strong>Door-to-Door</strong><span>We handle the entire journey.</span></button>
                        </div>
                    </div>

                    <div class="form-section two-column">
                        <div id="fcl-origin-section">
                            <h4>Origin</h4>
                            <div id="fcl-pickup-address-fields" class="hidden">
                                <div class="input-wrapper"><label for="fcl-pickup-name">Sender Name/Company</label><input type="text" id="fcl-pickup-name"></div>
                                <div class="input-wrapper"><label for="fcl-pickup-country">Country</label><input type="text" id="fcl-pickup-country"></div>
                            </div>
                             <div id="fcl-pickup-location-fields">
                                <div class="input-wrapper"><label for="fcl-pickup-port">Port of Loading</label><input type="text" id="fcl-pickup-port" placeholder="e.g., Shanghai or CNSHA"></div>
                            </div>
                        </div>
                         <div id="fcl-destination-section">
                            <h4>Destination</h4>
                            <div id="fcl-delivery-address-fields" class="hidden">
                                <div class="input-wrapper"><label for="fcl-delivery-name">Recipient Name/Company</label><input type="text" id="fcl-delivery-name"></div>
                                <div class="input-wrapper"><label for="fcl-delivery-country">Country</label><input type="text" id="fcl-delivery-country"></div>
                            </div>
                            <div id="fcl-delivery-location-fields">
                                <div class="input-wrapper"><label for="fcl-delivery-port">Port of Discharge</label><input type="text" id="fcl-delivery-port" placeholder="e.g., Los Angeles or USLAX"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h4>Cargo & Container Details</h4>
                        <div class="input-wrapper"><label for="fcl-cargo-description">Cargo Description</label><textarea id="fcl-cargo-description" required placeholder="e.g., 15 pallets of consumer electronics"></textarea></div>
                        <div id="fcl-container-list"></div>
                        <button type="button" id="fcl-add-container-btn" class="secondary-btn">Add Container</button>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="main-submit-btn">Get Quote & Compliance</button>
                    </div>
                </form>
            </div>
            
            <!-- Step 2: Quote & Compliance -->
            <div id="fcl-step-2" class="service-step">
                <h3>Quote & Compliance</h3>
                 <div class="quote-confirmation-panel" style="margin-bottom: 2rem;">
                    <h4>Please Note: This is an AI Estimate</h4>
                    <p>This price is an estimate generated by our AI based on current market rates. A Vcanship agent will contact you to confirm the final details, provide an exact quote, and finalize your booking.</p>
                </div>
                <div class="results-layout-grid">
                     <main id="fcl-compliance-container" class="results-main-content"></main>
                     <aside id="fcl-quote-sidebar" class="results-sidebar"></aside>
                </div>
                <div class="form-actions" style="justify-content: space-between;">
                    <button type="button" id="fcl-back-to-details-btn" class="secondary-btn">Back</button>
                    <button type="button" id="fcl-to-agreement-btn" class="main-submit-btn">Request Final Quote</button>
                </div>
            </div>

            <!-- Step 3: Agreement -->
            <div id="fcl-step-3" class="service-step">
                 <h3>Agreement & Finalization</h3>
                 <div class="two-column">
                    <div>
                        <h4>Booking Summary</h4>
                        <div id="fcl-agreement-summary" class="payment-overview"></div>
                        <div class="checkbox-wrapper" style="margin-top: 1.5rem;">
                            <input type="checkbox" id="fcl-compliance-ack">
                            <label for="fcl-compliance-ack">I acknowledge that providing the required compliance documents is my responsibility.</label>
                        </div>
                    </div>
                    <div>
                        <h4>Digital Signature</h4>
                        <div class="input-wrapper">
                            <label for="fcl-signer-name">Sign by Typing Your Full Name</label>
                            <input type="text" id="fcl-signer-name">
                        </div>
                        <label>Sign in the box below</label>
                        <canvas id="fcl-signature-pad" width="400" height="150" style="border: 2px solid var(--border-color); border-radius: 8px; cursor: crosshair;"></canvas>
                    </div>
                 </div>
                 <div class="form-actions" style="justify-content: space-between;">
                    <button type="button" id="fcl-back-to-compliance-btn" class="secondary-btn">Back</button>
                    <button type="button" id="fcl-to-payment-btn" class="main-submit-btn" disabled>Confirm Booking Request</button>
                </div>
            </div>

            <!-- Step 4: Confirmation -->
            <div id="fcl-step-4" class="service-step">
                <div class="confirmation-container">
                    <h3 id="fcl-confirmation-title">Booking Request Sent!</h3>
                    <p id="fcl-confirmation-message">Your FCL shipment request has been received. Our operations team will be in touch via email to coordinate the next steps.</p>
                    <div class="confirmation-tracking">
                        <h4>Reference ID</h4>
                        <div class="tracking-id-display" id="fcl-booking-id"></div>
                    </div>
                    <div class="confirmation-actions">
                         <button id="fcl-download-docs-btn" class="secondary-btn">Download Summary (PDF)</button>
                         <button id="fcl-new-shipment-btn" class="main-submit-btn">New Shipment</button>
                    </div>
                </div>
            </div>
        </div>
    `)}function eP(t){var i,r,o,s,a;document.querySelectorAll("#fcl-service-type-selector .service-type-btn").forEach(c=>c.classList.remove("active")),(i=document.querySelector(`#fcl-service-type-selector .service-type-btn[data-type="${t}"]`))==null||i.classList.add("active");const e=t.startsWith("door-to"),n=t.endsWith("-to-door");(r=document.getElementById("fcl-pickup-address-fields"))==null||r.classList.toggle("hidden",!e),(o=document.getElementById("fcl-pickup-location-fields"))==null||o.classList.toggle("hidden",e),(s=document.getElementById("fcl-delivery-address-fields"))==null||s.classList.toggle("hidden",!n),(a=document.getElementById("fcl-delivery-location-fields"))==null||a.classList.toggle("hidden",n)}function o0(){var n;const t=document.getElementById("fcl-container-list");if(!t)return;const e=((n=j.fclDetails)==null?void 0:n.containers)||[];t.innerHTML=e.map((i,r)=>`
        <div class="card" data-index="${r}" style="margin-bottom: 1rem; padding: 1rem;">
            <div class="form-grid" style="grid-template-columns: 2fr 1fr 1fr 1fr auto; gap: 1rem; align-items: flex-end;">
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Container Type</label><select class="fcl-container-type"><option ${i.type==="20GP"?"selected":""}>20GP</option><option ${i.type==="40GP"?"selected":""}>40GP</option><option ${i.type==="40HC"?"selected":""}>40HC</option></select></div>
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Quantity</label><input type="number" class="fcl-container-quantity" value="${i.quantity}" min="1"></div>
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Weight</label><input type="number" class="fcl-container-weight" value="${i.weight||""}" min="1"></div>
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Unit</label><select class="fcl-container-weight-unit"><option ${i.weightUnit==="KG"?"selected":""}>KG</option><option ${i.weightUnit==="TON"?"selected":""}>TON</option></select></div>
                <button type="button" class="secondary-btn fcl-remove-container-btn">&times;</button>
            </div>
        </div>
    `).join("")}function tP(){const t=[];document.querySelectorAll("#fcl-container-list .card").forEach(e=>{t.push({type:e.querySelector(".fcl-container-type").value,quantity:parseInt(e.querySelector(".fcl-container-quantity").value)||1,weight:parseInt(e.querySelector(".fcl-container-weight").value)||0,weightUnit:e.querySelector(".fcl-container-weight-unit").value})}),Ae({fclDetails:{...j.fclDetails,containers:t}})}function nP(){var o,s;const{fclQuote:t,fclComplianceDocs:e,fclDetails:n}=j,i=document.getElementById("fcl-quote-sidebar"),r=document.getElementById("fcl-compliance-container");i&&t&&n&&(i.innerHTML=`
            <div class="results-section">
                <h3>Route</h3>
                <div id="fcl-route-visualizer" style="padding: 1rem; background: var(--light-gray); border-radius: 8px; text-align: center;">
                    <p style="margin: 0;"><strong>From:</strong> ${n.pickupPort||((o=n.pickupAddress)==null?void 0:o.country)}<br><strong>To:</strong> ${n.deliveryPort||((s=n.deliveryAddress)==null?void 0:s.country)}</p>
                </div>
            </div>
            <div class="results-section">
                 <h3>AI-Generated Quote</h3>
                 <div class="payment-overview">
                    <div class="review-item"><span>Carrier:</span><strong>${t.carrierName}</strong></div>
                    <div class="review-item"><span>Transit Time:</span><strong>~${t.estimatedTransitTime}</strong></div>
                    <hr>
                    <div class="review-item total"><span>Est. Total Cost:</span><strong>${j.currentCurrency.symbol}${t.totalCost.toFixed(2)}</strong></div>
                 </div>
            </div>
        `),r&&e&&(r.innerHTML=`
            <h3>Compliance Checklist</h3>
            <p class="subtitle" style="text-align: left; margin: 0 0 1rem;">Upload the required documents for your shipment.</p>
            <div id="fcl-compliance-checklist" class="compliance-checklist">
                ${e.map(a=>`
                    <div class="compliance-doc-item" id="${a.id}" data-status="${a.status}">
                        <div class="compliance-doc-info"><h4>${a.title} ${a.required?"<span>(Required)</span>":""}</h4><p>${a.description}</p></div>
                        <div class="file-drop-area">
                            <div class="file-drop-area-idle"><span>Drop file or click</span></div>
                            <div class="file-drop-area-uploaded" style="display: none;"></div>
                            <input type="file" class="file-input" data-doc-id="${a.id}">
                        </div>
                    </div>
                `).join("")}
            </div>
        `)}function iP(){if(Ri=document.getElementById("fcl-signature-pad"),!Ri)return;Vr=Ri.getContext("2d"),Vr.strokeStyle="#212121",Vr.lineWidth=2;const t=i=>{Yu=!0,n(i)},e=()=>{Yu=!1,Vr.beginPath(),Ae({fclSignatureDataUrl:Ri.toDataURL()}),Hd()},n=i=>{if(!Yu)return;i.preventDefault();const r=Ri.getBoundingClientRect(),o=i instanceof MouseEvent?i:i.touches[0];Vr.lineTo(o.clientX-r.left,o.clientY-r.top),Vr.stroke(),Vr.beginPath(),Vr.moveTo(o.clientX-r.left,o.clientY-r.top)};Ri.addEventListener("mousedown",t),Ri.addEventListener("mouseup",e),Ri.addEventListener("mousemove",n),Ri.addEventListener("touchstart",t),Ri.addEventListener("touchend",e),Ri.addEventListener("touchmove",n)}function Hd(){const t=document.getElementById("fcl-compliance-ack").checked,e=document.getElementById("fcl-signer-name").value.trim(),n=!!j.fclSignatureDataUrl;document.getElementById("fcl-to-payment-btn").disabled=!(t&&e&&n)}async function rP(t){var a,c;if(t.preventDefault(),tP(),!kc())return;rt(!0,"Analyzing your FCL shipment...");const e=((a=document.querySelector("#fcl-service-type-selector .service-type-btn.active"))==null?void 0:a.getAttribute("data-type"))||"port-to-port",n=e.startsWith("door-to")?{name:document.getElementById("fcl-pickup-name").value,country:document.getElementById("fcl-pickup-country").value}:null,i=e.startsWith("door-to")?null:document.getElementById("fcl-pickup-port").value,r=e.endsWith("-to-door")?{name:document.getElementById("fcl-delivery-name").value,country:document.getElementById("fcl-delivery-country").value}:null,o=e.endsWith("-to-door")?null:document.getElementById("fcl-delivery-port").value,s={serviceType:e,pickupType:e.startsWith("door-to")?"address":"location",deliveryType:e.endsWith("-to-door")?"address":"location",pickupAddress:n,deliveryAddress:r,pickupPort:i,deliveryPort:o,cargoDescription:document.getElementById("fcl-cargo-description").value,hsCode:"",containers:((c=j.fclDetails)==null?void 0:c.containers)||[]};Ae({fclDetails:s});try{await Nc();const u={country:(n==null?void 0:n.country)||"China",city:i||"Shanghai"},f={country:(r==null?void 0:r.country)||"United States",city:o||"Los Angeles"},p=s.containers.map(C=>({type:C.type,quantity:C.quantity}));let v,m=!1,S=!1;const _=await Ga();if(_){const C={containers:p},k=Lf("fcl",u.city,f.city,C);if(k&&k.length>0){v=k[0],m=!0,S=!0;const I=Nf("fcl",u.city,f.city,C);Ee(`✅ Using cached rate (valid for ${I.hoursRemaining}h more)`,"success",3e3),console.log("[FCL] Using cached quote, saved 1 API call!")}}if(!S&&_)try{console.log("✅ Subscription active - fetching live FCL quotes...");const C=await KL(u,f,p);if(C&&C.length>0){const k=C[0],I=k.price,P=I*(1+An.fcl.standard);v={carrierName:k.carrier,estimatedTransitTime:k.transitTime,totalCost:P,carrierType:"Ocean Carrier",chargeableWeight:0,chargeableWeightUnit:"N/A",weightBasis:"Per Container",isSpecialOffer:!1,costBreakdown:{baseShippingCost:I,fuelSurcharge:0,estimatedCustomsAndTaxes:0,optionalInsuranceCost:0,ourServiceFee:P-I},serviceProvider:`SeaRates (${k.carrier})`};const G={containers:p};Pf("fcl",u.city,f.city,G,[v]),m=!0,Ee("✅ Real-time carrier quote! Valid for 24 hours.","success",3e3)}else throw new Error("No quotes returned from SeaRates API")}catch(C){console.log("❌ SeaRates API error, falling back to AI:",C.message)}if(!m){const C=await kf();if(console.log(`💡 Using AI estimate: ${C}`),!j.api)throw new Error("API not initialized");const k=s.containers.map(te=>`${te.quantity} x ${te.type}`).join(", "),I=`Act as a logistics pricing expert for FCL sea freight. Provide a realistic estimated quote.
            Route: From ${i||(n==null?void 0:n.country)} to ${o||(r==null?void 0:r.country)}.
            Containers: ${k}.
            Cargo: ${s.cargoDescription}.
            Currency: ${j.currentCurrency.code}.
            
            Provide a JSON object with: carrierName (e.g., Maersk, MSC), estimatedTransitTime (e.g., "25-30 days"), and totalCost (realistic market rate with ${An.fcl.standard*100}% markup included).`,P={type:Wn.OBJECT,properties:{carrierName:{type:Wn.STRING},estimatedTransitTime:{type:Wn.STRING},totalCost:{type:Wn.NUMBER}}},G=await j.api.models.generateContent({model:"gemini-2.5-flash",contents:I,config:{responseMimeType:"application/json",responseSchema:P}}),ee=JSON.parse(G.text);v={...ee,carrierType:"Ocean Carrier",chargeableWeight:0,chargeableWeightUnit:"N/A",weightBasis:"Per Container",isSpecialOffer:!1,costBreakdown:{baseShippingCost:ee.totalCost/(1+An.fcl.standard),fuelSurcharge:0,estimatedCustomsAndTaxes:0,optionalInsuranceCost:0,ourServiceFee:ee.totalCost-ee.totalCost/(1+An.fcl.standard)},serviceProvider:"Vcanship AI Estimate",isAIEstimate:!0},!_&&j.isLoggedIn?Ee("💡 AI estimate - Upgrade to Premium ($9.99/mo) for real carrier rates!","info",5e3):j.isLoggedIn?Ee("AI estimate - We'll email confirmed rates soon.","info",4e3):Ee("AI estimate. Log in & subscribe for live carrier rates.","info",4e3)}const E=[{id:"doc-commercial-invoice",title:"Commercial Invoice",description:"Detailed invoice showing goods value, quantities, and buyer/seller information.",status:"pending",file:null,required:!0},{id:"doc-packing-list",title:"Packing List",description:"Itemized list of container contents with weights and dimensions.",status:"pending",file:null,required:!0},{id:"doc-bill-of-lading",title:"Bill of Lading",description:"Contract between shipper and carrier. Will be issued by the carrier.",status:"pending",file:null,required:!0},{id:"doc-certificate-of-origin",title:"Certificate of Origin",description:"Certifies the country where goods were manufactured.",status:"pending",file:null,required:!1}];if(!m)try{const C=await Mc("FCL");C&&await Rc({serviceType:"FCL",customerInfo:C,shipmentDetails:s,aiEstimate:v})}catch(C){console.log("Customer info capture skipped:",C)}Ae({fclQuote:v,fclComplianceDocs:E}),nP(),Es(2)}catch(u){console.error("FCL quote error:",u),Ee("Could not generate an estimate. Please try again.","error")}finally{rt(!1)}}function oP(){var e,n,i,r,o,s,a,c,u,f,p,v;const t=document.getElementById("page-fcl");t&&((e=t.querySelector(".back-btn"))==null||e.addEventListener("click",()=>bt("landing")),(n=document.getElementById("fcl-quote-form"))==null||n.addEventListener("submit",rP),(i=document.getElementById("fcl-service-type-selector"))==null||i.addEventListener("click",m=>{const _=m.target.closest(".service-type-btn");_!=null&&_.dataset.type&&eP(_.dataset.type)}),(r=document.getElementById("fcl-add-container-btn"))==null||r.addEventListener("click",s0),(o=document.getElementById("fcl-container-list"))==null||o.addEventListener("click",m=>{var _,E;const S=m.target;if(S.classList.contains("fcl-remove-container-btn")){const C=parseInt(((_=S.closest(".card"))==null?void 0:_.dataset.index)||"-1");if(C>-1&&((E=j.fclDetails)!=null&&E.containers)){const k=j.fclDetails.containers.filter((I,P)=>P!==C);Ae({fclDetails:{...j.fclDetails,containers:k}}),o0()}}}),(s=document.getElementById("fcl-back-to-details-btn"))==null||s.addEventListener("click",()=>Es(1)),(a=document.getElementById("fcl-to-agreement-btn"))==null||a.addEventListener("click",()=>{const m=document.getElementById("fcl-agreement-summary");m&&(m.innerHTML=document.querySelector("#fcl-quote-sidebar .payment-overview").innerHTML),Es(3)}),(c=document.getElementById("fcl-back-to-compliance-btn"))==null||c.addEventListener("click",()=>Es(2)),(u=document.getElementById("fcl-to-payment-btn"))==null||u.addEventListener("click",()=>{const m=`FCL-${Date.now().toString().slice(-6)}`;Ae({fclBookingId:m}),document.getElementById("fcl-booking-id").textContent=m,Es(4)}),(f=document.getElementById("fcl-new-shipment-btn"))==null||f.addEventListener("click",()=>a0()),(p=document.getElementById("fcl-compliance-ack"))==null||p.addEventListener("change",Hd),(v=document.getElementById("fcl-signer-name"))==null||v.addEventListener("input",Hd))}function s0(){var n;const e=[...((n=j.fclDetails)==null?void 0:n.containers)||[],{type:"20GP",quantity:1,weight:0,weightUnit:"KG"}];Ae({fclDetails:{...j.fclDetails,containers:e}}),o0()}function a0(){Ae({currentService:"fcl"}),B1(),ZL(),bt("fcl"),oP(),Es(1),s0()}let li=[];function ka(t){var e;Ei("trade-finance",t-1),document.querySelectorAll("#page-lcl .service-step").forEach(n=>n.classList.remove("active")),(e=document.getElementById(`lcl-step-${t}`))==null||e.classList.add("active")}function l0(){const t=document.getElementById("page-lcl");t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div class="service-page-header">
            <h2>Book Less than Container Load (LCL)</h2>
            <p class="subtitle">Cost-effective shipping for goods not requiring a full container.</p>
        </div>
        <div class="form-container">
            <div class="visual-progress-bar" id="progress-bar-trade-finance">
                <div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div>
            </div>

            <!-- Step 1: Details -->
            <div id="lcl-step-1" class="service-step">
                <form id="lcl-details-form">
                    <h3>Shipment Details</h3>
                     <div class="form-section two-column">
                        <div class="input-wrapper"><label for="lcl-origin">Origin (City, Country)</label><input type="text" id="lcl-origin" required placeholder="e.g., Hamburg, Germany"></div>
                        <div class="input-wrapper"><label for="lcl-destination">Destination (City, Country)</label><input type="text" id="lcl-destination" required placeholder="e.g., New York, USA"></div>
                    </div>
                     <div class="form-section">
                        <h4>Cargo Description</h4>
                        <div class="input-wrapper">
                            <label for="lcl-cargo-description">Detailed description of goods</label>
                            <textarea id="lcl-cargo-description" required placeholder="e.g., 10 boxes of cotton t-shirts, 5 boxes of leather shoes"></textarea>
                        </div>
                        <div class="hs-code-suggester-wrapper" style="margin-top: 1rem;">
                            <div class="input-wrapper">
                                <label for="lcl-hs-code">HS Code (Harmonized System)</label>
                                <input type="text" id="lcl-hs-code" autocomplete="off" placeholder="Auto-suggested from description">
                                <div class="hs-code-suggestions" id="lcl-hs-code-suggestions"></div>
                                <p class="helper-text">This code is used by customs worldwide to classify products. We can suggest one based on your description.</p>
                            </div>
                        </div>
                    </div>
                    <div class="form-section">
                        <h4>Cargo Dimensions & Weight</h4>
                        <div id="lcl-cargo-list"></div>
                        <button type="button" id="lcl-add-cargo-btn" class="secondary-btn">Add Cargo Item</button>
                        <div id="lcl-cargo-summary" class="payment-overview" style="margin-top: 1rem;"></div>
                    </div>
                    <div class="form-actions"><button type="submit" class="main-submit-btn">Get AI Estimate</button></div>
                </form>
            </div>

            <!-- Step 2: Quote -->
            <div id="lcl-step-2" class="service-step">
                 <h3>Your AI-Powered Estimate</h3>
                <div id="lcl-quote-container"></div>
                <div class="quote-confirmation-panel">
                    <h4>Please Note: This is an AI Estimate</h4>
                    <p>This price is an estimate generated based on current market rates. It may not include local charges, customs, or duties. A Vcanship agent will contact you via email to confirm all details and provide a final, all-inclusive quote.</p>
                </div>
                <div class="form-actions">
                    <button type="button" id="lcl-back-to-details" class="secondary-btn">Back</button>
                    <button type="button" id="lcl-request-booking" class="main-submit-btn">Request Final Quote</button>
                </div>
            </div>
            
            <!-- Step 3: Confirmation -->
            <div id="lcl-step-3" class="service-step">
                <div class="confirmation-container">
                    <h3>Booking Request Sent!</h3>
                    <p>Your LCL shipment request has been received. Our team will email you shortly with a final quote and booking instructions.</p>
                    <div class="confirmation-tracking">
                        <h4>Reference ID</h4>
                        <div class="tracking-id-display" id="lcl-reference-id"></div>
                    </div>
                    <div class="confirmation-actions">
                        <button id="lcl-new-shipment-btn" class="main-submit-btn">Book Another LCL Shipment</button>
                    </div>
                </div>
            </div>
        </div>
    `)}function c0(){const t=document.getElementById("lcl-cargo-list");t&&(t.innerHTML=li.map((e,n)=>`
        <div class="lcl-cargo-item card" data-index="${n}">
             <div class="form-grid" style="grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 1rem; align-items: flex-end;">
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Pieces</label><input type="number" class="lcl-cargo-pieces" value="${e.pieces}" min="1" required></div>
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Length(cm)</label><input type="number" class="lcl-cargo-length" value="${e.length}" min="1" required></div>
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Width(cm)</label><input type="number" class="lcl-cargo-width" value="${e.width}" min="1" required></div>
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Height(cm)</label><input type="number" class="lcl-cargo-height" value="${e.height}" min="1" required></div>
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Weight(kg)</label><input type="number" class="lcl-cargo-weight" value="${e.weight}" min="1" required></div>
                <button type="button" class="secondary-btn lcl-remove-cargo-btn" style="margin-bottom: 0.5rem;">Remove</button>
            </div>
        </div>
    `).join(""),d0())}function Vd(){li.push({id:Date.now(),pieces:1,length:100,width:100,height:100,weight:100}),c0()}function u0(){const t=[];let e=!0;document.querySelectorAll(".lcl-cargo-item").forEach(n=>{const i={id:Date.now(),pieces:parseInt(n.querySelector(".lcl-cargo-pieces").value,10)||0,length:parseInt(n.querySelector(".lcl-cargo-length").value,10)||0,width:parseInt(n.querySelector(".lcl-cargo-width").value,10)||0,height:parseInt(n.querySelector(".lcl-cargo-height").value,10)||0,weight:parseInt(n.querySelector(".lcl-cargo-weight").value,10)||0};i.pieces>0&&i.length>0&&i.width>0&&i.height>0&&i.weight>0?t.push(i):e=!1}),li=t,e||Ee("Please ensure all cargo dimensions and weights are filled correctly.","warning"),d0()}function d0(){const t=document.getElementById("lcl-cargo-summary");if(!t)return;let e=0,n=0;li.forEach(r=>{e+=r.length*r.width*r.height/1e6*r.pieces,n+=r.weight*r.pieces});const i=Math.max(n,e*1e3);li.length>0?t.innerHTML=`
            <div class="review-item"><span>Total Volume (CBM):</span><strong>${e.toFixed(3)} m³</strong></div>
            <div class="review-item"><span>Total Actual Weight:</span><strong>${n.toFixed(2)} kg</strong></div>
            <div class="review-item"><span>Chargeable Weight:</span><strong>${i.toFixed(2)} kg</strong></div>
        `:t.innerHTML=""}async function sP(t){if(t.preventDefault(),u0(),li.length===0){Ee("Please add at least one cargo item.","error");return}rt(!0,"Calculating LCL estimate...");const e=document.getElementById("lcl-origin").value,n=document.getElementById("lcl-destination").value,i=document.getElementById("lcl-cargo-description").value,r=document.getElementById("lcl-hs-code").value,o=li.map(c=>`${c.pieces}pcs, ${c.length}x${c.width}x${c.height}cm, ${c.weight}kg`).join("; "),s=li.reduce((c,u)=>c+u.length*u.width*u.height/1e6*u.pieces,0),a=li.reduce((c,u)=>c+u.weight*u.pieces,0);try{await Nc();const[c,u]=e.split(",").map(k=>k.trim()),[f,p]=n.split(",").map(k=>k.trim());let v,m="",S=!1,_=!1;const E=await Ga();if(E){const k={weight:a,volume:s},I=Lf("lcl",c||e,f||n,k);if(I&&I.length>0){const P=I[0];v=P.totalCost,m=`<div class="review-item"><span>Carrier:</span><strong>${P.carrierName}</strong></div>
                                <div class="review-item"><span>Transit Time:</span><strong>${P.estimatedTransitTime}</strong></div>
                                <div class="review-item"><span>Cached Rate:</span><strong>Valid for ${Nf("lcl",c||e,f||n,k).hoursRemaining}h</strong></div>`,S=!0,_=!0,Ee("✅ Using cached LCL rate","success",3e3),console.log("[LCL] Cache hit, saved 1 API call!")}}if(!_&&E)try{console.log("✅ Subscription active - fetching live LCL quotes...");const k=await jL({country:u||e,city:c||e},{country:p||n,city:f||n},{weight:a,volume:s});if(k&&k.length>0){const I=k[0],P=I.price,G=An.lcl.standard;v=P*(1+G),m=`<div class="review-item"><span>Carrier:</span><strong>${I.carrier}</strong></div>
                                    <div class="review-item"><span>Transit Time:</span><strong>${I.transitTime}</strong></div>`,Pf("lcl",c||e,f||n,{weight:a,volume:s},[{carrierName:I.carrier,estimatedTransitTime:I.transitTime,totalCost:v,carrierType:"Ocean Freight",chargeableWeight:a,chargeableWeightUnit:"kg",weightBasis:"Actual Weight",isSpecialOffer:!1,costBreakdown:{baseShippingCost:P,fuelSurcharge:0,estimatedCustomsAndTaxes:0,optionalInsuranceCost:0,ourServiceFee:v-P},serviceProvider:`SeaRates (${I.carrier})`}]),S=!0,Ee("✅ Live LCL rate! Valid for 24 hours.","success",3e3)}else throw new Error("No quotes returned from SeaRates")}catch(k){console.log("❌ SeaRates API error, falling back to AI:",k.message)}if(!S){const k=await kf();if(console.log(`💡 Using AI estimate: ${k}`),!j.api)throw new Error("AI API not initialized.");const I=`
                Act as a logistics pricing expert for LCL (Less than Container Load) sea freight.
                - Origin CFS: ${e}
                - Destination CFS: ${n}
                - Total Volume: ${s.toFixed(3)} CBM
                - Total Weight: ${a.toFixed(2)} kg
                - Cargo description: ${i}
                - HS Code: ${r||"Not provided"}
                - Cargo details: ${o}
                - Currency: ${j.currentCurrency.code}

                Provide a single estimated base cost for the freight as a number. Do not add any other text or formatting.
            `,P=await j.api.models.generateContent({model:"gemini-2.5-flash",contents:I}),G=parseFloat(P.text);if(isNaN(G))throw new Error("Invalid AI response.");const ee=An.lcl.standard;v=G*(1+ee),m='<div class="review-item"><span>Source:</span><strong>AI Estimate</strong></div>',!E&&j.isLoggedIn?Ee("💡 AI estimate - Upgrade to Premium ($9.99/mo) for live rates!","info",5e3):j.isLoggedIn?Ee("AI estimate - We'll email confirmed rates soon.","info",4e3):Ee("AI estimate. Log in & subscribe for live carrier rates.","info",4e3)}const C=document.getElementById("lcl-quote-container");if(C&&(C.innerHTML=`
                <div class="payment-overview">
                    <div class="review-item"><span>Route:</span><strong>${e} &rarr; ${n}</strong></div>
                    ${m}
                    <div id="lcl-quote-summary-cargo"></div>
                    <hr>
                    <div class="review-item total"><span>Estimated Freight Cost:</span><strong>${j.currentCurrency.symbol}${v.toFixed(2)}</strong></div>
                </div>
            `,document.getElementById("lcl-quote-summary-cargo").innerHTML=document.getElementById("lcl-cargo-summary").innerHTML),!S)try{const k=await Mc("LCL");k&&await Rc({serviceType:"LCL",customerInfo:k,shipmentDetails:{origin:e,destination:n,cargoDescription:i,hsCode:r,totalCbm:s,totalWeight:a,cargoItems:li},aiEstimate:{totalCost:v,currency:j.currentCurrency.code}})}catch(k){console.log("Customer info capture skipped:",k)}ka(2)}catch(c){console.error("LCL quote error:",c),Ee("Could not generate an estimate. Please try again.","error")}finally{rt(!1)}}function f0(){var r,o,s,a,c,u,f,p;(r=document.querySelector("#page-lcl .back-btn"))==null||r.addEventListener("click",()=>bt("landing")),(o=document.getElementById("lcl-details-form"))==null||o.addEventListener("submit",sP),(s=document.getElementById("lcl-add-cargo-btn"))==null||s.addEventListener("click",Vd),(a=document.getElementById("lcl-cargo-list"))==null||a.addEventListener("click",v=>{const m=v.target;if(m.classList.contains("lcl-remove-cargo-btn")){const S=m.closest(".lcl-cargo-item");S!=null&&S.dataset.index&&(li.splice(parseInt(S.dataset.index,10),1),c0())}}),(c=document.getElementById("lcl-cargo-list"))==null||c.addEventListener("change",u0),(u=document.getElementById("lcl-back-to-details"))==null||u.addEventListener("click",()=>ka(1)),(f=document.getElementById("lcl-request-booking"))==null||f.addEventListener("click",()=>{const v=`LCL-${Date.now().toString().slice(-6)}`;document.getElementById("lcl-reference-id").textContent=v,ka(3),Ee("Request sent! Our team will contact you shortly.","success")}),(p=document.getElementById("lcl-new-shipment-btn"))==null||p.addEventListener("click",()=>{Jm(),li=[],l0(),f0(),ka(1),Vd()});let t=null;const e=document.getElementById("lcl-cargo-description"),n=document.getElementById("lcl-hs-code"),i=document.getElementById("lcl-hs-code-suggestions");e==null||e.addEventListener("input",()=>{const v=e.value.trim();if(t&&clearTimeout(t),v.length<10||!i){i==null||i.classList.remove("active");return}t=window.setTimeout(async()=>{rt(!0,"Suggesting HS codes...");try{const m=await hf(v);i&&(m.length>0?(i.innerHTML=m.map(S=>`
                            <div class="hs-code-suggestion-item" data-code="${S.code}">
                                <strong>${S.code}</strong> - ${S.description}
                            </div>
                        `).join(""),i.classList.add("active"),n&&n.value.trim()===""&&(n.value=m[0].code,Ee(`Suggested HS Code: ${m[0].code}`,"info"))):i.classList.remove("active"))}catch(m){console.error("HS Code suggestion failed",m)}finally{rt(!1)}},800)}),i==null||i.addEventListener("click",v=>{const S=v.target.closest(".hs-code-suggestion-item");S&&S.dataset.code&&n&&(n.value=S.dataset.code,i.classList.remove("active"))}),document.addEventListener("click",v=>{v.target.closest(".hs-code-suggester-wrapper")||i==null||i.classList.remove("active")})}function aP(){Ae({currentService:"lcl"}),Jm(),li=[],l0(),bt("lcl"),f0(),ka(1),Vd()}function h0(t,e,n,i,r){i=i||{};var o=1.15,s=r.internal.scaleFactor,a=r.internal.getFontSize()/s,c=r.getLineHeightFactor?r.getLineHeightFactor():o,u=a*c,f=/\r\n|\r|\n/g,p="",v=1;if((i.valign==="middle"||i.valign==="bottom"||i.halign==="center"||i.halign==="right")&&(p=typeof t=="string"?t.split(f):t,v=p.length||1),n+=a*(2-o),i.valign==="middle"?n-=v/2*u:i.valign==="bottom"&&(n-=v*u),i.halign==="center"||i.halign==="right"){var m=a;if(i.halign==="center"&&(m*=.5),p&&v>=1){for(var S=0;S<p.length;S++)r.text(p[S],e-r.getStringUnitWidth(p[S])*m,n),n+=u;return r}e-=r.getStringUnitWidth(t)*m}return i.halign==="justify"?r.text(t,e,n,{maxWidth:i.maxWidth||100,align:"justify"}):r.text(t,e,n),r}var Mm={},Ns=(function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,n){n===void 0&&(n=null),n?n.__autoTableDocumentDefaults=e:Mm=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,n){var i,r,o;n===void 0&&(n=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var s=this.jsPDFDocument.internal.getFont(),a=s.fontStyle,c=s.fontName;if(e.font&&(c=e.font),e.fontStyle){a=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(a)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),a=u[0])}if(this.jsPDFDocument.setFont(c,a),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!n){var f=t.unifyColor(e.fillColor);f&&(i=this.jsPDFDocument).setFillColor.apply(i,f),f=t.unifyColor(e.textColor),f&&(r=this.jsPDFDocument).setTextColor.apply(r,f),f=t.unifyColor(e.lineColor),f&&(o=this.jsPDFDocument).setDrawColor.apply(o,f),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,n,i){return this.jsPDFDocument.splitTextToSize(e,n,i)},t.prototype.rect=function(e,n,i,r,o){return this.jsPDFDocument.rect(e,n,i,r,o)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return Mm||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t})(),Gd=function(t,e){return Gd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},Gd(t,e)};function p0(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Gd(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var g0=(function(t){p0(e,t);function e(n){var i=t.call(this)||this;return i._element=n,i}return e})(Array);function lP(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function cP(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function yc(t,e,n){n.applyStyles(e,!0);var i=Array.isArray(t)?t:[t],r=i.map(function(o){return n.getTextWidth(o)}).reduce(function(o,s){return Math.max(o,s)},0);return r}function m0(t,e,n,i){var r=e.settings.tableLineWidth,o=e.settings.tableLineColor;t.applyStyles({lineWidth:r,lineColor:o});var s=v0(r,!1);s&&t.rect(n.x,n.y,e.getWidth(t.pageSize().width),i.y-n.y,s)}function v0(t,e){var n=t>0,i=e||e===0;return n&&i?"DF":n?"S":i?"F":null}function Bc(t,e){var n,i,r,o;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(n=t.left)!==null&&n!==void 0?n:e,top:(i=t.top)!==null&&i!==void 0?i:e,right:(r=t.right)!==null&&r!==void 0?r:e,bottom:(o=t.bottom)!==null&&o!==void 0?o:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function y0(t,e){var n=Bc(e.settings.margin,0);return t.pageSize().width-(n.left+n.right)}function uP(t,e,n,i,r){var o={},s=1.3333333333333333,a=Ku(e,function(I){return r.getComputedStyle(I).backgroundColor});a!=null&&(o.fillColor=a);var c=Ku(e,function(I){return r.getComputedStyle(I).color});c!=null&&(o.textColor=c);var u=fP(i,n);u&&(o.cellPadding=u);var f="borderTopColor",p=s*n,v=i.borderTopWidth;if(i.borderBottomWidth===v&&i.borderRightWidth===v&&i.borderLeftWidth===v){var m=(parseFloat(v)||0)/p;m&&(o.lineWidth=m)}else o.lineWidth={top:(parseFloat(i.borderTopWidth)||0)/p,right:(parseFloat(i.borderRightWidth)||0)/p,bottom:(parseFloat(i.borderBottomWidth)||0)/p,left:(parseFloat(i.borderLeftWidth)||0)/p},o.lineWidth.top||(o.lineWidth.right?f="borderRightColor":o.lineWidth.bottom?f="borderBottomColor":o.lineWidth.left&&(f="borderLeftColor"));var S=Ku(e,function(I){return r.getComputedStyle(I)[f]});S!=null&&(o.lineColor=S);var _=["left","right","center","justify"];_.indexOf(i.textAlign)!==-1&&(o.halign=i.textAlign),_=["middle","bottom","top"],_.indexOf(i.verticalAlign)!==-1&&(o.valign=i.verticalAlign);var E=parseInt(i.fontSize||"");isNaN(E)||(o.fontSize=E/s);var C=dP(i);C&&(o.fontStyle=C);var k=(i.fontFamily||"").toLowerCase();return t.indexOf(k)!==-1&&(o.font=k),o}function dP(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function Ku(t,e){var n=b0(t,e);if(!n)return null;var i=n.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!i||!Array.isArray(i))return null;var r=[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])],o=parseInt(i[4]);return o===0||isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function b0(t,e){var n=e(t);return n==="rgba(0, 0, 0, 0)"||n==="transparent"||n==="initial"||n==="inherit"?t.parentElement==null?null:b0(t.parentElement,e):n}function fP(t,e){var n=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],i=96/(72/e),r=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,o=n.map(function(a){return parseInt(a||"0")/i}),s=Bc(o,0);return r>s.top&&(s.top=r),r>s.bottom&&(s.bottom=r),s}function w0(t,e,n,i,r){var o,s;i===void 0&&(i=!1),r===void 0&&(r=!1);var a;typeof e=="string"?a=n.document.querySelector(e):a=e;var c=Object.keys(t.getFontList()),u=t.scaleFactor(),f=[],p=[],v=[];if(!a)return console.error("Html table could not be found with input: ",e),{head:f,body:p,foot:v};for(var m=0;m<a.rows.length;m++){var S=a.rows[m],_=(s=(o=S==null?void 0:S.parentElement)===null||o===void 0?void 0:o.tagName)===null||s===void 0?void 0:s.toLowerCase(),E=hP(c,u,n,S,i,r);E&&(_==="thead"?f.push(E):_==="tfoot"?v.push(E):p.push(E))}return{head:f,body:p,foot:v}}function hP(t,e,n,i,r,o){for(var s=new g0(i),a=0;a<i.cells.length;a++){var c=i.cells[a],u=n.getComputedStyle(c);if(r||u.display!=="none"){var f=void 0;o&&(f=uP(t,c,e,u,n)),s.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:f,_element:c,content:pP(c)})}}var p=n.getComputedStyle(i);if(s.length>0&&(r||p.display!=="none"))return s}function pP(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(n){return n.trim()}).join(`
`),e.innerText||e.textContent||""}function gP(t,e,n){for(var i=0,r=[t,e,n];i<r.length;i++){var o=r[i];o&&typeof o!="object"&&console.error("The options parameter should be of type object, is: "+typeof o),o.startY&&typeof o.startY!="number"&&(console.error("Invalid value for startY option",o.startY),delete o.startY)}}function wr(t,e,n,i,r){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),s=1;s<arguments.length;s++){var a=arguments[s];if(a!=null)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(o[c]=a[c])}return o}function S0(t,e){var n=new Ns(t),i=n.getDocumentOptions(),r=n.getGlobalOptions();gP(r,i,e);var o=wr({},r,i,e),s;typeof window<"u"&&(s=window);var a=mP(r,i,e),c=vP(r,i,e),u=yP(n,o),f=wP(n,o,s);return{id:e.tableId,content:f,hooks:c,styles:a,settings:u}}function mP(t,e,n){for(var i={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},r=function(c){if(c==="columnStyles"){var u=t[c],f=e[c],p=n[c];i.columnStyles=wr({},u,f,p)}else{var v=[t,e,n],m=v.map(function(S){return S[c]||{}});i[c]=wr({},m[0],m[1],m[2])}},o=0,s=Object.keys(i);o<s.length;o++){var a=s[o];r(a)}return i}function vP(t,e,n){for(var i=[t,e,n],r={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},o=0,s=i;o<s.length;o++){var a=s[o];a.didParseCell&&r.didParseCell.push(a.didParseCell),a.willDrawCell&&r.willDrawCell.push(a.willDrawCell),a.didDrawCell&&r.didDrawCell.push(a.didDrawCell),a.willDrawPage&&r.willDrawPage.push(a.willDrawPage),a.didDrawPage&&r.didDrawPage.push(a.didDrawPage)}return r}function yP(t,e){var n,i,r,o,s,a,c,u,f,p,v,m,S=Bc(e.margin,40/t.scaleFactor()),_=(n=bP(t,e.startY))!==null&&n!==void 0?n:S.top,E;e.showFoot===!0?E="everyPage":e.showFoot===!1?E="never":E=(i=e.showFoot)!==null&&i!==void 0?i:"everyPage";var C;e.showHead===!0?C="everyPage":e.showHead===!1?C="never":C=(r=e.showHead)!==null&&r!==void 0?r:"everyPage";var k=(o=e.useCss)!==null&&o!==void 0?o:!1,I=e.theme||(k?"plain":"striped"),P=!!e.horizontalPageBreak,G=(s=e.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(a=e.includeHiddenHtml)!==null&&a!==void 0?a:!1,useCss:k,theme:I,startY:_,margin:S,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(f=e.tableWidth)!==null&&f!==void 0?f:"auto",showHead:C,showFoot:E,tableLineWidth:(p=e.tableLineWidth)!==null&&p!==void 0?p:0,tableLineColor:(v=e.tableLineColor)!==null&&v!==void 0?v:200,horizontalPageBreak:P,horizontalPageBreakRepeat:G,horizontalPageBreakBehaviour:(m=e.horizontalPageBreakBehaviour)!==null&&m!==void 0?m:"afterAllRows"}}function bP(t,e){var n=t.getLastAutoTable(),i=t.scaleFactor(),r=t.pageNumber(),o=!1;if(n&&n.startPageNumber){var s=n.startPageNumber+n.pageNumber-1;o=s===r}return typeof e=="number"?e:(e==null||e===!1)&&o&&(n==null?void 0:n.finalY)!=null?n.finalY+20/i:null}function wP(t,e,n){var i=e.head||[],r=e.body||[],o=e.foot||[];if(e.html){var s=e.includeHiddenHtml;if(n){var a=w0(t,e.html,n,s,e.useCss)||{};i=a.head||i,r=a.body||i,o=a.foot||i}else console.error("Cannot parse html in non browser environment")}var c=e.columns||SP(i,r,o);return{columns:c,head:i,body:r,foot:o}}function SP(t,e,n){var i=t[0]||e[0]||n[0]||[],r=[];return Object.keys(i).filter(function(o){return o!=="_element"}).forEach(function(o){var s=1,a;Array.isArray(i)?a=i[parseInt(o)]:a=i[o],typeof a=="object"&&!Array.isArray(a)&&(s=(a==null?void 0:a.colSpan)||1);for(var c=0;c<s;c++){var u=void 0;Array.isArray(i)?u=r.length:u=o+(c>0?"_".concat(c):"");var f={dataKey:u};r.push(f)}}),r}var Wd=(function(){function t(e,n,i){this.table=n,this.pageNumber=n.pageNumber,this.settings=n.settings,this.cursor=i,this.doc=e.getDocument()}return t})(),_P=(function(t){p0(e,t);function e(n,i,r,o,s,a){var c=t.call(this,n,i,a)||this;return c.cell=r,c.row=o,c.column=s,c.section=o.section,c}return e})(Wd),CP=(function(){function t(e,n){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=n.columns,this.head=n.head,this.body=n.body,this.foot=n.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(n,i){return n+i.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(n,i){return n+i.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,n,i,r,o,s){for(var a=0,c=n;a<c.length;a++){var u=c[a],f=new _P(e,this,i,r,o,s),p=u(f)===!1;if(i.text=Array.isArray(i.text)?i.text:[i.text],p)return!1}return!0},t.prototype.callEndPageHooks=function(e,n){e.applyStyles(e.userStyles);for(var i=0,r=this.hooks.didDrawPage;i<r.length;i++){var o=r[i];o(new Wd(e,this,n))}},t.prototype.callWillDrawPageHooks=function(e,n){for(var i=0,r=this.hooks.willDrawPage;i<r.length;i++){var o=r[i];o(new Wd(e,this,n))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var n=this.columns.reduce(function(r,o){return r+o.wrappedWidth},0);return n}else{var i=this.settings.margin;return e-i.left-i.right}},t})(),_0=(function(){function t(e,n,i,r,o){o===void 0&&(o=!1),this.height=0,this.raw=e,e instanceof g0&&(this.raw=e._element,this.element=e._element),this.index=n,this.section=i,this.cells=r,this.spansMultiplePages=o}return t.prototype.getMaxCellHeight=function(e){var n=this;return e.reduce(function(i,r){var o;return Math.max(i,((o=n.cells[r.index])===null||o===void 0?void 0:o.height)||0)},0)},t.prototype.hasRowSpan=function(e){var n=this;return e.filter(function(i){var r=n.cells[i.index];return r?r.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,n){return this.getMaxCellHeight(n)<=e},t.prototype.getMinimumRowHeight=function(e,n){var i=this;return e.reduce(function(r,o){var s=i.cells[o.index];if(!s)return 0;var a=n.getLineHeight(s.styles.fontSize),c=s.padding("vertical"),u=c+a;return u>r?u:r},0)},t})(),C0=(function(){function t(e,n,i){var r;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=n,this.section=i,this.raw=e;var o=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,o=(r=e.content)!==null&&r!==void 0?r:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var s=o!=null?""+o:"",a=/\r\n|\r|\n/g;this.text=s.split(a)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var n=this.height-this.padding("vertical");e=this.y+n/2+this.padding("top")}var i;if(this.styles.halign==="right")i=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var r=this.width-this.padding("horizontal");i=this.x+r/2+this.padding("left")}else i=this.x+this.padding("left");return{x:i,y:e}},t.prototype.getContentHeight=function(e,n){n===void 0&&(n=1.15);var i=Array.isArray(this.text)?this.text.length:1,r=this.styles.fontSize/e*n,o=i*r+this.padding("vertical");return Math.max(o,this.styles.minCellHeight)},t.prototype.padding=function(e){var n=Bc(this.styles.cellPadding,0);return e==="vertical"?n.top+n.bottom:e==="horizontal"?n.left+n.right:n[e]},t})(),EP=(function(){function t(e,n,i){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=n,this.index=i}return t.prototype.getMaxCustomCellWidth=function(e){for(var n=0,i=0,r=e.allRows();i<r.length;i++){var o=r[i],s=o.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(n=Math.max(n,s.styles.cellWidth))}return n},t})();function TP(t,e){AP(t,e);var n=[],i=0;e.columns.forEach(function(o){var s=o.getMaxCustomCellWidth(e);s?o.width=s:(o.width=o.wrappedWidth,n.push(o)),i+=o.width});var r=e.getWidth(t.pageSize().width)-i;r&&(r=zd(n,r,function(o){return Math.max(o.minReadableWidth,o.minWidth)})),r&&(r=zd(n,r,function(o){return o.minWidth})),r=Math.abs(r),!e.settings.horizontalPageBreak&&r>.1/t.scaleFactor()&&(r=r<1?r:Math.round(r),console.warn("Of the table content, ".concat(r," units width could not fit page"))),kP(e),xP(e,t),IP(e)}function AP(t,e){var n=t.scaleFactor(),i=e.settings.horizontalPageBreak,r=y0(t,e);e.allRows().forEach(function(o){for(var s=0,a=e.columns;s<a.length;s++){var c=a[s],u=o.cells[c.index];if(u){var f=e.hooks.didParseCell;e.callCellHooks(t,f,u,o,c,null);var p=u.padding("horizontal");u.contentWidth=yc(u.text,u.styles,t)+p;var v=yc(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,t);if(u.minReadableWidth=v+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||i===!0)u.contentWidth>r?(u.minWidth=r,u.wrappedWidth=r):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var m=10/n;u.minWidth=u.styles.minCellWidth||m,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(o){for(var s=0,a=e.columns;s<a.length;s++){var c=a[s],u=o.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var f=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},p=f.cellWidth||f.minCellWidth;p&&typeof p=="number"&&(c.minWidth=p,c.wrappedWidth=p)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function zd(t,e,n){for(var i=e,r=t.reduce(function(m,S){return m+S.wrappedWidth},0),o=0;o<t.length;o++){var s=t[o],a=s.wrappedWidth/r,c=i*a,u=s.width+c,f=n(s),p=u<f?f:u;e-=p-s.width,s.width=p}if(e=Math.round(e*1e10)/1e10,e){var v=t.filter(function(m){return e<0?m.width>n(m):!0});v.length&&(e=zd(v,e,n))}return e}function IP(t){for(var e={},n=1,i=t.allRows(),r=0;r<i.length;r++)for(var o=i[r],s=0,a=t.columns;s<a.length;s++){var c=a[s],u=e[c.index];if(n>1)n--,delete o.cells[c.index];else if(u)u.cell.height+=o.height,n=u.cell.colSpan,delete o.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var f=o.cells[c.index];if(!f)continue;if(f.height=o.height,f.rowSpan>1){var p=i.length-r,v=f.rowSpan>p?p:f.rowSpan;e[c.index]={cell:f,left:v,row:o}}}}}function kP(t){for(var e=t.allRows(),n=0;n<e.length;n++)for(var i=e[n],r=null,o=0,s=0,a=0;a<t.columns.length;a++){var c=t.columns[a];if(s-=1,s>1&&t.columns[a+1])o+=c.width,delete i.cells[c.index];else if(r){var u=r;delete i.cells[c.index],r=null,u.width=c.width+o}else{var u=i.cells[c.index];if(!u)continue;if(s=u.colSpan,o=0,u.colSpan>1){r=u,o+=c.width;continue}u.width=c.width+o}}}function xP(t,e){for(var n={count:0,height:0},i=0,r=t.allRows();i<r.length;i++){for(var o=r[i],s=0,a=t.columns;s<a.length;s++){var c=a[s],u=o.cells[c.index];if(u){e.applyStyles(u.styles,!0);var f=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,f+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=Bm(u.text,f,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=Bm(u.text,f,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var p=u.styles.overflow(u.text,f);typeof p=="string"?u.text=[p]:u.text=p}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var v=u.contentHeight/u.rowSpan;u.rowSpan>1&&n.count*n.height<v*u.rowSpan?n={height:v,count:u.rowSpan}:n&&n.count>0&&n.height>v&&(v=n.height),v>o.height&&(o.height=v)}}n.count--}}function Bm(t,e,n,i,r){return t.map(function(o){return LP(o,e,n,i,r)})}function LP(t,e,n,i,r){var o=1e4*i.scaleFactor();if(e=Math.ceil(e*o)/o,e>=yc(t,n,i))return t;for(;e<yc(t+r,n,i)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+r}function E0(t,e){var n=new Ns(t),i=PP(e,n.scaleFactor()),r=new CP(e,i);return TP(n,r),n.applyStyles(n.userStyles),r}function PP(t,e){var n=t.content,i=RP(n.columns);if(n.head.length===0){var r=Dm(i,"head");r&&n.head.push(r)}if(n.foot.length===0){var r=Dm(i,"foot");r&&n.foot.push(r)}var o=t.settings.theme,s=t.styles;return{columns:i,head:ju("head",n.head,i,s,o,e),body:ju("body",n.body,i,s,o,e),foot:ju("foot",n.foot,i,s,o,e)}}function ju(t,e,n,i,r,o){var s={},a=e.map(function(c,u){for(var f=0,p={},v=0,m=0,S=0,_=n;S<_.length;S++){var E=_[S];if(s[E.index]==null||s[E.index].left===0)if(m===0){var C=void 0;Array.isArray(c)?C=c[E.index-v-f]:C=c[E.dataKey];var k={};typeof C=="object"&&!Array.isArray(C)&&(k=(C==null?void 0:C.styles)||{});var I=MP(t,E,u,r,i,o,k),P=new C0(C,I,t);p[E.dataKey]=P,p[E.index]=P,m=P.colSpan-1,s[E.index]={left:P.rowSpan-1,times:m}}else m--,v++;else s[E.index].left--,m=s[E.index].times,f++}return new _0(c,u,t,p)});return a}function Dm(t,e){var n={};return t.forEach(function(i){if(i.raw!=null){var r=NP(e,i.raw);r!=null&&(n[i.dataKey]=r)}}),Object.keys(n).length>0?n:null}function NP(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function RP(t){return t.map(function(e,n){var i,r;return typeof e=="object"?r=(i=e.dataKey)!==null&&i!==void 0?i:n:r=n,new EP(r,e,n)})}function MP(t,e,n,i,r,o,s){var a=cP(i),c;t==="head"?c=r.headStyles:t==="body"?c=r.bodyStyles:t==="foot"&&(c=r.footStyles);var u=wr({},a.table,a[t],r.styles,c),f=r.columnStyles[e.dataKey]||r.columnStyles[e.index]||{},p=t==="body"?f:{},v=t==="body"&&n%2===0?wr({},a.alternateRow,r.alternateRowStyles):{},m=lP(o),S=wr({},m,u,v,p);return wr(S,s)}function BP(t,e,n){var i;n===void 0&&(n={});var r=y0(t,e),o=new Map,s=[],a=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(v){var m=e.columns.find(function(S){return S.dataKey===v||S.index===v});m&&!o.has(m.index)&&(o.set(m.index,!0),s.push(m.index),a.push(e.columns[m.index]),r-=m.wrappedWidth)});for(var u=!0,f=(i=n==null?void 0:n.start)!==null&&i!==void 0?i:0;f<e.columns.length;){if(o.has(f)){f++;continue}var p=e.columns[f].wrappedWidth;if(u||r>=p)u=!1,s.push(f),a.push(e.columns[f]),r-=p;else break;f++}return{colIndexes:s,columns:a,lastIndex:f-1}}function DP(t,e){for(var n=[],i=0;i<e.columns.length;i++){var r=BP(t,e,{start:i});r.columns.length&&(n.push(r),i=r.lastIndex)}return n}function T0(t,e){var n=e.settings,i=n.startY,r=n.margin,o={x:r.left,y:i},s=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),a=i+r.bottom+s;if(n.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(v,m){return v+m.height},0);a+=u}var f=new Ns(t);(n.pageBreak==="always"||n.startY!=null&&a>f.pageSize().height)&&(I0(f),o.y=r.top),e.callWillDrawPageHooks(f,o);var p=wr({},o);e.startPageNumber=f.pageNumber(),n.horizontalPageBreak?FP(f,e,p,o):(f.applyStyles(f.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&e.head.forEach(function(v){return Sr(f,e,v,o,e.columns)}),f.applyStyles(f.userStyles),e.body.forEach(function(v,m){var S=m===e.body.length-1;bc(f,e,v,S,p,o,e.columns)}),f.applyStyles(f.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&e.foot.forEach(function(v){return Sr(f,e,v,o,e.columns)})),m0(f,e,p,o),e.callEndPageHooks(f,o),e.finalY=o.y,t.lastAutoTable=e,f.applyStyles(f.userStyles)}function FP(t,e,n,i){var r=DP(t,e),o=e.settings;if(o.horizontalPageBreakBehaviour==="afterAllRows")r.forEach(function(u,f){t.applyStyles(t.userStyles),f>0?xa(t,e,n,i,u.columns,!0):Fm(t,e,i,u.columns),qP(t,e,n,i,u.columns),Qu(t,e,i,u.columns)});else for(var s=-1,a=r[0],c=function(){var u=s;if(a){t.applyStyles(t.userStyles);var f=a.columns;s>=0?xa(t,e,n,i,f,!0):Fm(t,e,i,f),u=qm(t,e,s+1,i,f),Qu(t,e,i,f)}var p=u-s;r.slice(1).forEach(function(v){t.applyStyles(t.userStyles),xa(t,e,n,i,v.columns,!0),qm(t,e,s+1,i,v.columns,p),Qu(t,e,i,v.columns)}),s=u};s<e.body.length-1;)c()}function Fm(t,e,n,i){var r=e.settings;t.applyStyles(t.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(o){return Sr(t,e,o,n,i)})}function qP(t,e,n,i,r){t.applyStyles(t.userStyles),e.body.forEach(function(o,s){var a=s===e.body.length-1;bc(t,e,o,a,n,i,r)})}function qm(t,e,n,i,r,o){t.applyStyles(t.userStyles),o=o??e.body.length;var s=Math.min(n+o,e.body.length),a=-1;return e.body.slice(n,s).forEach(function(c,u){var f=n+u===e.body.length-1,p=A0(t,e,f,i);c.canEntireRowFit(p,r)&&(Sr(t,e,c,i,r),a=n+u)}),a}function Qu(t,e,n,i){var r=e.settings;t.applyStyles(t.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(o){return Sr(t,e,o,n,i)})}function UP(t,e,n){var i=n.getLineHeight(t.styles.fontSize),r=t.padding("vertical"),o=Math.floor((e-r)/i);return Math.max(0,o)}function $P(t,e,n,i){var r={};t.spansMultiplePages=!0,t.height=0;for(var o=0,s=0,a=n.columns;s<a.length;s++){var c=a[s],u=t.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var f=new C0(u.raw,u.styles,u.section);f=wr(f,u),f.text=[];var p=UP(u,e,i);u.text.length>p&&(f.text=u.text.splice(p,u.text.length));var v=i.scaleFactor(),m=i.getLineHeightFactor();u.contentHeight=u.getContentHeight(v,m),u.contentHeight>=e&&(u.contentHeight=e,f.styles.minCellHeight-=e),u.contentHeight>t.height&&(t.height=u.contentHeight),f.contentHeight=f.getContentHeight(v,m),f.contentHeight>o&&(o=f.contentHeight),r[c.index]=f}}var S=new _0(t.raw,-1,t.section,r,!0);S.height=o;for(var _=0,E=n.columns;_<E.length;_++){var c=E[_],f=S.cells[c.index];f&&(f.height=S.height);var u=t.cells[c.index];u&&(u.height=t.height)}return S}function OP(t,e,n,i){var r=t.pageSize().height,o=i.settings.margin,s=o.top+o.bottom,a=r-s;e.section==="body"&&(a-=i.getHeadHeight(i.columns)+i.getFootHeight(i.columns));var c=e.getMinimumRowHeight(i.columns,t),u=c<n;if(c>a)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var f=e.hasRowSpan(i.columns),p=e.getMaxCellHeight(i.columns)>a;return p?(f&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(f||i.settings.rowPageBreak==="avoid")}function bc(t,e,n,i,r,o,s){var a=A0(t,e,i,o);if(n.canEntireRowFit(a,s))Sr(t,e,n,o,s);else if(OP(t,n,a,e)){var c=$P(n,a,e,t);Sr(t,e,n,o,s),xa(t,e,r,o,s),bc(t,e,c,i,r,o,s)}else xa(t,e,r,o,s),bc(t,e,n,i,r,o,s)}function Sr(t,e,n,i,r){i.x=e.settings.margin.left;for(var o=0,s=r;o<s.length;o++){var a=s[o],c=n.cells[a.index];if(!c){i.x+=a.width;continue}t.applyStyles(c.styles),c.x=i.x,c.y=i.y;var u=e.callCellHooks(t,e.hooks.willDrawCell,c,n,a,i);if(u===!1){i.x+=a.width;continue}HP(t,c,i);var f=c.getTextPos();h0(c.text,f.x,f.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,n,a,i),i.x+=a.width}i.y+=n.height}function HP(t,e,n){var i=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof i.lineWidth=="number"){var r=v0(i.lineWidth,i.fillColor);r&&t.rect(e.x,n.y,e.width,e.height,r)}else typeof i.lineWidth=="object"&&(i.fillColor&&t.rect(e.x,n.y,e.width,e.height,"F"),VP(t,e,n,i.lineWidth))}function VP(t,e,n,i){var r,o,s,a;i.top&&(r=n.x,o=n.y,s=n.x+e.width,a=n.y,i.right&&(s+=.5*i.right),i.left&&(r-=.5*i.left),c(i.top,r,o,s,a)),i.bottom&&(r=n.x,o=n.y+e.height,s=n.x+e.width,a=n.y+e.height,i.right&&(s+=.5*i.right),i.left&&(r-=.5*i.left),c(i.bottom,r,o,s,a)),i.left&&(r=n.x,o=n.y,s=n.x,a=n.y+e.height,i.top&&(o-=.5*i.top),i.bottom&&(a+=.5*i.bottom),c(i.left,r,o,s,a)),i.right&&(r=n.x+e.width,o=n.y,s=n.x+e.width,a=n.y+e.height,i.top&&(o-=.5*i.top),i.bottom&&(a+=.5*i.bottom),c(i.right,r,o,s,a));function c(u,f,p,v,m){t.getDocument().setLineWidth(u),t.getDocument().line(f,p,v,m,"S")}}function A0(t,e,n,i){var r=e.settings.margin.bottom,o=e.settings.showFoot;return(o==="everyPage"||o==="lastPage"&&n)&&(r+=e.getFootHeight(e.columns)),t.pageSize().height-i.y-r}function xa(t,e,n,i,r,o){r===void 0&&(r=[]),o===void 0&&(o=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!o&&e.foot.forEach(function(a){return Sr(t,e,a,i,r)}),e.callEndPageHooks(t,i);var s=e.settings.margin;m0(t,e,n,i),I0(t),e.pageNumber++,i.x=s.left,i.y=s.top,n.y=s.top,e.callWillDrawPageHooks(t,i),e.settings.showHead==="everyPage"&&(e.head.forEach(function(a){return Sr(t,e,a,i,r)}),t.applyStyles(t.userStyles))}function I0(t){var e=t.pageNumber();t.setPage(e+1);var n=t.pageNumber();return n===e?(t.addPage(),!0):!1}function GP(t){t.API.autoTable=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=e[0],r=S0(this,i),o=E0(this,r);return T0(this,o),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,n,i,r){h0(e,n,i,r,this)},t.API.autoTableSetDefaults=function(e){return Ns.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,n){Ns.setDefaults(e,n)},t.API.autoTableHtmlToJson=function(e,n){var i;if(n===void 0&&(n=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var r=new Ns(this),o=w0(r,e,window,n,!1),s=o.head,a=o.body,c=((i=s[0])===null||i===void 0?void 0:i.map(function(u){return u.content}))||[];return{columns:c,rows:a,data:a}}}var Xu;function wc(t,e){var n=S0(t,e),i=E0(t,n);T0(t,i)}try{if(typeof window<"u"&&window){var Um=window,$m=Um.jsPDF||((Xu=Um.jspdf)===null||Xu===void 0?void 0:Xu.jsPDF);$m&&GP($m)}}catch(t){console.error("Could not apply autoTable plugin",t)}let Zi=[],jn,Gr,Zu=!1;function Yr(t){var e;Ae({currentAirfreightStep:t}),Ei("trade-finance",t-1),document.querySelectorAll("#page-airfreight .service-step").forEach(n=>n.classList.remove("active")),(e=document.getElementById(`airfreight-step-${t}`))==null||e.classList.add("active"),t===4&&YP()}function WP(){const t=document.getElementById("page-airfreight");t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div class="service-page-header">
            <h2>Book Air Freight</h2>
            <p class="subtitle">Fast and reliable shipping for your time-sensitive cargo.</p>
        </div>
        <div class="form-container">
            <div class="visual-progress-bar" id="progress-bar-trade-finance">
                <div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div>
            </div>

            <!-- Step 1: Details -->
            <div id="airfreight-step-1" class="service-step">
                <form id="airfreight-details-form">
                    <h3>Route & Cargo Details</h3>
                    <div class="form-section two-column">
                        <div class="input-wrapper"><label for="airfreight-origin">Origin Airport (IATA)</label><input type="text" id="airfreight-origin" required placeholder="e.g., LHR"></div>
                        <div class="input-wrapper"><label for="airfreight-destination">Destination Airport (IATA)</label><input type="text" id="airfreight-destination" required placeholder="e.g., JFK"></div>
                    </div>
                    <div class="form-section">
                        <div class="input-wrapper"><label for="airfreight-cargo-description">Detailed Cargo Description</label><textarea id="airfreight-cargo-description" required placeholder="e.g., 10 boxes of smartphone batteries"></textarea></div>
                        <div class="hs-code-suggester-wrapper">
                            <div class="input-wrapper"><label for="airfreight-hs-code">HS Code</label><input type="text" id="airfreight-hs-code" placeholder="Auto-suggested from description"><div class="hs-code-suggestions" id="airfreight-hs-code-suggestions"></div></div>
                        </div>
                    </div>
                    <div class="form-actions"><button type="button" id="airfreight-to-dims-btn" class="main-submit-btn">Next: Dimensions</button></div>
                </form>
            </div>

            <!-- Step 2: Dimensions -->
            <div id="airfreight-step-2" class="service-step">
                <h3>Dimensions & Weight</h3>
                <div id="airfreight-cargo-list"></div>
                <button type="button" id="airfreight-add-piece-btn" class="secondary-btn">Add Piece</button>
                <div id="airfreight-cargo-summary" class="payment-overview" style="margin-top: 1rem;"></div>
                <div class="form-actions" style="justify-content: space-between">
                    <button type="button" id="airfreight-back-to-details-btn" class="secondary-btn">Back</button>
                    <button type="button" id="airfreight-to-quote-btn" class="main-submit-btn">Get Quote & Compliance</button>
                </div>
            </div>

            <!-- Step 3: Quote & Compliance -->
            <div id="airfreight-step-3" class="service-step">
                <h3>Quote & Compliance</h3>
                <div class="results-layout-grid">
                     <main id="airfreight-compliance-container" class="results-main-content"></main>
                     <aside id="airfreight-quote-sidebar" class="results-sidebar"></aside>
                </div>
                <div class="form-actions" style="justify-content: space-between;">
                    <button type="button" id="airfreight-back-to-dims-btn" class="secondary-btn">Back</button>
                    <button type="button" id="airfreight-to-agreement-btn" class="main-submit-btn">Proceed to Agreement</button>
                </div>
            </div>
            
            <!-- Step 4: Agreement -->
            <div id="airfreight-step-4" class="service-step">
                 <h3>Agreement & Finalization</h3>
                 <div class="two-column">
                    <div>
                        <h4>Booking Summary</h4>
                        <div id="airfreight-agreement-summary" class="payment-overview"></div>
                        <div class="checkbox-wrapper" style="margin-top: 1.5rem;"><input type="checkbox" id="airfreight-compliance-ack"><label for="airfreight-compliance-ack">I acknowledge my responsibility for providing the required compliance documents.</label></div>
                    </div>
                    <div>
                        <h4>Digital Signature</h4>
                        <div class="input-wrapper"><label for="airfreight-signer-name">Sign by Typing Your Full Name</label><input type="text" id="airfreight-signer-name"></div>
                        <label>Sign in the box below</label>
                        <canvas id="airfreight-signature-pad" width="400" height="150" style="border: 2px solid var(--border-color); border-radius: 8px; cursor: crosshair;"></canvas>
                    </div>
                 </div>
                 <div class="form-actions" style="justify-content: space-between;">
                    <button type="button" id="airfreight-back-to-compliance-btn" class="secondary-btn">Back</button>
                    <button type="button" id="airfreight-confirm-booking-btn" class="main-submit-btn" disabled>Confirm Booking Request</button>
                </div>
            </div>

            <!-- Step 5: Confirmation -->
            <div id="airfreight-step-5" class="service-step">
                <div class="confirmation-container">
                    <h3>Booking Request Confirmed!</h3>
                    <p>Your Air Freight booking is confirmed. Our operations team will be in touch to coordinate the next steps.</p>
                    <div class="confirmation-tracking"><h4>Booking ID</h4><div class="tracking-id-display" id="airfreight-booking-id"></div></div>
                    <div class="confirmation-actions">
                         <button id="airfreight-download-pdf-btn" class="secondary-btn">Download Summary (PDF)</button>
                         <button id="airfreight-new-shipment-btn" class="main-submit-btn">New Shipment</button>
                    </div>
                </div>
            </div>
        </div>
    `)}function k0(){const t=document.getElementById("airfreight-cargo-list");t&&(t.innerHTML=Zi.map((e,n)=>`
        <div class="airfreight-cargo-item card" data-index="${n}">
             <div class="form-grid" style="grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 1rem; align-items: flex-end;">
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Pieces</label><input type="number" class="airfreight-cargo-pieces" value="${e.pieces}" min="1" required></div>
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Length(cm)</label><input type="number" class="airfreight-cargo-length" value="${e.length}" min="1" required></div>
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Width(cm)</label><input type="number" class="airfreight-cargo-width" value="${e.width}" min="1" required></div>
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Height(cm)</label><input type="number" class="airfreight-cargo-height" value="${e.height}" min="1" required></div>
                <div class="input-wrapper" style="margin-bottom: 0;"><label>Weight(kg)</label><input type="number" class="airfreight-cargo-weight" value="${e.weight}" min="1" required></div>
                <button type="button" class="secondary-btn airfreight-remove-piece-btn" style="margin-bottom: 0.5rem;">Remove</button>
            </div>
        </div>
    `).join(""),P0())}function x0(){Zi.push({id:Date.now(),pieces:1,length:50,width:50,height:50,weight:20}),k0()}function L0(){const t=[];return document.querySelectorAll(".airfreight-cargo-item").forEach(e=>{t.push({id:Date.now(),pieces:parseInt(e.querySelector(".airfreight-cargo-pieces").value,10)||0,length:parseInt(e.querySelector(".airfreight-cargo-length").value,10)||0,width:parseInt(e.querySelector(".airfreight-cargo-width").value,10)||0,height:parseInt(e.querySelector(".airfreight-cargo-height").value,10)||0,weight:parseInt(e.querySelector(".airfreight-cargo-weight").value,10)||0})}),Zi=t,P0()}function P0(){const t=document.getElementById("airfreight-cargo-summary");if(!t)return 0;let e=0,n=0;Zi.forEach(r=>{e+=r.length*r.width*r.height/1e6*r.pieces,n+=r.weight*r.pieces});const i=Math.max(n,e*167);return Zi.length>0?t.innerHTML=`
            <div class="review-item"><span>Total Actual Weight:</span><strong>${n.toFixed(2)} kg</strong></div>
            <div class="review-item"><span>Total Volume:</span><strong>${e.toFixed(3)} m³</strong></div>
            <div class="review-item total"><span>Chargeable Weight:</span><strong>${i.toFixed(2)} kg</strong></div>
        `:t.innerHTML="",i}async function zP(){const t=L0();if(Zi.length===0){Ee("Please add at least one cargo piece.","error");return}const e={originAirport:document.getElementById("airfreight-origin").value,destAirport:document.getElementById("airfreight-destination").value,cargoDescription:document.getElementById("airfreight-cargo-description").value,hsCode:document.getElementById("airfreight-hs-code").value,cargoPieces:Zi,chargeableWeight:t,serviceLevel:"standard",cargoCategory:""};Ae({airfreightDetails:e}),rt(!0,"Getting air freight quotes...");try{await Nc();let n=0;Zi.forEach(u=>{n+=u.length*u.width*u.height/1e6*u.pieces});let i,r=!1,o=!1;const s=await Ga();if(s){const u={weight:t,volume:n},f=Lf("airfreight",e.originAirport,e.destAirport,u);if(f&&f.length>0){i=f[0],r=!0,o=!0;const p=Nf("airfreight",e.originAirport,e.destAirport,u);Ee(`✅ Using cached air freight rate (${p.hoursRemaining}h valid)`,"success",3e3),console.log("[Air Freight] Cache hit, saved 1 API call!")}}if(!o&&s)try{console.log("✅ Subscription active - fetching live air freight quotes...");const u=await QL({country:"UK",city:e.originAirport},{country:"US",city:e.destAirport},{weight:t,volume:n});if(u&&u.length>0){const f=u[0],p=f.price,v=p*(1+An.airfreight.standard);i={carrierName:f.carrier,carrierType:"Air Carrier",estimatedTransitTime:f.transitTime,chargeableWeight:t,chargeableWeightUnit:"KG",weightBasis:"Chargeable Weight",isSpecialOffer:!1,totalCost:v,costBreakdown:{baseShippingCost:p,fuelSurcharge:p*.2,estimatedCustomsAndTaxes:0,optionalInsuranceCost:0,ourServiceFee:v-p},serviceProvider:`SeaRates (${f.carrier})`};const m={weight:t,volume:n};Pf("airfreight",e.originAirport,e.destAirport,m,[i]),r=!0,Ee("✅ Live air freight quote! Valid for 24 hours.","success",3e3)}else throw new Error("No quotes returned from SeaRates")}catch(u){console.log("❌ SeaRates API error, falling back to AI:",u.message)}if(!r){const u=await kf();console.log(`💡 Using AI estimate: ${u}`);const p=(3.5+Math.random()*2)*t;i={carrierName:"Lufthansa Cargo",carrierType:"Air Carrier",estimatedTransitTime:"3-5 days",chargeableWeight:t,chargeableWeightUnit:"KG",weightBasis:"Chargeable Weight",isSpecialOffer:!1,totalCost:p*1.1,costBreakdown:{baseShippingCost:p,fuelSurcharge:p*.2,estimatedCustomsAndTaxes:0,optionalInsuranceCost:0,ourServiceFee:p*.1},serviceProvider:"Vcanship AI Estimate"},!s&&j.isLoggedIn?Ee("💡 AI estimate - Upgrade to Premium ($9.99/mo) for live rates!","info",5e3):j.isLoggedIn?Ee("AI estimate - We'll email confirmed rates soon.","info",4e3):Ee("AI estimate. Log in & subscribe for live air freight rates.","info",4e3)}const a=[{id:"doc-awb",title:"Air Waybill (AWB)",description:"The primary transport document for your air freight.",required:!0},{id:"doc-ci",title:"Commercial Invoice",description:"A customs document detailing the goods and their value.",required:!0},{id:"doc-pl",title:"Packing List",description:"Details the contents of the shipment.",required:!0}];(e.cargoDescription.toLowerCase().includes("batteries")||e.cargoDescription.toLowerCase().includes("lithium"))&&a.push({id:"doc-dgd",title:"Dangerous Goods Declaration (DGD)",description:"Required for items containing lithium batteries.",required:!0}),(e.cargoDescription.toLowerCase().includes("food")||e.cargoDescription.toLowerCase().includes("plant"))&&a.push({id:"doc-phyto",title:"Phytosanitary Certificate",description:"Required for shipping organic materials like food or plants.",required:!0});const c=a.map(u=>({...u,status:"pending",file:null}));if(!r)try{const u=await Mc("Air Freight");u&&await Rc({serviceType:"Air Freight",customerInfo:u,shipmentDetails:e,aiEstimate:i})}catch(u){console.log("Customer info capture skipped:",u)}Ae({airfreightQuote:i,airfreightComplianceDocs:c}),JP(),Yr(3)}catch(n){console.error("Air freight quote error:",n),Ee("Failed to get quote and compliance.","error")}finally{rt(!1)}}function JP(){const{airfreightQuote:t,airfreightComplianceDocs:e,airfreightDetails:n}=j,i=document.getElementById("airfreight-quote-sidebar"),r=document.getElementById("airfreight-compliance-container");i&&t&&n&&(i.innerHTML=`
            <div class="results-section"><h3>Route</h3><p><strong>From:</strong> ${n.originAirport} <strong>To:</strong> ${n.destAirport}</p></div>
            <div class="results-section">
                 <h3>AI-Generated Quote</h3>
                 <div class="payment-overview">
                    <div class="review-item"><span>Carrier:</span><strong>${t.carrierName}</strong></div>
                    <div class="review-item"><span>Transit Time:</span><strong>~${t.estimatedTransitTime}</strong></div>
                    <hr>
                    <div class="review-item total"><span>Est. Total Cost:</span><strong>${j.currentCurrency.symbol}${t.totalCost.toFixed(2)}</strong></div>
                 </div>
            </div>
        `),r&&e&&(r.innerHTML=`
            <h3>Compliance Checklist</h3>
            <p class="subtitle" style="text-align: left; margin: 0 0 1rem;">Upload the required documents for your shipment.</p>
            <div id="airfreight-compliance-checklist" class="compliance-checklist">
                ${e.map(o=>`
                    <div class="compliance-doc-item" id="${o.id}" data-status="${o.status}">
                        <div class="compliance-doc-info"><h4>${o.title} ${o.required?"<span>(Required)</span>":""}</h4><p>${o.description}</p></div>
                        <div class="file-drop-area"><div class="file-drop-area-idle"><span>Drop file or click</span></div><div class="file-drop-area-uploaded" style="display: none;"></div><input type="file" class="file-input" data-doc-id="${o.id}"></div>
                    </div>
                `).join("")}
            </div>
        `)}function YP(){if(jn=document.getElementById("airfreight-signature-pad"),!jn)return;Gr=jn.getContext("2d"),Gr.strokeStyle="#212121",Gr.lineWidth=2;const t=i=>{Zu=!0,n(i)},e=()=>{Zu=!1,Gr.beginPath(),Jd()},n=i=>{if(!Zu)return;i.preventDefault();const r=jn.getBoundingClientRect(),o=i instanceof MouseEvent?i:i.touches[0];Gr.lineTo(o.clientX-r.left,o.clientY-r.top),Gr.stroke(),Gr.beginPath(),Gr.moveTo(o.clientX-r.left,o.clientY-r.top)};jn.addEventListener("mousedown",t),jn.addEventListener("mouseup",e),jn.addEventListener("mousemove",n),jn.addEventListener("touchstart",t),jn.addEventListener("touchend",e),jn.addEventListener("touchmove",n)}function Jd(){const t=document.getElementById("airfreight-compliance-ack").checked,e=document.getElementById("airfreight-signer-name").value.trim();document.getElementById("airfreight-confirm-booking-btn").disabled=!(t&&e&&!KP())}function KP(){return jn?!jn.getContext("2d").getImageData(0,0,jn.width,jn.height).data.some(t=>t!==0):!0}function jP(){const{airfreightDetails:t,airfreightQuote:e,airfreightBookingId:n}=j;if(!t||!e||!n){Ee("Cannot generate PDF, missing data.","error");return}const i=new Oe;i.text("Air Freight Booking Summary",14,20),i.text(`Booking ID: ${n}`,14,28),wc(i,{startY:35,head:[["Detail","Information"]],body:[["Route",`${t.originAirport} -> ${t.destAirport}`],["Cargo",t.cargoDescription],["Chargeable Weight",`${t.chargeableWeight.toFixed(2)} KG`],["Carrier",e.carrierName],["Est. Transit",e.estimatedTransitTime],["Est. Total Cost",`${j.currentCurrency.symbol}${e.totalCost.toFixed(2)}`]]});const r=t.cargoPieces.map(o=>[o.pieces,`${o.length}x${o.width}x${o.height}cm`,`${o.weight}kg`]);wc(i,{startY:i.lastAutoTable.finalY+10,head:[["Pieces","Dimensions","Weight"]],body:r}),i.save(`Vcanship_AIR_${n}.pdf`)}function QP(){var s,a,c,u,f,p,v,m,S,_,E,C,k;const t=document.getElementById("page-airfreight");if(!t)return;(s=t.querySelector(".back-btn"))==null||s.addEventListener("click",()=>bt("landing")),(a=document.getElementById("airfreight-to-dims-btn"))==null||a.addEventListener("click",()=>Yr(2)),(c=document.getElementById("airfreight-back-to-details-btn"))==null||c.addEventListener("click",()=>Yr(1)),(u=document.getElementById("airfreight-to-quote-btn"))==null||u.addEventListener("click",zP),(f=document.getElementById("airfreight-back-to-dims-btn"))==null||f.addEventListener("click",()=>Yr(2)),(p=document.getElementById("airfreight-to-agreement-btn"))==null||p.addEventListener("click",()=>{const I=document.getElementById("airfreight-agreement-summary");I&&j.airfreightQuote&&(I.innerHTML=document.querySelector("#airfreight-quote-sidebar .payment-overview").innerHTML),Yr(4)}),(v=document.getElementById("airfreight-back-to-compliance-btn"))==null||v.addEventListener("click",()=>Yr(3)),(m=document.getElementById("airfreight-confirm-booking-btn"))==null||m.addEventListener("click",()=>{const I=`AIR-${Date.now().toString().slice(-6)}`;Ae({airfreightBookingId:I}),document.getElementById("airfreight-booking-id").textContent=I,Yr(5)}),(S=document.getElementById("airfreight-new-shipment-btn"))==null||S.addEventListener("click",N0),(_=document.getElementById("airfreight-download-pdf-btn"))==null||_.addEventListener("click",jP),(E=document.getElementById("airfreight-add-piece-btn"))==null||E.addEventListener("click",x0);const e=document.getElementById("airfreight-cargo-list");e==null||e.addEventListener("click",I=>{var P;if(I.target.closest(".airfreight-remove-piece-btn")){const G=parseInt(((P=I.target.closest(".airfreight-cargo-item"))==null?void 0:P.dataset.index)||"-1");G>-1&&(Zi.splice(G,1),k0())}}),e==null||e.addEventListener("change",L0),(C=document.getElementById("airfreight-compliance-ack"))==null||C.addEventListener("change",Jd),(k=document.getElementById("airfreight-signer-name"))==null||k.addEventListener("input",Jd);let n;const i=document.getElementById("airfreight-cargo-description"),r=document.getElementById("airfreight-hs-code"),o=document.getElementById("airfreight-hs-code-suggestions");i==null||i.addEventListener("input",()=>{if(clearTimeout(n),!o)return;const I=i.value.trim();if(I.length<5){o.classList.remove("active");return}n=window.setTimeout(async()=>{const P=await hf(I);P.length>0?(o.innerHTML=P.map(G=>`<div class="hs-code-suggestion-item" data-code="${G.code}"><strong>${G.code}</strong> - ${G.description}</div>`).join(""),o.classList.add("active"),r.value===""&&(r.value=P[0].code)):o.classList.remove("active")},500)}),o==null||o.addEventListener("click",I=>{const P=I.target.closest(".hs-code-suggestion-item");P!=null&&P.dataset.code&&(r.value=P.dataset.code,o.classList.remove("active"))})}function N0(){Ae({currentService:"airfreight"}),F1(),Zi=[],WP(),bt("airfreight"),QP(),Yr(1),x0()}let Qn,Wr,ed=!1;async function XP(t){await new Promise(r=>setTimeout(r,1500));const e=1200+Math.random()*500;return{quote:{carrierName:"Hoegh Autoliners",carrierType:"RoRo Carrier",estimatedTransitTime:"25-30 days",chargeableWeight:0,chargeableWeightUnit:"N/A",weightBasis:"Per Vehicle",isSpecialOffer:!1,totalCost:e*(1+An.vehicle.standard),costBreakdown:{baseShippingCost:e,fuelSurcharge:e*.15,estimatedCustomsAndTaxes:0,optionalInsuranceCost:0,ourServiceFee:e*An.vehicle.standard-e*.15},serviceProvider:"Vcanship AI"},complianceReport:{status:"Action Required",summary:"Standard documents are required for international vehicle shipping.",requirements:[{id:"doc-title",title:"Vehicle Title / Registration",description:"Proof of ownership for the vehicle being shipped.",required:!0},{id:"doc-bos",title:"Bill of Sale",description:"A dated bill of sale if the vehicle was recently purchased.",required:!0},{id:"doc-id",title:"Shipper's Photo ID",description:"A valid government-issued ID (e.g., Passport, Driver's License).",required:!0}]}}}function Kr(t){var e;Ae({currentVehicleStep:t}),Ei("trade-finance",t-1),document.querySelectorAll("#page-vehicle .service-step").forEach(n=>n.classList.remove("active")),(e=document.getElementById(`vehicle-step-${t}`))==null||e.classList.add("active"),t===4&&nN()}function ZP(){const t=document.getElementById("page-vehicle");t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div class="service-page-header">
            <h2>Ship a Vehicle</h2>
            <p class="subtitle">Reliable RoRo and container shipping for your car, motorcycle, or machinery.</p>
        </div>
        <div class="form-container">
            <div class="visual-progress-bar" id="progress-bar-trade-finance">
                <div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div>
            </div>

            <!-- Step 1: Details -->
            <div id="vehicle-step-1" class="service-step">
                <form id="vehicle-details-form">
                    <h3>Vehicle & Route</h3>
                    <div class="form-section two-column">
                        <div class="input-wrapper"><label for="vehicle-origin-port">Origin Port</label><input type="text" id="vehicle-origin-port" required placeholder="e.g., Southampton, GB"></div>
                        <div class="input-wrapper"><label for="vehicle-dest-port">Destination Port</label><input type="text" id="vehicle-dest-port" required placeholder="e.g., New York, US"></div>
                    </div>
                     <div class="form-section two-column">
                        <div class="input-wrapper"><label for="vehicle-make">Make</label><input type="text" id="vehicle-make" required placeholder="e.g., Toyota"></div>
                        <div class="input-wrapper"><label for="vehicle-model">Model</label><input type="text" id="vehicle-model" required placeholder="e.g., Camry"></div>
                        <div class="input-wrapper"><label for="vehicle-year">Year</label><input type="number" id="vehicle-year" required placeholder="e.g., 2022" min="1900" max="2025"></div>
                        <div class="input-wrapper"><label for="vehicle-condition">Condition</label>
                            <select id="vehicle-condition">
                                <option value="operable">Operable (Runs and Drives)</option>
                                <option value="inoperable">Inoperable (Needs towing/forklift)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-actions"><button type="submit" class="main-submit-btn">Get Quote & Compliance</button></div>
                </form>
            </div>

            <!-- Step 2: Quote -->
            <div id="vehicle-step-2" class="service-step">
                <h3>AI-Powered Estimate</h3>
                <div id="vehicle-quote-container" class="payment-overview card"></div>
                <div class="form-actions" style="justify-content: space-between;">
                    <button type="button" id="vehicle-back-to-details-btn" class="secondary-btn">Back</button>
                    <button type="button" id="vehicle-to-compliance-btn" class="main-submit-btn">Proceed</button>
                </div>
            </div>

            <!-- Step 3: Compliance -->
            <div id="vehicle-step-3" class="service-step">
                <h3>Compliance Documents</h3>
                <p class="subtitle">Please upload the following required documents for your vehicle shipment.</p>
                <div id="vehicle-compliance-checklist" class="compliance-checklist"></div>
                <div class="form-actions" style="justify-content: space-between;">
                    <button type="button" id="vehicle-back-to-quote-btn" class="secondary-btn">Back</button>
                    <button type="button" id="vehicle-to-agreement-btn" class="main-submit-btn">Proceed to Agreement</button>
                </div>
            </div>
            
            <!-- Step 4: Agreement -->
            <div id="vehicle-step-4" class="service-step">
                 <h3>Agreement & Finalization</h3>
                 <div class="two-column">
                    <div>
                        <h4>Booking Summary</h4>
                        <div id="vehicle-agreement-summary" class="payment-overview"></div>
                        <div class="checkbox-wrapper" style="margin-top: 1.5rem;"><input type="checkbox" id="vehicle-compliance-ack"><label for="vehicle-compliance-ack">I acknowledge that all information and documents provided are accurate.</label></div>
                    </div>
                    <div>
                        <h4>Digital Signature</h4>
                        <div class="input-wrapper"><label for="vehicle-signer-name">Sign by Typing Your Full Name</label><input type="text" id="vehicle-signer-name"></div>
                        <label>Sign in the box below</label>
                        <canvas id="vehicle-signature-pad" width="400" height="150" style="border: 2px solid var(--border-color); border-radius: 8px; cursor: crosshair;"></canvas>
                    </div>
                 </div>
                 <div class="form-actions" style="justify-content: space-between;">
                    <button type="button" id="vehicle-back-to-compliance-btn" class="secondary-btn">Back</button>
                    <button type="button" id="vehicle-confirm-booking-btn" class="main-submit-btn" disabled>Confirm Booking Request</button>
                </div>
            </div>

            <!-- Step 5: Confirmation -->
            <div id="vehicle-step-5" class="service-step">
                 <div class="confirmation-container">
                    <h3>Booking Request Sent!</h3>
                    <p>Your vehicle shipping request has been received. Our team will be in touch via email to finalize the details.</p>
                    <div class="confirmation-tracking"><h4>Booking ID</h4><div class="tracking-id-display" id="vehicle-booking-id"></div></div>
                    <div class="confirmation-actions">
                        <button id="vehicle-download-pdf-btn" class="secondary-btn">Download Summary (PDF)</button>
                        <button id="vehicle-new-shipment-btn" class="main-submit-btn">Book Another Vehicle</button>
                    </div>
                </div>
            </div>
        </div>
    `)}async function eN(t){t.preventDefault(),rt(!0,"Analyzing your vehicle shipment...");const e={originPort:document.getElementById("vehicle-origin-port").value,destPort:document.getElementById("vehicle-dest-port").value,make:document.getElementById("vehicle-make").value,model:document.getElementById("vehicle-model").value,year:parseInt(document.getElementById("vehicle-year").value),condition:document.getElementById("vehicle-condition").value,canRollOnDeck:!0,length:0,width:0,height:0,weight:0};Ae({vehicleDetails:e});try{const{quote:n,complianceReport:i}=await XP(e),r=i.requirements.map(s=>({...s,status:"pending",file:null}));Ae({vehicleQuote:n,vehicleComplianceDocs:r});const o=document.getElementById("vehicle-quote-container");o&&(o.innerHTML=`
                <div class="review-item"><span>Route:</span><strong>${e.originPort} &rarr; ${e.destPort}</strong></div>
                <div class="review-item"><span>Vehicle:</span><strong>${e.year} ${e.make} ${e.model}</strong></div>
                <hr>
                <div class="review-item total"><span>Estimated RoRo Cost:</span><strong>${j.currentCurrency.symbol}${n.totalCost.toFixed(2)}</strong></div>
            `),tN(),Kr(2)}catch(n){console.error("Vehicle quote error:",n),Ee("Could not generate an estimate. Please try again.","error")}finally{rt(!1)}}function tN(){const t=document.getElementById("vehicle-compliance-checklist");t&&(t.innerHTML=j.vehicleComplianceDocs.map(e=>`
        <div class="compliance-doc-item" id="${e.id}" data-status="${e.status}">
            <div class="compliance-doc-info"><h4>${e.title} ${e.required?"<span>(Required)</span>":""}</h4><p>${e.description}</p></div>
            <div class="file-drop-area"><div class="file-drop-area-idle"><span>Drop file or click</span></div><div class="file-drop-area-uploaded" style="display: none;"></div><input type="file" class="file-input" data-doc-id="${e.id}"></div>
        </div>
    `).join(""))}function nN(){if(Qn=document.getElementById("vehicle-signature-pad"),!Qn)return;Wr=Qn.getContext("2d"),Wr.strokeStyle="#212121",Wr.lineWidth=2;const t=i=>{ed=!0,n(i)},e=()=>{ed=!1,Wr.beginPath(),Yd()},n=i=>{if(!ed)return;i.preventDefault();const r=Qn.getBoundingClientRect(),o=i instanceof MouseEvent?i:i.touches[0];Wr.lineTo(o.clientX-r.left,o.clientY-r.top),Wr.stroke(),Wr.beginPath(),Wr.moveTo(o.clientX-r.left,o.clientY-r.top)};Qn.addEventListener("mousedown",t),Qn.addEventListener("mouseup",e),Qn.addEventListener("mousemove",n),Qn.addEventListener("touchstart",t),Qn.addEventListener("touchend",e),Qn.addEventListener("touchmove",n)}function Yd(){const t=document.getElementById("vehicle-compliance-ack").checked,e=document.getElementById("vehicle-signer-name").value.trim(),n=Qn&&!Qn.getContext("2d").getImageData(0,0,Qn.width,Qn.height).data.some(i=>i!==0);document.getElementById("vehicle-confirm-booking-btn").disabled=!(t&&e&&!n)}function iN(){const{vehicleDetails:t,vehicleQuote:e,vehicleBookingId:n}=j;if(!t||!e||!n)return;const i=new Oe;i.text("Vehicle Shipping Summary",14,20),i.text(`Booking ID: ${n}`,14,28),wc(i,{startY:35,head:[["Detail","Information"]],body:[["Route",`${t.originPort} -> ${t.destPort}`],["Vehicle",`${t.year} ${t.make} ${t.model}`],["Condition",t.condition],["Carrier",e.carrierName],["Est. Total Cost",`${j.currentCurrency.symbol}${e.totalCost.toFixed(2)}`]]}),i.save(`Vcanship_VEH_${n}.pdf`)}function rN(){var e,n,i,r,o,s,a,c,u,f,p,v;const t=document.getElementById("page-vehicle");t&&((e=t.querySelector(".back-btn"))==null||e.addEventListener("click",()=>bt("landing")),(n=document.getElementById("vehicle-details-form"))==null||n.addEventListener("submit",eN),(i=document.getElementById("vehicle-back-to-details-btn"))==null||i.addEventListener("click",()=>Kr(1)),(r=document.getElementById("vehicle-to-compliance-btn"))==null||r.addEventListener("click",()=>Kr(3)),(o=document.getElementById("vehicle-back-to-quote-btn"))==null||o.addEventListener("click",()=>Kr(2)),(s=document.getElementById("vehicle-to-agreement-btn"))==null||s.addEventListener("click",()=>{const m=document.getElementById("vehicle-agreement-summary");m&&(m.innerHTML=document.getElementById("vehicle-quote-container").innerHTML),Kr(4)}),(a=document.getElementById("vehicle-back-to-compliance-btn"))==null||a.addEventListener("click",()=>Kr(3)),(c=document.getElementById("vehicle-confirm-booking-btn"))==null||c.addEventListener("click",()=>{const m=`VEH-${Date.now().toString().slice(-6)}`;Ae({vehicleBookingId:m}),document.getElementById("vehicle-booking-id").textContent=m,Kr(5)}),(u=document.getElementById("vehicle-new-shipment-btn"))==null||u.addEventListener("click",R0),(f=document.getElementById("vehicle-download-pdf-btn"))==null||f.addEventListener("click",iN),(p=document.getElementById("vehicle-compliance-ack"))==null||p.addEventListener("change",Yd),(v=document.getElementById("vehicle-signer-name"))==null||v.addEventListener("input",Yd))}function R0(){Ae({currentService:"vehicle"}),D1(),ZP(),bt("vehicle"),rN(),Kr(1)}function La(t){var e;Ei("trade-finance",t-1),document.querySelectorAll("#page-railway .service-step").forEach(n=>n.classList.remove("active")),(e=document.getElementById(`railway-step-${t}`))==null||e.classList.add("active")}function M0(){const t=document.getElementById("page-railway");t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div class="service-page-header">
            <h2>Book Railway Freight</h2>
            <p class="subtitle">An efficient and eco-friendly option for overland logistics.</p>
        </div>
        <div class="form-container">
            <div class="visual-progress-bar" id="progress-bar-trade-finance">
                <div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div>
            </div>

            <!-- Step 1: Details -->
            <div id="railway-step-1" class="service-step">
                <form id="railway-details-form">
                    <h3>Route & Cargo</h3>
                    <div class="form-section two-column">
                        <div class="input-wrapper"><label for="railway-origin">Origin Terminal</label><input type="text" id="railway-origin" required placeholder="e.g., Chongqing, China"></div>
                        <div class="input-wrapper"><label for="railway-destination">Destination Terminal</label><input type="text" id="railway-destination" required placeholder="e.g., Duisburg, Germany"></div>
                    </div>
                     <div class="form-section">
                        <div class="input-wrapper">
                            <label for="railway-cargo-type">Cargo Type</label>
                            <select id="railway-cargo-type">
                                <option value="standard-container-40ft">Standard 40ft Container</option>
                                <option value="standard-container-20ft">Standard 20ft Container</option>
                                <option value="bulk-wagon">Bulk Wagon</option>
                            </select>
                        </div>
                        <div class="input-wrapper"><label for="railway-cargo-weight">Cargo Weight (Tons)</label><input type="number" id="railway-cargo-weight" required min="1"></div>
                    </div>
                    <div class="form-actions"><button type="submit" class="main-submit-btn">Get AI Estimate</button></div>
                </form>
            </div>

            <!-- Step 2: Quote -->
            <div id="railway-step-2" class="service-step">
                <h3>Your AI-Powered Estimate</h3>
                <div id="railway-quote-container"></div>
                <div class="quote-confirmation-panel">
                    <h4>Please Note: This is an AI Estimate</h4>
                    <p>This is an estimated price based on current market rates for terminal-to-terminal rail freight. A Vcanship agent will contact you to confirm all details and provide a final quote.</p>
                </div>
                <div class="form-actions">
                    <button type="button" id="railway-back-to-details" class="secondary-btn">Back</button>
                    <button type="button" id="railway-request-booking" class="main-submit-btn">Request Final Quote</button>
                </div>
            </div>

            <!-- Step 3: Confirmation -->
            <div id="railway-step-3" class="service-step">
                 <div class="confirmation-container">
                    <h3>Booking Request Sent!</h3>
                    <p>Your railway freight request has been received. Our team will be in touch shortly.</p>
                    <div class="confirmation-tracking">
                        <h4>Reference ID</h4>
                        <div class="tracking-id-display" id="railway-reference-id"></div>
                    </div>
                    <div class="confirmation-actions">
                        <button id="railway-new-shipment-btn" class="main-submit-btn">Book Another Rail Shipment</button>
                    </div>
                </div>
            </div>
        </div>
    `)}async function oN(t){t.preventDefault(),rt(!0,"Calculating railway estimate...");const e=document.getElementById("railway-origin").value,n=document.getElementById("railway-destination").value,i=document.getElementById("railway-cargo-type").value,r=document.getElementById("railway-cargo-weight").value;try{if(await Nc(),!j.api)throw new Error("AI API not initialized.");const o=`
            Act as a logistics pricing expert for railway freight.
            - Origin Terminal: ${e}
            - Destination Terminal: ${n}
            - Cargo: ${i}, ${r} tons
            - Currency: ${j.currentCurrency.code}

            Provide a single estimated base cost for the freight as a number. Do not add any other text or formatting.
        `,s=await j.api.models.generateContent({model:"gemini-2.5-flash",contents:o}),a=parseFloat(s.text);if(isNaN(a))throw new Error("Invalid AI response.");const c=An.railway.standard,u=a*(1+c),f=document.getElementById("railway-quote-container");f&&(f.innerHTML=`
                <div class="payment-overview">
                    <div class="review-item"><span>Route:</span><strong>${e} &rarr; ${n}</strong></div>
                    <div class="review-item"><span>Cargo:</span><strong>${i} (${r} tons)</strong></div>
                    <div class="review-item"><span>Source:</span><strong>AI Estimate</strong></div>
                    <hr>
                    <div class="review-item total"><span>Estimated Cost:</span><strong>${j.currentCurrency.symbol}${u.toFixed(2)}</strong></div>
                </div>
            `);try{const p=await Mc("Railway");p&&await Rc({serviceType:"Railway",customerInfo:p,shipmentDetails:{origin:e,destination:n,cargoType:i,weight:`${r} tons`},aiEstimate:{totalCost:u,currency:j.currentCurrency.code}})}catch(p){console.log("Customer info capture skipped:",p)}Ee("AI estimate generated. We'll email confirmed rates.","info",4e3),La(2)}catch(o){console.error("Railway quote error:",o),Ee("Could not generate an estimate. Please try again.","error")}finally{rt(!1)}}function B0(){var t,e,n,i,r;(t=document.querySelector("#page-railway .back-btn"))==null||t.addEventListener("click",()=>bt("landing")),(e=document.getElementById("railway-details-form"))==null||e.addEventListener("submit",oN),(n=document.getElementById("railway-back-to-details"))==null||n.addEventListener("click",()=>La(1)),(i=document.getElementById("railway-request-booking"))==null||i.addEventListener("click",()=>{const o=`RWY-${Date.now().toString().slice(-6)}`;document.getElementById("railway-reference-id").textContent=o,La(3),Ee("Request sent!","success")}),(r=document.getElementById("railway-new-shipment-btn"))==null||r.addEventListener("click",()=>{Km(),M0(),B0(),La(1)})}function sN(){Ae({currentService:"railway"}),Km(),M0(),bt("railway"),B0(),La(1)}let Mi,zr,td=!1;async function aN(t){return await new Promise(n=>setTimeout(n,1500)),[{driverName:"John D.",driverRating:4.8,etaPickupMin:45,price:450,vehicleType:"26t Rigid Truck",gps_lat:0,gps_lon:0},{driverName:"Mike S.",driverRating:4.9,etaPickupMin:60,price:510,vehicleType:"Curtain Sider",gps_lat:0,gps_lon:0},{driverName:"Alex P.",driverRating:4.6,etaPickupMin:90,price:380,vehicleType:"18t Rigid Truck",gps_lat:0,gps_lon:0}].map(n=>({...n,id:`truck-${Math.random()}`}))}function Rs(t){var e;Ae({currentInlandStep:t}),Ei("trade-finance",t-1),document.querySelectorAll("#page-inland .service-step").forEach(n=>n.classList.remove("active")),(e=document.getElementById(`inland-step-${t}`))==null||e.classList.add("active"),t===3&&dN()}function lN(){const t=document.getElementById("page-inland");t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div class="service-page-header">
            <h2>Book Inland Trucking</h2>
            <p class="subtitle">Reliable FTL and LTL services for your domestic and cross-border needs.</p>
        </div>
        <div class="form-container">
            <div class="visual-progress-bar" id="progress-bar-trade-finance">
                <div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div>
            </div>

            <!-- Step 1: Details -->
            <div id="inland-step-1" class="service-step">
                <form id="inland-details-form">
                    <h3>Route & Cargo</h3>
                     <div class="form-section two-column">
                        <div class="input-wrapper"><label for="inland-origin">Origin (City, Country)</label><input type="text" id="inland-origin" required placeholder="e.g., London, GB"></div>
                        <div class="input-wrapper"><label for="inland-destination">Destination (City, Country)</label><input type="text" id="inland-destination" required placeholder="e.g., Manchester, GB"></div>
                    </div>
                     <div class="form-section two-column">
                        <div class="input-wrapper">
                            <label for="inland-load-type">Load Type</label>
                            <select id="inland-load-type">
                                <option value="FTL">Full Truckload (FTL)</option>
                                <option value="LTL">Less than Truckload (LTL)</option>
                            </select>
                        </div>
                        <div class="input-wrapper"><label for="inland-cargo-weight">Cargo Weight (kg)</label><input type="number" id="inland-cargo-weight" required min="1"></div>
                    </div>
                    <div class="form-actions"><button type="submit" class="main-submit-btn">Find Trucks</button></div>
                </form>
            </div>

            <!-- Step 2: Truck Board -->
            <div id="inland-step-2" class="service-step">
                <h3>AI-Generated Available Trucks</h3>
                <div id="inland-truck-board" class="results-grid"></div>
                <div class="form-actions" style="justify-content: flex-start;">
                    <button type="button" id="inland-back-to-details" class="secondary-btn">Back</button>
                </div>
            </div>

            <!-- Step 3: Agreement -->
            <div id="inland-step-3" class="service-step">
                 <h3>Agreement & Finalization</h3>
                 <div class="two-column">
                    <div>
                        <h4>Booking Summary</h4>
                        <div id="inland-agreement-summary" class="payment-overview"></div>
                        <div class="checkbox-wrapper" style="margin-top: 1.5rem;"><input type="checkbox" id="inland-terms-ack"><label for="inland-terms-ack">I agree to the terms of carriage and confirm the details are correct.</label></div>
                    </div>
                    <div>
                        <h4>Digital Signature</h4>
                        <div class="input-wrapper"><label for="inland-signer-name">Sign by Typing Your Full Name</label><input type="text" id="inland-signer-name"></div>
                        <label>Sign in the box below</label>
                        <canvas id="inland-signature-pad" width="400" height="150" style="border: 2px solid var(--border-color); border-radius: 8px; cursor: crosshair;"></canvas>
                    </div>
                 </div>
                 <div class="form-actions" style="justify-content: space-between;">
                    <button type="button" id="inland-back-to-board-btn" class="secondary-btn">Back</button>
                    <button type="button" id="inland-confirm-booking-btn" class="main-submit-btn" disabled>Confirm Booking</button>
                </div>
            </div>
            
            <!-- Step 4: Confirmation -->
            <div id="inland-step-4" class="service-step">
                <div class="confirmation-container">
                    <h3>Booking Confirmed!</h3>
                    <p>Your truck is booked. The driver will contact you upon arrival at the pickup location.</p>
                    <div class="confirmation-tracking"><h4>Booking ID</h4><div class="tracking-id-display" id="inland-booking-id"></div></div>
                    <div class="confirmation-actions">
                        <button id="inland-download-bol-btn" class="secondary-btn">Download Bill of Lading (PDF)</button>
                        <button id="inland-new-shipment-btn" class="main-submit-btn">New Booking</button>
                    </div>
                </div>
            </div>
        </div>
    `)}async function cN(t){t.preventDefault(),rt(!0,"Finding available trucks...");const e={originAddress:document.getElementById("inland-origin").value,destAddress:document.getElementById("inland-destination").value,loadType:document.getElementById("inland-load-type").value,weight:parseInt(document.getElementById("inland-cargo-weight").value),cargoDescription:"",selectedTruck:null};Ae({inlandDetails:e});try{const n=await aN(e);Ae({availableTrucks:n});const i=document.getElementById("inland-truck-board");i&&(i.innerHTML=n.map(r=>{const o=An.inland.standard,s=r.price*(1+o);return`
                    <div class="quote-card">
                        <div class="quote-card-header"><h4>${r.vehicleType}</h4></div>
                        <div class="quote-card-body">
                            <div class="quote-card-details">
                                <div class="detail-item"><span>Driver</span><strong>${r.driverName} (${r.driverRating} ★)</strong></div>
                                <div class="detail-item"><span>ETA to Pickup</span><strong>~${r.etaPickupMin} mins</strong></div>
                            </div>
                            <div class="quote-card-price"><strong>${j.currentCurrency.symbol}${s.toFixed(2)}</strong></div>
                        </div>
                        <div class="quote-card-actions"><button class="main-submit-btn inland-book-truck-btn" data-truck-id="${r.id}">Select & Book</button></div>
                    </div>
                `}).join("")),Rs(2)}catch(n){console.error("Inland quote error:",n),Ee("Could not find available trucks. Please try again.","error")}finally{rt(!1)}}function uN(t){const e=j.availableTrucks.find(i=>i.id===t);if(!e||!j.inlandDetails)return;Ae({inlandDetails:{...j.inlandDetails,selectedTruck:e}});const n=document.getElementById("inland-agreement-summary");if(n){const i=An.inland.standard,r=e.price*(1+i);n.innerHTML=`
            <div class="review-item"><span>Route:</span><strong>${j.inlandDetails.originAddress} &rarr; ${j.inlandDetails.destAddress}</strong></div>
            <div class="review-item"><span>Vehicle:</span><strong>${e.vehicleType}</strong></div>
            <div class="review-item"><span>Driver:</span><strong>${e.driverName} (${e.driverRating} ★)</strong></div>
            <hr>
            <div class="review-item total"><span>Total Cost:</span><strong>${j.currentCurrency.symbol}${r.toFixed(2)}</strong></div>
        `}Rs(3)}function dN(){if(Mi=document.getElementById("inland-signature-pad"),!Mi)return;zr=Mi.getContext("2d"),zr.strokeStyle="#212121",zr.lineWidth=2;const t=i=>{td=!0,n(i)},e=()=>{td=!1,zr.beginPath(),Ae({inlandSignatureDataUrl:Mi.toDataURL()}),Kd()},n=i=>{if(!td)return;i.preventDefault();const r=Mi.getBoundingClientRect(),o=i instanceof MouseEvent?i:i.touches[0];zr.lineTo(o.clientX-r.left,o.clientY-r.top),zr.stroke(),zr.beginPath(),zr.moveTo(o.clientX-r.left,o.clientY-r.top)};Mi.addEventListener("mousedown",t),Mi.addEventListener("mouseup",e),Mi.addEventListener("mousemove",n),Mi.addEventListener("touchstart",t),Mi.addEventListener("touchend",e),Mi.addEventListener("touchmove",n)}function Kd(){const t=document.getElementById("inland-terms-ack").checked,e=document.getElementById("inland-signer-name").value.trim(),n=!!j.inlandSignatureDataUrl;document.getElementById("inland-confirm-booking-btn").disabled=!(t&&e&&n)}function fN(){const{inlandDetails:t}=j;if(!t||!t.selectedTruck||!t.bookingId)return;const e=new Oe;e.text("Bill of Lading (BOL)",14,20),e.text(`Booking ID: ${t.bookingId}`,14,28),wc(e,{startY:35,head:[["Detail","Information"]],body:[["Shipper (Origin)",t.originAddress],["Consignee (Destination)",t.destAddress],["Carrier",`${t.selectedTruck.driverName} (${t.selectedTruck.vehicleType})`],["Load Type",t.loadType],["Weight",`${t.weight} kg`],["Signature on File","Yes"]]}),e.save(`Vcanship_BOL_${t.bookingId}.pdf`)}function hN(){var e,n,i,r,o,s,a,c,u,f;const t=document.getElementById("page-inland");t&&((e=t.querySelector(".back-btn"))==null||e.addEventListener("click",()=>bt("landing")),(n=document.getElementById("inland-details-form"))==null||n.addEventListener("submit",cN),(i=document.getElementById("inland-truck-board"))==null||i.addEventListener("click",p=>{const m=p.target.closest(".inland-book-truck-btn");m!=null&&m.dataset.truckId&&uN(m.dataset.truckId)}),(r=document.getElementById("inland-back-to-details"))==null||r.addEventListener("click",()=>Rs(1)),(o=document.getElementById("inland-back-to-board-btn"))==null||o.addEventListener("click",()=>Rs(2)),(s=document.getElementById("inland-confirm-booking-btn"))==null||s.addEventListener("click",()=>{const p=`TRK-${Date.now().toString().slice(-6)}`;Ae({inlandDetails:{...j.inlandDetails,bookingId:p}}),document.getElementById("inland-booking-id").textContent=p,Rs(4)}),(a=document.getElementById("inland-new-shipment-btn"))==null||a.addEventListener("click",D0),(c=document.getElementById("inland-download-bol-btn"))==null||c.addEventListener("click",fN),(u=document.getElementById("inland-terms-ack"))==null||u.addEventListener("change",Kd),(f=document.getElementById("inland-signer-name"))==null||f.addEventListener("input",Kd))}function D0(){Ae({currentService:"inland"}),q1(),lN(),bt("inland"),hN(),Rs(1)}function Pa(t){var e;Ei("trade-finance",t-1),document.querySelectorAll("#page-bulk .service-step").forEach(n=>n.classList.remove("active")),(e=document.getElementById(`bulk-step-${t}`))==null||e.classList.add("active")}function F0(){const t=document.getElementById("page-bulk");t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div class="service-page-header">
            <h2>Bulk & Charter Services</h2>
            <p class="subtitle">For large-scale commodity shipping and vessel chartering.</p>
        </div>
        <div class="form-container">
            <div class="visual-progress-bar" id="progress-bar-trade-finance">
                <div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div>
            </div>

            <!-- Step 1: Details -->
            <div id="bulk-step-1" class="service-step">
                <form id="bulk-details-form">
                    <h3>Shipment Inquiry</h3>
                     <div class="form-section two-column">
                        <div class="input-wrapper"><label for="bulk-origin-port">Origin Port</label><input type="text" id="bulk-origin-port" required placeholder="e.g., Port Hedland, AU"></div>
                        <div class="input-wrapper"><label for="bulk-dest-port">Destination Port</label><input type="text" id="bulk-dest-port" required placeholder="e.g., Qingdao, CN"></div>
                    </div>
                     <div class="form-section two-column">
                        <div class="input-wrapper"><label for="bulk-cargo-type">Cargo Type</label><input type="text" id="bulk-cargo-type" required placeholder="e.g., Iron Ore"></div>
                        <div class="input-wrapper"><label for="bulk-cargo-quantity">Cargo Quantity (Tons)</label><input type="number" id="bulk-cargo-quantity" required min="1000"></div>
                    </div>
                    <div class="form-actions"><button type="submit" class="main-submit-btn">Get AI Estimate</button></div>
                </form>
            </div>

            <!-- Step 2: Quote -->
            <div id="bulk-step-2" class="service-step">
                <h3>Your AI-Powered Estimate</h3>
                <div id="bulk-quote-container"></div>
                <div class="quote-confirmation-panel">
                    <h4>Please Note: This is an AI Estimate</h4>
                    <p>This is a budgetary estimate based on current market conditions for vessel chartering. Rates are highly volatile. A Vcanship broker will contact you to discuss your specific needs and provide a firm quote.</p>
                </div>
                <div class="form-actions">
                    <button type="button" id="bulk-back-to-details" class="secondary-btn">Back</button>
                    <button type="button" id="bulk-request-booking" class="main-submit-btn">Contact a Broker</button>
                </div>
            </div>
            
            <!-- Step 3: Confirmation -->
            <div id="bulk-step-3" class="service-step">
                 <div class="confirmation-container">
                    <h3>Inquiry Sent!</h3>
                    <p>Your inquiry has been received. Our chartering desk will review your request and contact you via email shortly.</p>
                    <div class="confirmation-tracking">
                        <h4>Reference ID</h4>
                        <div class="tracking-id-display" id="bulk-reference-id"></div>
                    </div>
                    <div class="confirmation-actions">
                        <button id="bulk-new-shipment-btn" class="main-submit-btn">New Inquiry</button>
                    </div>
                </div>
            </div>
        </div>
    `)}async function pN(t){t.preventDefault(),rt(!0,"Calculating bulk freight estimate...");const e=document.getElementById("bulk-origin-port").value,n=document.getElementById("bulk-dest-port").value,i=document.getElementById("bulk-cargo-type").value,r=document.getElementById("bulk-cargo-quantity").value,o=`
        Act as a ship chartering expert. Provide an estimated cost for a bulk shipment.
        - Origin Port: ${e}
        - Destination Port: ${n}
        - Cargo: ${i}
        - Quantity: ${r} tons
        - Currency: ${j.currentCurrency.code}

        Provide a single estimated total freight cost as a number. Do not add any other text or formatting.
    `;try{if(!j.api)throw new Error("AI API not initialized.");const s=await j.api.models.generateContent({model:"gemini-2.5-flash",contents:o}),a=parseFloat(s.text);if(isNaN(a))throw new Error("Invalid AI response.");const c=An.bulk.commission,u=a/(1-c),f=document.getElementById("bulk-quote-container");f&&(f.innerHTML=`
                 <div class="payment-overview">
                    <div class="review-item"><span>Route:</span><strong>${e} &rarr; ${n}</strong></div>
                    <div class="review-item"><span>Cargo:</span><strong>${r} tons of ${i}</strong></div>
                    <hr>
                    <div class="review-item total"><span>Estimated Charter Cost:</span><strong>${j.currentCurrency.symbol}${u.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}</strong></div>
                </div>
            `),Pa(2)}catch(s){console.error("Bulk quote error:",s),Ee("Could not generate an estimate. Please try again.","error")}finally{rt(!1)}}function q0(){var t,e,n,i,r;(t=document.querySelector("#page-bulk .back-btn"))==null||t.addEventListener("click",()=>bt("landing")),(e=document.getElementById("bulk-details-form"))==null||e.addEventListener("submit",pN),(n=document.getElementById("bulk-back-to-details"))==null||n.addEventListener("click",()=>Pa(1)),(i=document.getElementById("bulk-request-booking"))==null||i.addEventListener("click",()=>{const o=`BLK-${Date.now().toString().slice(-6)}`;document.getElementById("bulk-reference-id").textContent=o,Pa(3),Ee("Inquiry sent! Our brokers will contact you.","success")}),(r=document.getElementById("bulk-new-shipment-btn"))==null||r.addEventListener("click",()=>{Ym(),F0(),q0(),Pa(1)})}function gN(){Ae({currentService:"bulk"}),Ym(),F0(),bt("bulk"),q0(),Pa(1)}function Na(t){var e;Ei("trade-finance",t-1),document.querySelectorAll("#page-rivertug .service-step").forEach(n=>n.classList.remove("active")),(e=document.getElementById(`rivertug-step-${t}`))==null||e.classList.add("active")}function U0(){const t=document.getElementById("page-rivertug");t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div class="service-page-header">
            <h2>River Tug & Barge Service</h2>
            <p class="subtitle">Inland waterway transport for bulk and project cargo.</p>
        </div>
        <div class="form-container">
            <div class="visual-progress-bar" id="progress-bar-trade-finance">
                <div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div>
            </div>

            <!-- Step 1: Details -->
            <div id="rivertug-step-1" class="service-step">
                <form id="rivertug-details-form">
                    <h3>Route & Cargo</h3>
                    <div class="form-section two-column">
                        <div class="input-wrapper"><label for="rivertug-origin">Origin River Port</label><input type="text" id="rivertug-origin" required placeholder="e.g., Duisburg"></div>
                        <div class="input-wrapper"><label for="rivertug-destination">Destination River Port</label><input type="text" id="rivertug-destination" required placeholder="e.g., Rotterdam"></div>
                    </div>
                     <div class="form-section">
                        <div class="input-wrapper"><label for="rivertug-cargo-volume">Cargo Volume (CBM or Tons)</label><input type="number" id="rivertug-cargo-volume" required min="10"></div>
                     </div>
                     <div class="form-section">
                        <label class="checkbox-group-label">Select Barge Type</label>
                        <div id="rivertug-barge-type-selector" class="visual-selector-grid">
                            <button type="button" class="service-type-btn" data-type="deck">
                                <i class="fa-solid fa-square-full selector-icon"></i>
                                <strong>Deck Barge</strong>
                                <span>For oversized cargo, vehicles, containers.</span>
                            </button>
                            <button type="button" class="service-type-btn" data-type="hopper">
                                <i class="fa-solid fa-box-archive selector-icon"></i>
                                <strong>Hopper Barge</strong>
                                <span>For bulk goods like coal, grain, gravel.</span>
                            </button>
                        </div>
                     </div>
                    <div class="form-actions"><button type="submit" class="main-submit-btn">Get AI Estimate</button></div>
                </form>
            </div>

            <!-- Step 2: Quote -->
            <div id="rivertug-step-2" class="service-step">
                <h3>Your AI-Powered Estimate</h3>
                <div id="rivertug-quote-container"></div>
                <div class="quote-confirmation-panel">
                    <h4>Please Note: This is an AI Estimate</h4>
                    <p>This is a budgetary estimate. A Vcanship agent will contact you to confirm availability, and provide a final quote.</p>
                </div>
                <div class="form-actions">
                    <button type="button" id="rivertug-back-to-details" class="secondary-btn">Back</button>
                    <button type="button" id="rivertug-request-booking" class="main-submit-btn">Request Final Quote</button>
                </div>
            </div>

            <!-- Step 3: Confirmation -->
            <div id="rivertug-step-3" class="service-step">
                <div class="confirmation-container">
                    <h3>Booking Request Sent!</h3>
                    <p>Your request has been received. Our inland waterways team will be in touch shortly.</p>
                    <div class="confirmation-tracking">
                        <h4>Reference ID</h4>
                        <div class="tracking-id-display" id="rivertug-reference-id"></div>
                    </div>
                    <div class="confirmation-actions">
                        <button id="rivertug-new-shipment-btn" class="main-submit-btn">New Inquiry</button>
                    </div>
                </div>
            </div>
        </div>
    `)}async function mN(t){t.preventDefault();const e=document.querySelector("#rivertug-barge-type-selector .service-type-btn.active");if(!e){Ee("Please select a barge type.","error");return}rt(!0,"Calculating estimate...");const n=document.getElementById("rivertug-origin").value,i=document.getElementById("rivertug-destination").value,r=document.getElementById("rivertug-cargo-volume").value,o=e.dataset.type,s=`
        Act as a logistics pricing expert for river barge transport.
        - Origin River Port: ${n}
        - Destination River Port: ${i}
        - Cargo Volume: ${r} tons/cbm
        - Barge Type: ${o}
        - Currency: ${j.currentCurrency.code}

        Provide a single estimated base cost for the transport as a number. Do not add any other text or formatting.
    `;try{if(!j.api)throw new Error("AI API not initialized.");const a=await j.api.models.generateContent({model:"gemini-2.5-flash",contents:s}),c=parseFloat(a.text);if(isNaN(c))throw new Error("Invalid AI response.");const u=An.rivertug.standard,f=c*(1+u),p=document.getElementById("rivertug-quote-container");p&&(p.innerHTML=`
                 <div class="payment-overview">
                    <div class="review-item"><span>Route:</span><strong>${n} &rarr; ${i}</strong></div>
                    <div class="review-item"><span>Details:</span><strong>${r} units on a ${o} barge</strong></div>
                    <hr>
                    <div class="review-item total"><span>Estimated Cost:</span><strong>${j.currentCurrency.symbol}${f.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}</strong></div>
                </div>
            `),Na(2)}catch(a){console.error("River tug quote error:",a),Ee("Could not generate an estimate. Please try again.","error")}finally{rt(!1)}}function $0(){var t,e,n,i,r,o;(t=document.querySelector("#page-rivertug .back-btn"))==null||t.addEventListener("click",()=>bt("landing")),(e=document.getElementById("rivertug-details-form"))==null||e.addEventListener("submit",mN),(n=document.getElementById("rivertug-barge-type-selector"))==null||n.addEventListener("click",s=>{const c=s.target.closest(".service-type-btn");c&&(document.querySelectorAll("#rivertug-barge-type-selector .service-type-btn").forEach(u=>u.classList.remove("active")),c.classList.add("active"))}),(i=document.getElementById("rivertug-back-to-details"))==null||i.addEventListener("click",()=>Na(1)),(r=document.getElementById("rivertug-request-booking"))==null||r.addEventListener("click",()=>{const s=`RTG-${Date.now().toString().slice(-6)}`;document.getElementById("rivertug-reference-id").textContent=s,Na(3),Ee("Request sent!","success")}),(o=document.getElementById("rivertug-new-shipment-btn"))==null||o.addEventListener("click",()=>{jm(),U0(),$0(),Na(1)})}function vN(){Ae({currentService:"rivertug"}),jm(),U0(),bt("rivertug"),$0(),Na(1)}function Ra(t){var e;Ei("trade-finance",t-1),document.querySelectorAll("#page-warehouse .service-step").forEach(n=>n.classList.remove("active")),(e=document.getElementById(`warehouse-step-${t}`))==null||e.classList.add("active")}function O0(){const t=document.getElementById("page-warehouse");t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div class="service-page-header">
            <h2>Find Warehousing Space</h2>
            <p class="subtitle">Search for short-term or long-term storage solutions globally.</p>
        </div>
        <div class="form-container">
             <div class="visual-progress-bar" id="progress-bar-trade-finance">
                <div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div>
            </div>

            <!-- Step 1: Search -->
            <div id="warehouse-step-1" class="service-step">
                <form id="warehouse-search-form">
                    <h3>Find a Facility</h3>
                    <div class="form-section">
                        <div class="input-wrapper"><label for="warehouse-location">Location (City, Country)</label><input type="text" id="warehouse-location" required placeholder="e.g., Felixstowe, GB"></div>
                         <div class="input-wrapper"><label for="warehouse-pallets">Number of Pallets</label><input type="number" id="warehouse-pallets" required min="1"></div>
                    </div>
                     <div class="form-section">
                        <label class="checkbox-group-label">Special Requirements</label>
                        <div class="checkbox-grid" style="grid-template-columns: 1fr 1fr;">
                            <div class="checkbox-wrapper"><input type="checkbox" id="req-temp" name="requirements" value="temp"><label for="req-temp">Temperature Controlled</label></div>
                            <div class="checkbox-wrapper"><input type="checkbox" id="req-bonded" name="requirements" value="bonded"><label for="req-bonded">Bonded</label></div>
                            <div class="checkbox-wrapper"><input type="checkbox" id="req-hazmat" name="requirements" value="hazmat"><label for="req-hazmat">Hazardous Materials</label></div>
                        </div>
                    </div>
                    <div class="form-actions"><button type="submit" class="main-submit-btn">Search Facilities</button></div>
                </form>
            </div>

            <!-- Step 2: Results -->
            <div id="warehouse-step-2" class="service-step">
                <h3>AI-Generated Available Facilities (Example)</h3>
                <div id="warehouse-results-list" class="warehouse-results"></div>
                <div class="quote-confirmation-panel">
                    <h4>Please Note: This is an AI Simulation</h4>
                    <p>These are example facilities and prices generated by AI. A Vcanship agent will contact you to confirm the best available space and provide a final quote.</p>
                </div>
                 <div class="form-actions">
                    <button type="button" id="warehouse-back-to-search" class="secondary-btn">Back to Search</button>
                </div>
            </div>
            
            <!-- Step 3: Confirmation -->
            <div id="warehouse-step-3" class="service-step">
                 <div class="confirmation-container">
                    <h3>Booking Request Sent!</h3>
                    <p>Your request for warehousing space has been received. Our team will be in touch shortly to finalize the details.</p>
                    <div class="confirmation-tracking">
                        <h4>Reference ID</h4>
                        <div class="tracking-id-display" id="warehouse-reference-id"></div>
                    </div>
                    <div class="confirmation-actions">
                        <button id="warehouse-new-search-btn" class="main-submit-btn">New Search</button>
                    </div>
                </div>
            </div>
        </div>
    `)}async function yN(t){t.preventDefault(),rt(!0,"Searching for facilities...");const e=document.getElementById("warehouse-location").value,n=document.getElementById("warehouse-pallets").value,i=Array.from(document.querySelectorAll('input[name="requirements"]:checked')).map(o=>o.value).join(", ")||"None",r=`
        Act as a commercial real estate agent for logistics. For a request for ${n} pallet spaces in ${e} with special requirements: ${i}, generate a list of 3 plausible but fictional warehouse facilities.
        For each facility, provide:
        - name (e.g., "Felixstowe Logistics Park")
        - types (an array of strings, e.g., ["Bonded", "Temp-Controlled"])
        - basePricePerPallet (a number, in ${j.currentCurrency.code})

        Format the output as a JSON array of objects.
    `;try{if(!j.api)throw new Error("AI API not initialized.");const o=await j.api.models.generateContent({model:"gemini-2.5-flash",contents:r,config:{responseMimeType:"application/json"}}),s=JSON.parse(o.text),a=document.getElementById("warehouse-results-list");a&&(a.innerHTML=s.map(c=>{const u=An.warehousing.standard,f=c.basePricePerPallet*(1+u);return`
                    <div class="facility-card">
                        <div class="facility-card-header">
                            <i class="fa-solid fa-warehouse"></i>
                            <h5>${c.name}</h5>
                        </div>
                        <div class="facility-card-tags">
                            ${(c.types||[]).map(p=>`<span class="facility-tag">${p}</span>`).join("")}
                        </div>
                        <div class="facility-card-footer">
                            <div class="facility-card-price">
                                <strong>${j.currentCurrency.symbol}${f.toFixed(2)}</strong>
                                <p>/ pallet / week (est.)</p>
                            </div>
                            <button class="cta-button warehouse-book-btn">Request to Book</button>
                        </div>
                    </div>
                 `}).join("")),Ra(2)}catch(o){console.error("Warehouse search error:",o),Ee("Could not find facilities. Please try again.","error")}finally{rt(!1)}}function H0(){var t,e,n,i,r;(t=document.querySelector("#page-warehouse .back-btn"))==null||t.addEventListener("click",()=>bt("landing")),(e=document.getElementById("warehouse-search-form"))==null||e.addEventListener("submit",yN),(n=document.getElementById("warehouse-back-to-search"))==null||n.addEventListener("click",()=>Ra(1)),(i=document.getElementById("warehouse-results-list"))==null||i.addEventListener("click",o=>{if(o.target.classList.contains("warehouse-book-btn")){const a=`WHS-${Date.now().toString().slice(-6)}`;document.getElementById("warehouse-reference-id").textContent=a,Ra(3),Ee("Request sent!","success")}}),(r=document.getElementById("warehouse-new-search-btn"))==null||r.addEventListener("click",()=>{Qm(),O0(),H0(),Ra(1)})}function bN(){Ae({currentService:"warehouse"}),Qm(),O0(),bt("warehouse"),H0(),Ra(1)}const V0="vcanship_ecom_products",Sc=["Amazon","eBay","Shopify","Walmart","Etsy","Instagram","Facebook Marketplace","Google Shopping","TikTok Shop","Alibaba"];let Mo=null;function wN(){const t=localStorage.getItem(V0);Ae(t?{ecomProducts:JSON.parse(t)}:{ecomProducts:[]})}function _c(){localStorage.setItem(V0,JSON.stringify(j.ecomProducts))}function Bo(t,e=null){Ae({ecomCurrentView:t,ecomViewingProductId:e}),SN()}function SN(){switch(j.ecomCurrentView){case"dashboard":_N();break;case"form":G0();break;case"detail":j.ecomViewingProductId!==null&&CN(j.ecomViewingProductId);break}}function _N(){const t=document.getElementById("ecom-content-container");t&&(t.innerHTML=`
        <div id="ecom-dashboard-view">
            <div class="ecom-view-header">
                <h2>Admin Dashboard</h2>
                <button id="ecom-add-new-product-btn" class="main-submit-btn">
                    <i class="fa-solid fa-plus"></i> Add New Product
                </button>
            </div>
            <div id="ecom-product-list-container"></div>
        </div>
    `,jd())}function G0(t){const e=document.getElementById("ecom-content-container");e&&(Ae({ecomEditingProductId:(t==null?void 0:t.id)??null}),e.innerHTML=`
        <div id="ecom-form-view">
            <button class="back-btn" id="ecom-back-to-dashboard-btn"><i class="fa-solid fa-arrow-left"></i> Back to Dashboard</button>
            <div class="ecom-wizard-layout">
                <div class="ecom-wizard-form-panel card">
                     <h3 id="ecom-form-title">${t?"Edit Product":"Add New Product"}</h3>
                     <form id="ecom-product-form" novalidate>
                        <div class="form-section">
                            <h4>Core Details</h4>
                            <div class="input-wrapper"><label for="ecom-product-name">Product Name</label><input type="text" id="ecom-product-name" required></div>
                            <div class="input-wrapper"><label for="ecom-product-description">Description</label><textarea id="ecom-product-description" rows="4"></textarea></div>
                        </div>
                        <div class="form-section">
                           <h4>Image</h4>
                           <div id="ecom-image-drop-zone" class="image-drop-zone"><div id="ecom-image-drop-zone-idle"><i class="fa-solid fa-cloud-arrow-up"></i><p><strong>Click to upload</strong> or drag and drop</p></div><img id="ecom-image-preview" class="hidden"></div>
                           <input type="file" id="ecom-image-input" accept="image/png, image/jpeg, image/webp" class="hidden">
                           <button type="button" id="ecom-remove-image-btn" class="link-btn hidden" style="margin-top: 0.5rem;">Remove Image</button>
                       </div>
                       <div class="form-section">
                            <h4>Pricing & Stock</h4>
                             <div class="two-column" style="gap: 1.5rem;">
                                <div class="input-wrapper"><label for="ecom-product-price">Price (${j.currentCurrency.code})</label><input type="number" id="ecom-product-price" min="0" step="0.01" required></div>
                                <div class="input-wrapper"><label for="ecom-product-stock">Stock Quantity</label><input type="number" id="ecom-product-stock" min="0" required></div>
                            </div>
                        </div>
                        <div class="form-actions" style="margin-top: 2rem;">
                            <button type="submit" class="main-submit-btn">Save Product</button>
                        </div>
                    </form>
                </div>
                <div class="ecom-wizard-preview-panel">
                    <h3>Live Preview</h3>
                    <div id="ecom-live-preview-container"></div>
                </div>
            </div>
        </div>
    `,Mo=null,t&&(document.getElementById("ecom-product-name").value=t.name,document.getElementById("ecom-product-description").value=t.description,document.getElementById("ecom-product-price").value=String(t.price),document.getElementById("ecom-product-stock").value=String(t.stock),t.imageUrl&&(Mo=t.imageUrl,Qd(Mo))),ec(),AN())}function CN(t){const e=document.getElementById("ecom-content-container"),n=j.ecomProducts.find(i=>i.id===t);if(!e||!n){Ee("Product not found.","error"),Bo("dashboard");return}e.innerHTML=`
        <div id="ecom-detail-view">
             <button class="back-btn" id="ecom-back-to-dashboard-btn"><i class="fa-solid fa-arrow-left"></i> Back to Dashboard</button>
             <div class="ecom-product-detail-layout">
                <img src="${n.imageUrl||"https://placehold.co/600x450/e2e8f0/adb5bd?text=No+Image"}" alt="${n.name}" class="ecom-product-detail-image">
                <div class="ecom-product-detail-info">
                    <p class="ecom-product-category">${n.category}</p>
                    <h2 id="detail-product-name">${n.name}</h2>
                    <p class="ecom-product-detail-price" id="detail-product-price">${j.currentCurrency.symbol}${n.price.toFixed(2)}</p>
                    <p class="ecom-product-detail-stock"><strong>${n.stock}</strong> units in stock</p>
                    <p class="ecom-product-detail-description" id="detail-product-desc">${n.description}</p>
                    
                    <div class="ecom-mock-actions">
                         <button class="secondary-btn" id="mock-translate-btn">Translate (ES)</button>
                         <button class="secondary-btn" id="mock-currency-btn">Convert Currency (EUR)</button>
                    </div>
                </div>
             </div>
        </div>
    `}function jd(){const t=document.getElementById("ecom-product-list-container");t&&(j.ecomProducts.length>0?t.innerHTML=`<div id="ecom-products-grid">${j.ecomProducts.map(W0).join("")}</div>`:t.innerHTML=`
            <div class="card" style="text-align: center; padding: 3rem;">
                <h3>No Products Listed Yet</h3>
                <p>Start by advertising your first product to a global audience.</p>
                <button id="ecom-add-new-from-empty-btn" class="main-submit-btn" style="margin-top: 1rem;">Add Your First Product</button>
            </div>`)}function W0(t){const e=t.imageUrl||"https://placehold.co/400x300/e2e8f0/adb5bd?text=No+Image",n=i=>{const o=(i.syndicationStatus?Object.values(i.syndicationStatus):[]).filter(a=>a==="live").length,s=Sc.length;return`
            <div class="ecom-syndication-status">
                <h5>Syndication Status (${o}/${s} Live)</h5>
                <div class="ecom-platform-list">
                ${Sc.map(a=>{var c;return`
                    <div class="ecom-platform-status">
                        <span class="status-dot ${((c=i.syndicationStatus)==null?void 0:c[a])||"pending"}"></span>
                        <span>${a}</span>
                    </div>
                `}).join("")}
                </div>
            </div>`};return`
        <div class="ecom-product-card" data-product-id="${t.id}">
            <div class="ecom-product-card-image-wrapper" data-action="view-detail">
                <img src="${e}" alt="${t.name}" class="ecom-product-image">
            </div>
            <div class="ecom-product-card-body">
                <h4 class="ecom-product-title" data-action="view-detail">${t.name||"Untitled Product"}</h4>
                ${n(t)}
                <div class="ecom-product-card-footer">
                    <div class="ecom-stock-controls">
                        <button class="secondary-btn" data-action="decrease-stock">-</button>
                        <input type="number" value="${t.stock}" class="ecom-stock-input" min="0">
                        <button class="secondary-btn" data-action="increase-stock">+</button>
                    </div>
                    <div class="ecom-product-actions">
                        <button class="secondary-btn" data-action="edit-product">Edit</button>
                    </div>
                </div>
            </div>
        </div>
    `}function ec(){const t=document.getElementById("ecom-live-preview-container");if(!t)return;const n={...z0(),id:0,syndicationStatus:{}};t.innerHTML=W0(n)}function EN(t){t.preventDefault();const e=z0(),n=j.ecomEditingProductId!==null;if(!e.name||e.price<=0){Ee("Product Name and a valid Price are required.","error");return}let i;if(n)i={...j.ecomProducts.find(o=>o.id===j.ecomEditingProductId),...e},Ae({ecomProducts:j.ecomProducts.map(o=>o.id===i.id?i:o)});else{const r=Sc.reduce((o,s)=>({...o,[s]:"pending"}),{});i={...e,id:Date.now(),status:"Live",syndicationStatus:r},Ae({ecomProducts:[...j.ecomProducts,i]}),TN(i.id)}_c(),Ee(n?"Product updated successfully!":"Product added successfully!","success"),Bo("dashboard")}function TN(t){const e=j.ecomProducts.findIndex(n=>n.id===t);e!==-1&&Sc.forEach(n=>{setTimeout(()=>{const i=[...j.ecomProducts];i[e].syndicationStatus[n]="syndicating",Ae({ecomProducts:i}),_c(),j.ecomCurrentView==="dashboard"&&jd()},Math.random()*2e3+500),setTimeout(()=>{const i=[...j.ecomProducts];i[e].syndicationStatus[n]=Math.random()>.1?"live":"failed",Ae({ecomProducts:i}),_c(),j.ecomCurrentView==="dashboard"&&jd()},Math.random()*4e3+2e3)})}function nd(t,e,n){const i=[...j.ecomProducts],r=i.findIndex(s=>s.id===t);if(r===-1)return;e==="input"?i[r].stock=n!==void 0?Math.max(0,n):0:i[r].stock=Math.max(0,i[r].stock+e),Ae({ecomProducts:i}),_c();const o=document.querySelector(`.ecom-product-card[data-product-id="${t}"] .ecom-stock-input`);o&&(o.value=String(i[r].stock))}function AN(){var r,o;(r=document.getElementById("ecom-product-form"))==null||r.addEventListener("submit",EN),(o=document.getElementById("ecom-product-form"))==null||o.addEventListener("input",ec);const t=document.getElementById("ecom-image-input"),e=document.getElementById("ecom-image-drop-zone"),n=document.getElementById("ecom-remove-image-btn"),i=s=>{if(!s.type.startsWith("image/")){Ee("Invalid file type.","error");return}const a=new FileReader;a.onloadend=()=>{Mo=a.result,Qd(Mo),ec()},a.readAsDataURL(s)};t==null||t.addEventListener("change",()=>{var s;return((s=t.files)==null?void 0:s[0])&&i(t.files[0])}),e==null||e.addEventListener("click",()=>t.click()),e==null||e.addEventListener("dragover",s=>{s.preventDefault(),e.classList.add("dragover")}),e==null||e.addEventListener("dragleave",()=>e.classList.remove("dragover")),e==null||e.addEventListener("drop",s=>{var a,c;s.preventDefault(),(c=(a=s.dataTransfer)==null?void 0:a.files)!=null&&c[0]&&i(s.dataTransfer.files[0])}),n==null||n.addEventListener("click",()=>{Mo=null,t.value="",Qd(null),ec()})}function IN(){const t=document.getElementById("page-ecommerce");t&&(t.addEventListener("click",e=>{var s;const n=e.target,i=n.dataset.action||((s=n.parentElement)==null?void 0:s.dataset.action)||n.id,r=n.closest(".ecom-product-card"),o=r?parseInt(r.dataset.productId||"0",10):0;switch(i){case"ecom-add-new-product-btn":case"ecom-add-new-from-empty-btn":Bo("form");break;case"ecom-back-to-dashboard-btn":Bo("dashboard");break;case"edit-product":const a=j.ecomProducts.find(u=>u.id===o);a&&G0(a);break;case"view-detail":Bo("detail",o);break;case"increase-stock":nd(o,1);break;case"decrease-stock":nd(o,-1);break;case"mock-translate-btn":document.getElementById("detail-product-name").textContent="Nombre del Producto (Traducido)",document.getElementById("detail-product-desc").textContent="Esta es una descripción del producto simulada y traducida para demostrar la funcionalidad de localización.",Ee("Content translated to Spanish (mock).","info");break;case"mock-currency-btn":const c=j.ecomProducts.find(u=>u.id===j.ecomViewingProductId);if(c){const u=c.price*.93;document.getElementById("detail-product-price").textContent=`€${u.toFixed(2)}`,Ee("Price converted to EUR (mock).","info")}break}}),t.addEventListener("change",e=>{const n=e.target;if(n.classList.contains("ecom-stock-input")){const i=n.closest(".ecom-product-card"),r=i?parseInt(i.dataset.productId||"0",10):0;nd(r,"input",parseInt(n.value,10))}}))}function kN(){var e;const t=document.getElementById("page-ecommerce");t&&(t.innerHTML=`
        <div class="ecom-page-container">
            <button class="back-btn" id="ecom-back-to-main-dashboard">Back to Main Dashboard</button>
            <div id="ecom-content-container"></div>
        </div>
    `,(e=document.getElementById("ecom-back-to-main-dashboard"))==null||e.addEventListener("click",()=>bt("dashboard")))}function z0(){return{name:document.getElementById("ecom-product-name").value,description:document.getElementById("ecom-product-description").value,price:parseFloat(document.getElementById("ecom-product-price").value)||0,stock:parseInt(document.getElementById("ecom-product-stock").value,10)||0,imageUrl:Mo||"",category:"Demo Category",brand:"Demo Brand",specifications:[],productType:"physical"}}function Qd(t){const e=document.getElementById("ecom-image-preview"),n=document.getElementById("ecom-image-drop-zone-idle"),i=document.getElementById("ecom-remove-image-btn");!e||!n||!i||(t?(e.src=t,e.classList.remove("hidden"),n.classList.add("hidden"),i.classList.remove("hidden")):(e.src="",e.classList.add("hidden"),n.classList.remove("hidden"),i.classList.add("hidden")))}function xN(){Ae({currentService:"ecommerce"}),bt("ecommerce"),wN(),kN(),IN();const t=j.ecomInitialView;Bo(t==="add-product"?"form":"dashboard"),Ae({ecomInitialView:null})}const LN=[{id:"s1",mode:"SEA",carrier:"Maersk",origin:{code:"CNSHA",name:"Shanghai"},destination:{code:"NLRTM",name:"Rotterdam"},route:"Shanghai → Rotterdam",etd:"2024-07-27",eta:"2024-08-20",transit_days:24,reliability_pct:87,vessel:"MSC Gulsun",capacity_left:"12 TEU"},{id:"s2",mode:"SEA",carrier:"CMA CGM",origin:{code:"SGSIN",name:"Singapore"},destination:{code:"GBFXT",name:"Felixstowe"},route:"Singapore → Felixstowe",etd:"2024-07-25",eta:"2024-08-18",transit_days:24,reliability_pct:82,vessel:"CMA CGM Marco Polo",capacity_left:"5 TEU"},{id:"s3",mode:"AIR",carrier:"MSC Air Cargo",origin:{code:"ORD",name:"Chicago O'Hare"},destination:{code:"CAN",name:"Guangzhou"},route:"ORD → CAN",etd:"2024-07-26",eta:"2024-07-28",transit_days:2,reliability_pct:92,flight:"5Y340",capacity_left:"2 t"},{id:"s4",mode:"AIR",carrier:"Atlas Air",origin:{code:"LAX",name:"Los Angeles"},destination:{code:"HKG",name:"Hong Kong"},route:"LAX → HKG",etd:"2024-07-27",eta:"2024-07-29",transit_days:2,reliability_pct:89,flight:"5Y3411",capacity_left:"3 t"},{id:"s5",mode:"SEA",carrier:"Hapag-Lloyd",origin:{code:"DEHAM",name:"Hamburg"},destination:{code:"USNYC",name:"New York"},route:"Hamburg → New York",etd:"2024-07-28",eta:"2024-08-10",transit_days:13,reliability_pct:91,vessel:"Al Zubara",capacity_left:"25 TEU"},{id:"s6",mode:"AIR",carrier:"Lufthansa Cargo",origin:{code:"FRA",name:"Frankfurt"},destination:{code:"JFK",name:"New York JFK"},route:"FRA → JFK",etd:"2024-07-25",eta:"2024-07-25",transit_days:1,reliability_pct:95,flight:"LH8120",capacity_left:"1.5 t"},{id:"s7",mode:"SEA",carrier:"Evergreen",origin:{code:"TWKHH",name:"Kaohsiung"},destination:{code:"USLAX",name:"Los Angeles"},route:"Kaohsiung → Los Angeles",etd:"2024-07-29",eta:"2024-08-15",transit_days:17,reliability_pct:78,vessel:"Ever Ace",capacity_left:"8 TEU"},{id:"s8",mode:"AIR",carrier:"Cathay Cargo",origin:{code:"HKG",name:"Hong Kong"},destination:{code:"LHR",name:"London"},route:"HKG → LHR",etd:"2024-07-28",eta:"2024-07-29",transit_days:1,reliability_pct:93,flight:"CX251",capacity_left:"5 t"},{id:"s9",mode:"SEA",carrier:"ONE",origin:{code:"JPYOK",name:"Yokohama"},destination:{code:"SGSIN",name:"Singapore"},route:"Yokohama → Singapore",etd:"2024-08-01",eta:"2024-08-09",transit_days:8,reliability_pct:94,vessel:"ONE Competence",capacity_left:"30 TEU"},{id:"s10",mode:"AIR",carrier:"Emirates SkyCargo",origin:{code:"DXB",name:"Dubai"},destination:{code:"ORD",name:"Chicago O'Hare"},route:"DXB → ORD",etd:"2024-07-26",eta:"2024-07-27",transit_days:1,reliability_pct:96,flight:"EK9911",capacity_left:"8 t"}];function PN(){var e;const t=document.getElementById("page-schedules");t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div class="service-page-header">
            <h2>Schedules & Trade Lanes</h2>
            <p class="subtitle">Explore global shipping schedules for major sea and air carriers.</p>
        </div>
        <div class="schedules-container">
            <aside class="schedules-filters-card card">
                 <h3>Filters</h3>
                 <div class="input-wrapper"><label for="schedules-origin-input">Origin</label><input type="text" id="schedules-origin-input" placeholder="e.g., Shanghai or CNSHA"></div>
                 <div class="input-wrapper"><label for="schedules-dest-input">Destination</label><input type="text" id="schedules-dest-input" placeholder="e.g., Rotterdam or NLRTM"></div>
                 <div class="input-wrapper"><label for="schedules-mode-select">Mode</label><select id="schedules-mode-select"><option value="">All Modes</option><option value="SEA">Sea</option><option value="AIR">Air</option></select></div>
                 <div class="input-wrapper"><label for="schedules-carrier-select">Carrier</label><select id="schedules-carrier-select"><option value="">All Carriers</option></select></div>
                 <button id="schedules-reset-btn" class="secondary-btn">Reset Filters</button>
            </aside>
            <main class="schedules-results-container">
                <div id="schedules-card-list" class="schedules-results-grid">
                    <!-- Schedule cards will be rendered here -->
                </div>
                 <div id="schedules-empty-state" class="schedules-empty-state hidden">
                    <i class="fa-solid fa-route empty-state-icon"></i>
                    <h3>No Schedules Found</h3>
                    <p>Try adjusting your filters or search for a different route.</p>
                </div>
            </main>
        </div>
    `,(e=t.querySelector(".back-btn"))==null||e.addEventListener("click",()=>bt("landing")))}function NN(t){t.sort((r,o)=>new Date(r.etd).getTime()-new Date(o.etd).getTime());const e=document.getElementById("schedules-card-list"),n=document.getElementById("schedules-empty-state");if(!e||!n)return;if(t.length===0){e.innerHTML="",n.classList.remove("hidden");return}e.innerHTML="",n.classList.add("hidden");const i={SEA:'<i class="fa-solid fa-ship mode-icon"></i>',AIR:'<i class="fa-solid fa-plane-up mode-icon"></i>'};t.forEach(r=>{var u;const o=r.reliability_pct>=90?"high":r.reliability_pct>=80?"medium":"low",s=r.carrier||"Carrier",a=`https://logo.clearbit.com/${s.toLowerCase().replace(/\s|&/g,"").replace("cargolux","cargolux.com/img").replace(".","").replace("group","")}.com?size=40`,c=document.createElement("div");c.className="schedule-card",c.innerHTML=`
            <div class="schedule-card-header">
                <img src="${a}" alt="${s}" class="carrier-logo" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                <div class="carrier-logo-fallback" style="display: none;">${s.charAt(0)}</div>
                <div class="carrier-info">
                    <h4>${s}</h4>
                    <span>${r.vessel||r.flight||"N/A"}</span>
                </div>
                ${i[r.mode]}
            </div>
            <div class="schedule-card-route">
                <div class="route-point">
                    <strong>${r.origin.code}</strong>
                    <span>${r.origin.name}</span>
                </div>
                <div class="route-line"></div>
                <div class="route-point">
                    <strong>${r.destination.code}</strong>
                    <span>${r.destination.name}</span>
                </div>
            </div>
            <div class="schedule-card-details">
                <div class="schedule-detail-item"><label>ETD</label><strong>${r.etd}</strong></div>
                <div class="schedule-detail-item"><label>ETA</label><strong>${r.eta}</strong></div>
                <div class="schedule-detail-item"><label>Transit Time</label><strong>${r.transit_days} days</strong></div>
                <div class="schedule-detail-item"><label>On-Time Reliability</label><strong><span class="reliability-dot ${o}"></span> ${r.reliability_pct}%</strong></div>
            </div>
            <div class="schedule-card-footer">
                <span class="capacity-info">Capacity: <strong>${r.capacity_left||"Available"}</strong></span>
                <button class="cta-button">Book Now</button>
            </div>
        `,(u=c.querySelector(".cta-button"))==null||u.addEventListener("click",()=>{Ee(`Booking for ${s} is coming soon.`,"info")}),e.appendChild(c)})}function RN(t){const e=Le.schedules.carrierSelect,n=e.value,i=[...new Set(t.map(r=>r.carrier))].sort();e.innerHTML='<option value="">All carriers</option>',i.forEach(r=>{const o=document.createElement("option");o.value=r,o.textContent=r,e.appendChild(o)}),i.includes(n)&&(e.value=n)}function Hl(){const t=Le.schedules.originInput.value.toLowerCase().trim(),e=Le.schedules.destInput.value.toLowerCase().trim(),n=Le.schedules.modeSelect.value,i=LN.filter(s=>{const a=!t||s.origin.name.toLowerCase().includes(t)||s.origin.code.toLowerCase().includes(t),c=!e||s.destination.name.toLowerCase().includes(e)||s.destination.code.toLowerCase().includes(e),u=!n||s.mode===n;return a&&c&&u});RN(i);const r=Le.schedules.carrierSelect.value,o=i.filter(s=>!r||s.carrier===r);NN(o)}const MN=()=>{Ae({currentService:"schedules"}),PN(),bt("schedules"),[Le.schedules.originInput,Le.schedules.destInput,Le.schedules.modeSelect].forEach(n=>n.addEventListener("input",Hl)),Le.schedules.carrierSelect.addEventListener("change",Hl);const e=document.getElementById("schedules-reset-btn");e==null||e.addEventListener("click",()=>{Le.schedules.originInput.value="",Le.schedules.destInput.value="",Le.schedules.modeSelect.value="",Hl()}),Hl()};let tc=[];const BN=3;let nc=0;function DN(){var e;const t=Le.register.page;t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div id="tf-main-view">
            <div class="tf-hero">
                <div class="tf-hero-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M12.378 1.602a.75.75 0 0 0-.756 0L3 6.632l9 5.25 9-5.25-8.622-5.03ZM21.75 7.93l-9 5.25v9l8.628-5.032a.75.75 0 0 0 .372-.648V7.93ZM2.25 7.93v8.519c0 .245.135.468.372.648L11.25 22.25v-9l-9-5.25Z" />
                    </svg>
                </div>
                <div>
                    <h2>Vcanship Trade Finance</h2>
                    <p class="subtitle" style="margin: 0; max-width: none;">Unlock working capital, mitigate risks, and streamline your global trade operations. Our solutions are integrated directly into your shipping workflow.</p>
                </div>
            </div>

            <div class="form-container" style="max-width: 100%;">
                 <div class="tf-product-cards">
                    <div class="tf-product-card" data-product="Invoice Financing">
                        <div class="tf-product-card-header">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.122 2.122l7.81-7.81" /></svg>
                            <h4>Invoice Financing</h4>
                        </div>
                        <p>Convert your unpaid invoices into immediate cash. Stop waiting 30-90 days for customer payments.</p>
                        <ul>
                            <li><strong>Access up to 90%</strong> of your invoice value within 24 hours.</li>
                        </ul>
                    </div>
                     <div class="tf-product-card" data-product="PO Financing">
                        <div class="tf-product-card-header">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
                            <h4>Purchase Order (PO) Financing</h4>
                        </div>
                        <p>Secure funds to pay your suppliers and fulfill large customer orders before you've been paid.</p>
                         <ul>
                            <li>Fulfill orders you couldn't otherwise afford to take on.</li>
                        </ul>
                    </div>
                    <div class="tf-product-card" data-product="Supply Chain Finance">
                        <div class="tf-product-card-header">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 21v-7.5a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 .75.75V21m-4.5 0H2.25a.75.75 0 0 1-.75-.75V5.25c0-.414.336-.75.75-.75h19.5c.414 0 .75.336.75.75v14.25a.75.75 0 0 1-.75-.75h-4.5m-4.5 0H9" /></svg>
                            <h4>Supply Chain Finance</h4>
                        </div>
                        <p>Offer early payment to your suppliers, improving their cash flow while you maintain yours.</p>
                         <ul>
                            <li>Strengthen supplier relationships and negotiate better terms.</li>
                        </ul>
                    </div>
                </div>

                <div class="form-actions" style="margin-top: 2rem; justify-content: center;">
                    <button class="main-submit-btn" id="tf-start-application-btn" disabled>Select a Product to Start</button>
                </div>

                <div class="ai-advisor-container">
                    <h3>Need Help Choosing?</h3>
                    <p class="subtitle" style="margin: 0 0 1rem 0;">Describe your business needs to our AI Trade Advisor for a personalized recommendation.</p>
                    <div id="lookup-counter" class="lookup-counter"></div>
                    <div id="tf-chat-history" class="chat-history-tf">
                        <div class="chat-message-tf advisor-msg">
                            Hello! Please describe your business situation. For example, "I have a large purchase order from a new customer but need funds to pay my supplier."
                        </div>
                    </div>
                    <form id="tf-advisor-form" class="advisor-form">
                        <textarea id="tf-user-query" placeholder="Describe your situation here..." required></textarea>
                        <button type="submit" class="cta-button">Get Advice</button>
                    </form>
                </div>
            </div>
        </div>
        
        <div id="tf-application-view" class="hidden">
             <div class="form-container">
                <div id="tf-wizard-header" class="tf-wizard-header"></div>
                <div class="visual-progress-bar" id="progress-bar-trade-finance">
                    <div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div>
                </div>
                
                <form id="tf-application-form" novalidate>
                    <!-- Step 1: Company Details -->
                    <div id="tf-step-1" class="service-step">
                        <h3>Step 1: Company Details</h3>
                        <div class="form-section two-column">
                            <div class="input-wrapper"><label for="tf-company-name">Company Name</label><input type="text" id="tf-company-name" required></div>
                            <div class="input-wrapper"><label for="tf-registration-number">Business Registration No.</label><input type="text" id="tf-registration-number" required></div>
                            <div class="input-wrapper"><label for="tf-contact-person">Contact Person</label><input type="text" id="tf-contact-person" required></div>
                            <div class="input-wrapper"><label for="tf-contact-email">Contact Email</label><input type="email" id="tf-contact-email" required></div>
                        </div>
                    </div>
                    
                     <!-- Step 2: Documents -->
                    <div id="tf-step-2" class="service-step">
                        <h3>Step 2: Upload Compliance Documents</h3>
                        <p class="subtitle">Drag & drop your files or click to upload.</p>
                        <div id="tf-compliance-checklist" class="compliance-checklist"></div>
                    </div>
                    
                     <!-- Step 3: Review -->
                    <div id="tf-step-3" class="service-step">
                        <h3>Step 3: Review & Submit</h3>
                        <div id="tf-review-pane" class="payment-overview"></div>
                    </div>
                    
                     <!-- Step 4: Confirmation -->
                    <div id="tf-step-4" class="service-step">
                        <div class="confirmation-container">
                             <h3>Application Received!</h3>
                             <p>Your application ID is <strong id="tf-application-id"></strong>. Our team will review your submission and be in touch within 2-3 business days.</p>
                             <div class="confirmation-actions">
                                <button type="button" class="secondary-btn" id="tf-download-summary-btn">Download Summary</button>
                                <button type="button" class="main-submit-btn" id="tf-back-to-services-btn">Back to Services</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="secondary-btn" id="tf-wizard-back-btn">Back</button>
                        <button type="button" class="main-submit-btn" id="tf-wizard-next-btn">Next</button>
                    </div>
                </form>
            </div>
        </div>
    `,(e=t.querySelector(".back-btn"))==null||e.addEventListener("click",()=>{Le.register.mainView.classList.remove("hidden"),Le.register.applicationView.classList.add("hidden"),bt("landing")}))}function Cc(t){var r;Ae({currentTradeFinanceStep:t}),Ei("trade-finance",t-1),document.querySelectorAll("#tf-application-form .service-step").forEach(o=>o.classList.remove("active")),(r=document.getElementById(`tf-step-${t}`))==null||r.classList.add("active");const e=document.getElementById("tf-wizard-back-btn"),n=document.getElementById("tf-wizard-next-btn"),i=document.querySelector("#tf-application-form .form-actions");t===4?i==null||i.classList.add("hidden"):i==null||i.classList.remove("hidden"),t===1?e.style.visibility="hidden":e.style.visibility="visible",t===3?n.textContent="Submit Application":n.textContent="Next"}async function FN(t){if(t.preventDefault(),!kc())return;const{advisorForm:e,userQueryInput:n,chatHistory:i}=Le.register;if(!e||!n||!i||!j.api)return;const r=n.value.trim();if(!r)return;const o=document.createElement("div");o.className="chat-message-tf user-msg",o.textContent=r,i.appendChild(o),n.value="",tc.push({role:"user",parts:[{text:r}]}),nc++;const s=document.createElement("div");if(s.className="chat-message-tf advisor-msg thinking-indicator",s.innerHTML='<span>Thinking</span><div class="dot"></div><div class="dot"></div><div class="dot"></div>',i.appendChild(s),i.scrollTop=i.scrollHeight,nc>=BN){const c='It seems your query is quite specific. For the best assistance, please start a general application and our experts will guide you, or contact them directly at <a href="mailto:support@vcanresources.com">support@vcanresources.com</a>.';s.remove();const u=document.createElement("div");u.className="chat-message-tf advisor-msg",u.innerHTML=c,i.appendChild(u),i.scrollTop=i.scrollHeight,nc=0;return}const a={type:Wn.OBJECT,properties:{recommendedProduct:{type:Wn.STRING,enum:["Invoice Financing","PO Financing","Supply Chain Finance","None"]},reasoning:{type:Wn.STRING}},required:["recommendedProduct","reasoning"]};try{const c=await j.api.models.generateContent({model:"gemini-2.5-flash",contents:`System: You are a trade finance advisor for Vcanship. Recommend 'Invoice Financing', 'PO Financing', or 'Supply Chain Finance'. If unclear, recommend 'None'. Provide a brief reasoning.
            ${tc.map(v=>`${v.role}: ${v.parts[0].text}`).join(`
`)}
            user: ${r}`,config:{responseMimeType:"application/json",responseSchema:a}}),u=JSON.parse(c.text);s.remove();const f=document.createElement("div");f.className="chat-message-tf advisor-msg";let p=`<p>${u.reasoning}</p>`;if(u.recommendedProduct&&u.recommendedProduct!=="None"){p+="<p>I've highlighted the recommended option for you above. Click it to learn more and start an application.</p>",document.querySelectorAll(".tf-product-card").forEach(m=>m.classList.remove("highlighted","selected"));const v=document.querySelector(`.tf-product-card[data-product="${u.recommendedProduct}"]`);v==null||v.classList.add("highlighted")}f.innerHTML=p,i.appendChild(f),i.scrollTop=i.scrollHeight,tc.push({role:"model",parts:[{text:JSON.stringify(u)}]})}catch(c){console.error("AI Advisor Error:",c),s.remove();const u=document.createElement("div");u.className="chat-message-tf advisor-msg",u.textContent="Sorry, I encountered an error. Please try again.",i.appendChild(u),i.scrollTop=i.scrollHeight}}function qN(t){var n;Ae({tradeFinanceProduct:t}),Le.register.mainView.classList.add("hidden"),Le.register.applicationView.classList.remove("hidden");const e=document.getElementById("tf-wizard-header");e&&(e.innerHTML=`
            <h3>Applying for: ${t} 
                <button type="button" id="tf-change-product-btn" class="link-btn">(Change)</button>
            </h3>
        `,(n=document.getElementById("tf-change-product-btn"))==null||n.addEventListener("click",()=>{Le.register.mainView.classList.remove("hidden"),Le.register.applicationView.classList.add("hidden"),Ae({tradeFinanceProduct:null})})),Cc(1)}function UN(){const t=j.currentTradeFinanceStep;if(t===3){const e=`TF-${Date.now().toString().slice(-6)}`;document.getElementById("tf-application-id").textContent=e,Cc(4)}else t===1&&J0(j.tradeFinanceProduct),t===2&&HN(),Cc(t+1)}function $N(t,e){const n=j.tradeFinanceComplianceDocs.findIndex(i=>i.id===e);if(n>-1){const i=[...j.tradeFinanceComplianceDocs];i[n]={...i[n],file:t,status:"uploaded"},Ae({tradeFinanceComplianceDocs:i});const r=document.getElementById(e);if(!r)return;const o=r.querySelector(".file-drop-area-idle"),s=r.querySelector(".file-drop-area-uploaded");o&&s&&(o.style.display="none",s.style.display="flex",s.innerHTML=`
                <div class="file-info">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="file-icon"><path fill-rule="evenodd" d="M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 18.375 9h-7.5A3.75 3.75 0 0 1 7.125 5.25V1.5H5.625Zm7.5 0v3.75c0 .621.504 1.125 1.125 1.125h3.75a3.75 3.75 0 0 1-3.75 3.75h-7.5a.75.75 0 0 0-.75.75v11.25c0 .414.336.75.75.75h12.75a.75.75 0 0 0 .75-.75V12.75a.75.75 0 0 0-.75-.75h-7.5a2.25 2.25 0 0 1-2.25-2.25V1.5h-1.5Z" clip-rule="evenodd" /></svg>
                    <div class="file-details">
                        <span class="file-name">${t.name}</span>
                        <span class="file-status-badge">Uploaded</span>
                    </div>
                </div>
                <button type="button" class="remove-file-btn" data-doc-id="${e}">&times;</button>
            `)}}function ON(t){const e=j.tradeFinanceComplianceDocs.findIndex(n=>n.id===t);if(e>-1){const n=[...j.tradeFinanceComplianceDocs];n[e]={...n[e],file:null,status:"pending"},Ae({tradeFinanceComplianceDocs:n}),J0(j.tradeFinanceProduct)}}function J0(t){let e=[{id:"tf-doc-incorp",title:"Certificate of Incorporation",description:"Legal proof of your company registration.",status:"pending",file:null,required:!0},{id:"tf-doc-id",title:"Director ID Documents",description:"Passport or national ID for all company directors.",status:"pending",file:null,required:!0}];t==="Invoice Financing"?e.push({id:"tf-doc-invoice",title:"Sample Customer Invoice",description:"A typical invoice you issue to your clients.",status:"pending",file:null,required:!0}):t==="PO Financing"&&(e.push({id:"tf-doc-po",title:"Purchase Order",description:"The PO you need to fulfill.",status:"pending",file:null,required:!0}),e.push({id:"tf-doc-supplier",title:"Supplier Quotation / Proforma",description:"The invoice from your supplier for the goods.",status:"pending",file:null,required:!0})),Ae({tradeFinanceComplianceDocs:e}),Le.register.complianceChecklist.innerHTML=e.map(n=>`
        <div class="compliance-doc-item" id="${n.id}" data-status="${n.status}">
            <div class="compliance-doc-info">
                <h4>${n.title} ${n.required?"<span>(Required)</span>":""}</h4>
                <p>${n.description}</p>
            </div>
            <div class="file-drop-area">
                <div class="file-drop-area-idle">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="upload-icon"><path fill-rule="evenodd" d="M11.47 2.47a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06l-3.22-3.22V16.5a.75.75 0 0 1-1.5 0V4.81L8.03 8.03a.75.75 0 0 1-1.06-1.06l4.5-4.5ZM3 15.75A2.25 2.25 0 0 1 5.25 18h13.5A2.25 2.25 0 0 1 21 15.75v-3a.75.75 0 0 1 1.5 0v3A3.75 3.75 0 0 1 18.75 19.5H5.25A3.75 3.75 0 0 1 1.5 15.75v-3a.75.75 0 0 1 1.5 0v3Z" clip-rule="evenodd" /></svg>
                    <span>Drop file or click</span>
                </div>
                <div class="file-drop-area-uploaded" style="display: none;"></div>
                <input type="file" class="file-input" accept=".pdf,.doc,.docx,.jpg,.png" data-doc-id="${n.id}">
            </div>
        </div>
    `).join("")}function HN(){const t=document.getElementById("tf-review-pane");t&&(t.innerHTML=`
        <div style="width: 100%;">
            <h4>Application Summary</h4>
            <div class="review-item"><span>Product:</span><strong>${j.tradeFinanceProduct}</strong></div>
            <div class="review-item"><span>Company:</span><strong>${document.getElementById("tf-company-name").value}</strong></div>
            <div class="review-item"><span>Contact:</span><strong>${document.getElementById("tf-contact-email").value}</strong></div>
            <hr>
            <h4>Uploaded Documents</h4>
            <ul>
                ${j.tradeFinanceComplianceDocs.filter(e=>e.file).map(e=>`<li>${e.title}: ${e.file.name}</li>`).join("")||"<li>No documents uploaded.</li>"}
            </ul>
        </div>
    `)}function VN(){var n,i,r,o;(n=Le.register.advisorForm)==null||n.addEventListener("submit",FN),(i=document.getElementById("tf-wizard-next-btn"))==null||i.addEventListener("click",UN),(r=document.getElementById("tf-wizard-back-btn"))==null||r.addEventListener("click",()=>Cc(j.currentTradeFinanceStep-1)),(o=document.getElementById("tf-back-to-services-btn"))==null||o.addEventListener("click",()=>bt("landing"));function t(s){var c;document.querySelectorAll(".tf-product-card").forEach(u=>u.classList.remove("selected","highlighted")),(c=document.querySelector(`.tf-product-card[data-product="${s}"]`))==null||c.classList.add("selected"),Ae({tradeFinanceProduct:s});const a=document.getElementById("tf-start-application-btn");a.disabled=!1,a.textContent=`Start ${s} Application`}const e=Le.register.page;e.addEventListener("click",s=>{const a=s.target,c=a.closest(".tf-product-card");c!=null&&c.dataset.product&&t(c.dataset.product);const u=a.closest("#tf-start-application-btn");u&&!u.disabled&&j.tradeFinanceProduct&&qN(j.tradeFinanceProduct);const f=a.closest(".remove-file-btn");f!=null&&f.dataset.docId&&ON(f.dataset.docId)}),e.addEventListener("change",s=>{var c;const a=s.target;a.classList.contains("file-input")&&((c=a.files)!=null&&c[0])&&a.dataset.docId&&$N(a.files[0],a.dataset.docId)})}function GN(){Ae({currentService:"register"}),DN(),bt("register"),U1(),od(),tc=[],nc=0,VN()}const WN=[{id:"parcel",label:"Parcel"},{id:"air_freight",label:"Air Freight"},{id:"baggage",label:"Baggage"},{id:"fcl",label:"FCL"},{id:"lcl",label:"LCL"},{id:"vehicle_shipping",label:"Vehicle Shipping"},{id:"railway_freight",label:"Railway Freight"},{id:"bulk_charter",label:"Bulk Charter"},{id:"river_barge_tug",label:"River Barge / Tug"},{id:"warehousing",label:"Warehousing"},{id:"schedule_trade_lanes",label:"Schedule Trade Lanes"},{id:"trade_finance",label:"Trade Finance"}],zN=[{id:"africa",label:"Africa"},{id:"asia",label:"Asia"},{id:"europe",label:"Europe"},{id:"north_america",label:"North America"},{id:"south_america",label:"South America"},{id:"oceania",label:"Oceania"},{id:"middle_east",label:"Middle East"},{id:"global",label:"Global"}],JN=[{id:"freight_forwarder",label:"Freight Forwarder"},{id:"carrier",label:"Carrier (Ocean/Air/Land)"},{id:"warehouse_operator",label:"Warehouse Operator"},{id:"customs_broker",label:"Customs Broker"},{id:"trucking_company",label:"Trucking Company"},{id:"3pl",label:"Third-Party Logistics (3PL)"}];function YN(){var e;const t=document.getElementById("page-service-provider-register");t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div class="service-page-header">
            <h2>Register as a Service Provider</h2>
            <p class="subtitle">Join our network of logistics partners. Fill out the form below to get started.</p>
        </div>
        <div class="form-container card" style="padding: 2rem;">
            <form id="service-provider-form" noValidate>
                <div class="form-section two-column" style="gap: 2rem; align-items: flex-start;">
                    <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                        <h3>Company Information</h3>
                        <div class="input-wrapper">
                            <label for="company_name">Company Name</label>
                            <input id="company_name" name="company_name" placeholder="Global Logistics Inc." required />
                            <p class="error-text hidden"></p>
                        </div>
                        <div class="input-wrapper">
                            <label for="website">Website</label>
                            <input id="website" name="website" type="url" placeholder="https://globallogistics.com" required />
                             <p class="error-text hidden"></p>
                        </div>
                        <div class="input-wrapper">
                            <label for="logo">Company Logo</label>
                            <input id="logo" name="logo" type="file" accept="image/png, image/jpeg" class="file-input-styled" />
                             <div id="logo-preview-container" class="file-preview-container"></div>
                            <p class="helper-text">PNG or JPG, max 2MB.</p>
                            <p class="error-text hidden"></p>
                        </div>
                        <div class="input-wrapper">
                            <label for="business_document">Business Registration Document</label>
                            <input id="business_document" name="business_document" type="file" accept=".pdf,.docx" class="file-input-styled" />
                            <p id="document-filename-display" class="helper-text" style="font-weight: 500;"></p>
                            <p class="helper-text">PDF or DOCX, max 5MB.</p>
                            <p class="error-text hidden"></p>
                        </div>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                        <h3>Contact & Address</h3>
                        <div class="input-wrapper">
                            <label for="email">Primary Contact Email</label>
                            <input id="email" type="email" name="email" placeholder="contact@company.com" required />
                             <p class="error-text hidden"></p>
                        </div>
                        <div class="input-wrapper">
                            <label for="phone">Primary Contact Phone</label>
                            <input id="phone" name="phone" placeholder="+1 (555) 123-4567" required />
                             <p class="error-text hidden"></p>
                        </div>
                         <div class="input-wrapper">
                            <label for="address_street">Street Address</label>
                            <input id="address_street" name="address_street" placeholder="123 Logistics Lane" required />
                             <p class="error-text hidden"></p>
                        </div>
                         <div class="input-wrapper">
                            <label for="address_city">City</label>
                            <input id="address_city" name="address_city" placeholder="New York" required />
                             <p class="error-text hidden"></p>
                        </div>
                         <div class="input-wrapper">
                            <label for="address_country">Country</label>
                            <input id="address_country" name="address_country" placeholder="USA" required />
                             <p class="error-text hidden"></p>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <span class="checkbox-group-label">Provider Type</span>
                    <p class="helper-text">What type of provider are you? Select all that apply.</p>
                    <div class="checkbox-grid" id="provider-type-grid">
                        ${JN.map(n=>`
                            <div class="checkbox-wrapper">
                                <input type="checkbox" id="provider-${n.id}" value="${n.id}" name="provider_type">
                                <label for="provider-${n.id}">${n.label}</label>
                            </div>
                        `).join("")}
                    </div>
                    <p class="error-text hidden" id="provider-type-error"></p>
                </div>

                <div class="form-section">
                    <span class="checkbox-group-label">Services Offered</span>
                    <p class="helper-text">Select all the services your company provides.</p>
                    <div class="checkbox-grid" id="services-grid">
                        ${WN.map(n=>`
                            <div class="checkbox-wrapper">
                                <input type="checkbox" id="service-${n.id}" value="${n.id}" name="services">
                                <label for="service-${n.id}">${n.label}</label>
                            </div>
                        `).join("")}
                    </div>
                    <p class="error-text hidden" id="services-error"></p>
                </div>
                
                 <div class="form-section">
                    <span class="checkbox-group-label">Coverage Regions</span>
                    <p class="helper-text">Select all regions your company operates in.</p>
                    <div class="checkbox-grid" id="regions-grid">
                         ${zN.map(n=>`
                            <div class="checkbox-wrapper">
                                <input type="checkbox" id="region-${n.id}" value="${n.id}" name="coverage_regions">
                                <label for="region-${n.id}">${n.label}</label>
                            </div>
                        `).join("")}
                    </div>
                     <p class="error-text hidden" id="regions-error"></p>
                </div>

                <div class="form-section">
                    <h3>Payout Information</h3>
                    <p class="helper-text">How you'll get paid. Securely provide your payout details to receive funds from your sales.</p>
                    <div class="payout-options">
                        <button type="button" id="stripe-connect-btn" class="main-submit-btn">
                            <i class="fa-brands fa-stripe-s"></i> Connect with Stripe (Recommended)
                        </button>
                        <p class="helper-text" style="text-align: center; margin: 0.5rem 0;">or</p>
                        <button type="button" id="manual-payout-btn" class="link-btn">Enter Bank Details Manually</button>
                    </div>
                    <div id="manual-payout-fields" class="hidden" style="margin-top: 1.5rem; border-top: 1px solid var(--border-color); padding-top: 1.5rem;">
                        <div class="two-column" style="gap: 2rem;">
                            <div class="input-wrapper">
                                <label for="account_holder_name">Account Holder Name</label>
                                <input id="account_holder_name" name="account_holder_name" placeholder="John Doe" />
                                <p class="error-text hidden"></p>
                            </div>
                            <div class="input-wrapper">
                                <label for="bank_name">Bank Name</label>
                                <input id="bank_name" name="bank_name" placeholder="Global Bank Inc." />
                                <p class="error-text hidden"></p>
                            </div>
                        </div>
                        <div class="two-column" style="gap: 2rem;">
                             <div class="input-wrapper">
                                <label for="iban">IBAN</label>
                                <input id="iban" name="iban" placeholder="DE89 3704 0044 0532 0130 00" />
                                <p class="error-text hidden"></p>
                            </div>
                            <div class="input-wrapper">
                                <label for="swift_bic">SWIFT / BIC Code</label>
                                <input id="swift_bic" name="swift_bic" placeholder="DEUTDEFF" />
                                <p class="error-text hidden"></p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="main-submit-btn">Submit Registration</button>
                </div>
            </form>
        </div>
    `,(e=t.querySelector(".back-btn"))==null||e.addEventListener("click",()=>bt("landing")))}function Om(t){var r,o;const e=(r=t.parentElement)==null?void 0:r.querySelector(".error-text");let n=!0,i="";return t.required&&!t.value.trim()?(n=!1,i="This field is required."):t.id==="company_name"&&t.value.trim().length<2?(n=!1,i="Company name must be at least 2 characters."):t.id==="phone"&&t.value.trim().length<10?(n=!1,i="Phone number must be at least 10 characters."):t.id==="address_street"&&t.value.trim().length<5?(n=!1,i="Street address must be at least 5 characters."):t.id==="address_city"&&t.value.trim().length<2?(n=!1,i="City must be at least 2 characters."):t.id==="address_country"&&t.value.trim().length<2?(n=!1,i="Country must be at least 2 characters."):t.type==="email"&&t.value.trim()&&!/^\S+@\S+\.\S+$/.test(t.value)?(n=!1,i="Please enter a valid email address."):t.type==="url"&&t.value.trim()&&!/^https?:\/\/.+\..+/.test(t.value)?(n=!1,i="Please enter a valid URL (e.g., https://example.com)."):t.id==="iban"&&t.value.trim()&&!/^[A-Z]{2}[0-9]{2}[A-Z0-9]{1,30}$/.test(t.value.replace(/\s/g,""))?(n=!1,i="Please enter a valid IBAN format."):t.id==="swift_bic"&&t.value.trim()&&!/^[A-Z]{6}[A-Z0-9]{2}([A-Z0-9]{3})?$/.test(t.value)&&(n=!1,i="Please enter a valid SWIFT/BIC code."),e&&e.classList.contains("error-text")&&(e.textContent=i,e.classList.toggle("hidden",n),(o=t.closest(".input-wrapper"))==null||o.classList.toggle("input-error",!n)),n}function id(t,e){const n=document.querySelectorAll(`input[name="${t}"]:checked`).length>0,i=document.getElementById(e);return i&&(i.classList.toggle("hidden",n),n||(i.textContent="Please select at least one option.")),n}function Ec(t,e,n){var a,c,u;const i=(a=t.parentElement)==null?void 0:a.querySelector(".error-text"),r=(c=t.files)==null?void 0:c[0];let o=!0,s="";return r&&(r.size>e*1024*1024?(o=!1,s=`File size must not exceed ${e}MB.`):n.includes(r.type)||(s=`Invalid file type. Please upload one of: ${n.map(p=>p.split("/")[1].toUpperCase()).join(", ")}.`)),i&&(i.textContent=s,i.classList.toggle("hidden",o),(u=t.closest(".input-wrapper"))==null||u.classList.toggle("input-error",!o)),o}async function KN(t){t.preventDefault();const e=t.target;let n=!0;e.querySelectorAll('input[required], input[type="url"], input[type="email"]').forEach(a=>{Om(a)||(n=!1)});const i=document.getElementById("logo"),r=document.getElementById("business_document");Ec(i,2,["image/png","image/jpeg"])||(n=!1),Ec(r,5,["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document"])||(n=!1),id("provider_type","provider-type-error")||(n=!1),id("services","services-error")||(n=!1),id("coverage_regions","regions-error")||(n=!1);const o=document.getElementById("manual-payout-fields");if(o&&!o.classList.contains("hidden")&&e.querySelectorAll("#manual-payout-fields input").forEach(a=>{a.value.trim()!==""&&(Om(a)||(n=!1))}),!n){Ee("Please correct the errors in the form.","error");return}rt(!0,"Submitting registration...");const s={accountHolder:document.getElementById("account_holder_name").value,bankName:document.getElementById("bank_name").value,iban:document.getElementById("iban").value,swiftBic:document.getElementById("swift_bic").value};console.log("Captured Payout Data (demo):",s),Ee("This is a demo. Form submission is not connected to a live database.","info"),setTimeout(()=>{rt(!1),Ee("Registration Submitted! (Demo)","success"),e.reset();const a=document.getElementById("logo-preview-container");a&&(a.innerHTML="");const c=document.getElementById("document-filename-display");c&&(c.textContent="");const u=document.getElementById("manual-payout-fields");u&&u.classList.add("hidden")},1500)}function jN(){const t=document.getElementById("service-provider-form");t==null||t.addEventListener("submit",KN);const e=document.getElementById("logo"),n=document.getElementById("logo-preview-container");e==null||e.addEventListener("change",()=>{var u;const c=(u=e.files)==null?void 0:u[0];if(n.innerHTML="",c){if(!Ec(e,2,["image/png","image/jpeg"]))return;const f=new FileReader;f.onloadend=()=>{const p=document.createElement("img");p.src=f.result,p.alt="Logo preview",n.appendChild(p)},f.readAsDataURL(c)}});const i=document.getElementById("business_document"),r=document.getElementById("document-filename-display");i==null||i.addEventListener("change",()=>{var u;const c=(u=i.files)==null?void 0:u[0];if(c){if(!Ec(i,5,["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document"])){r.textContent="";return}r.textContent=`Selected: ${c.name}`}else r.textContent=""});const o=document.getElementById("stripe-connect-btn"),s=document.getElementById("manual-payout-btn"),a=document.getElementById("manual-payout-fields");o==null||o.addEventListener("click",()=>{Ee("In a real app, this would redirect to Stripe for secure onboarding.","info"),a&&a.classList.add("hidden")}),s==null||s.addEventListener("click",()=>{a&&a.classList.toggle("hidden")})}function QN(){Ae({currentService:"service-provider-register"}),YN(),bt("service-provider-register"),jN()}const XN=.025;function Bs(t){var e;Ae({currentSecureTradeStep:t}),Ei("trade-finance",t-1),document.querySelectorAll("#page-secure-trade .service-step").forEach(n=>n.classList.remove("active")),(e=document.getElementById(`secure-trade-step-${t}`))==null||e.classList.add("active")}function ZN(){const t=document.getElementById("page-secure-trade");t&&(t.innerHTML=`
        <button class="back-btn">Back to Services</button>
        <div class="service-page-header">
            <h2>Vcanship Secure Trade</h2>
            <p class="subtitle">Your end-to-end solution for secure global transactions and shipping.</p>
        </div>
        <div class="form-container">
            <div class="visual-progress-bar" id="progress-bar-trade-finance">
                <div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div>
            </div>

            <!-- Step 1: Details -->
            <div id="secure-trade-step-1" class="service-step">
                <form id="secure-trade-details-form" novalidate>
                    <h3>Step 1: Initiate Your Secure Trade</h3>
                    <p class="subtitle" style="text-align:left; max-width: 100%; margin: 0 0 2rem;">Enter the details of your trade. We will contact the seller with instructions once you have funded the transaction.</p>
                    <div class="form-section">
                        <div class="input-wrapper"><label for="st-seller-email">Seller's Email Address</label><input type="email" id="st-seller-email" required placeholder="seller@example.com"></div>
                        <div class="input-wrapper"><label for="st-goods-desc">Brief Description of Goods</label><input type="text" id="st-goods-desc" required placeholder="e.g., 1000 Custom T-Shirts"></div>
                        <div class="input-wrapper"><label for="st-goods-value">Value of Goods (${j.currentCurrency.code})</label><input type="number" id="st-goods-value" required min="1" placeholder="e.g., 5000"></div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="main-submit-btn">Calculate Fees & Proceed</button>
                    </div>
                </form>
            </div>

            <!-- Step 2: Funding -->
            <div id="secure-trade-step-2" class="service-step">
                <h3>Step 2: Fund the Transaction</h3>
                <p class="subtitle" style="text-align:left; max-width: 100%; margin: 0 0 2rem;">Review the cost breakdown below. Your funds will be held securely by Vcanship until the seller's goods are verified and you approve the shipment.</p>
                <div id="st-funding-summary" class="payment-overview card"></div>
                <div class="quote-confirmation-panel">
                    <h4>How it Works</h4>
                    <p>By clicking "Confirm Deposit", you are authorizing Vcanship to hold these funds. We will then instruct the seller to deliver the goods to our warehouse. Shipping costs will be calculated and quoted separately after verification.</p>
                </div>
                <div class="form-actions" style="justify-content: space-between;">
                    <button type="button" id="st-back-to-details" class="secondary-btn">Back</button>
                    <button type="button" id="st-confirm-deposit" class="main-submit-btn">Confirm Deposit (Simulated)</button>
                </div>
            </div>

            <!-- Step 3: Awaiting Cargo -->
            <div id="secure-trade-step-3" class="service-step">
                <div class="status-card card">
                    <div class="status-icon"><i class="fa-solid fa-hourglass-half"></i></div>
                    <h3>Awaiting Seller's Cargo</h3>
                    <p>We have received your funds and have instructed the seller to deliver the goods to our designated warehouse. We will notify you as soon as the cargo arrives for verification.</p>
                    <div id="st-awaiting-details" class="payment-overview" style="margin-top: 2rem; text-align: left;"></div>
                </div>
            </div>

            <!-- Step 4: Verification -->
            <div id="secure-trade-step-4" class="service-step">
                 <h3>Step 3: Verify Your Cargo</h3>
                 <p class="subtitle" style="text-align:left; max-width: 100%; margin: 0 0 2rem;">The seller's goods have arrived at our warehouse. Please review the verification report below. Click "Approve & Ship" to proceed with shipping and release the payment to the seller.</p>
                 <div class="verification-report-card">
                    <h4>Verification Report: #<span id="st-verification-trade-id"></span></h4>
                    <div class="report-summary">
                        <p>Our team has visually inspected the cargo. See photos below. Everything appears to match the description provided.</p>
                    </div>
                    <div class="photo-grid">
                        <img src="https://placehold.co/400x300/e2e8f0/adb5bd?text=Box+1" alt="Cargo photo 1">
                        <img src="https://placehold.co/400x300/e2e8f0/adb5bd?text=Box+2" alt="Cargo photo 2">
                        <img src="https://placehold.co/400x300/e2e8f0/adb5bd?text=Contents" alt="Cargo photo 3">
                    </div>
                 </div>
                 <div class="form-actions" style="justify-content: space-between;">
                    <button type="button" class="secondary-btn" style="background-color: var(--error-color); color: white; border-color: var(--error-color);">Raise Dispute</button>
                    <button type="button" id="st-approve-shipment" class="main-submit-btn">Approve & Ship</button>
                </div>
            </div>

            <!-- Step 5: Confirmation -->
            <div id="secure-trade-step-5" class="service-step">
                <div class="confirmation-container">
                    <h3>Trade Complete & Shipment Initiated!</h3>
                    <p>You have approved the cargo. Payment has been released to the seller, and we will now proceed with arranging the final shipment to you.</p>
                    <div class="confirmation-tracking"><h4>Your Secure Trade ID</h4><div class="tracking-id-display" id="st-confirmation-trade-id"></div></div>
                    <div class="confirmation-actions">
                        <button id="st-new-trade-btn" class="main-submit-btn">Start a New Secure Trade</button>
                    </div>
                </div>
            </div>
        </div>
    `)}function e6(t){t.preventDefault();const e=document.getElementById("st-seller-email").value,n=document.getElementById("st-goods-desc").value,i=parseFloat(document.getElementById("st-goods-value").value);if(!e||!n||isNaN(i)||i<=0){Ee("Please fill out all fields with valid information.","error");return}const r={sellerEmail:e,goodsDescription:n,goodsValue:i},o=i*XN,s=i+o;Ae({secureTradeDetails:r,secureTradeFee:o,secureTradeTotalDeposit:s});const a=document.getElementById("st-funding-summary");a&&(a.innerHTML=`
            <div class="review-item"><span>Value of Goods:</span><strong>${j.currentCurrency.symbol}${r.goodsValue.toFixed(2)}</strong></div>
            <div class="review-item"><span>Vcanship Secure Trade Fee (2.5%):</span><strong>${j.currentCurrency.symbol}${o.toFixed(2)}</strong></div>
            <hr>
            <div class="review-item total"><span>Total Secure Deposit:</span><strong>${j.currentCurrency.symbol}${s.toFixed(2)}</strong></div>
        `),Bs(2)}function t6(){rt(!0,"Securing your transaction..."),setTimeout(()=>{const t=`VST-${Date.now().toString().slice(-6)}`;Ae({secureTradeId:t});const e=document.getElementById("st-awaiting-details");e&&j.secureTradeDetails&&(e.innerHTML=`
                <div class="review-item"><span>Trade ID:</span><strong>${t}</strong></div>
                <div class="review-item"><span>Goods:</span><strong>${j.secureTradeDetails.goodsDescription}</strong></div>
                <div class="review-item"><span>Seller:</span><strong>${j.secureTradeDetails.sellerEmail}</strong></div>
            `),rt(!1),Bs(3),setTimeout(()=>{j.currentService==="secure-trade"&&j.currentSecureTradeStep===3&&(Ee(`Cargo for trade #${t} has arrived at our warehouse!`,"success"),document.getElementById("st-verification-trade-id").textContent=t,Bs(4))},8e3)},1500)}function n6(){rt(!0,"Finalizing transaction..."),setTimeout(()=>{document.getElementById("st-confirmation-trade-id").textContent=j.secureTradeId,rt(!1),Bs(5),Ee("Payment released to seller. Shipment is being processed.","success")},1500)}function i6(){var e,n,i,r,o,s;const t=document.getElementById("page-secure-trade");t&&((e=t.querySelector(".back-btn"))==null||e.addEventListener("click",()=>bt("landing")),(n=document.getElementById("secure-trade-details-form"))==null||n.addEventListener("submit",e6),(i=document.getElementById("st-back-to-details"))==null||i.addEventListener("click",()=>Bs(1)),(r=document.getElementById("st-confirm-deposit"))==null||r.addEventListener("click",t6),(o=document.getElementById("st-approve-shipment"))==null||o.addEventListener("click",n6),(s=document.getElementById("st-new-trade-btn"))==null||s.addEventListener("click",Y0))}function Y0(){Ae({currentService:"secure-trade"}),$1(),ZN(),bt("secure-trade"),i6(),Bs(1)}function r6(t){switch(t){case"parcel":return yy;case"baggage":return G_;case"fcl":return a0;case"lcl":return aP;case"airfreight":return N0;case"vehicle":return R0;case"warehouse":return bN;case"ecommerce":return xN;case"schedules":return MN;case"register":return GN;case"service-provider-register":return QN;case"railway":return sN;case"inland":return D0;case"bulk":return gN;case"rivertug":return vN;case"secure-trade":return Y0;default:return null}}function o6(t){switch(t){case"dashboard":return vf;case"address-book":return Ha;case"settings":return yf;case"api-hub":return fy;case"help":return dy;case"privacy":return hy;case"terms":return py;default:return null}}const _i=async t=>{if(dc(),t!=="service-provider-register"){if(["ecommerce","dashboard","address-book","settings","secure-trade"].includes(t)&&!j.isLoggedIn){Ae({postLoginRedirectService:t}),tf();return}}const e=o6(t);if(e){Ae({currentService:null}),e(),bt(t);return}const n=r6(t);if(typeof n=="function"){rt(!0,"Loading service...");try{await new Promise(i=>setTimeout(i,50)),Ae({currentService:t}),n(),d_(t)}catch(i){console.error(`Failed to load service module for '${t}':`,i),Ee(`Could not load the ${t} service. Please try again.`,"error"),j.currentPage!=="landing"&&bt("landing")}finally{rt(!1)}}else Ee(`The '${t}' service is not available yet.`,"info"),console.warn(`Attempted to mount unknown service: ${t}`)};var s6={};let Ua=null,Xd=null,Zd=null;const a6=s6.STRIPE_PUBLISHABLE_KEY||"pk_test_51Pbi57RxPl8AIz54N5k1d365mQEtLqigstn62BAbpuqXqI0B0g60bkc2y6w2wO2r67c5Chw6uDxtaQyvIxiqWvsd00OAKW4xH5";function l6(){return new Promise((t,e)=>{if(window.Stripe){t();return}const n=document.createElement("script");n.src="https://js.stripe.com/v3/",n.async=!0,n.onload=()=>t(),n.onerror=()=>e("Failed to load Stripe.js"),document.head.appendChild(n)})}function c6(){const t=document.getElementById("payment-summary-items"),e=document.getElementById("payment-summary-total");if(!t||!e||!j.paymentContext)return;const{quote:n,addons:i}=j.paymentContext;let r=n.totalCost,o=`
        <div class="review-item">
            <span>${n.carrierName} (${n.carrierType})</span>
            <strong>${j.currentCurrency.symbol}${n.totalCost.toFixed(2)}</strong>
        </div>
    `;i&&i.length>0&&i.forEach(s=>{o+=`
                <div class="review-item">
                    <span>${s.name}</span>
                    <strong>${j.currentCurrency.symbol}${s.cost.toFixed(2)}</strong>
                </div>
            `,r+=s.cost}),t.innerHTML=o,e.textContent=`${j.currentCurrency.symbol}${r.toFixed(2)}`}async function u6(){if(!Ua||!j.paymentContext){Ee("Payment cannot be initiated.","error"),_i("landing");return}const{quote:t,addons:e,shipmentId:n}=j.paymentContext;let i=t.totalCost+((e==null?void 0:e.reduce((r,o)=>r+o.cost,0))||0);rt(!0,"Preparing secure payment...");try{const{data:r,error:o}=await In.functions.invoke("create-payment-intent",{body:{amount:Math.round(i*100),currency:j.currentCurrency.code.toLowerCase(),description:`Vcanship Shipment ${n}`}});if(o||!(r!=null&&r.clientSecret))throw new Error((o==null?void 0:o.message)||"Failed to create payment session.");Ae({paymentClientSecret:r.clientSecret}),Xd=Ua.elements({clientSecret:r.clientSecret}),Zd=Xd.create("card",{style:{base:{color:getComputedStyle(document.documentElement).getPropertyValue("--text-color").trim(),fontFamily:'"Poppins", sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:getComputedStyle(document.documentElement).getPropertyValue("--medium-gray").trim()}},invalid:{color:getComputedStyle(document.documentElement).getPropertyValue("--error-color").trim(),iconColor:getComputedStyle(document.documentElement).getPropertyValue("--error-color").trim()}}});const s=document.getElementById("stripe-card-element");if(s)s.innerHTML="",Zd.mount(s);else throw new Error("Stripe container element not found.")}catch(r){console.error("Error mounting payment form:",r),Ee(r.message||"Could not prepare payment form.","error"),_i(j.paymentContext.service||"landing")}finally{rt(!1)}}async function d6(t){if(t.preventDefault(),!Ua||!Xd||!j.paymentClientSecret){Ee("Payment system is not ready. Please wait.","error");return}const e=document.getElementById("payment-submit-btn"),n=e.querySelector(".loading-spinner-small");rt(!0,"Processing payment..."),e.disabled=!0,n&&(n.style.display="inline-block");try{const r=document.getElementById("cardholder-name").value;if(!r)throw Ee("Please enter the cardholder name.","error"),new Error("Missing cardholder name");const{error:o,paymentIntent:s}=await Ua.confirmCardPayment(j.paymentClientSecret,{payment_method:{card:Zd,billing_details:{name:r}}});if(o)throw Ee(o.message||"An error occurred during payment.","error"),new Error(o.message);if(s&&s.status==="succeeded"){if(Ee("Payment successful!","success"),j.paymentContext){const{quote:a,addons:c,shipmentId:u,origin:f,destination:p,service:v}=j.paymentContext,m=a.totalCost+((c==null?void 0:c.reduce((S,_)=>S+_.cost,0))||0);jS({service:v,tracking_id:u,origin:typeof f=="string"?f:f.street,destination:typeof p=="string"?p:p.street,cost:m,currency:j.currentCurrency.code}),sessionStorage.setItem("vcanship_show_confirmation",JSON.stringify(j.paymentContext)),_i(v)}}else Ee("Payment did not succeed. Please try again.","warning")}catch(i){console.error("Payment submission failed:",i)}finally{rt(!1),e.disabled=!1,n&&(n.style.display="none")}}async function f6(){try{await l6(),Ua=window.Stripe(a6)}catch(n){console.error(n),Ee("Could not load payment provider. Please refresh.","error");return}const t=document.getElementById("page-payment");t&&new MutationObserver(i=>{for(const r of i)r.attributeName==="class"&&r.target.classList.contains("active")&&(j.paymentContext?(c6(),u6()):(Ee("No payment information found. Redirecting...","error"),_i("landing")))}).observe(t,{attributes:!0});const e=document.getElementById("payment-form");e==null||e.addEventListener("submit",d6)}async function h6(t,e,n){try{rt(!0,"Creating your account...");const{data:i,error:r}=await In.auth.signUp({email:t,password:e,options:{data:{full_name:n},emailRedirectTo:`${window.location.origin}/auth/callback`}});if(r)throw r;if(!i.user)throw new Error("Failed to create user");const{error:o}=await In.from("users").insert({id:i.user.id,email:i.user.email,name:n,subscription_tier:"free"});if(o)throw o;rt(!1),Ee("Account created! Please check your email to verify your account.","success"),Le.authModal.classList.remove("active")}catch(i){rt(!1),console.error("Sign up error:",i),Ee(i.message||"Failed to create account","error")}}async function p6(t,e){try{rt(!0,"Signing in...");const{data:n,error:i}=await In.auth.signInWithPassword({email:t,password:e});if(i)throw i;if(!n.user)throw new Error("Failed to sign in");rt(!1),Ee("Welcome back!","success"),Le.authModal.classList.remove("active")}catch(n){rt(!1),console.error("Sign in error:",n),Ee(n.message||"Failed to sign in","error")}}async function g6(){try{rt(!0,"Redirecting to Google...");const{data:t,error:e}=await In.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`,queryParams:{access_type:"offline",prompt:"consent"}}});if(e)throw e}catch(t){rt(!1),console.error("Google sign in error:",t),Ee("Failed to sign in with Google","error")}}async function m6(){try{rt(!0,"Signing out...");const{error:t}=await In.auth.signOut();if(t)throw t;Ae({isLoggedIn:!1,currentUser:null,subscriptionTier:"guest",aiLookupsRemaining:0}),rt(!1),Ee("Signed out successfully","success"),bt("landing")}catch(t){rt(!1),console.error("Sign out error:",t),Ee("Failed to sign out","error")}}async function K0(t){try{const{data:e,error:n}=await In.from("users").select("*").eq("id",t).single();if(n)throw n;return e}catch(e){return console.error("Failed to get user profile:",e),null}}async function ef(){try{const{data:{session:t}}=await In.auth.getSession();if(t!=null&&t.user){const e=await K0(t.user.id);e&&(Ae({isLoggedIn:!0,currentUser:{name:e.name,email:e.email},subscriptionTier:e.subscription_tier||"free",aiLookupsRemaining:e.ai_lookups_remaining||5}),Le.myAccountBtn&&(Le.myAccountBtn.textContent=`Hi, ${e.name.split(" ")[0]}`),Le.myAccountDropdown&&Le.myAccountDropdown.classList.remove("hidden"),Le.loginSignupBtn&&(Le.loginSignupBtn.style.display="none"))}else Ae({isLoggedIn:!1,currentUser:null,subscriptionTier:"guest",aiLookupsRemaining:0}),Le.myAccountDropdown&&Le.myAccountDropdown.classList.add("hidden"),Le.loginSignupBtn&&(Le.loginSignupBtn.style.display="block")}catch(t){console.error("Session check error:",t)}}function v6(){In.auth.onAuthStateChange(async(t,e)=>{if(console.log("Auth state changed:",t),t==="SIGNED_IN"&&(e!=null&&e.user)){const n=await K0(e.user.id);n&&(Ae({isLoggedIn:!0,currentUser:{name:n.name,email:n.email},subscriptionTier:n.subscription_tier||"free",aiLookupsRemaining:n.ai_lookups_remaining||5}),Ee(`Welcome back, ${n.name.split(" ")[0]}!`,"success"),await ef())}else t==="SIGNED_OUT"&&(Ae({isLoggedIn:!1,currentUser:null,subscriptionTier:"guest",aiLookupsRemaining:0}),await ef())})}async function y6(){await ef()}function b6(){const{isLoggedIn:t,currentUser:e}=j;Le.loginSignupBtn.classList.toggle("hidden",t),Le.myAccountDropdown.classList.toggle("hidden",!t),t&&e&&(Le.myAccountBtn.textContent=`Hi, ${e.name.split(" ")[0]}`);const n=document.getElementById("header-dashboard-link");n&&(n.style.display=t?"inline-block":"none");const i=document.getElementById("welcome-banner");i&&(t&&e?(i.innerHTML=`
                <h2 class="welcome-title">Welcome back, ${e.name}!</h2>
                <p>What would you like to ship today?</p>
            `,i.classList.remove("hidden")):(i.innerHTML="",i.classList.add("hidden")))}function Hm(t){const e=t==="login";Le.loginView.classList.toggle("hidden",!e),Le.signupView.classList.toggle("hidden",e),Le.loginToggleText.classList.toggle("hidden",!e),Le.signupToggleText.classList.toggle("hidden",e)}async function Vm(t){t==="Google"?await g6():Ee("Apple Sign In coming soon!","info")}async function w6(t){t.preventDefault();const e=Le.loginEmail.value,n=Le.loginPassword.value;await p6(e,n)}async function S6(t){t.preventDefault();const e=Le.signupName.value,n=Le.signupEmail.value,i=Le.signupPassword.value;await h6(n,i,e)}async function _6(){await m6()}function C6(){v6(),y6(),Le.loginSignupBtn.addEventListener("click",tf),Le.closeAuthModalBtn.addEventListener("click",H1),Le.showSignupBtn.addEventListener("click",()=>Hm("signup")),Le.showLoginBtn.addEventListener("click",()=>Hm("login")),Le.loginForm.addEventListener("submit",w6),Le.signupForm.addEventListener("submit",S6),document.querySelectorAll(".google-login-btn").forEach(e=>{e.addEventListener("click",()=>Vm("Google"))}),document.querySelectorAll(".apple-login-btn").forEach(e=>{e.addEventListener("click",()=>Vm("Apple"))}),document.querySelectorAll(".password-toggle").forEach(e=>{e.addEventListener("click",()=>{const n=e.previousElementSibling,i=e.querySelector("i");!n||!i||(n.type==="password"?(n.type="text",i.classList.remove("fa-eye"),i.classList.add("fa-eye-slash"),e.setAttribute("aria-label","Hide password")):(n.type="password",i.classList.remove("fa-eye-slash"),i.classList.add("fa-eye"),e.setAttribute("aria-label","Show password")))})})}function Gm(t){document.documentElement.setAttribute("data-theme",t),localStorage.setItem("vcanship-theme",t)}function E6(){const t=document.querySelector(".theme-switch");if(!t)return;const e=localStorage.getItem("vcanship-theme"),n=window.matchMedia("(prefers-color-scheme: dark)").matches;Gm(e||(n?"dark":"light")),t.addEventListener("click",()=>{const o=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";Gm(o)})}function T6(){const t=document.querySelector("header");if(!t)return;let e=window.scrollY,n=!1;const i=()=>{const o=window.scrollY;o<=10?t.classList.remove("header-hidden"):o>e&&o>100?t.classList.add("header-hidden"):o<e&&t.classList.remove("header-hidden"),e=o,n=!1},r=()=>{n||(window.requestAnimationFrame(i),n=!0)};window.addEventListener("scroll",r,{passive:!0})}function A6(){const t=document.getElementById("mobile-menu-btn"),e=document.getElementById("app-sidebar"),n=document.getElementById("mobile-sidebar-overlay");if(!t||!e||!n)return;const i=()=>{e.classList.toggle("mobile-active"),n.classList.toggle("active")},r=()=>{e.classList.remove("mobile-active"),n.classList.remove("active")};t.addEventListener("click",i),n.addEventListener("click",r),e.addEventListener("click",o=>{const s=o.target;(s.classList.contains("sidebar-btn")||s.classList.contains("sidebar-btn-service")||s.closest(".sidebar-btn")||s.closest(".sidebar-btn-service"))&&r()})}function I6(){if(!(/iPhone|iPod|Android.*Mobile/i.test(navigator.userAgent)&&window.innerWidth<=767))return;let e=null,n=sessionStorage.getItem("vcanship-orientation-dismissed")==="true";const i=()=>{const r=window.innerHeight>window.innerWidth;if(r&&!n){if(!e){e=document.createElement("div"),e.style.cssText=`
                    position: fixed;
                    bottom: 0;
                    left: 0;
                    right: 0;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 1rem;
                    text-align: center;
                    z-index: 1000;
                    box-shadow: 0 -4px 12px rgba(0,0,0,0.2);
                    animation: slideUp 0.3s ease;
                    font-family: 'Poppins', sans-serif;
                `,e.innerHTML=`
                    <div style="display: flex; align-items: center; justify-content: space-between; gap: 1rem; max-width: 600px; margin: 0 auto;">
                        <div style="display: flex; align-items: center; gap: 0.75rem; flex: 1;">
                            <i class="fas fa-mobile-screen-button" style="font-size: 2rem; animation: rotatePhone 2s ease-in-out infinite;"></i>
                            <div style="text-align: left;">
                                <strong style="display: block; margin-bottom: 0.25rem;">Better View Available!</strong>
                                <span style="font-size: 0.9rem; opacity: 0.95;">Rotate your phone to landscape mode</span>
                            </div>
                        </div>
                        <button id="dismiss-orientation" style="
                            background: rgba(255,255,255,0.3);
                            border: 2px solid white;
                            color: white;
                            padding: 0.5rem 1rem;
                            border-radius: 20px;
                            cursor: pointer;
                            font-weight: 600;
                            white-space: nowrap;
                            font-family: 'Poppins', sans-serif;
                        ">Got it</button>
                    </div>
                `,document.body.appendChild(e);const o=document.createElement("style");o.textContent=`
                    @keyframes slideUp {
                        from { transform: translateY(100%); }
                        to { transform: translateY(0); }
                    }
                    @keyframes rotatePhone {
                        0%, 100% { transform: rotate(0deg); }
                        25% { transform: rotate(-15deg); }
                        75% { transform: rotate(15deg); }
                    }
                `,document.head.appendChild(o);const s=e.querySelector("#dismiss-orientation");s==null||s.addEventListener("click",()=>{n=!0,sessionStorage.setItem("vcanship-orientation-dismissed","true"),e&&(e.style.animation="slideDown 0.3s ease",setTimeout(()=>{e==null||e.remove(),e=null},300))})}}else!r&&e&&(e.remove(),e=null)};i(),window.addEventListener("orientationchange",()=>{setTimeout(i,300)}),window.addEventListener("resize",()=>{setTimeout(i,100)})}let rd=null,Wm=null;function k6(){const t=document.getElementById("chatbot-fab"),e=document.getElementById("chat-window"),n=document.getElementById("close-chat-btn"),i=document.getElementById("chat-form"),r=document.getElementById("chat-input"),o=document.getElementById("chat-history");if(!(!t||!e||!n||!i||!o)){try{console.warn("API_KEY missing for chatbot. Disabling feature."),t.style.display="none";return}catch(s){console.error("Failed to initialize Gemini for chatbot:",s),t.style.display="none";return}t.addEventListener("click",()=>{e.classList.remove("hidden"),t.classList.add("hidden"),r.focus()}),n.addEventListener("click",()=>{e.classList.add("hidden"),t.classList.remove("hidden")}),i.addEventListener("submit",async s=>{if(s.preventDefault(),!rd)return;const a=r.value.trim();if(!a)return;r.value="",r.disabled=!0;const c=document.createElement("div");c.className="chat-message user-message",c.textContent=a,o.appendChild(c),o.scrollTop=o.scrollHeight;const u=document.createElement("div");u.className="chat-message bot-message thinking-indicator",u.innerHTML='<span>Thinking</span><div class="dot"></div><div class="dot"></div><div class="dot"></div>',o.appendChild(u),o.scrollTop=o.scrollHeight;try{const f=await rd.sendMessageStream({message:a});let p=document.createElement("div");p.className="chat-message bot-message";let v=!0;for await(const m of f)v&&(o.removeChild(u),o.appendChild(p),v=!1),p.textContent+=m.text,o.scrollTop=o.scrollHeight}catch(f){console.error("Chatbot error:",f),o.removeChild(u);const p=document.createElement("div");p.className="chat-message bot-message error",p.textContent="Sorry, I couldn't connect to the assistant right now.",o.appendChild(p)}finally{r.disabled=!1,r.focus(),o.scrollTop=o.scrollHeight}})}}async function x6(){await S_(),E6(),gy();const t=new URLSearchParams(window.location.search),e=sessionStorage.getItem("vcanship_checkout_context");if(t.get("stripe-success")&&e){const i=JSON.parse(e);Ee("Payment successful! Your shipment is confirmed.","success"),sessionStorage.setItem("vcanship_show_confirmation",JSON.stringify(i)),_i(i.service),sessionStorage.removeItem("vcanship_checkout_context"),history.replaceState(null,"",window.location.pathname)}else t.get("stripe-cancel")&&(Ee("Payment was cancelled. You can try again anytime.","info"),sessionStorage.removeItem("vcanship_checkout_context"),history.replaceState(null,"",window.location.pathname));f_(),C6(),f6();const n=document.getElementById("logout-btn");n&&n.addEventListener("click",i=>{i.preventDefault(),_6()}),o_(),h_(),b_(),k6(),T6(),I6(),A6(),VL().catch(i=>{console.error("Failed to initialize API usage tracking:",i)}),document.body.addEventListener("click",i=>{const r=i.target,o=r.closest("[data-service]"),s=r.closest(".static-link");if(s){i.preventDefault(),dc();const a=s.dataset.page;a==="landing"?(Ae({currentService:null}),bt("landing")):_i(a);return}if(o){const a=o.dataset.service;a&&(i.preventDefault(),_i(a))}}),Le.trackBtn.addEventListener("click",()=>{Le.trackingModal.classList.add("active")}),Le.closeTrackingModalBtn.addEventListener("click",()=>{Le.trackingModal.classList.remove("active")}),Le.trackingForm.addEventListener("submit",i=>{i.preventDefault(),Ee("Live tracking coming soon!","info")}),Le.complianceBtn.addEventListener("click",i=>{i.preventDefault(),Le.inspectorModal.classList.add("active")}),Le.closeInspectorModalBtn.addEventListener("click",()=>{Le.inspectorModal.classList.remove("active")}),b6()}x6();export{Bt as _,P6 as c,D5 as g};
